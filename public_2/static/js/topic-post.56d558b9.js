(window.webpackJsonp=window.webpackJsonp||[]).push([["topic-post"],{"04fe":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.readCategories=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/categories.v2",method:"GET",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"0a1d":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={url:"",method:"GET",dataType:"json",timeout:3e4,isValidate:!1,validateRules:null}},"185d":function(t,e,i){t.exports=i.p+"static/img/auth.51e40f27.svg"},1865:function(t,e,i){"use strict";i.r(e);var a=i("f108"),s=i("3bd0");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("d9eb");var n=i("f0c5"),r=Object(n.a)(s.default,a.b,a.c,!1,null,"2b7e4c4a",null,!1,a.a,void 0);e.default=r.exports},"245f":function(t,e,i){"use strict";(function(e){var a=i("4ea4").default,s=a(i("6f74")),o=i("b95e"),n=a(i("4c82"));t.exports={mixins:[s.default,n.default],methods:{getForum:function(){var t=this;this.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]).then((function(e){e&&(t.forum=e)}))},jump2PhoneLoginPage:function(){uni.redirectTo({url:"/pages/user/phone-login"})},jump2PhoneLoginRegisterPage:function(){uni.redirectTo({url:"/pages/user/phone-login-register"})},jump2LoginPage:function(){uni.navigateTo({url:"/pages/user/login"})},jump2RegisterPage:function(){uni.redirectTo({url:"/pages/user/register"})},jump2RegisterExtendPage:function(){uni.redirectTo({url:"/pages/user/supple-mentary"})},jump2LoginBindPage:function(){uni.redirectTo({url:"/pages/user/login-bind"})},jump2RegisterBindPage:function(){uni.redirectTo({url:"/pages/user/register-bind"})},jump2LoginBindPhonePage:function(){uni.redirectTo({url:"/pages/user/login-bind-phone"})},jump2RegisterBindPhonePage:function(){uni.redirectTo({url:"/pages/user/register-bind-phone"})},jump2findpwdPage:function(){uni.navigateTo({url:"/pages/modify/findpwd?pas=reset_pwd"})},mpLoginMode:function(){this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&this.jump2LoginPage(),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&(uni.setStorageSync("register",1),uni.setStorageSync("isSend",!0),this.$store.getters["session/get"]("auth").open())},h5LoginMode:function(){n.default.isWeixin().isWeixin?(this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&(uni.setStorageSync("register",1),this.$store.dispatch("session/wxh5Login"))):(this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}),this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type&&this.jump2PhoneLoginRegisterPage(),this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type&&uni.navigateTo({url:"/pages/user/login"}))},refreshmpParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};t()},mpLogin:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;uni.setStorageSync("register",t),uni.setStorageSync("isSend",!0),this.$store.getters["session/get"]("auth").open()},wxh5Login:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;uni.setStorageSync("register",t),uni.setStorageSync("rebind",e),uni.setStorageSync("h5_wechat_login",1),this.$store.dispatch("session/wxh5Login")},getLoginParams:function(t,e){var i=t;if(""===t.data.attributes.username)uni.showToast({icon:"none",title:this.i18n.t("user.usernameEmpty"),duration:2e3});else if(""===t.data.attributes.password)uni.showToast({icon:"none",title:this.i18n.t("user.passwordEmpty"),duration:2e3});else{var a=uni.getStorageSync("token");""!==a&&(i.data.attributes.token=a),this.login(i,e)}},getLoginBindParams:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.refreshmpParams();var a=t;if(""===t.data.attributes.username)uni.showToast({icon:"none",title:this.i18n.t("user.usernameEmpty"),duration:2e3});else if(""===t.data.attributes.password)uni.showToast({icon:"none",title:this.i18n.t("user.passwordEmpty"),duration:2e3});else{1===i&&(a.data.attributes.rebind=1);var s=uni.getStorageSync("token");""!==s&&(a.data.attributes.token=s),this.login(a,e)}},login:function(t,i){var a=this;this.$store.dispatch("session/h5Login",t).then((function(t){if(t&&t.data&&t.data.data&&t.data.data.id&&(a.logind(),a.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]).then((function(t){t&&t.set_site&&t.set_site.site_mode!==o.SITE_PAY&&uni.getStorage({key:"page",success:function(t){uni.redirectTo({url:t.data})}}),t&&t.set_site&&t.set_site.site_mode===o.SITE_PAY&&a.user&&!a.user.paid&&uni.redirectTo({url:"/pages/site/info"})})),uni.showToast({title:i,duration:2e3})),t&&t.data&&t.data.errors){if("401"===t.data.errors[0].status||"402"===t.data.errors[0].status||"500"===t.data.errors[0].status){var e=a.i18n.t("core.".concat(t.data.errors[0].code));uni.showToast({icon:"none",title:e,duration:2e3})}if("403"===t.data.errors[0].status||"422"===t.data.errors[0].status){var s=a.i18n.t("core.".concat(t.data.errors[0].code))||a.i18n.t(t.data.errors[0].detail[0]);uni.showToast({icon:"none",title:s,duration:2e3})}}})).catch((function(t){return e.log(t)}))}}}}).call(this,i("5a52").default)},"25d8":function(t,e,i){"use strict";var a=i("4ea4").default;i("99af"),i("c975"),i("ac1f"),i("1276");var s=a(i("b469"));t.exports={mixins:[s.default],methods:{getPosition:function(){var t=this.forums.lbs.qq_lbs_key;new qq.maps.Geolocation(t,"myapp").getLocation(this.showPosition,this.errorPosition,{timeout:6e3})},showPosition:function(t){var e=this.forums.lbs.qq_lbs_key,i="".concat(t.lat,",").concat(t.lng),a=window.location.href,s=a.indexOf("&name");-1!==s&&(a=a.substr(0,s));var o=encodeURIComponent(a);window.location.href="https://apis.map.qq.com/tools/locpicker?search=1&type=0&backurl=".concat(o,"&key=").concat(e,"&referer=myapp&coord=").concat(i)},errorPosition:function(){this.getPosition()},getUrl:function(){var t=/iPad|iPhone|iPod/.test(navigator.userAgent),e=window.location.href.split("#")[0];return t&&window.entryUrl&&!/wechatdevtools/.test(navigator.userAgent)&&(e=window.entryUrl),e}}}},"26d0":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("ac1f"),i("5319"),i("a9e3");var a,s=i("b95e"),o=i("f61d"),n=s.DISCUZ_REQUEST_HOST.replace(/\/$/,""),r=(0,o.apiIns)({baseURL:n});r.http.interceptors.response.use((function(t){var e=t.data,i=e||{},s=i.Code,n=i.Message;switch(a=getApp(),Number(s)){case o.RESPONSE_CODE.UNAUTHORIZED:a.$store.dispatch("forum/setError",{code:"type_401",status:500});break;case o.RESPONSE_CODE.SUCCESS:break;default:uni.showToast({icon:"none",title:n})}return e}));var c=r;e.default=c},"2df5":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.createPosts=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={data:{type:"object",fields:{relationships:{type:"object",fields:{thread:{type:"object",fields:{data:{type:"object",required:!0,fields:{id:{type:"number",required:!0}}}}}}},attributes:{type:"object",fields:{replyId:{type:"number"},content:{type:"string",required:!0},commentPostId:{type:"number"},commentUserId:{type:"number"}}}}}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/posts.v2",method:"POST",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",handleError(t.t0));case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"2e6a":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.readCommentList=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={page:{type:"number"},perPage:{type:"number"}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/posts.v2",method:"GET",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"35ab":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=0,i=0;i<t.length;i++)e+=t.charCodeAt(i);var a=function(t,e,i){var a,s,o,n=Math.floor(6*t),r=6*t-n,c=i*(1-e),u=i*(1-r*e),d=i*(1-(1-r)*e);switch(n%6){case 0:a=i,s=d,o=c;break;case 1:a=u,s=i,o=c;break;case 2:a=c,s=i,o=d;break;case 3:a=c,s=u,o=i;break;case 4:a=d,s=c,o=i;break;case 5:a=i,s=c,o=u}return{r:Math.floor(255*a),g:Math.floor(255*s),b:Math.floor(255*o)}}(e%360/360,.3,.9);return""+a.r.toString(16)+a.g.toString(16)+a.b.toString(16)},i("d3b7"),i("25f0")},"368d":function(t,e,i){t.exports=i.p+"static/img/msg-warning.f35ce51f.svg"},"3bd0":function(t,e,i){"use strict";i.r(e);var a=i("cfc0"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e.default=s.a},"3edc":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAhBAMAAABtpjWKAAAAKlBMVEUAAAD09PTz8/P09PT09PT09PT29vb19fX19fX09PT19fX09PT09PT09PTGpfImAAAADXRSTlMA7AdUwoMl0JcZPa1ttwPs5AAAALtJREFUKM+NkMsJwlAQRYM/tACFgAEXglsbyMZ9QAsQTAvuLUGIHaQEGxBsIRg1BG8vfhK8zpsRcpZzFsO5XgNap7EtOsDZFGugtO5tAFliiANeHI3X0VtctejiQ6pEWAnfvQ+CSuQTR0xRs1QRNRcVUZNthIjxZSsidhTFr+gDZC4jyI33XgCQO1NmIGLJvRQPRjikjJD4jJDkKkIuGWpRMkKSJYyQLBghKVQEl4xtMfIiEJGCP3grmAyfqDpxqSbCHDEAAAAASUVORK5CYII="},4661:function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.readStickList=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={categoryId:{type:"array"}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/sticks.v2",method:"GET",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},4833:function(t,e,i){var a=i("6bc4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);(0,i("4f06").default)("31c5c818",a,!0,{sourceMap:!1,shadowMode:!1})},5458:function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.updatePosts=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={data:{type:"object",required:!0,fields:{attributes:{type:"object",required:!0,fields:{}}}},pid:{type:"number",required:!0}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function e(){var i,a,n,u,d,p,l,h,f=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.length>0&&void 0!==f[0]?f[0]:{},e.prev=1,a=i.params,n=void 0===a?{}:a,u=i.data,d=void 0===u?{}:u,p=(0,o.default)(i,r),t.log("op",d),l=(0,s.default)((0,s.default)({url:"/api/posts.update.v2",method:"POST",params:n,data:d},p),{},{validateRules:c}),e.next=7,this.http(l);case 7:return h=e.sent,e.abrupt("return",h);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",handleError(e.t0));case 14:case"end":return e.stop()}}),e,this,[[1,11]])})))).apply(this,arguments)}}).call(this,i("5a52").default)},6354:function(t,e){},6524:function(t,e,i){"use strict";(function(t){var a;i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return a}));try{a={quiPage:i("29c4").default,quiCellItem:i("e0ca").default,quiAvatar:i("da98").default,quiIcon:i("895d").default,quiEmoji:i("725e").default,quiUploader:i("c012").default,quiUploadFile:i("500f").default,quiUploadVideo:i("a1e0").default,quiUploadAudio:i("0316").default,uSwitch:i("1504").default,quiButton:i("8397").default,quiPay:i("35fd").default,uniPopup:i("1c89").default,quiToast:i("2039").default,quiLoadingCover:i("605f").default}}catch(e){if(-1===e.message.indexOf("Cannot find module")||-1===e.message.indexOf(".vue"))throw e;t.error(e.message),t.error("1. 排查组件名称拼写是否正确"),t.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),t.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("qui-page",{attrs:{"data-qui-theme":t.theme}},[t.loadStatus?a("v-uni-view",{staticClass:"post-box"},[1===t.type?a("v-uni-view",{staticClass:"post-box__title"},[1===t.type?a("v-uni-input",{staticClass:"post-box__title-input",attrs:{type:"text",focus:1===t.type,placeholder:t.i18n.t("discuzq.post.pleaseEnterAPostTitle")},model:{value:t.postTitle,callback:function(e){t.postTitle=e},expression:"postTitle"}}):t._e()],1):t._e(),5===t.type?a("v-uni-view",{staticClass:"post-box__titles"},[5===t.type?a("qui-cell-item",{attrs:{title:t.i18n.t("discuzq.post.askedUsers"),"slot-right":!0,arrow:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeAvatar.apply(void 0,arguments)}}},[a("qui-avatar",{staticClass:"my-profile__avatar",staticStyle:{"margin-right":"20rpx"},attrs:{user:{avatarUrl:t.userImage,username:t.beUserName}}}),a("v-uni-view",{staticClass:"username"},[t._v(t._s(t.beUserName))])],1):t._e()],1):t._e(),1!==t.type?a("v-uni-view",[a("v-uni-view",{staticClass:"post-box__hd"},[a("v-uni-view",{staticClass:"post-box__hd-l"},[a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-expression",size:"34",color:t.emojiShow?"#EA3D5A":"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.emojiclick.apply(void 0,arguments)}}}),a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-call",size:"34",color:"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.callClick.apply(void 0,arguments)}}}),a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-wei",size:"34",color:"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.topicPage.apply(void 0,arguments)}}})],1),5!==t.type?a("v-uni-text",{staticClass:"post-box__hd-r"},[t._v(t._s(t.textAreaValue.length<=t.textAreaLength?t.i18n.t("discuzq.post.note",{num:t.textAreaLength-t.textAreaValue.length}):t.i18n.t("discuzq.post.exceed",{num:t.textAreaValue.length-t.textAreaLength})))]):t._e(),5===t.type?a("v-uni-text",{staticClass:"post-box__hd-r"},[t._v(t._s(t.textAreaValue.length<=t.textAreaLength?t.i18n.t("discuzq.post.note",{num:t.textAnswerLength-t.textAreaValue.length}):t.i18n.t("discuzq.post.exceed",{num:t.textAreaValue.length-t.textAnswerLength})))]):t._e()],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.emojiShow,expression:"emojiShow"}],staticClass:"emoji-bd"},[a("qui-emoji",{attrs:{position:"absolute",top:"20rpx","border-radius":"10rpx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getEmojiClick.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"post-box__con"},[a("v-uni-textarea",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],ref:"textarea",staticClass:"post-box__con-text",attrs:{id:"textarea",placeholder:5!==t.type?t.i18n.t("discuzq.post.placeholder"):t.i18n.t("discuzq.post.placeholderQuestion"),"placeholder-class":"textarea-placeholder","auto-height":"true","show-confirm-bar":t.barStatus,"adjust-position":!0,"cursor-spacing":"30",cursor:"cursor",maxlength:49999,focus:1!==t.type},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.contBlur.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.focusEvent.apply(void 0,arguments)}},model:{value:t.textAreaValue,callback:function(e){t.textAreaValue=e},expression:"textAreaValue"}}),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:!t.textShow,expression:"!textShow"}],staticClass:"post-box__con-text post-box__con-text--static"},[a("v-uni-text",{staticClass:"text-cover"},[t._v(t._s(t.textAreaValue))])],1),t.markdownShow?a("v-uni-view",{staticClass:"markdown-box"},[a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-bold",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("bold")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-title",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("title")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-italic",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("italic")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-quote",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("quote")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-code",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("code")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-link",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("link")}}})],1),a("v-uni-view",[a("qui-icon",{staticClass:"qui-icon",attrs:{name:"icon-strikethrough",size:"30"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toolBarClick("strikethrough")}}})],1)],1):t._e()],1)],1):a("v-uni-view",[a("v-uni-view",{ref:"vditor"},[a("v-uni-view",{staticClass:"post-box__hd"},[a("v-uni-view",{staticClass:"post-box__hd-l"},[a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-expression",size:"34",color:t.emojiShow?"#EA3D5A":"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.emojiclick.apply(void 0,arguments)}}}),a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-call",size:"34",color:"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.callClick.apply(void 0,arguments)}}}),a("qui-icon",{staticClass:"post-box__hd-l__icon",attrs:{name:"icon-wei",size:"34",color:"#999999"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.topicPage.apply(void 0,arguments)}}})],1),5!==t.type?a("v-uni-text",{staticClass:"post-box__hd-r"},[t._v(t._s(t.textAreaValue.length<=t.textAreaLength?t.i18n.t("discuzq.post.note",{num:t.textAreaLength-t.textAreaValue.length}):t.i18n.t("discuzq.post.exceed",{num:t.textAreaValue.length-t.textAreaLength})))]):t._e(),5===t.type?a("v-uni-text",{staticClass:"post-box__hd-r"},[t._v(t._s(t.textAreaValue.length<=t.textAreaLength?t.i18n.t("discuzq.post.note",{num:t.textAnswerLength-t.textAreaValue.length}):t.i18n.t("discuzq.post.exceed",{num:t.textAreaValue.length-t.textAnswerLength})))]):t._e()],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.emojiShow,expression:"emojiShow"}],staticClass:"emoji-bd"},[a("qui-emoji",{attrs:{position:"absolute",top:"20rpx","border-radius":"10rpx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getEmojiClick.apply(void 0,arguments)}}})],1),a("v-uni-view",{staticClass:"post-box__con"},[a("v-uni-textarea",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],ref:"textarea",staticClass:"post-box__con-text",attrs:{id:"textarea",placeholder:5!==t.type?t.i18n.t("discuzq.post.placeholder"):t.i18n.t("discuzq.post.placeholderQuestion"),"placeholder-class":"textarea-placeholder","auto-height":"true","show-confirm-bar":t.barStatus,"adjust-position":!0,"cursor-spacing":"30",cursor:"cursor",maxlength:49999,focus:1!==t.type},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.contBlur.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.focusEvent.apply(void 0,arguments)}},model:{value:t.textAreaValue,callback:function(e){t.textAreaValue=e},expression:"textAreaValue"}}),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:!t.textShow,expression:"!textShow"}],staticClass:"post-box__con-text post-box__con-text--static"},[a("v-uni-text",{staticClass:"text-cover"},[t._v(t._s(t.textAreaValue))])],1)],1)],1)],1),1===t.type||3===t.type||5===t.type?a("qui-uploader",{ref:"upload",attrs:{url:t.url+"api/attachments","form-data":t.formData,"file-preview":t.filePreview,name:"file","async-clear":!0},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadChange.apply(void 0,arguments)},clear:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadClear.apply(void 0,arguments)},uploadClick:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadClick.apply(void 0,arguments)}}}):t._e(),a("qui-upload-file",{directives:[{name:"show",rawName:"v-show",value:1===t.type&&5!==t.type&&t.forums.other&&t.forums.other.can_upload_attachments,expression:"type === 1 && type !== 5 && forums.other && forums.other.can_upload_attachments"}],ref:"uploadFiles",attrs:{url:t.url+"api/attachments",header:t.header,"attachment-list":t.attachmentList,"max-length":5,"file-format":t.forums.set_attach&&t.forums.set_attach.support_file_ext,"file-size":t.forums.set_attach&&t.forums.set_attach.support_max_size},on:{deleteItem:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteFile.apply(void 0,arguments)}}}),2===t.type?a("qui-upload-video",{ref:"uploadVideo",attrs:{"type-status":t.operating,url:t.url,"video-before-list":t.videoBeforeList,controls:t.controlsStatus,"choose-type":t.chooseType},on:{videoDel:function(e){arguments[0]=e=t.$handleEvent(e),t.videoDel.apply(void 0,arguments)}}}):t._e(),4===t.type?a("v-uni-view",{staticClass:"post-box__audio"},[a("qui-upload-audio",{ref:"uploadAudio",attrs:{"audio-before-list":t.audioBeforeList},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.uploadAudioChange.apply(void 0,arguments)},audioDel:function(e){arguments[0]=e=t.$handleEvent(e),t.audioDel.apply(void 0,arguments)}}})],1):t._e(),1===t.type&&t.forums.other&&t.forums.other.can_create_thread_paid&&t.ioshide?a("qui-cell-item",{attrs:{title:t.i18n.t("discuzq.post.lookPay"),addon:t.showPayType,arrow:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.lookPay.apply(void 0,arguments)}}}):t._e(),1===t.type?a("v-uni-view",[0!==t.type&&t.showHidden&&t.forums.paycenter&&t.forums.paycenter.wxpay_close&&0!==t.payType&&t.forums.other.can_create_thread_paid&&t.ioshide?a("qui-cell-item",{class:t.price>0?"cell-item-right-text":"",attrs:{title:t.i18n.t("discuzq.post.paymentAmount"),addon:t.showPrice,arrow:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cellClick("pay")}}}):t._e()],1):0!==t.type&&5!==t.type&&6!==t.type&&t.forums.other.can_create_thread_paid&&t.ioshide?a("v-uni-view",[0!==t.type&&t.showHidden&&t.forums.paycenter.wxpay_close&&t.forums.other.can_create_thread_paid&&t.ioshide?a("qui-cell-item",{class:t.price>0?"cell-item-right-text":"",attrs:{title:4===t.type?t.i18n.t("discuzq.post.payByListeningToAudio"):t.i18n.t("discuzq.post.paymentAmount"),addon:t.showPrice,arrow:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cellClick("pay")}}}):t._e()],1):t._e(),6===t.type?a("v-uni-view",[t.isShowGoods&&6===t.type&&t.dataGoodInfo?a("v-uni-view",{staticClass:"post-box__good"},[a("v-uni-view",[a("v-uni-image",{staticClass:"post-box__good__image",attrs:{"lazy-load":!0,src:t.dataGoodInfo.imagePath}})],1),a("v-uni-view",{staticClass:"post-box__good__info"},[a("v-uni-view",{staticClass:"post-box__good__title"},[t._v(t._s(t.dataGoodInfo.title))]),a("v-uni-view",{staticClass:"post-box__good__ft",style:{justifyContent:""!==t.dataGoodInfoPrice?"space-between":"flex-end"}},[""!==t.dataGoodInfoPrice?a("v-uni-view",{staticClass:"post-box__good__price"},[t._v("￥"+t._s(t.dataGoodInfoPrice)+"元")]):t._e(),a("qui-icon",{attrs:{name:"icon-delete",size:"26"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deleteGoods.apply(void 0,arguments)}}})],1)],1)],1):a("v-uni-view",{staticClass:"post-box__space",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addGoods.apply(void 0,arguments)}}},[a("qui-icon",{attrs:{name:"icon-add",size:"26"}})],1)],1):t._e(),t.anonymity_show&&"edit"!==t.operating?a("v-uni-view",{staticClass:"uni-list-cell uni-list-cell-pd"},[a("v-uni-view",{staticClass:"uni-list-cell-db"},[t._v(t._s(t.i18n.t("discuzq.post.anonymity")))]),a("u-switch",{attrs:{"active-color":"#EA3D5A"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeCheck.apply(void 0,arguments)}},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}})],1):t._e(),5===t.type&&t.forums.other&&t.forums.other.can_be_onlooker?a("v-uni-view",{staticClass:"uni-list-cell uni-list-cell-pd"},[a("v-uni-view",{staticClass:"uni-list-cell-db"},[a("v-uni-view",{},[t._v(t._s(""+t.i18n.t("discuzq.post.otherPay")+t.forums.set_site.site_onlooker_price+"元"))]),a("v-uni-view",{staticClass:"watchpay"},[t._v(t._s(0===parseInt(t.haveDate)?"":t.i18n.t("discuzq.post.youHaveTo")+"\n            "+t.haveDate+t.i18n.t("discuzq.post.yuan")+",")+"\n          "+t._s(0===parseInt(t.answerIsDate)?"":t.i18n.t("discuzq.post.theAnswerIs")+"\n            "+t.answerIsDate+t.i18n.t("discuzq.post.yuan")+",")+"\n          "+t._s(0===parseInt(t.platformDate)?"":t.i18n.t("discuzq.post.platform")+"\n            "+t.platformDate+t.i18n.t("discuzq.post.yuan")))])],1),a("u-switch",{attrs:{"active-color":"#EA3D5A"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.changeCheck.apply(void 0,arguments)}},model:{value:t.watchChecked,callback:function(e){t.watchChecked=e},expression:"watchChecked"}})],1):t._e(),t.price>0&&3!==t.type&&2!==t.type&&0!==t.type&&4!==t.type&&5!==t.type&&1!==t.payType&&0!==t.payType?a("qui-cell-item",{attrs:{title:t.i18n.t("discuzq.post.freeWordCount"),addon:t.i18n.t("discuzq.post.word",{num:t.percentagedisplay}),arrow:!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cellClick("word")}}}):t._e(),t.redshow?a("v-uni-view",{staticClass:"post-box__position"},["edit"!==t.operating||"edit"===t.operating&&t.is_red_packet?a("qui-cell-item",{attrs:{arrow:!0,"slot-left":!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.skipred_packet()}}},[a("v-uni-view",[t.is_red_packet?a("v-uni-text",{staticClass:"redshowstyle"},[a("v-uni-text",[t._v(t._s(t.sumtype)+"红包")]),a("v-uni-text",{staticStyle:{"margin-right":"10rpx","margin-left":"10rpx"}},[t._v("/")]),t._v(t._s("随机"===t.sumtype?"总金额":"每个")),a("v-uni-text",{staticStyle:{"margin-right":"10rpx"}}),a("v-uni-text",{staticClass:"redshowstyle_redmargin"},[t._v(t._s(t.showmoney))]),t._v("元"),a("v-uni-text",{staticStyle:{"margin-right":"10rpx","margin-left":"10rpx"}},[t._v("/")]),a("v-uni-text",{staticClass:"redshowstyle_redelse"},[t._v(t._s(t.number))]),t._v("个")],1):a("v-uni-text",[t._v("添加红包")])],1)],1):t._e(),t.is_red_packet&&"edit"!==t.operating?a("qui-icon",{attrs:{name:"icon-close1",size:"32",color:"#ccc"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearPacket.apply(void 0,arguments)}}}):t._e()],1):t._e(),t.forums.lbs&&t.forums.lbs.lbs?a("v-uni-view",{staticClass:"post-box__position"},[t.geographical_location?a("qui-cell-item",{attrs:{arrow:!0,"slot-left":!0},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.choosePosition.apply(void 0,arguments)}}},[a("v-uni-view",[a("v-uni-text",[t._v(t._s(t.currentPosition&&t.currentPosition.location?t.currentPosition.location:t.i18n.t("discuzq.post.addPosition")))])],1)],1):t._e(),t.currentPosition&&t.currentPosition.location?a("qui-icon",{attrs:{name:"icon-close1",size:"32",color:"#ccc"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.clearPosition.apply(void 0,arguments)}}}):t._e()],1):t._e(),a("v-uni-view",{staticClass:"post-box__ft"},[a("v-uni-text",{staticClass:"post-box__ft-tit"},[t._v(t._s(t.i18n.t("discuzq.post.chooseCategory")))]),a("v-uni-view",{staticClass:"post-box__ft-categories"},t._l(t.allCategories,(function(e,i){return a("qui-button",{key:e._jv.id,class:Number(e._jv.id)===Number(t.categoryId)?"cateActive":"",attrs:{type:Number(e._jv.id)===Number(t.categoryId)?"primary":"",plain:Number(e._jv.id)===Number(t.categoryId)},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.checkClass(e,i,e._jv.id)}}},[t._v(t._s(e.name))])})),1),""!=t.secondallcategories?a("v-uni-view",{staticClass:"post-box__ft-categories post-box__img"},[t._l(t.secondallcategories,(function(e,i){return a("qui-button",{key:e.id,class:Number(e.id)===Number(t.two_categoryId)?"cateActive":"",attrs:{type:Number(e.id)===Number(t.two_categoryId)?"primary":"second_level",plain:Number(e.id)===Number(t.two_categoryId)},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.checkClassing(e,i,e.id)}}},[t._v(t._s(e.name))])})),a("img",{staticClass:"pullDown_img",attrs:{src:i("3edc"),alt:""}})],2):t._e(),7===t.type?a("v-uni-view",{staticClass:"post-box__position post-box__zhuti"},[a("qui-cell-item",{attrs:{arrow:!0,title:t.i18n.t("添加主题"),addon:t.titlexune},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addthetheme.apply(void 0,arguments)}}},[a("v-uni-view",[a("v-uni-text",[t._v("添加主题")])],1)],1)],1):t._e(),a("v-uni-view",{staticClass:"bottom_button"},[5!==t.type?a("qui-button",{attrs:{loading:t.postLoading,type:"primary",size:"minpink",id:"TencentCaptcha","data-appid":t.forums.qcloud&&t.forums.qcloud.qcloud_captcha_app_id||"",disabled:t.textAreaValue.length>t.textAreaLength},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.postClick.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.t("discuzq.post.post")))]):t._e(),5===t.type?a("qui-button",{attrs:{loading:t.postLoading,type:"primary",size:"minpink",id:"TencentCaptcha","data-appid":t.forums.qcloud&&t.forums.qcloud.qcloud_captcha_app_id||"",disabled:t.textAreaValue.length>t.textAreaLength},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.postAnswerClick.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.t("discuzq.post.post")))]):t._e(),a("qui-button",{attrs:{loading:t.postLoading,type:"primary",size:"minpink",id:"TencentCaptcha","data-appid":t.forums.qcloud&&t.forums.qcloud.qcloud_captcha_app_id||"",disabled:t.textAreaValue.length>t.textAreaLength},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toDraftsing.apply(void 0,arguments)}}},[t._v("保存草稿箱")])],1)],1),t.payShowStatus?a("v-uni-view",[a("qui-pay",{ref:"payShow",attrs:{"pay-type":t.payTypeText,money:t.priceAsk,"wallet-status":t.user.canWalletPay,balance:Number(t.user.walletBalance),"pay-password":t.pwdVal,"pay-type-data":t.payTypeData,"to-name":t.beUserName},on:{paysureShow:function(e){arguments[0]=e=t.$handleEvent(e),t.paysureShow.apply(void 0,arguments)},onInput:function(e){arguments[0]=e=t.$handleEvent(e),t.onInput.apply(void 0,arguments)},radioChange:function(e){arguments[0]=e=t.$handleEvent(e),t.radioChange.apply(void 0,arguments)}}}),a("qui-pay",{ref:"payShowtwo",attrs:{"pay-type":"红包支付",money:t.money,"wallet-status":t.user.canWalletPay,balance:Number(t.user.walletBalance),"pay-password":t.pwdVal,"pay-type-data":t.payTypeData,"to-name":t.beUserName},on:{paysureShow:function(e){arguments[0]=e=t.$handleEvent(e),t.paysureShow.apply(void 0,arguments)},onInput:function(e){arguments[0]=e=t.$handleEvent(e),t.onInput.apply(void 0,arguments)},radioChange:function(e){arguments[0]=e=t.$handleEvent(e),t.radioChange.apply(void 0,arguments)}}})],1):t._e(),a("uni-popup",{ref:"lookPayPopup",attrs:{type:"bottom"}},[a("v-uni-view",{staticClass:"popup-share"},[a("v-uni-view",{staticClass:"pay-type",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.choicePayType(0)}}},[t._v(t._s(t.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree")))]),1===t.type&&t.canUploadAttachment?a("v-uni-view",{staticClass:"pay-type",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.choicePayType(1)}}},[t._v(t._s(t.i18n.t("discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid")))]):t._e(),a("v-uni-view",{staticClass:"pay-type",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.choicePayType(2)}}},[t._v(t._s(t.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsPaid")))]),a("v-uni-view",{staticClass:"popup-share-content-space"}),a("v-uni-text",{staticClass:"popup-share-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancelLookPay()}}},[t._v(t._s(t.i18n.t("discuzq.post.cancel")))])],1)],1),a("uni-popup",{ref:"popupBtm",attrs:{type:"bottom"}},[a("v-uni-view",{staticClass:"popup-share"},[a("v-uni-view",{staticClass:"popup-share-content"},[5!==t.type?a("v-uni-text",{staticClass:"popup-title"},[t._v(t._s("pay"===t.setType?t.i18n.t("discuzq.post.selectToViewPaymentAmount"):t.i18n.t("discuzq.post.selectToViewFreeWordCount")))]):t._e(),"pay"===t.setType&&5===t.type?a("v-uni-text",{staticClass:"popup-title"},[t._v(t._s(t.i18n.t("discuzq.post.supportTheAuthorToContinueToCreate")))]):t._e(),"pay"===t.setType?a("v-uni-view",{staticClass:"popup-content-btn"},t._l(t.payNum,(function(e,i){return a("qui-button",{key:i,staticClass:"popup-btn",attrs:{type:t.payNumCheck.length>0&&t.payNumCheck[0].name===e.name?"primary":"post",plain:!0,size:"post"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.moneyClick(i)}}},[t._v(t._s(e.name))])})),1):t._e(),"word"===t.setType?a("v-uni-view",{staticClass:"popup-content-btn"},t._l(t.freepercentage,(function(e,i){return a("qui-button",{key:i,staticClass:"popup-btn",attrs:{type:t.freewords.length>0&&t.freewords[0].name===e.name?"primary":"post",plain:!0,size:"post"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.percentageClick(i)}}},[t._v(t._s(e.name))])})),1):t._e()],1),a("v-uni-view",{staticClass:"popup-share-content-space"}),a("v-uni-text",{staticClass:"popup-share-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.cancel()}}},[t._v(t._s(t.i18n.t("discuzq.post.cancel")))])],1)],1),t.popupStatus?a("v-uni-view",[a("uni-popup",{ref:"popup",attrs:{type:"center"}},[a("v-uni-view",{staticClass:"popup-dialog"},[a("v-uni-view",{staticClass:"popup-dialog__top"},[a("v-uni-text",[t._v(t._s(t.i18n.t("discuzq.post.payMoney")))])],1),a("v-uni-view",{staticClass:"popup-dialog__cont"},["pay"===t.setType?a("qui-icon",{staticClass:"popup-dialog__cont-rmb",attrs:{name:"icon-rmb",size:"40"}}):a("v-uni-text",{staticClass:"popup-dialog__cont-rmb"},[t._v(t._s(t.i18n.t("discuzq.post.word",{num:""})))]),"pay"===t.setType?a("v-uni-input",{staticClass:"popup-dialog__cont-input",attrs:{type:"digit",placeholder:"0.0",maxlength:t.maxLength,focus:"pay"===t.setType},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.checkNum.apply(void 0,arguments)}},model:{value:t.inputPrice,callback:function(e){t.inputPrice=e},expression:"inputPrice"}}):a("v-uni-input",{staticClass:"popup-dialog__cont-input",attrs:{type:"digit",placeholder:"0",maxlength:5,focus:"word"===t.setType},model:{value:t.inputWord,callback:function(e){t.inputWord=e},expression:"inputWord"}})],1),a("v-uni-view",{staticClass:"popup-dialog__ft"},[a("v-uni-button",{staticClass:"popup-btn--close",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.diaLogClose.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.t("discuzq.close")))]),"pay"===t.setType?a("v-uni-button",{staticClass:"popup-btn--ok",class:t.inputPrice>0?"popup-btn--ok--blue":"",attrs:{disabled:""===t.inputPrice},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.diaLogOk.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.t("discuzq.ok")))]):a("v-uni-button",{staticClass:"popup-btn--ok",class:t.inputWord>0?"popup-btn--ok--blue":"",attrs:{disabled:""===t.inputWord},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.diaLogOk.apply(void 0,arguments)}}},[t._v(t._s(t.i18n.t("discuzq.ok")))])],1)],1)],1)],1):t._e(),a("uni-popup",{ref:"deletePopup",attrs:{type:"center"}},[a("uni-popup-dialog",{attrs:{type:"warn",content:t.deleteTip,"before-close":!0},on:{close:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClickCancel.apply(void 0,arguments)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClickOk.apply(void 0,arguments)}}})],1),a("uni-popup",{ref:"wechatPopup",attrs:{type:"center"}},[a("uni-popup-dialog",{attrs:{type:"warn",content:t.wechatTip,"before-close":!0},on:{close:function(e){arguments[0]=e=t.$handleEvent(e),t.handleWechatClickCancel.apply(void 0,arguments)},confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.handleWechatClickOk.apply(void 0,arguments)}}})],1),a("qui-toast",{ref:"toast"}),t.coverLoading?a("qui-loading-cover",{attrs:{"mask-zindex":"111"}}):t._e()],1):t._e()],1)},o=[]}).call(this,i("5a52").default)},6670:function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.updateThreads=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={id:{type:"number",required:!0}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/threads/update.v2",method:"POST",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:t.prev=10,t.t0=t.catch(1);case 12:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"6bc4":function(t,e,i){(e=i("24fb")(!1)).push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* eg:\n  .container {\n    color: --color(BG-1);\n  }\n*/.uni-list-cell-gw[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.uni-list-cell-gw-explain[data-v-2b7e4c4a]{font-size:%?24?%;color:#c5c6cb}.post-box[data-v-2b7e4c4a]{width:100vw;height:100%;padding:%?40?%;overflow:hidden;background-color:var(--qui-BG-2);box-sizing:border-box}.post-box__title[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:100vw;height:%?100?%;margin-bottom:%?30?%;border-bottom:%?2?% solid var(--qui-BOR-ED)}.post-box__title-input[data-v-2b7e4c4a]{width:100%;padding-right:%?80?%;font-size:%?36?%}.post-box__titles[data-v-2b7e4c4a]{margin-bottom:%?30?%}.post-box__hd[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.post-box__hd-l__icon[data-v-2b7e4c4a]{margin-right:%?54?%}.post-box__hd-r[data-v-2b7e4c4a]{font-size:%?26?%;color:var(--qui-FC-777);color:#999!important}.post-box__con[data-v-2b7e4c4a]{width:100%;max-height:%?900?%;padding:%?10?% 0 0;margin-top:%?20?%;margin-bottom:%?63?%;overflow:hidden;background-color:var(--qui-BG-1);border:%?1?% solid var(--qui-BOR-DDD);border-radius:%?7?%;box-sizing:border-box}.post-box__con-text[data-v-2b7e4c4a]{z-index:0;width:100%;max-height:%?900?%;min-height:%?400?%;min-height:%?238?%;padding:%?10?% %?20?% %?20?%;font-size:%?30?%;line-height:%?40?%;box-sizing:border-box}.post-box__con-text .text-cover[data-v-2b7e4c4a]{font-size:%?30?%;line-height:%?40?%}.post-box__con-text--static[data-v-2b7e4c4a]{overflow:auto}.post-box__ft-tit[data-v-2b7e4c4a]{display:block;margin:%?30?% 0;font-size:%?30?%;color:var(--qui-FC-7D7979)}.post-box__ft-categories[data-v-2b7e4c4a]{margin-bottom:%?40?%}.post-box__good[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;margin:%?30?% 0;font-size:%?28?%}.post-box__good__image[data-v-2b7e4c4a]{width:%?160?%;height:%?160?%;margin:0 %?30?% 0 0;border-radius:%?5?%}.post-box__good__info[data-v-2b7e4c4a]{position:relative;-webkit-box-flex:1;-webkit-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.post-box__good__title[data-v-2b7e4c4a]{max-height:%?120?%;overflow:hidden;font-weight:700;line-height:%?40?%;color:var(--qui-FC-333)}.post-box__good__ft[data-v-2b7e4c4a]{position:absolute;bottom:0;display:-webkit-box;display:-webkit-flex;display:flex;width:100%;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;align-items:center;line-height:%?45?%;color:var(--qui-FC-777)}.post-box__good__price[data-v-2b7e4c4a]{display:inline-block;font-size:%?36?%;color:var(--qui-RED)}.post-box__good__btn[data-v-2b7e4c4a]{display:inline-block}.post-box__space[data-v-2b7e4c4a]{width:100%;height:%?160?%;margin:%?30?% 0;line-height:%?160?%;color:var(--qui-FC-B5);text-align:center;background-color:var(--qui-FC-f7);border:%?1?% solid var(--qui-BOR-ED);border-radius:%?5?%}.post-box__position[data-v-2b7e4c4a] {position:relative;color:var(--qui-FC-777)}.post-box__position[data-v-2b7e4c4a] .icon-weizhi{margin-right:%?10?%}.post-box__position[data-v-2b7e4c4a] .icon-close1{position:absolute;top:%?36?%;right:0;z-index:100}.play-load .post-box__video__play__load__mask[data-v-2b7e4c4a]{position:absolute;width:100%;height:100%;background-color:var(--qui-BG-ED);border:1px solid var(--qui-BOR-ED);border-radius:%?5?%;opacity:.7}.play-load .post-box__video__play__load__text[data-v-2b7e4c4a]{position:relative;z-index:2;font-size:%?30?%;line-height:%?36?%;color:var(--qui-FC-34)}.play-load uni-progress[data-v-2b7e4c4a]{position:absolute;bottom:%?9.5?%;z-index:3;width:87.5%}.post-box__ft-categories[data-v-2b7e4c4a] .qui-button--button{margin-top:%?10?%;margin-right:%?20?%;margin-bottom:%?10?%}.post-box__ft-categories[data-v-2b7e4c4a] .qui-button--button[type="primary"]{color:#fff;background:#ea3d5a;border:none}.post-box__ft-categories[data-v-2b7e4c4a] .qui-button--button:after{border:none;border-radius:0}.post-box__ft-categories[data-v-2b7e4c4a] .cateActive[size="default"]{color:#fff;background:#ea3d5a;border:none}.popup-content-btn[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.popup-content-btn .popup-btn[data-v-2b7e4c4a]{margin-top:%?20?%}.popup-share[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;background:var(--qui-BG-2)}.popup-share-content[data-v-2b7e4c4a]{height:%?477?%;padding:%?40?% %?45?%;text-align:center;box-sizing:border-box}.popup-share-content .popup-title[data-v-2b7e4c4a]{font-size:%?30?%}.popup-share-content-space[data-v-2b7e4c4a]{width:100%;height:%?9?%;background:var(--qui-BG-ED)}.emoji-bd[data-v-2b7e4c4a]{position:relative;width:100%}[data-v-2b7e4c4a] uni-textarea .textarea-placeholder{font-size:%?30?%;color:var(--qui-FC-B5)}[data-v-2b7e4c4a] uni-input .input-placeholder{font-size:%?36?%;color:var(--qui-FC-AAA)}.cell-item-right-text[data-v-2b7e4c4a] .cell-item__body__right-text{color:var(--qui-RED)}[data-v-2b7e4c4a] .cell-item__body__right .cell-item__body__right-text{font-size:%?36?%}[data-v-2b7e4c4a] .cell-item__body__content-title{color:var(--qui-FC-777)}[data-v-2b7e4c4a] .uni-list-cell{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;height:%?100?%;-webkit-box-align:center;-webkit-align-items:center;align-items:center;font-size:%?30?%;color:var(--qui-FC-777);border-bottom:%?2?% solid #ededed}[data-v-2b7e4c4a] .my-profile__avatar{position:relative}[data-v-2b7e4c4a] .avatar-box__r__tit{color:var(--qui-FC-TAG)}[data-v-2b7e4c4a] .uni-list-cell .uni-list-cell-pd{position:relative}.popup-dialog[data-v-2b7e4c4a]{width:%?670?%;height:%?342?%;background-color:var(--qui-BG-2);border-radius:%?14?%}.popup-dialog__top[data-v-2b7e4c4a]{padding-top:%?40?%;text-align:center}.popup-dialog__top uni-text[data-v-2b7e4c4a]{font-size:%?30?%;color:var(--qui-FC-333)}.popup-dialog__cont[data-v-2b7e4c4a]{position:relative;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;padding:%?24?% %?52?% %?40?%}.popup-dialog__cont-rmb[data-v-2b7e4c4a]{position:absolute;margin-left:%?25?%}.popup-dialog__cont-input[data-v-2b7e4c4a]{width:100%;height:%?100?%;padding:0 %?25?% 0 %?80?%;font-size:%?40?%;text-align:right;border:1px solid var(--qui-BOR-DDD);border-radius:%?7?%;box-sizing:border-box}.popup-dialog__ft[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:%?100?%;border-top:%?2?% solid var(--qui-BOR-DDD);box-sizing:border-box}.popup-dialog__ft uni-button[data-v-2b7e4c4a]{width:50%;color:var(--qui-FC-777);background-color:var(--qui-BG-2);border-radius:0}.popup-dialog__ft uni-button[data-v-2b7e4c4a]:after{border:none}.popup-dialog__ft uni-button[data-v-2b7e4c4a]:last-of-type{border-left:%?2?% solid var(--qui-BOR-DDD);border-bottom-right-radius:%?10?%}.popup-dialog__ft uni-button[data-v-2b7e4c4a]:first-of-type{border-bottom-left-radius:%?10?%}.popup-dialog__ft .popup-btn--ok--blue[data-v-2b7e4c4a]{color:var(--qui-BG-HIGH-LIGHT)}[data-v-2b7e4c4a] .uni-video-cover{display:none}[data-v-2b7e4c4a] .cell-item__body__right{display:contents}.markdown-box[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-justify-content:space-around;justify-content:space-around;width:100%;height:%?60?%;line-height:%?60?%;background:var(--qui-BG-FFF);border-top:1px solid var(--qui-BOR-DDD)}.username[data-v-2b7e4c4a]{max-width:%?200?%;overflow:hidden;font-size:%?28?%;text-overflow:ellipsis;white-space:nowrap}.pay-type[data-v-2b7e4c4a]{font-size:%?30?%;line-height:%?100?%;text-align:center;border-bottom:1px solid var(--qui-BOR-ED)}.watchpay[data-v-2b7e4c4a]{font-size:%?28?%;color:var(--qui-FC-AAA)}.bottom_button[data-v-2b7e4c4a]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.bottom_button[data-v-2b7e4c4a] .qui-button--button:after{border:none}.post-box__img[data-v-2b7e4c4a]{position:relative;padding:%?20?% %?10?%;background-color:#f4f4f4}.post-box__img[data-v-2b7e4c4a] .qui-button--button{background-color:#fff}.post-box__img .pullDown_img[data-v-2b7e4c4a]{position:absolute;top:%?-30?%;left:%?20?%;width:%?44?%;height:%?33?%}.post-box__zhuti[data-v-2b7e4c4a]{margin-bottom:%?114?%}.post-box__zhuti[data-v-2b7e4c4a] .cell-item__body__right-text{font-family:PingFang SC;font-size:%?28?%;font-weight:400;color:#000}.redshowstyle_redmargin[data-v-2b7e4c4a]{font-weight:600;color:#c20c0c}.redshowstyle_redelse[data-v-2b7e4c4a]{font-weight:600;color:#333}',""]),t.exports=e},"6f74":function(t,e,i){"use strict";var a=i("b95e");t.exports={computed:{user:function(){var t=this.$store.getters["session/get"]("userId");return t?this.$store.getters["jv/get"]("users/".concat(t)):{}}},methods:{getUserInfo:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=(new Date).getTime(),i=uni.getStorageSync(a.STORGE_GET_USER_TIME);if(t||(e-i)/1e3>60){var s={include:"groups,wechat"},o=this.$store.getters["session/get"]("userId");this.$store.commit("jv/deleteRecord",{_jv:{type:"users",id:o}}),this.$store.dispatch("jv/get",["users/".concat(o),{params:s}]).then((function(){return uni.$emit("updateNotiNum")})),uni.setStorageSync(a.STORGE_GET_USER_TIME,(new Date).getTime())}},logind:function(){var t=this,e=this.$store.getters["session/get"]("userId");if(e){this.$store.dispatch("jv/get",["forum",{params:{include:"users"}}]);this.$store.dispatch("jv/get",["users/".concat(e),{params:{include:"groups,wechat"}}]).then((function(e){t.$u.event.$emit("logind",e)})),this.$store.dispatch("forum/setError",{loading:!1})}}}}},"790f":function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.requestParamsValidator=c,e.validateParameter=void 0,i("96cf");var s=a(i("5530")),o=a(i("1da1"));i("d3b7");var n=a(i("2a95")),r=a(i("2d83"));function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(a,s){new n.default(i).validate(e,{firstFields:!0},(function(e,i){var o=e?"fail":"success",n=e?e[0].message:"";"success"===o?a({status:o,message:n,fieldsData:i}):(t.warn("The current parameter validation failed."),s((0,r.default)("Parameter Validator Error",{status:o,message:n,fieldsData:i,errors:e},null)))}))}))}var u=function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(e){var i,a,o,n,r,u,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.params,a=void 0===i?{}:i,o=e.data,n=void 0===o?{}:o,r=e.isValidate,u=e.validateRules,!r||!u){t.next=5;break}return d=(0,s.default)((0,s.default)({},a),n),t.next=5,c(d,u,e);case 5:return t.abrupt("return",e);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();e.validateParameter=u}).call(this,i("5a52").default)},"79fc":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.readThreadList=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={page:{type:"number"},perPage:{type:"number"},filter:{type:"object",required:!0,fields:{sticky:{type:"number",required:!0},essence:{type:"number",required:!0},types:{type:"array"},categoryids:{type:"array"},sort:{type:"number"},attention:{type:"number"}}}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/threads.v2",method:"GET",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"7c26":function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LocalBridge=void 0,i("99af"),i("d3b7"),i("25f0"),i("e25e");var s=a(i("5530")),o=a(i("d4ec")),n=a(i("bee2")),r=null;var c="undefined"!=typeof window;function u(){var t="__dzqtest_ls__";try{return!!r&&(r.setItem(t,t),r.getItem(t),!0)}catch(t){return!1}}r=c?window.localStorage:{};var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e);var i="__dzqls-",a=0;this.options=(0,s.default)({prefix:i,expires:a},t),this.expiresPrefix="expires".concat(this.options.prefix)}return(0,n.default)(e,[{key:"getKey",value:function(t){var e=this.options.prefix;return"".concat(e).concat(t)}},{key:"getExpiresKey",value:function(t){return"".concat(this.expiresPrefix).concat(t)}},{key:"getCurrentTime",value:function(){return Math.floor((new Date).getTime()/1e3)}},{key:"getExpiresValue",value:function(t){return(this.getCurrentTime()+t).toString(10)}},{key:"shiftItem",value:function(t){if(!u())return!1;var e=r.removeItem;e(this.getKey(t)),e(this.getExpiresKey(t))}},{key:"isExpired",value:function(e){if(u()){var i=r.getItem(this.getExpiresKey(e));if(i){var a=parseInt(i,10),s=this.getCurrentTime();if(t.log(a,s),s>a)return this.shiftItem(e),!0}}}},{key:"set",value:function(t,e,i){var a=this.getKey(t),s=e;if(!u())return!1;try{s=JSON.stringify(e)}catch(t){return!1}var o=r,n=o.setItem,c=o.removeItem;try{n(a,s);var d=this.getExpiresKey(t);i?n(d,this.getExpiresValue(i)):c(d)}catch(t){return!1}return!0}},{key:"get",value:function(t){if(!u())return null;if(this.isExpired(t))return null;var e=r.getItem(this.getKey(t));try{return JSON.parse(e)}catch(t){return e}}},{key:"remove",value:function(t){u()&&this.shiftItem(t)}},{key:"clear",value:function(){u()&&r.clear()}}]),e}();e.LocalBridge=d;var p=d;e.default=p}).call(this,i("5a52").default)},"7f23":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.createThread=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={categoriesId:{type:"number",required:!0},content:{type:"string",required:!0},type:{type:"number",required:!0},isAnonymous:{type:"number"},price:{type:"number"},attachmentPrice:{type:"number"},freeWords:{type:"number"},location:{type:"string"},longitude:{type:"number"},latitude:{type:"number"},address:{type:"string"},id:{type:"string"},isDraft:{type:"number"},isRedPacket:{type:"number"},isOldDraft:{type:"number"},title:{type:"string"},postGoodsId:{type:"number"},redPacket:{type:"object",fields:{condition:{type:"number"},likenum:{type:"number"},money:{type:"number"},number:{type:"number"},rule:{type:"number"},orderId:{type:"string"},orderPrice:{type:"number"}}},attachments:{type:"array",defaultField:{type:"object",fields:{id:{type:"number"},type:{type:"string"}}}},question:{type:"object",fields:{type:{type:"number"},price:{type:"number"},orderId:{type:"string"},isOnlooker:{type:"boolean"},beUserId:{type:"number"},expiredAt:{type:"date"}}}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/thread.v2",method:"POST",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:t.prev=10,t.t0=t.catch(1);case 12:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},"7fe0":function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("5530")),o=a(i("d4ec")),n=a(i("bee2")),r=a(i("98ef")),c=a(i("7c26")),u=i("790f"),d=a(i("4328")),p=new c.default({prefix:""}),l=function(t){var e=p.get("access_token");return e&&(t.headers.authorization="Bearer ".concat(e)),t},h=function(t){return{data:t.data,status:t.status}},f=function(){function e(t){(0,o.default)(this,e),this.axiosConfig=t,this.createHttp()}return(0,n.default)(e,[{key:"createHttp",value:function(){this.http=r.default.create((0,s.default)({isValidate:!1,withCredentials:!0,paramsSerializer:function(t){return d.default.stringify(t,{arrayFormat:"indices",encode:!1})}},this.axiosConfig)),this.setHttpRequestInterceptors(),this.setHttpResponseInterceptors()}},{key:"setHttpRequestInterceptors",value:function(){this.http.interceptors.request.use(l),this.http.interceptors.request.use(u.validateParameter,null,{synchronous:!0})}},{key:"setHttpResponseInterceptors",value:function(){this.http.interceptors.response.use(h,(function(e){return t.log(e),e}))}}]),e}();e.default=f}).call(this,i("5a52").default)},"913c":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIBAMAAABfdrOtAAAAFVBMVEVHcExGRkZGRkZGRkZFRUVGRkZHR0eRrgNKAAAABnRSTlMAFrndSYSvQ3G1AAACxUlEQVR42u2aQW/bMAyFbcfZ2YjRnBN09XnGNp+zS87e1uY82an+/0/YujiLBawS+QgTK8Z3K9r4K0XmiaKVZSaTyWQymUwmk8lkMplMJtN/pLv7zjP08AVgbDxX79mM0vO150JOAMQfeIw1wvBnhUC8r5bOyIs+cCBHEPLMYOQdCBkZ67XyqBj11cCQfuH6ZWb+iEN+LF2/L3JUSK0B6RQghVeAnBQgkrSTIUcFSN4pQGqvAGkUIGuvADkqQEqvAKkVIML6pUEKrwA5KUDEaadAYvU7PoT5+nyPQWJpH/usnP/60ytr6yT168ITy/CricshSJPop/ImPImcAMg62Rlu5oH8PYVOYluXpF1D2f3+8R0fUhIOHlMow+UTWz6kJvS4Uyi710N3EttqZ74zRD7hJLY1zCpwF/mEE9nW7clDrOKdyLZuj44FEoekt91pElBEA4lC8rS/DtNxsI/m0Am33T3Fg5yw2xoqQjE66W61J/xXTrq3z0IpgJ1xyx01NQCE2Df+mTcUfjnI1cEidfJGILLl2vICwRJf8ALBSrhkBgJ9GUm2MgpthWSQrdQgc3ogX2GrJxTxtZW4wvibVvrUe3t2C2+/ydTfHj1UaCORGqDOF6mFW6JEc3eeN3cV2twlrKWfL1GLtqmJb/1hvkJTKEDDHe8hqyDXLXp0iLvkIfiLSxkgkUSnqH1YtC16nIsa2DkMdYQPpmW8vPIm/G7WCwwLnr4HPz99AycS0rEdbYDTaEBWGhCVoZp4zvnvDDrFszsSpNCAZJ0GROWFQKkBUXlJIzQw6ouzRgOy0oDkGhBR6skQlRfMEgMjvyqXGBj9pb9g79rR70hsYQjjIgaees4VHLSKOZdjYANzHAhqYLy7V5vlVysLu2uyeh4kuwMYzDtk0II9V2wI94rix0eAYTKZTCaTyWQymUwmk8lkMr0l/QQpFrC5b3mvpgAAAABJRU5ErkJggg=="},"98d7":function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=a(i("d4ec")),o=a(i("bee2")),n=a(i("b900")),r=function(){function e(){(0,s.default)(this,e)}return(0,o.default)(e,[{key:"startRecord",value:function(t){var e=this;try{n.default.get((function(i){e.recorder=i,e.recorder.start(),t.success("record successfully!")}))}catch(e){t.error("record failed!".concat(e))}}},{key:"stopRecord",value:function(t){try{var e=this.recorder.getBlob();t.success(e)}catch(e){t.error("record stop failed!".concat(e))}}},{key:"play",value:function(e){try{this.recorder.play(e)}catch(e){t.log("play record failed!".concat(e))}}}]),e}();e.default=r}).call(this,i("5a52").default)},"98ef":function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Request=void 0;var s=a(i("5530")),o=a(i("bc3a")),n=a(i("0a1d")),r=o.default;e.Request=r,r.defaults=(0,s.default)((0,s.default)((0,s.default)({},r.defaults),n.default),{},{validateRules:null});var c=r;e.default=c},b469:function(t,e){t.exports={computed:{forums:function(){return this.$store.getters["jv/get"]("forums/1")}}}},b900:function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("ace4"),i("cfc3"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("e25e"),i("c19f"),i("b420"),i("25f0");var s=a(i("d4ec")),o=a(i("bee2")),n=function(){function e(t,i){if((0,s.default)(this,e),window.URL=window.URL||window.webkitURL,void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia){var a=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia||navigator.khtmlGetUserMedia;navigator.mediaDevices.getUserMedia=function(t){return a?new Promise((function(e,i){a.call(navigator,t,e,i)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}}(i=i||{}).sampleBits=i.sampleBits||16,i.sampleRate=i.sampleRate||8e3,this.context=new(window.webkitAudioContext||window.AudioContext),this.audioInput=this.context.createMediaStreamSource(t),this.createScript=this.context.createScriptProcessor||this.context.createJavaScriptNode,this.recorder=this.createScript.apply(this.context,[4096,1,1]),this.audioData={size:0,buffer:[],inputSampleRate:this.context.sampleRate,inputSampleBits:16,outputSampleRate:i.sampleRate,oututSampleBits:i.sampleBits,input:function(t){this.buffer.push(new Float32Array(t)),this.size+=t.length},compress:function(){for(var t=new Float32Array(this.size),e=0,i=0;i<this.buffer.length;i+=1)t.set(this.buffer[i],e),e+=this.buffer[i].length;for(var a=parseInt(this.inputSampleRate/this.outputSampleRate,10),s=t.length/a,o=new Float32Array(s),n=0,r=0;n<s;)o[n]=t[r],r+=a,n+=1;return o},encodeWAV:function(){var t=Math.min(this.inputSampleRate,this.outputSampleRate),e=Math.min(this.inputSampleBits,this.oututSampleBits),i=this.compress(),a=i.length*(e/8),s=new ArrayBuffer(44+a),o=new DataView(s),n=0,r=function(t){for(var e=0;e<t.length;e+=1)o.setUint8(n+e,t.charCodeAt(e))};if(r("RIFF"),n+=4,o.setUint32(n,36+a,!0),n+=4,r("WAVE"),n+=4,r("fmt "),n+=4,o.setUint32(n,16,!0),n+=4,o.setUint16(n,1,!0),n+=2,o.setUint16(n,1,!0),n+=2,o.setUint32(n,t,!0),n+=4,o.setUint32(n,1*t*(e/8),!0),n+=4,o.setUint16(n,e/8*1,!0),n+=2,o.setUint16(n,e,!0),n+=2,r("data"),n+=4,o.setUint32(n,a,!0),n+=4,8===e)for(var c=0;c<i.length;c+=1,n+=1){var u=Math.max(-1,Math.min(1,i[c])),d=u<0?32768*u:32767*u;d=parseInt(255/(65535/(d+32768)),10),o.setInt8(n,d,!0)}else for(var p=0;p<i.length;p+=1,n+=2){var l=Math.max(-1,Math.min(1,i[p]));o.setInt16(n,l<0?32768*l:32767*l,!0)}return new Blob([o],{type:"audio/wav"})}}}return(0,o.default)(e,[{key:"start",value:function(){this.audioInput.connect(this.recorder),this.recorder.connect(this.context.destination);var t=this;this.recorder.onaudioprocess=function(e){t.audioData.input(e.inputBuffer.getChannelData(0))}}},{key:"stop",value:function(){this.recorder.disconnect()}},{key:"getBlob",value:function(){return this.stop(),this.audioData.encodeWAV()}},{key:"play",value:function(t){t.src=window.URL.createObjectURL(this.getBlob())}},{key:"clear",value:function(){this.audioData.buffer=[],this.audioData.size=0}}],[{key:"throwError",value:function(e){var i=this;throw t.log("Error:".concat(e)),new function(){i.toString=function(){return e}}}},{key:"canRecording",value:function(){return null!=navigator.mediaDevices.getUserMedia}},{key:"get",value:function(i,a){i&&(e.canRecording()?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){var s=new e(t,a);i(s)})).catch((function(i){t.log(i),e.throwError("无法录音，请检查设备状态。")})):e.throwError("当前浏览器不支持录音功能。"))}}]),e}();e.default=n}).call(this,i("5a52").default)},cfc0:function(t,e,i){"use strict";(function(t){var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("96cf"),i("e25e"),i("b680"),i("a9e3"),i("ac1f"),i("5319"),i("d3b7"),i("99af"),i("4160"),i("159b"),i("7039"),i("fb6a"),i("c975"),i("acd8"),i("d81d"),i("a434"),i("1276");var s=a(i("1da1")),o=a(i("5530")),n=i("2f62"),r=i("b95e"),c=a(i("b469")),u=a(i("6f74")),d=a(i("245f")),p=a(i("6354")),l=a(i("4c82")),h=a(i("25d8")),f=a(i("840a")),m=a(i("26d0")),v=null,y={name:"Post",components:{uniPopupDialog:f.default},mixins:[c.default,u.default,d.default,p.default,h.default,l.default],data:function(){return{lowestPrice:0,redbagplay:!0,geographical_location:!1,anonymity_show:!1,redshow:!1,save:!1,SecondaryClassification:"",titlexune:"已添加0个标题",secondallcategories:[],is_onlookers:!1,two_categoryId:"",situation_categoryId:"",is_red_packet:"",showmoney:"",rule:"",money:"",number:"",condition:"",likenum:"",sumtype:"",timer1:null,timer2:null,cansavedraft:!0,currentId:"",vditor:null,navTitle:"发布",loadStatus:"",textAreaValue:"",markdownShow:!1,barStatus:!1,textAreaLength:5e3,textAnswerLength:49999,postTitle:"",checkClassData:[],type:0,price:0,priceAsk:0,pwdVal:"",browser:0,inputPrice:"",maxLength:7,inputWord:"",operating:"",emojiShow:!1,textShow:!0,header:{},formData:{},captcha:null,captcha_ticket:"",captcha_rand_str:"",userImage:"",beUserName:"",checked:!1,watchChecked:!1,watchShow:!1,payShowStatus:!0,haveDate:0,answerIsDate:0,platformDate:0,askingPrice:!0,payNum:[{name:this.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree"),pay:0},{name:"￥2",pay:2},{name:"￥5",pay:5},{name:"￥10",pay:10},{name:"￥20",pay:20},{name:"￥50",pay:50},{name:"￥88",pay:88},{name:"￥128",pay:128},{name:this.i18n.t("discuzq.post.customize"),pay:0}],payNumCheck:[{name:"",pay:0}],freepercentage:[{name:"0%",pay:0},{name:"10%",pay:.1},{name:"30%",pay:.3},{name:"50%",pay:.5},{name:"70%",pay:.7},{name:"100%",pay:1}],freewords:[],percentagedisplay:"0%",uploadFile:[],cursor:0,wordCountCheck:[{name:this.i18n.t("discuzq.post.word",{num:0}),num:0}],word:0,setType:"pay",controlsStatus:!1,videoBeforeList:[],audioBeforeList:[],fullscreenStatus:!1,videoName:"",percent:0,fileId:"",url:"",postLoading:!1,allCategories:[],categoryIndex:"",categoryId:"",threadId:"",firstPostId:"",postDetails:{},filePreview:[],uploadStatus:!0,showHidden:!0,ticket:"",randstr:"",captchaResult:{},attachmentList:[],signatureVal:"",deleteType:"",deleteId:"",deleteIndex:"",deleteTip:"确定删除吗？",wechatTip:this.i18n.t("discuzq.wechatBind"),currentPosition:{},watchMoeny:"1",beAskId:"",payTypeText:"",orderSn:"",coverLoading:!1,payStatus:!1,payTypeData:[{name:"微信支付",icon:"icon-wxPay",color:"#09bb07",value:"0"},{name:"钱包支付",icon:"icon-walletPay",color:"#1878f3",value:"1"}],chooseType:1,payType:0,showPayType:"",ioshide:!1,isShowGoods:!0,dataGoodInfo:{},dataGoodInfoPrice:0,goodsId:"",categoryid:0,categoryindex:0,postShow:!1,popupStatus:!1,canUploadAttachment:!1}},computed:(0,o.default)((0,o.default)({},(0,n.mapState)({getAtMemberData:function(t){return t.atMember.atMemberData}})),{},{showPrice:function(){return 1===this.type?this.i18n.t("discuzq.post.pleaseChoice"):this.i18n.t("discuzq.post.free"),this.price<=0?1===this.type?this.i18n.t("discuzq.post.pleaseChoice"):this.i18n.t("discuzq.post.free"):"￥".concat(this.price+this.i18n.t("discuzq.post.yuan"))},showAskPrice:function(){this.i18n.t("discuzq.post.free");return this.priceAsk<=0?this.i18n.t("discuzq.post.free"):"￥".concat(this.priceAsk+this.i18n.t("discuzq.post.yuan"))},currentLoginId:function(){var t=this.$store.getters["session/get"]("userId");return parseInt(t,10)}}),beforeDestroy:function(){this.save=!0,clearInterval(this.timer1),this.timer1=null,clearInterval(this.timer2),this.timer2=null},updated:function(){var t=this;this.red_bagshow(),this.geographical_location_show(),this.forums&&5===this.type&&(this.platformDate=(this.forums.set_site.site_onlooker_price*(this.forums.set_site.site_master_scale/10)).toFixed(2),this.haveDate=((this.forums.set_site.site_onlooker_price-this.platformDate)/2).toFixed(2),this.answerIsDate=(this.forums.set_site.site_onlooker_price-this.platformDate-this.haveDate).toFixed(2)),this.$nextTick((function(){t.$refs.textarea&&(t.$refs.textarea.$refs.textarea.style.overflowY="auto",t.$refs.textarea.$refs.textarea.style.paddingRight="10px")})),uni.$off("uploadVideoOver"),uni.$on("uploadVideoOver",(function(e){t.percent=1,e.doneResult?t.fileId=e.doneResult.fileId:e.result&&(t.fileId=e.result.fileId),t.videoBeforeList.push({path:e.uploadVideoRes.tempFilePath})}))},methods:(0,o.default)((0,o.default)({red_bagshow:function(){0===this.type&&this.forums.other.can_create_thread_red_packet&&(this.redshow=!0),1===this.type&&this.forums.other.can_create_thread_long_red_packet&&(this.redshow=!0)},geographical_location_show:function(){switch(0===this.type&&this.forums.other.can_create_thread_position&&(this.geographical_location=!0),1===this.type&&this.forums.other.can_create_thread_long_position&&(this.geographical_location=!0),2===this.type&&this.forums.other.can_create_thread_video_position&&(this.geographical_location=!0),3===this.type&&this.forums.other.can_create_thread_image_position&&(this.geographical_location=!0),4===this.type&&this.forums.other.can_create_thread_audio_position&&(this.geographical_location=!0),5===this.type&&this.forums.other.can_create_thread_question_position&&(this.geographical_location=!0),6===this.type&&this.forums.other.can_create_thread_goods_position&&(this.geographical_location=!0),this.type){case 0:this.anonymity_show=this.forums.other.can_create_thread_anonymous;break;case 1:this.anonymity_show=this.forums.other.can_create_thread_long_anonymous;break;case 2:this.anonymity_show=this.forums.other.can_create_thread_video_anonymous;break;case 3:this.anonymity_show=this.forums.other.can_create_thread_image_anonymous;break;case 4:this.anonymity_show=this.forums.other.can_create_thread_audio_anonymous;break;case 5:this.anonymity_show=this.forums.other.can_create_thread_question_anonymous;break;default:this.anonymity_show=this.forums.other.can_create_thread_goods_anonymous}},toDraftsing:function(){var t=this;if(!1!==this.redbagplay){if(0===this.textAreaValue.length)return this.$refs.toast.show({message:this.i18n.t("草稿不能为空")});if(!this.categoryId&&!this.two_categoryId)return this.$refs.toast.show({message:this.i18n.t("未选择分类")});this.save=!0,clearInterval(this.timer2),this.timer2=null;var e={categoriesId:Number(this.two_categoryId||this.categoryId),content:this.textAreaValue,type:this.type,isAnonymous:this.checked?1:0,price:this.price,freeWords:this.word,id:this.currentId,isDraft:1,isOldDraft:0,captchaTicket:this.ticket,captchaRandStr:this.randstr,redPacket:{rule:+this.rule,money:+this.money,number:+this.number,condition:+this.condition,likenum:+this.likenum,orderId:this.orderSn,orderPrice:0}};this.vditor&&1===this.type&&(e.content=this.vditor.getValue().replace(/blob:/g,"").replace(/\n\n/g,"\n\n\n")),1===this.payType?(e.attachmentPrice=this.price,e.price=""):0===this.payType&&(e.attachmentPrice="",e.price=this.price);var i=this.currentPosition;i&&(e.longitude=Number(i.longitude)||"",e.latitude=Number(i.latitude)||"",e.location=i.location||"",e.address=i.address||""),new Promise((function(i,a){switch(t.type){case 0:i();break;case 1:e.title=t.postTitle;var s=t.addImg().data.concat(t.addFile().data);e.attachments=[],s.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),i();break;case 2:e.fileId=t.fileId,e.fileName=t.videoName,i();break;case 3:var o=t.addImg().data;e.attachments=[],o.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),i();break;case 4:e.fileId=t.audioBeforeList[0].id,e.fileName=t.audioBeforeList[0].fileName,i();break;case 5:var n=t.addImg().data,r=t.addQuestion().data;e.attachments=[],e.question={},n.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),r&&(e.question.type=r.type,e.question.price=Number(r.price),e.question.orderId=r.order_id,e.question.isOnlooker=r.is_onlooker,e.question.beUserId=r.be_user_id),i();break;case 6:e.postGoodsId=Number(t.dataGoodInfo._jv.id),i();break;default:a(),t.$refs.toast.show({message:t.i18n.t("core.postTypesDoNotMatch")})}})).then((function(){m.default.createThread({data:e}).then((function(e){t.save=!1,t.currentId||(t.currentId=e.Data.id),t.$refs.toast.show({message:t.i18n.t("保存成功")})}))}))}},toDrafts:function(){var t=this;this.save=!0;var e={categoriesId:Number(this.two_categoryId||this.categoryId),content:this.textAreaValue,type:this.type,isAnonymous:this.checked?1:0,price:this.price,freeWords:this.word,id:this.currentId,isDraft:1,isOldDraft:0,captchaTicket:this.ticket,captchaRandStr:this.randstr,redPacket:{rule:+this.rule,money:+this.money,number:+this.number,condition:+this.condition,likenum:+this.likenum,orderId:this.orderSn,orderPrice:0}};this.vditor&&1===this.type&&(e.content=this.vditor.getValue().replace(/blob:/g,"").replace(/\n\n/g,"\n\n\n")),1===this.payType?(e.attachmentPrice=this.price,e.price=""):0===this.payType&&(e.attachmentPrice="",e.price=this.price);var i=this.currentPosition;i&&(e.longitude=Number(i.longitude)||"",e.latitude=Number(i.latitude)||"",e.location=i.location||"",e.address=i.address||""),new Promise((function(i,a){switch(t.type){case 0:i();break;case 1:e.title=t.postTitle;var s=t.addImg().data.concat(t.addFile().data);e.attachments=[],s.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),i();break;case 2:e.fileId=t.fileId,e.fileName=t.videoName,i();break;case 3:var o=t.addImg().data;e.attachments=[],o.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),i();break;case 4:e.fileId=t.audioBeforeList[0].id,e.fileName=t.audioBeforeList[0].fileName,i();break;case 5:var n=t.addImg().data,r=t.addQuestion().data;e.attachments=[],e.question={},n.forEach((function(t){e.attachments.push({id:Number(t.id),type:t.type})})),r&&(e.question.type=r.type,e.question.price=Number(r.price),e.question.orderId=r.order_id,e.question.isOnlooker=r.is_onlooker,e.question.beUserId=r.be_user_id),i();break;case 6:e.postGoodsId=Number(t.dataGoodInfo._jv.id),i();break;default:a(),t.$refs.toast.show({message:t.i18n.t("core.postTypesDoNotMatch")})}})).then((function(){m.default.createThread({data:e}).then((function(e){t.save=!1,t.currentId||(t.currentId=e.Data.id)}))}))},onStartSave:function(){var t=this;this.timer1=setInterval((function(){t.categoryId&&0!==t.textAreaValue.length&&(t.startSave(),clearInterval(t.timer1),t.timer1=null)}),1e4)},startSave:function(){var t=this;this.timer2=setInterval((function(){t.save||t.toDrafts()}),12e4)},addGoods:function(){if("edit"===this.operating)uni.redirectTo({url:"/pages/topic/parse-goods?type=".concat(this.type,"&operating=edit&threadId=").concat(this.threadId)});else{try{uni.setStorageSync("add_goods_text",this.textAreaValue||"")}catch(t){}uni.redirectTo({url:"/pages/topic/parse-goods?type=".concat(this.type,"&isSaveText=1")})}},deleteGoods:function(){this.dataGoodInfo=[],this.isShowGoods=!1},changeCheck:function(){},choosePosition:function(){this.currentPosition.location||(this.saveThread(),this.getPosition())},clearPosition:function(){this.currentPosition={}},addthetheme:function(){uni.navigateTo({url:"/pagesplay_web/AddTheTheme"})},skipred_packet:function(){!1!==this.redbagplay&&uni.navigateTo({url:"/pagesplay_web/compile-money"})},clearPacket:function(){this.is_red_packet="",this.showmoney="",this.rule="",this.money="",this.number="",this.condition="",this.likenum="",this.sumtype=""},saveThread:function(){var t=this;uni.removeStorageSync("current_thread");var e={};if(["postTitle","price","word","fileId","videoName","textAreaValue","categoryIndex","categoryId","checkClassData","uploadFile","videoBeforeList","audioBeforeList","checked","watchChecked","askingPrice","watchShow","priceAsk","beAskId","userImage","beUserName","type","showHidden","payType","showPayType","ioshide","dataGoodInfo"].forEach((function(i){t[i]&&(e[i]=t[i])})),this.$refs.uploadFiles){var i=this.$refs.uploadFiles.getValue(),a=[];i.forEach((function(t){a.push({fileName:t.attributes.fileName,url:t.attributes.url,_jv:{id:t.id}})})),e.attachmentList=a}if(this.$refs.upload){var s=this.$refs.upload.getValue();s.forEach((function(t,e){t.attributes&&(s[e]={path:t.attributes.thumbUrl,id:t.id,order:t.attributes.order,name:t.attributes.fileName,url:t.attributes.url})})),e.imgList=s}uni.setStorageSync("current_thread",JSON.stringify(e))},setThread:function(){var t=this,e=uni.getStorageSync("current_thread");e&&(e=JSON.parse(e),this.dataGoodInfo=e.dataGoodInfo,Object.getOwnPropertyNames(e).forEach((function(i){if("imgList"===i){var a=e[i];a.forEach((function(t,e){a[e]={thumbUrl:t.path,_jv:{id:t.id},order:t.order,fileName:t.name,url:t.url}}));var s={firstPost:{images:[]}};s.firstPost.images=e[i],t.setAnnex("img",s)}else t[i]=e[i]})),this.videoBeforeList.length>0&&(this.percent=1),uni.removeStorageSync("current_thread"))},focusEvent:function(){},toolBarClick:function(t){var e="";"bold"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"**粗体文字**").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=2,this.focusEvent(this.cursor)):"italic"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"__").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=1,this.focusEvent(this.cursor)):"title"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"\n### ").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=4,this.focusEvent(this.cursor)):"quote"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"\n> ").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=1,this.focusEvent(this.cursor)):"link"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"[](url)").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=1,this.focusEvent(this.cursor)):"code"===t?(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"``").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=1,this.focusEvent(this.cursor)):"strikethrough"===t&&(e="".concat("".concat(this.textAreaValue.slice(0,this.cursor),"~~~~").concat(this.textAreaValue.slice(this.cursor))),this.cursor+=2,this.focusEvent(this.cursor)),this.textAreaValue=e}},(0,n.mapMutations)({setAtMember:"atMember/SET_ATMEMBER"})),{},{checkNum:function(t){var e=this,i=t.target.value,a=i.indexOf(".");i.indexOf(".")<0&&""!=i?i.length>6?(i=i.substring(0,i.length-1),uni.showToast({title:e.c.TheAmountCannotExceedOneMillion,icon:"none"})):i=parseFloat(i):0==i.indexOf(".")?i=(i=i.replace(/[^$#$]/g,"0.")).replace(/\.{2,}/g,"."):/^(\d?)+(\.\d{0,2})?$/.test(i)||(i=i.substring(0,i.length-1)),e.$nextTick((function(){e.maxLength=-1==a?7:10,e.inputPrice=i}))},videoDel:function(){this.deleteType=2,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteVideoSure")},playVideo:function(t){uni.$emit("playVideo",t)},fullscreenchange:function(t){this.fullscreenStatus=t.detail.fullScreen,t.detail.fullScreen||(this.controlsStatus=!1,this.videoContext.pause())},emojiclick:function(){this.emojiShow=!this.emojiShow,this.textShow=!this.textShow},contBlur:function(t){this.cursor=t.detail.cursor},diaLogClose:function(){this.$refs.popup.close(),this.popupStatus=!1,this.textShow=!0},diaLogOk:function(){if(""===this.forums.set_site.site_minimum_amount){if(this.inputPrice<"0.1")return void uni.showToast({title:this.i18n.t("core.TheAmountCannotBeLessThanOneYuan"),icon:"none"})}else if(this.inputPrice<this.forums.set_site.site_minimum_amount)return void uni.showToast({title:this.i18n.t("core.TheAmountCannotBeLessThanMinMoney")+this.forums.set_site.site_minimum_amount+this.i18n.t("discuzq.post.yuan"),icon:"none"});if(5===this.type)return this.priceAsk=this.inputPrice,this.$refs.popup.close(),this.popupStatus=!1,this.textShow=!0,void this.postClick();"pay"===this.setType?this.price=this.inputPrice:this.word=this.inputWord,this.$refs.popup.close(),this.popupStatus=!1,this.textShow=!0},percentageClick:function(t){this.word=this.freepercentage[t].pay,this.percentagedisplay=this.freepercentage[t].name,this.setType="word",this.freewords=[],this.freewords.push(this.freepercentage[t]),this.$refs.popupBtm.close()},moneyClick:function(t){var e=this;if(0===this.forums.set_site.site_onlooker_price&&(this.watchShow=!1),0===t){if(5===this.type)return this.watchShow=!1,void this.postClick();1!==this.type&&5!==this.type&&(this.payType=0,0===this.payType&&(this.showPayType=this.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree")))}else this.watchShow=!0;if(this.setType="pay",this.payNumCheck=[],this.payNumCheck.push(this.payNum[t]),this.payNumCheck[0].name===this.i18n.t("discuzq.post.customize"))this.textShow=!1,this.$refs.popupBtm.close(),this.popupStatus=!0,this.$nextTick((function(){e.inputPrice="",e.$refs.popup.open(),e.textShow=!1}));else{if(5===this.type&&0!==t)return this.priceAsk=this.payNumCheck[0].pay,this.$refs.popupBtm.close(),this.postClick(),void(this.textShow=!0);this.price=this.payNumCheck[0].pay,this.$refs.popupBtm.close(),this.textShow=!0}},lookPay:function(){this.$refs.lookPayPopup.open()},cancelLookPay:function(){this.$refs.lookPayPopup.close()},choicePayType:function(t){0===t?(this.payNumCheck=[],this.price="",this.showPayType=this.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree")):1===t?(this.payNumCheck=[],this.showPayType=this.i18n.t("discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid"),this.payNum[0].name="￥1",this.payNum[0].pay=1):(this.payNumCheck=[],this.payNum[0].name="￥1",this.showPayType=this.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsPaid"),this.payNum[0].pay=1),this.payType=t,this.$refs.lookPayPopup.close()},cellClick:function(t){this.setType=t,this.$refs.popupBtm.open(),this.textShow=!1},postAnswerClick:function(t){this.two_categoryId||this.categoryId?(this.$refs.popupBtm.open(),this.textShow=!1):uni.showToast({title:"请选择分类",icon:"none"})},cancel:function(){this.$refs.popupBtm.close(),this.textShow=!0},uploadClick:function(t){this.uploadStatus=t},uploadChange:function(t,e){this.uploadFile=t,this.uploadStatus=e},uploadClear:function(t,e){var i=t.id;this.deleteType=0,this.deleteId=i,this.deleteIndex=e,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteImgSure")},uploadAudioChange:function(t){this.audioBeforeList=t},audioDel:function(){this.deleteType=3,this.$refs.deletePopup.open(),this.deleteTip=this.i18n.t("core.deleteAudioSure")},getEmojiClick:function(t){var e;e="".concat(this.textAreaValue.slice(0,this.cursor)+t+this.textAreaValue.slice(this.cursor)),this.cursor=e.length,this.textAreaValue=e,this.emojiShow=!1,this.textShow=!0},callClick:function(){uni.navigateTo({url:"/pages/user/at-member"})},topicPage:function(){uni.navigateTo({url:"/pages/topic/topic"})},checkClass:function(t,e,i){this.two_categoryId="",this.checkClassData=[],+this.categoryId!=+i?(this.categoryId=i,this.checkClassData.push(t),this.secondallcategories=t.children||[]):this.categoryId=""},checkClassing:function(t,e,i){+this.two_categoryId!=+i?this.two_categoryId=i:this.two_categoryId=""},payClickShow:function(){var t=this;if(this.$store.getters["session/get"]("isLogin")||(this.$store.dispatch("session/setUrl",this.curUrl),this.h5LoginMode()),this.payStatus=!1,this.forums.paycenter.wxpay_close){if(!this.forums.paycenter.wxpay_close||!this.forums.other.can_create_thread_paid)return this.ioshide=!1,void(this.payShowStatus=!1);this.ioshide=!0,this.payShowStatus=!0,this.payTypeText=this.t.pay+this.t.payAskingPrice,this.priceAsk=parseFloat(this.thread.price),this.$nextTick((function(){t.$refs.payShow.payClickShow(t.payTypeVal)}))}else this.payShowStatus=!1},paysureShow:function(t){if(uni.setStorage({key:"page",data:"/topic/post?type=5&categoryId=".concat(this.categoryid,"&categoryIndex=").concat(this.categoryindex)}),0===t){if(!0===this.isWeixin&&void 0===this.user.wechat)return void this.$refs.wechatPopup.open();if(!0===this.isWeixin&&this.user.wechat&&""===this.user.wechat.mp_openid)return void this.$refs.wechatPopup.open();1===this.is_red_packet||"1"===this.is_red_packet?(0===this.type&&this.creatOrder(this.money,20,"",t),1===this.type&&this.creatOrder(this.money,21,"",t)):this.creatOrder(this.priceAsk,5,"",t)}},onInput:function(t){this.value=t,1===this.is_red_packet||"1"===this.is_red_packet?(0===this.type&&this.creatOrder(this.money,20,t,1),1===this.type&&this.creatOrder(this.money,21,t,1)):this.creatOrder(this.priceAsk,5,t,1)},creatOrder:function(e,i,a,s){var o=this,n={_jv:{type:"orders"},type:i,payee_id:this.beAskId,amount:e,is_anonymous:this.checked?"0":"1"};this.$store.dispatch("jv/post",n).then((function(t){o.orderSn=t.order_sn,0===s?0==o.browser?o.orderPay(13,a,o.orderSn,s,"0"):o.isWeixin&&o.isPhone?o.orderPay(12,a,o.orderSn,s,"1"):o.isPhone?o.orderPay(20,a,o.orderSn,1,"2"):o.orderPay(10,a,o.orderSn,s,"3"):1===s&&o.orderPay(20,a,o.orderSn,s)})).catch((function(e){t.log(e)}))},orderPay:function(e,i,a,s,o){var n=this,r={};0===s?r={_jv:{type:"trade/pay/order/".concat(a)},payment_type:e}:1===s&&(r={_jv:{type:"trade/pay/order/".concat(a)},payment_type:e,pay_password:i}),this.$store.dispatch("jv/post",r).then((function(t){n.wxRes=t,0===s?"0"===o?n.wechatPay(t.wechat_js.timeStamp,t.wechat_js.nonceStr,t.wechat_js.package,t.wechat_js.signType,t.wechat_js.paySign):"1"===o?"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n.onBridgeReady(t),!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n.onBridgeReady(t)),document.attachEvent("onWeixinJSBridgeReady",n.onBridgeReady(t))):n.onBridgeReady(t):"2"===o?n.postThread().then((function(e){n.postLoading=!1,uni.hideLoading(),e&&1===e.isApproved&&n.$u.event.$emit("refreshHome",t),e&&e.Data&&e.Data.id&&uni.redirectTo({url:"/topic/index?id=".concat(e.Data.id)})})):"3"===o&&t&&(n.codeUrl=t.wechat_qrcode,n.payShowStatus=!1,n.$refs.codePopup.open(),n.qrcodeShow=!0,v=setInterval((function(){1!==n.payStatus?(n.getOrderStatus(n.orderSn,o),uni.hideLoading()):clearInterval(v)}),3e3)):1===s&&("success"===t.wallet_pay.result&&(n.$store.dispatch("jv/get",["users/".concat(n.currentLoginId),{}]),n.coverLoading=!1,n.postThread().then((function(t){n.postLoading=!1,uni.hideLoading(),t&&1===t.isApproved&&n.$u.event.$emit("refreshHome",t),t&&t.Data&&t.Data.id&&uni.redirectTo({url:"/topic/index?id=".concat(t.Data.id)})}))),n.coverLoading=!1)})).catch((function(e){t.log(e),n.$refs.payShow.clearPassword()}))},getOrderStatus:function(e,i){var a=this;this.$store.dispatch("jv/get",["orders/".concat(e),{custom:{loading:!1}}]).then((function(t){a.payStatus=t.status,1===a.payStatus&&("2"===i||("3"===i?(a.$refs.codePopup.close(),a.qrcodeShow=!1,a.postThread()):("0"===i||"1"===i)&&a.postThread().then((function(t){a.postLoading=!1,uni.hideLoading(),t&&1===t.isApproved&&a.$u.event.$emit("refreshHome",t),t&&t.Data&&t.Data.id&&uni.redirectTo({url:"/topic/index?id=".concat(t.Data.id)})}))),a.$refs.toast.show({message:a.i18n.t("pay.paySuccess")}))})).catch((function(e){t.log(e),a.coverLoading=!1,a.$refs.toast.show({message:a.i18n.t("pay.payFail")})}))},wechatPay:function(t,e,i,a,s){var o=this;uni.requestPayment({provider:"wxpay",timeStamp:t,nonceStr:e,package:i,signType:a,paySign:s,success:function(t){o.coverLoading=!0,v=setInterval((function(){1!==o.payStatus?o.getOrderStatus(o.orderSn,"0"):clearInterval(v)}),3e3)},fail:function(t){o.payShowStatus=!1,o.coverLoading=!1,o.$refs.toast.show({message:o.p.payFail})}})},onBridgeReady:function(t){var e=this;WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:t.wechat_js.appId,timeStamp:t.wechat_js.timeStamp,nonceStr:t.wechat_js.nonceStr,package:t.wechat_js.package,signType:"MD5",paySign:t.wechat_js.paySign},(function(t){"get_brand_wcpay_request:ok"==t.err_msg||("get_brand_wcpay_request:cancel"==t.err_msg||"get_brand_wcpay_request:fail"==t.err_msg)&&(clearInterval(v),resolve)})),v=setInterval((function(){1!==e.payStatus?e.getOrderStatus(e.orderSn,"1"):clearInterval(v)}),3e3)},radioChange:function(t){},postClick:function(){var t=this;if(this.payTypeText=this.i18n.t("topic.pay")+this.i18n.t("discuzq.post.payAskingPrice"),this.type,!this.categoryId&&!this.two_categoryId)return this.$refs.toast.show({message:this.i18n.t("discuzq.post.theclassifyCanNotBeBlank")}),!1;var e=!0;switch(this.type){case 0:this.textAreaValue.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.theContentCanNotBeBlank")}),e=!1):e=!0;break;case 1:this.postTitle.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.theTitleCanNotBeBlank")}),e=!1):this.textAreaValue.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.theContentCanNotBeBlank")}),e=!1):this.uploadStatus?1===this.payType?0===this.$refs.uploadFiles.getValue().length?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.attachmentCannotBeEmpty")}),e=!1):0===this.price?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.priceCannotBeFree")}),e=!1):e=!0:2===this.payType&&0===this.price?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.priceCannotBeFree")}),e=!1):e=!0:(this.$refs.toast.show({message:this.i18n.t("discuzq.post.pleaseWaitForTheImageUploadToComplete")}),e=!1);break;case 2:this.videoBeforeList.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.videoCannotBeEmpty")}),e=!1):1!==this.percent?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.pleaseWaitForTheVideoUploadToComplete")}),e=!1):2===this.payType&&0===this.price?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.priceCannotBeFree")}),e=!1):e=!0;break;case 3:"edit"!==this.operating||"draft"===this.operating?this.uploadStatus?this.uploadFile.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.imageCannotBeEmpty")}),e=!1):2===this.payType&&0===this.price?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.priceCannotBeFree")}),e=!1):e=!0:(this.$refs.toast.show({message:this.i18n.t("discuzq.post.pleaseWaitForTheImageUploadToComplete")}),e=!1):this.uploadStatus?2===this.payType&&0===this.price?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.priceCannotBeFree")}),e=!1):e=!0:(this.$refs.toast.show({message:this.i18n.t("discuzq.post.pleaseWaitForTheImageUploadToComplete")}),e=!1);break;case 4:this.audioBeforeList.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.audioCannotBeEmpty")}),e=!1):e=!0;break;case 5:""===this.beAskId?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.pleaseSelectTheUserToBeAsked")}),e=!1):this.textAreaValue.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.theContentCanNotBeBlank")}),e=!1):this.watchShow&&(this.payShowStatus=!0,this.$nextTick((function(){t.$refs.payShow.payClickShow()})));break;case 6:""===this.dataGoodInfo||0===this.dataGoodInfo.length?(this.$refs.toast.show({message:this.i18n.t("core.productInformationDoesNotExist")}),e=!1):e=!0;break;default:e=!1,this.$refs.toast.show({message:this.i18n.t("core.postTypesDoNotMatch")})}if(e)if(this.save=!0,clearInterval(this.timer1),this.timer1=null,clearInterval(this.timer2),this.timer2=null,5!==this.type&&(this.postLoading=!0),"edit"===this.operating)3===this.type&&this.uploadFile.length<1?(this.$refs.toast.show({message:this.i18n.t("discuzq.post.imageCannotBeEmpty")}),uni.hideLoading(),this.postLoading=!1):this.editThread().then((function(e){t.postLoading=!1,uni.hideLoading(),e&&t.threadId&&uni.redirectTo({url:"/topic/index?id=".concat(t.threadId)})}));else{if(this.forums.qcloud.qcloud_captcha&&this.forums.other.create_thread_with_captcha&&(!this.ticket||!this.randstr))return this.toTCaptcha(),!1;this.watchShow&&5===this.type||(1===this.is_red_packet||"1"===this.is_red_packet?this.$nextTick((function(){t.$refs.payShowtwo.payClickShow()})):this.postThread().then((function(e){t.postLoading=!1,uni.hideLoading(),e&&1===e.isApproved&&t.$u.event.$emit("addThread",e),e&&e.Data&&e.Data.id&&uni.redirectTo({url:"/topic/index?id=".concat(e.Data.id)})})))}},setAnnex:function(t,e){switch(t){case"img":var i=[];e.firstPost.images.map((function(t){return i.push({path:t.thumbUrl,id:t._jv.id,order:t.order,name:t.fileName,url:t.url}),t})),this.filePreview=i;break;case"video":this.videoBeforeList.push({path:e.threadVideo.media_url});break;case"audio":this.audioBeforeList.push({fileName:e.threadAudio.file_name,url:e.threadAudio.media_url,id:e.threadAudio.file_id});break;case"goods":this.dataGoodInfo=e.firstPost.postGoods,-1!==e.firstPost.postGoods.price.indexOf("-")||Number(e.firstPost.postGoods.price)>0?this.dataGoodInfoPrice=e.firstPost.postGoods.price:Number(e.firstPost.postGoods.price)<=0&&(this.dataGoodInfoPrice="")}},addImg:function(){var t={data:[]};return this.uploadFile.forEach((function(e){e&&t.data.push({type:"attachments",id:e.id})})),t},addFile:function(){var t={data:[]};return this.$refs.uploadFiles.getValue().forEach((function(e){e.id&&t.data.push({type:"attachments",id:e.id})})),t},addQuestion:function(){return{data:{be_user_id:this.beAskId,price:this.priceAsk,is_onlooker:this.watchChecked,order_id:this.orderSn,type:1}}},deleteFile:function(t){this.deleteTip=this.i18n.t("core.deleteEnclosureSure"),this.$refs.deletePopup.open(),this.deleteType=1,this.deleteId=t},deleteFileSure:function(t){var e=this,i={_jv:{type:"attachments",id:t}};this.$store.dispatch("jv/delete",i).then((function(t){e.$refs.uploadFiles.deleteSure()}))},getCategories:function(){var t=this;return(0,s.default)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$store.dispatch("jv/get",["categories?filter[createThread]=1",{}]).then((function(e){t.allCategories=e,""===t.categoryId&&t.checkClass(e[0],0)}));case 2:t.categoryId&&t.initCategoryId(t.categoryId);case 3:case"end":return e.stop()}}),e)})))()},initCategoryId:function(t){var e=this;this.allCategories.forEach((function(i){i._jv.id==t?(e.categoryId=t,e.two_categoryId=""):i.children&&i.children.forEach((function(a){a.id==t&&(e.secondallcategories=i.children,e.categoryId=Number(i._jv.id),e.two_categoryId=t)}))}))},postThread:function(){var e=this,i={categoriesId:Number(this.two_categoryId||this.categoryId),content:this.textAreaValue,type:this.type,isAnonymous:this.checked?1:0,price:Number(this.price),freeWords:this.word,id:this.currentId,isDraft:0,isOldDraft:this.currentId?1:0,captchaTicket:this.ticket,captchaRandStr:this.randstr,redPacket:{rule:+this.rule,money:+this.money,number:+this.number,condition:+this.condition,likenum:+this.likenum,orderId:this.orderSn,orderPrice:0}};1===this.payType?(i.attachmentPrice=this.price,i.price=0):0===this.payType&&(i.attachmentPrice="",i.price=Number(this.price));var a=this.currentPosition;a&&(i.longitude=Number(a.longitude)||"",i.latitude=Number(a.latitude)||"",i.location=a.location||"",i.address=a.address||"");var s=new Promise((function(t,a){switch(e.type){case 0:t();break;case 1:i.title=e.postTitle;var s=e.addImg().data.concat(e.addFile().data);i.attachments=[],s.map((function(t){i.attachments.push({id:Number(t.id),type:t.type})})),t();break;case 2:i.fileId=e.fileId,i.fileName=e.videoName,t();break;case 3:var o=e.addImg().data;i.attachments=[],o.map((function(t){i.attachments.push({id:Number(t.id),type:t.type})})),t();break;case 4:i.fileId=e.audioBeforeList[0].id,i.fileName=e.audioBeforeList[0].fileName,t();break;case 5:var n=e.addImg().data,r=e.addQuestion().data;i.attachments=[],i.question={},n.map((function(t){i.attachments.push({id:Number(t.id),type:t.type})})),r&&(i.question.type=r.type,i.question.price=Number(r.price),i.question.orderId=r.order_id,i.question.isOnlooker=r.is_onlooker,i.question.beUserId=r.be_user_id),t();break;case 6:i.postGoodsId=Number(e.dataGoodInfo._jv.id),t();break;default:a(),e.$refs.toast.show({message:e.i18n.t("core.postTypesDoNotMatch")})}}));return this.save=!0,clearInterval(this.timer1),this.timer1=null,clearInterval(this.timer2),this.timer2=null,s.then((function(){return m.default.createThread({data:i}).then((function(t){return t})).catch((function(e){t.log(e)}))}))},delAttachments:function(t,e){if("edit"===this.operating){this.$u.event.$emit("deleteImg",{threadId:this.postDetails._jv.id,index:e});var i=this.$store.getters["jv/get"]("posts/".concat(this.postDetails.firstPost._jv.id));i.images.splice(e,1),i._jv.relationships.images.data.splice(e,1)}},handleClickOk:function(){this.$refs.deletePopup.close(),0===this.deleteType?(this.delAttachments(this.deleteId,this.deleteIndex),this.$refs.upload.clear(this.deleteIndex)):2===this.deleteType?(this.videoBeforeList=[],this.percent=0):3===this.deleteType&&(this.audioBeforeList=[])},handleClickCancel:function(){this.$refs.deletePopup.close()},handleWechatClickOk:function(){this.isWeixin?this.wxh5Login(0,0):uni.showToast({icon:"none",title:this.i18n.t("user.unLogin"),duration:2e3})},handleWechatClickCancel:function(){this.$refs.wechatPopup.close()},getSignature:function(t){this.$store.dispatch("jv/get",["signature",{}]).then((function(e){t((function(){return e.signature}))}))},postVideo:function(t){var e={_jv:{type:"thread/video"},file_id:t,type:0};this.$store.dispatch("jv/post",e)},getPostThread:function(t){var e=this;this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:["firstPost","firstPost.images","threadVideo","threadAudio","category","firstPost.attachments","question","onlookers","question.beUser","question.images","firstPost.postGoods"]}}]).then((function(i){switch(e.is_red_packet=i.isRedPacket,i.question&&(e.beUserName=i.question.beUser.username,e.beAskId=i.question.beUser.id,e.userImage=i.question.beUser.avatarUrl),e.postDetails=i,e.firstPostId=i.firstPost._jv.id,e.type=i.type,1===e.type&&(e.markdownShow=!0),e.attachmentList=i.firstPost.attachments||[],e.textAreaValue=i.firstPost.parseContentHtml,e.categoryId=i.category._jv.id,e.initCategoryId(e.categoryId),e.checkClassData.push(i.category),i.threadVideo&&(e.fileId=i.threadVideo.file_id,e.percent=1),e.checked=i.isAnonymous,5===e.type&&(e.watchChecked=i.question.is_onlooker),i.firstPost.images&&i.firstPost.images.forEach((function(t){t&&e.uploadFile.push({type:"attachments",id:t._jv.id,order:t.order,name:t.fileName,url:t.url,path:t.thumbUrl?t.thumbUrl:""})})),6===e.type&&i.firstPost.postGoods&&(e.dataGoodInfo=i.firstPost.postGoods,-1!==i.firstPost.postGoods.price.indexOf("-")||Number(i.firstPost.postGoods.price)>0?e.dataGoodInfoPrice=i.firstPost.postGoods.price:Number(i.firstPost.postGoods.price)<=0&&(e.dataGoodInfoPrice=""),e.isShowGoods=!0),e.loadStatus=!0,Number(i.price)>0?(e.price=i.price,e.word=i.freeWords,e.freepercentage.forEach((function(t){i.freeWords===t.pay&&(e.percentagedisplay=t.name)})),e.payType=2,e.showPayType=e.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsPaid"),1===e.type&&(e.payNum[0].name="￥1",e.payNum[0].pay=1)):Number(i.attachmentPrice)>0?(e.price=i.attachmentPrice,e.payType=1,e.showPayType=e.i18n.t("discuzq.post.TheContentIsFreeAndTheAccessoriesArePaid"),e.payNum[0].name="￥1",e.payNum[0].pay=1):e.showPayType=e.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree"),e.textAreaLength=1===e.type?49999:5e3,Number(i.type)){case 0:break;case 1:e.postTitle=i.title,e.setAnnex("img",i);break;case 2:e.percent=1,e.setAnnex("video",i);break;case 3:e.setAnnex("img",i);break;case 4:e.setAnnex("audio",i);break;case 5:e.setAnnex("img",i);break;case 6:e.setAnnex("goods",i)}if(t.name){var a={},s=t.latng.split(",");a.longitude=s[1],a.latitude=s[0],a.location=t.name,a.address=t.addr,e.currentPosition=a}else e.currentPosition.longitude=i.longitude||"",e.currentPosition.latitude=i.latitude||"",e.currentPosition.location=i.location||"",e.currentPosition.address=i.address||"";"edit"===e.operating&&e.goodsId&&e.getGoodsInfo(),e.setThread()}))},getGoodsInfo:function(){var t=this;this.$store.dispatch("jv/get","goods/".concat(this.goodsId)).then((function(e){t.dataGoodInfo=e,-1!==e.price.indexOf("-")||Number(e.price)>0?t.dataGoodInfoPrice=e.price:Number(e.price)<=0&&(t.dataGoodInfoPrice=""),t.isShowGoods=!0}))},editThread:function(){var t=this;return(0,s.default)(regeneratorRuntime.mark((function e(){var i,a,s,o,n,r,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=0,a={pid:Number(t.firstPostId),data:{attributes:{content:t.textAreaValue,is_old_draft:1},relationships:{attachments:{data:[]}},id:Number(t.threadId)}},s={categoriesId:Number(t.two_categoryId||t.categoryId),id:Number(t.threadId),isOldDraft:1,content:t.textAreaValue,type:t.type},o=t.currentPosition,s.longitude=Number(o.longitude)||"",s.latitude=Number(o.latitude)||"",s.location=o.location||"",s.address=o.address||"",e.t0=t.type,e.next=0===e.t0?11:1===e.t0?12:2===e.t0?18:3===e.t0?22:4===e.t0?27:5===e.t0?31:6===e.t0?36:38;break;case 11:return e.abrupt("break",39);case 12:return s.title=t.postTitle,1===t.payType?(s.attachmentPrice=t.price,s.price=0):2===t.payType?(s.attachmentPrice="",s.price=Number(t.price)):0===t.payType&&(s.attachmentPrice=0,s.price=0),n=t.addImg().data.concat(t.addFile().data),a.data.relationships.attachments.data=[],n.forEach((function(t){a.data.relationships.attachments.data.push({id:Number(t.id),type:t.type})})),e.abrupt("break",39);case 18:return s.fileId=t.fileId,s.fileName=t.videoName,s.price=t.price,e.abrupt("break",39);case 22:return s.price=t.price,r=t.addImg().data,a.data.relationships.attachments.data=[],r.forEach((function(t){a.data.relationships.attachments.data.push({id:Number(t.id),type:t.type})})),e.abrupt("break",39);case 27:return s.price=t.price,s.fileId=t.audioBeforeList[0].id,s.fileName=t.audioBeforeList[0].fileName,e.abrupt("break",39);case 31:return c=t.addImg().data,a.data.relationships.attachments.data=[],c.forEach((function(t){a.data.relationships.attachments.data.push({id:Number(t.id),type:t.type})})),params._jv.relationships.question=t.addQuestion(),e.abrupt("break",39);case 36:return a.postGoodsId=t.dataGoodInfo._jv.id,e.abrupt("break",39);case 38:return e.abrupt("break",39);case 39:return e.next=41,m.default.updatePosts({data:a}).then((function(t){return t.Data.pid&&(i+=1),t}));case 41:return e.next=43,m.default.updateThreads({data:s}).then((function(t){t.Data.id&&(i+=1)}));case 43:if(2!==i){e.next=45;break}return e.abrupt("return",i);case 45:throw new Error("出错了");case 46:case"end":return e.stop()}}),e)})))()},toTCaptcha:function(){var t=this;this.captcha=new TencentCaptcha(this.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret&&(t.ticket=e.ticket,t.randstr=e.randstr,t.payShowStatus=!0,t.postClick()),2===e.ret&&(t.postLoading=!1,t.payShowStatus=!1,uni.hideLoading())})),this.captcha.show()},changeAvatar:function(){uni.setStorage({key:"edit_content",data:this.textAreaValue}),uni.navigateTo({url:"/pages/user/at-member?name=select"})}}),onLoad:function(e){var i=this;if("1"===e.isSaveText)try{var a=uni.getStorageSync("add_goods_text");a&&(this.textAreaValue=a)}catch(t){}"edit"===e.operating&&(this.cansavedraft=!1,this.redbagplay=!1),this.currentId=e.threadId,1==e.isredbag&&this.$store.dispatch("jv/get",["redpacket/".concat(e.threadId),{}]).then((function(t){i.is_red_packet=e.isredbag,i.money=t.money,i.showmoney=t.money,i.number=t.number,i.condition=t.condition,i.likenum=t.likenum,i.rule=t.rule,"1"===i.rule||1===i.rule?i.sumtype="随机":(i.sumtype="固定",i.showmoney=i.money/i.number)}),(function(e){return t.log(e)})),"5"===e.type&&(uni.getStorage({key:"edit_content",success:function(t){i.textAreaValue=t.data}}),this.payNum[0].name=this.i18n.t("discuzq.post.noReward")),this.categoryid=e.categoryId,this.categoryindex=e.categoryIndex,uni.$on("radioChange",(function(t){i.beUserName=t.username,i.beAskId=t.id,i.userImage=t.avatarUrl})),this.forums&&this.forums.other&&(this.canUploadAttachment=this.forums.other.can_upload_attachments),this.forums&&this.forums.paycenter&&("edit"!==e.operating&&this.forums.paycenter.wxpay_close?this.showPayType=this.i18n.t("discuzq.post.TheContentAndTheAccessoriesIsFree"):this.askingPrice=!1),e.type&&(this.type=Number(e.type));var s=l.default.isWeixin().isWeixin;this.isWeixin=s,this.isPhone=l.default.isWeixin().isPhone,!1===this.isWeixin&&(this.payTypeData[0].hide=!0),this.browser=1,1===this.type&&uni.$on("vditor",(function(t,e){i.vditor=t,i.vditor.setValue(i.textAreaValue),e.setPostComponent(i)})),this.url=r.DISCUZ_REQUEST_HOST;var o=uni.getStorageSync("access_token");if(this.header={authorization:"Bearer ".concat(o)},this.formData={type:1},this.getCategories(),e.operating&&(this.operating=e.operating),e.threadId&&(this.threadId=e.threadId),e.categoryIndex&&("0"===e.categoryIndex?this.categoryIndex="":this.categoryIndex=Number(e.categoryIndex)),e.categoryId&&(this.categoryId=0===Number(e.categoryId)?"":Number(e.categoryId)),this.textAreaLength=1===Number(e.type)?49999:5e3,"edit"===this.operating||"draft"===this.operating)this.loadStatus=!1,this.getPostThread(e);else if(this.loadStatus=!0,e.name){var n={},c=e.latng.split(",");n.longitude=c[1],n.latitude=c[0],n.location=e.name,n.address=e.addr,this.currentPosition=n}try{uni.getSystemInfoSync();this.forums&&this.forums.paycenter.wxpay_close&&this.forums.other.can_create_thread_paid?(this.ioshide=!0,this.showHidden=!0):(this.ioshide=!1,this.showHidden=!1)}catch(t){}(1===this.type&&(this.markdownShow=!0),this.$u.event.$on("captchaResult",(function(t){i.ticket=t.ticket,i.randstr=t.randstr,i.postClick()})),this.$u.event.$on("closeChaReault",(function(){i.postLoading=!1,i.payShowStatus=!1,uni.hideLoading()})),uni.$on("clickTopic",(function(t){t.keywords&&(i.textAreaValue="".concat(i.textAreaValue.slice(0,i.cursor),"  #").concat(t.keywords.replace(/\s+/g,""),"#").concat(i.textAreaValue.slice(i.cursor),"  ")),i.cursor=i.textAreaValue?i.textAreaValue.length:0})),6===this.type&&(this.goodsId=e.goodsId),(6===this.type&&"edit"!==e.operating&&""!==e.threadId&&this.goodsId||6===this.type&&this.goodsId)&&this.getGoodsInfo(),2===this.type||3===this.type)&&this.getOpenerEventChannel().on("acceptDataFromOpenerPage",(function(t){3===i.type&&(t.map((function(t){i.uploadFile.push({type:"attachments",id:t.data.id,order:t.data.attributes.order,name:t.data.attributes.fileName,url:t.data.attributes.url,path:t.data.attributes.thumbUrl?t.data.attributes.thumbUrl:""}),i.filePreview.push({path:t.data.attributes.thumbUrl,id:t.data.id,order:t.data.attributes.order,name:t.data.attributes.fileName,url:t.data.attributes.url})})),i.addImg()),2===i.type&&t.data&&(t.data.doneResult?i.fileId=t.data.doneResult.fileId:i.fileId=t.data.result.fileId,i.videoBeforeList.push({path:t.data.uploadVideoRes.tempFilePath}),i.chooseType=0,i.percent=1)}));e.fromdrafts&&(this.operating="")},onShow:function(){var t=this,e="";this.getAtMemberData.map((function(t){return e+="@".concat(t.username," ")})),this.textAreaValue="".concat(this.textAreaValue.slice(0,this.cursor)+e+this.textAreaValue.slice(this.cursor)),this.setAtMember([]),this.cursor=this.textAreaValue?this.textAreaValue.length:0,this.threadId||this.setThread(),uni.getStorage({key:"is_red_packet",success:function(e){t.is_red_packet=e.data}}),uni.getStorage({key:"rule",success:function(e){t.rule=e.data}}),uni.getStorage({key:"money",success:function(e){t.money=e.data,t.showmoney=e.data}}),uni.getStorage({key:"number",success:function(e){t.number=e.data}}),uni.getStorage({key:"condition",success:function(e){t.condition=e.data}}),uni.getStorage({key:"likenum",success:function(e){t.likenum=e.data,"1"===t.rule||1===t.rule?t.sumtype="随机":(t.sumtype="固定",t.money=t.money*t.number)}})},onReady:function(){this.videoContext=uni.createVideoContext("video")},onUnload:function(){this.$u.event.$off("captchaResult"),this.$u.event.$off("closeChaReault"),this.$u.event.$off("radioChange"),this.$u.event.$off("radioEditChange"),uni.$off("clickTopic"),uni.$off("clickImage"),uni.$off("clickAttach"),this.captcha&&this.captcha.destroy(),clearInterval(v),clearInterval(null),uni.removeStorage({key:"is_red_packet",success:function(t){}}),uni.removeStorage({key:"rule",success:function(t){}}),uni.removeStorage({key:"money",success:function(t){}}),uni.removeStorage({key:"number",success:function(t){}}),uni.removeStorage({key:"condition",success:function(t){}}),uni.removeStorage({key:"likenum",success:function(t){}}),uni.removeStorage({key:"edit_content",success:function(t){}}),this.save=!0,clearInterval(this.timer1),this.timer1=null,clearInterval(this.timer2),this.timer2=null},mounted:function(){this.cansavedraft&&this.onStartSave(),this.red_bagshow(),this.geographical_location_show()}};e.default=y}).call(this,i("5a52").default)},d1de:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RESPONSE_CODE=void 0;e.RESPONSE_CODE={SUCCESS:0,JUMP_TO_LOGIN:-3001,JUMP_TO_REGISTER:-3002,JUMP_TO_AUDIT:-3003,JUMP_TO_HOME_INDEX:-3004,INVALID_PARAMETER:-4001,UNAUTHORIZED:-4002,RESOURCE_EXIST:-4003,RESOURCE_NOT_FOUND:-4004,RESOURCE_IN_USE:-4005,NET_ERROR:-5001,INTERNAL_ERROR:-5002,DB_ERROR:-5003,EXTERNAL_API_ERROR:-5004,UNKNOWN_ERROR:-6001,DEBUG_ERROR:-6002}},d9eb:function(t,e,i){"use strict";var a=i("4833");i.n(a).a},e047:function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.readThreadDetail=function(){return u.apply(this,arguments)},i("96cf");var s=a(i("5530")),o=a(i("15fd")),n=a(i("1da1")),r=["params","data"],c={pid:{type:"number",required:!0},stopViewCount:{type:"boolean"}};function u(){return(u=(0,n.default)(regeneratorRuntime.mark((function t(){var e,i,a,n,u,d,p,l,h=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=h.length>0&&void 0!==h[0]?h[0]:{},t.prev=1,i=e.params,a=void 0===i?{}:i,n=e.data,u=void 0===n?{}:n,d=(0,o.default)(e,r),p=(0,s.default)((0,s.default)({url:"/api/threads.detail.v2",method:"GET",params:a,data:u},d),{},{validateRules:c}),t.next=6,this.http(p);case 6:return l=t.sent,t.abrupt("return",l);case 10:return t.prev=10,t.t0=t.catch(1),t.abrupt("return",t.t0);case 13:case"end":return t.stop()}}),t,this,[[1,10]])})))).apply(this,arguments)}},e972:function(t,e,i){t.exports=i.p+"static/img/msg-404.3ba2611f.svg"},f108:function(t,e,i){"use strict";var a=i("6524");i.d(e,"a",(function(){return a.a})),i.d(e,"b",(function(){return a.b})),i.d(e,"c",(function(){return a.c}))},f61d:function(t,e,i){"use strict";var a=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"RESPONSE_CODE",{enumerable:!0,get:function(){return o.RESPONSE_CODE}}),e.apiIns=void 0;var s=a(i("7fe0")),o=i("d1de"),n=i("79fc"),r=i("e047"),c=i("04fe"),u=i("2e6a"),d=i("4661"),p=i("7f23"),l=i("6670"),h=i("5458"),f=i("2df5");e.apiIns=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new s.default(t);return e.readThreadList=n.readThreadList,e.readThreadDetail=r.readThreadDetail,e.readCategories=c.readCategories,e.readCommentList=u.readCommentList,e.readStickList=d.readStickList,e.createThread=p.createThread,e.updateThreads=l.updateThreads,e.updatePosts=h.updatePosts,e.createPosts=f.createPosts,e}}}]);