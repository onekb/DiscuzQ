(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{"/V7O":function(e,r,t){"use strict";t.r(r);var a=t("uMH0"),c=t("yDFb");for(var i in c)["default"].indexOf(i)<0&&function(e){t.d(r,e,(function(){return c[e]}))}(i);var s=t("KHd+"),o=Object(s.a)(c.default,a.a,a.b,!1,null,null,null);r.default=o.exports},fsy8:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=i(t("QbLZ"));t("I1+7");var c=i(t("zxK7"));function i(e){return e&&e.__esModule?e:{default:e}}r.default=(0,a.default)({name:"user-permission-view"},c.default)},uMH0:function(e,r,t){"use strict";t.d(r,"a",(function(){return a})),t.d(r,"b",(function(){return c}));var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"rol-permission-box"},[t("div",{staticClass:"index-main-con__main-title__class permission__title"},[t("i"),e._v(" "),e._l(e.menuData,(function(r,a){return t("span",{key:a,class:e.activeTab.name===r.name?"is-active":"",on:{click:function(t){e.activeTab=r}}},[e._v(e._s(r.title))])}))],2),e._v(" "),t("Card",{attrs:{header:e.$router.history.current.query.name+e.activeTab.title}}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"publish"===e.activeTab.name,expression:"activeTab.name === 'publish'"}]},[t("Card",[t("CardRow",{attrs:{description:"允许发布文字帖"}},[t("el-checkbox",{attrs:{label:"createThread",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布文字")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布长文帖"}},[t("el-checkbox",{attrs:{label:"createThreadLong",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布帖子")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布图片帖"}},[t("el-checkbox",{attrs:{label:"createThreadImage",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布图片")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布语音帖"}},[t("el-checkbox",{attrs:{label:"createThreadAudio",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布语音")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布视频帖"}},[t("el-checkbox",{attrs:{label:"createThreadVideo",disabled:e.videoDisabled||"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布视频")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布私信"}},[t("el-checkbox",{attrs:{label:"dialog.create",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布私信")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布商品帖"}},[t("el-checkbox",{attrs:{label:"createThreadGoods",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布商品")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布问答，只有在开启微信支付且允许发布付费内容时才能设置提问价格"}},[t("el-checkbox",{attrs:{label:"createThreadQuestion",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布问答")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许成为发布问答时的提问对象"}},[t("el-checkbox",{attrs:{label:"canBeAsked",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("允许被提问")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许在发布问答时设置围观"}},[t("el-checkbox",{attrs:{label:"canBeOnlooker",disabled:!e.canBeOnlooker||"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("设置围观")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"回复主题的权限"}},[t("el-checkbox",{attrs:{label:"thread.reply",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("回复主题")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"发布主题时上传附件的权限"}},[t("el-checkbox",{attrs:{label:"attachment.create.0",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("上传附件")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"发布主题时上传图片的权限"}},[t("el-checkbox",{attrs:{label:"attachment.create.1",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("上传图片")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"允许发布付费内容、付费附件"}},[t("el-checkbox",{attrs:{label:"createThreadPaid",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id||e.wechatPayment},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布付费内容")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"内容允许被打赏"}},[t("el-checkbox",{attrs:{label:"canBeReward",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id||e.wechatPayment},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("允许被打赏")])],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"security"===e.activeTab.name,expression:"activeTab.name === 'security'"}]},[t("Card",[t("CardRow",{attrs:{description:"启用验证码需先在腾讯云设置中开启验证码服务"}},[t("el-checkbox",{attrs:{label:"createThreadWithCaptcha",disabled:e.captchaDisabled||"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布内容时启用验证码")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"实名认证后才可发布内容"}},[t("el-checkbox",{attrs:{label:"publishNeedRealName",disabled:e.realNameDisabled||"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布内容需先实名认证")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"绑定手机后才可发布内容"}},[t("el-checkbox",{attrs:{label:"publishNeedBindPhone",disabled:e.bindPhoneDisabled||"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("发布内容需先绑定手机")])],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"operate"===e.activeTab.name,expression:"activeTab.name === 'operate'"}]},[t("Card",[t("CardRow",{attrs:{description:"查看主题列表页的权限"}},[t("el-checkbox",{attrs:{label:"viewThreads",disabled:"1"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("查看主题列表")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"查看主题的详情页的权限"}},[t("el-checkbox",{attrs:{label:"thread.viewPosts",disabled:"1"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("查看主题详情")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"查看站点成员列表、搜索成员的权限"}},[t("el-checkbox",{attrs:{label:"viewUserList",disabled:"1"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("站点会员列表")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"作者编辑自己的主题或回复的权限"}},[t("el-checkbox",{attrs:{label:"editOwnThreadOrPost",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("编辑自己的主题或回复")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"作者删除自己的主题或回复的权限"}},[t("el-checkbox",{attrs:{label:"hideOwnThreadOrPost",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("删除自己的主题或回复")])],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"manage"===e.activeTab.name,expression:"activeTab.name === 'manage'"}]},[t("Card",[t("CardRow",{attrs:{description:"前台删除单个主题的权限"}},[t("el-checkbox",{attrs:{label:"thread.hide",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("删主题")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台删除单个回复的权限"}},[t("el-checkbox",{attrs:{label:"thread.hidePosts",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("删回复")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台置顶、取消置顶主题的权限"}},[t("el-checkbox",{attrs:{label:"thread.sticky",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("置顶")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台精华、取消精华主题的权限"}},[t("el-checkbox",{attrs:{label:"thread.essence",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("加精")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台单个主题的编辑权限"}},[t("el-checkbox",{attrs:{label:"thread.editPosts",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("编辑")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台批量管理主题的权限"}},[t("el-checkbox",{attrs:{label:"thread.batchEdit",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("批量管理主题")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台按用户组邀请成员的权限"}},[t("el-checkbox",{attrs:{label:"createInvite",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("管理-邀请加入")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台更改成员所属用户组的权限"}},[t("el-checkbox",{attrs:{label:"user.edit.group",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("编辑用户组")])],1)],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:"前台更改成员禁用状态的权限"}},[t("el-checkbox",{attrs:{label:"user.edit.status",disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("编辑用户状态")])],1)],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"default"===e.activeTab.name,expression:"activeTab.name === 'default'"}]},[t("Card",[t("CardRow",{attrs:{description:""}},[t("p",{staticStyle:{"margin-left":"24PX"}},[e._v("站点信息")])])],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:""}},[t("p",{staticStyle:{"margin-left":"24PX"}},[e._v("主题点赞")])])],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:""}},[t("p",{staticStyle:{"margin-left":"24PX"}},[e._v("主题收藏")])])],1),e._v(" "),t("Card",[t("CardRow",{attrs:{description:""}},[t("p",{staticStyle:{"margin-left":"24PX"}},[e._v("主题打赏")])])],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"other"===e.activeTab.name,expression:"activeTab.name === 'other'"}]},[t("Card",{attrs:{header:"裂变推广："}},[t("CardRow",{attrs:{description:"允许用户裂变推广以及通过推广注册进来的用户收入是否能分成"}},[t("el-checkbox",{attrs:{disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},on:{change:e.handlePromotionChange},model:{value:e.is_subordinate,callback:function(r){e.is_subordinate=r},expression:"is_subordinate"}},[e._v("裂变推广")]),e._v(" "),t("el-checkbox",{attrs:{disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id},on:{change:e.handleScaleChange},model:{value:e.is_commission,callback:function(r){e.is_commission=r},expression:"is_commission"}},[e._v("收入分成")])],1),e._v(" "),e.is_subordinate||e.is_commission?t("CardRow",{staticClass:"proportion-box",attrs:{description:"站点开启付费模式时下线付费加入、主题被打赏、被付费等的分成比例设置，填1表示10%，不填或为0时为不分成"}},[t("div",[t("span",[e._v("提成比例")]),e._v(" "),t("el-input",{attrs:{type:"number"},on:{blur:e.checkNum},model:{value:e.scale,callback:function(r){e.scale=r},expression:"scale"}})],1)]):e._e()],1)],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"pricesetting"===e.activeTab.name,expression:"activeTab.name === 'pricesetting'"}]},[t("Card",{attrs:{header:"允许购买："}},[t("CardRow",{staticClass:"allow-box",attrs:{description:"允许购买"}},[t("el-switch",{attrs:{disabled:"1"===e.$router.history.current.query.id||"7"===e.$router.history.current.query.id||!e.allowtobuy||e.defaultuser,"active-color":"#336699","inactive-color":"#bbbbbb"},on:{change:e.fun},model:{value:e.value,callback:function(r){e.value=r},expression:"value"}})],1)],1),e._v(" "),e.value?t("Card",{attrs:{header:"购买价格（元）："}},[t("CardRow",{attrs:{description:"需支付的金额"}},[t("el-input",{attrs:{placeholder:"加入价格",type:"number"},on:{input:e.addprice},model:{value:e.purchasePrice,callback:function(r){e.purchasePrice=r},expression:"purchasePrice"}})],1)],1):e._e(),e._v(" "),e.value?t("Card",{attrs:{header:"到期时间："}},[t("CardRow",{attrs:{description:"到期时间，可维持的时间"}},[e._v("\n        加入起\n        "),t("el-input",{staticClass:"elinput",staticStyle:{height:"36PX",width:"80PX"},attrs:{clearable:"",placeholder:"天数",type:"number"},on:{input:e.duedata},model:{value:e.dyedate,callback:function(r){e.dyedate=r},expression:"dyedate"}}),e._v("\n        天后\n      ")],1)],1):e._e()],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:"category"===e.activeTab.name,expression:"activeTab.name === 'category'"}],staticClass:"cont-class-box"},[t("div",{staticClass:"cont-class-table"},[t("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.categoriesList,"tooltip-effect":"dark"}},[t("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{id:r.row.id,indeterminate:r.row.isIndeterminate},on:{change:function(t){return e.handleCheckAllChange(r.row)}},model:{value:r.row.checkAll,callback:function(t){e.$set(r.row,"checkAll",t)},expression:"scope.row.checkAll"}})}}])}),e._v(" "),t("el-table-column",{attrs:{label:"分类"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v(e._s(r.row.name))]}}])}),e._v(" "),t("el-table-column",{attrs:{label:"浏览分类"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{label:"category"+r.row.id+".viewThreads"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])}),e._v(" "),t("el-table-column",{attrs:{label:"发表内容"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{disabled:-1===e.checked.indexOf("category"+r.row.id+".viewThreads")||"7"===e.groupId,label:"category"+r.row.id+".createThread"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])}),e._v(" "),t("el-table-column",{attrs:{label:"发表评论"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{disabled:-1===e.checked.indexOf("category"+r.row.id+".viewThreads")||"7"===e.groupId,label:"category"+r.row.id+".replyThread"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])}),e._v(" "),t("el-table-column",{attrs:{label:"编辑内容"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{disabled:-1===e.checked.indexOf("category"+r.row.id+".viewThreads")||"7"===e.groupId,label:"category"+r.row.id+".thread.edit"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])}),e._v(" "),t("el-table-column",{attrs:{label:"删除内容"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{disabled:-1===e.checked.indexOf("category"+r.row.id+".viewThreads")||"7"===e.groupId,label:"category"+r.row.id+".thread.hide"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])}),e._v(" "),t("el-table-column",{attrs:{label:"加精内容"},scopedSlots:e._u([{key:"default",fn:function(r){return t("el-checkbox",{attrs:{disabled:-1===e.checked.indexOf("category"+r.row.id+".viewThreads")||"7"===e.groupId,label:"category"+r.row.id+".thread.essence"},on:{change:function(t){return e.handleCheckedCategoryPermissionsChange(r.row)}},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v(e._s("")+"\n          ")])}}])})],1)],1)]),e._v(" "),t("Card",{staticClass:"footer-btn"},[t("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.submitClick}},[e._v("提交")])],1)],1)},c=[]},yDFb:function(e,r,t){"use strict";t.r(r);var a=t("fsy8"),c=t.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){t.d(r,e,(function(){return a[e]}))}(i);r.default=c.a},zxK7:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=i(t("4gYi")),c=i(t("pNQN"));function i(e){return e&&e.__esModule?e:{default:e}}r.default={data:function(){return{groupId:0,checked:[],videoDisabled:!1,captchaDisabled:!1,realNameDisabled:!1,is_subordinate:!1,is_commission:!1,scale:0,bindPhoneDisabled:!1,wechatPayment:!1,canBeOnlooker:!1,categoriesList:[],activeTab:{title:"内容发布权限",name:"publish"},menuData:[{title:"内容发布权限",name:"publish"},{title:"内容分类权限",name:"category"},{title:"前台操作权限",name:"operate"},{title:"前台管理权限",name:"manage"},{title:"安全设置",name:"security"},{title:"价格设置",name:"pricesetting"},{title:"其他设置",name:"other"}],value:"",purchasePrice:"",dyedate:"",ispad:"",allowtobuy:"",defaultuser:!1}},methods:{duedata:function(e){this.duedata=e.replace(/[^\d]/g,"")},addprice:function(e){var r=this;setTimeout((function(){r.purchasePrice=e.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,"")}),5)},signUpSet:function(){var e=this;this.appFetch({url:"forum",method:"get"}).then((function(r){r.errors?e.$message.error(r.errors[0].code):(e.videoDisabled=!1===r.readdata._data.qcloud.qcloud_vod,e.captchaDisabled=!1===r.readdata._data.qcloud.qcloud_captcha,e.realNameDisabled=!1===r.readdata._data.qcloud.qcloud_faceid,e.bindPhoneDisabled=!1===r.readdata._data.qcloud.qcloud_sms,e.wechatPayment=!1===r.readdata._data.paycenter.wxpay_close,e.canBeOnlooker=r.readdata._data.set_site.site_onlooker_price>0,e.allowtobuy=r.readdata._data.set_site.site_pay_group_close,e.allowtobuy||(e.value=!1))}))},getCategories:function(){var e=this;this.appFetch({url:"categories",method:"get"}).then((function(r){r.errors?e.$message.error(r.errors[0].code):(e.categoriesList=[],r.readdata.forEach((function(r){var t={id:r._data.id,name:r._data.name};e.handleCheckedCategoryPermissionsChange(t),e.categoriesList.push(t)})))}))},handleCheckAllChange:function(e){var r=this;["category"+e.id+".viewThreads","category"+e.id+".createThread","category"+e.id+".replyThread","category"+e.id+".thread.edit","category"+e.id+".thread.hide","category"+e.id+".thread.essence"].forEach((function(t){var a=r.checked.indexOf(t);e.checkAll?-1===a&&r.checked.push(t):-1!==a&&r.checked.splice(a,1)})),e.isIndeterminate=!1},handleCheckedCategoryPermissionsChange:function(e){var r=0,t=["category"+e.id+".viewThreads","category"+e.id+".createThread","category"+e.id+".replyThread","category"+e.id+".thread.edit","category"+e.id+".thread.hide","category"+e.id+".thread.essence"];this.checked.forEach((function(e){-1!==t.indexOf(e)&&r++})),e.checkAll=r===t.length,e.isIndeterminate=r>0&&r<t.length},submitClick:function(){if(this.checkNum())if(this.value){if(0==this.purchasePrice)return void this.$message.error("价格不能为0");if(" "==this.purchasePrice)return void this.$message.error("价格不能为空");if(0==this.dyedate)return void this.$message.error("到期时间不能为0");if(" "==this.dyedate)return void this.$message.error("到期时间不能为空");this.patchGroupScale()}else this.patchGroupScale()},getGroupResource:function(){var e=this;this.appFetch({url:"groups",method:"get",splice:"/"+this.groupId,data:{include:["permission","categoryPermissions"]}}).then((function(r){if(r.errors)r.errors[0].detail?e.$message.error(r.errors[0].code+"\n"+r.errors[0].detail[0]):e.$message.error(r.errors[0].code);else{e.ispad=r.data.attributes.isPaid,e.purchasePrice=r.data.attributes.fee,e.dyedate=r.data.attributes.days;var t=r.readdata.permission;e.checked=[],e.scale=r.data.attributes.scale,e.is_subordinate=r.data.attributes.is_subordinate,e.is_commission=r.data.attributes.is_commission,e.defaultuser=r.data.attributes.default,r.data.attributes.default?(e.value=!1,e.patchGroupScale()):e.value=r.data.attributes.isPaid,t.forEach((function(r){e.checked.push(r._data.permission)})),e.getCategories()}})).catch((function(e){}))},patchGroupPermission:function(){var e=this,r=this.checked;this.is_commission||this.is_subordinate?-1===r.indexOf("other.canInviteUserScale")&&r.push("other.canInviteUserScale"):r.forEach((function(e,t){"other.canInviteUserScale"===e&&r.splice(t,1)})),this.appFetch({url:"groupPermission",method:"post",data:{data:{attributes:{groupId:this.groupId,permissions:r}}}}).then((function(r){r.errors?e.$message.error(r.errors[0].code):e.$message({showClose:!0,message:"提交成功",type:"success"})})).catch((function(e){}))},patchGroupScale:function(){var e=this;this.appFetch({url:"groups",method:"PATCH",splice:"/"+this.groupId,data:{data:{attributes:{name:this.$route.query.name,is_paid:this.value?1:0,fee:this.purchasePrice,days:this.dyedate,scale:this.scale,is_subordinate:this.is_subordinate,is_commission:this.is_commission}}}}).then((function(r){r.errors?e.$message.error(r.errors[0].code):e.patchGroupPermission()})).catch((function(e){}))},handlePromotionChange:function(e){this.is_subordinate=e},handleScaleChange:function(e){this.is_commission=e},checkNum:function(){if(!this.scale)return!0;return!!/^([0-9](\.\d)?|10)$/.test(this.scale)||(this.$message({message:"提成比例必须是0~10的整数或者一位小数",type:"error"}),!1)}},created:function(){this.groupId=this.$route.query.id,this.activeTab.title=this.$route.query.title||"内容发布权限",this.activeTab.name=this.$route.query.names||"publish",this.getGroupResource(),this.signUpSet()},components:{Card:a.default,CardRow:c.default}}}}]);