(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{"9kjX":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(r("Dt3C")),s=o(r("rWG0")),i=o(r("7qpD")),n=o(r("VVfg"));function o(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{searchData:{userName:"",reportType:null,reportTime:["",""],status:0},reportTypeData:[{name:"主题",id:1},{name:"评论/回复",id:2}],reportListAll:[],reportList:[],submitForm:[],pageData:{pageSize:10,pageCount:1,pageNumber:1,pageTotal:0},subLoading:!1,visible:!1}},methods:{closeDelet:function(e){this.$refs[e][0].doClose()},radioChange:function(e,t){switch(e){case 0:this.submitForm[t].type=0;break;case 1:this.submitForm[t].type=1}},formatDate:function(e){return this.$dayjs(e).format("YYYY-MM-DD HH:mm")},getType:function(e){return 0===e?"个人主页":1===e?"主题":2===e?"评论/回复":void 0},getUrl:function(e,t,r){var a="";return{href:a=0===r?0===t?"/user/"+e:"/thread/"+t:"/thread/comment/"+r+"?threadId="+t,url:window.origin+a}},searchClick:function(){this.searchData.reportTime=null==this.searchData.reportTime?["",""]:this.searchData.reportTime,this.searchData.reportType=""===this.searchData.reportType?null:this.searchData.reportType,this.pageData.pageNumber=1,this.getReportList(1)},getReportList:function(e){var t=this,r=this.searchData;this.appFetch({url:"reports_get_v3",method:"get",data:{"filter[username]":r.userName,"filter[status]":0,"filter[type]":r.reportType,"filter[startTime]":r.reportTime[0],"filter[endTime]":r.reportTime[1],page:e,perPage:this.pageData.pageSize}}).then((function(e){if(e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);var r=e.Data;t.reportList=r.pageData||[],t.pageData.pageTotal=r.totalCount,t.pageData.pageCount=r.totalPage,t.reportListAll=[],t.submitForm=[],t.reportList.forEach((function(e){t.reportListAll.push(e.report.id),t.submitForm.push({radio:"",id:e.report.id,type:null})}))}}))},handleCurrentChange:function(e){this.pageData.pageNumber=e,this.getReportList(e)},operationsSubmit:function(e,t,r){var a=[];if("delete"===e)switch(t){case 1:this.deleteOperation(r);break;case 2:this.deleteOperation(this.reportListAll.toString())}else{switch(t){case 1:a=[{id:r,status:1}];break;case 2:this.reportListAll.forEach((function(e){a.push({id:e,status:1})}))}this.HandledOperation(a)}},deleteOperation:function(e){var t=this,r=this;this.appFetch({url:"reports_delete_v3",method:"post",data:{ids:e}}).then((function(e){0===e.Code?(r.subLoading=!1,r.$message({message:"删除成功",type:"success"}),r.getReportList(Number(n.default.getLItem("pageNumber"))||1)):t.$message.error(e.Message)}))},HandledOperation:function(e){var t=this;this.appFetch({url:"reports_update_v3",method:"post",data:{data:e}}).then((function(e){0===e.Code?(t.subLoading=!1,t.$message({message:"操作成功",type:"success"}),t.getReportList(Number(n.default.getLItem("pageNumber"))||1)):t.$message.error(e.Message)}))},submitClick:function(){if(this.submitForm.some((function(e){return 0===e.type||(1===e.type||void 0)}))){this.subLoading=!0;var e=[],t=[];this.submitForm.forEach((function(r){0===r.type&&e.push(r.id),1===r.type&&t.push({id:r.id,status:1})})),e.length>0&&this.deleteOperation(e.join(",")),t.length>0&&this.HandledOperation(t)}else this.$message({showClose:!0,message:"操作举报列表为空，请选择举报信息",type:"warning"})},getCreated:function(e){e?this.getReportList(1):this.getReportList(Number(n.default.getLItem("pageNumber"))||1)}},created:function(){this.getUrl()},beforeRouteEnter:function(e,t,r){r((function(r){e.name!==t.name&&null!==t.name?r.getCreated(!0):r.getCreated(!1)}))},components:{ContArrange:a.default,Page:s.default,tableNoList:i.default}}},AZdf:function(e,t,r){"use strict";r.r(t);var a=r("rKTM"),s=r("nVfn");for(var i in s)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return s[e]}))}(i);var n=r("KHd+"),o=Object(n.a)(s.default,a.a,a.b,!1,null,null,null);t.default=o.exports},"KHd+":function(e,t,r){"use strict";function a(e,t,r,a,s,i,n,o){var l,p="function"==typeof e?e.options:e;if(t&&(p.render=t,p.staticRenderFns=r,p._compiled=!0),a&&(p.functional=!0),i&&(p._scopeId="data-v-"+i),n?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),s&&s.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(n)},p._ssrRegister=l):s&&(l=o?function(){s.call(this,(p.functional?this.parent:this).$root.$options.shadowRoot)}:s),l)if(p.functional){p._injectStyles=l;var u=p.render;p.render=function(e,t){return l.call(t),u(e,t)}}else{var c=p.beforeCreate;p.beforeCreate=c?[].concat(c,l):[l]}return{exports:e,options:p}}r.d(t,"a",(function(){return a}))},"P/Re":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(r("QbLZ"));r("lL+3");var s=i(r("9kjX"));function i(e){return e&&e.__esModule?e:{default:e}}t.default=(0,a.default)({name:"report-manage-view"},s.default)},nVfn:function(e,t,r){"use strict";r.r(t);var a=r("P/Re"),s=r.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){r.d(t,e,(function(){return a[e]}))}(i);t.default=s.a},rKTM:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"report-manage-box"},[r("div",{staticClass:"report-manage-header"},[r("div",{staticClass:"report-manage-header__section"},[r("span",{staticClass:"report-manage-header__section-title"},[e._v("举报人：")]),e._v(" "),r("el-input",{attrs:{size:"medium",clearable:""},model:{value:e.searchData.userName,callback:function(t){e.$set(e.searchData,"userName",t)},expression:"searchData.userName"}})],1),e._v(" "),r("div",{staticClass:"report-manage-header__section"},[r("span",{staticClass:"report-manage-header__section-title"},[e._v("举报类型：")]),e._v(" "),r("el-select",{attrs:{clearable:"",size:"medium"},model:{value:e.searchData.reportType,callback:function(t){e.$set(e.searchData,"reportType",t)},expression:"searchData.reportType"}},e._l(e.reportTypeData,(function(e){return r("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),r("div",{staticClass:"report-manage-header__section"},[r("span",{staticClass:"report-manage-header__section-title time-title"},[e._v("举报时间范围：")]),e._v(" "),r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"daterange",align:"right","unlink-panels":"",size:"medium","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.searchData.reportTime,callback:function(t){e.$set(e.searchData,"reportTime",t)},expression:"searchData.reportTime"}})],1),e._v(" "),r("div",{staticClass:"report-manage-header__section"},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.searchClick}},[e._v("搜索")])],1)]),e._v(" "),r("div",{staticClass:"report-manage-content"},[r("div",{staticClass:"report-manage-content__header"},[e._v("举报列表")]),e._v(" "),e._l(e.reportList,(function(t,a){return r("ContArrange",{key:t.report.id,staticClass:"report-manage-content__table",attrs:{establish:t.user?t.user.userName:"该用户被删除",userId:t.user?t.user.pid:"该用户被删除",time:e.formatDate(t.report.createdAt),type:e.getType(t.report.type)}},[r("div",{staticClass:"report-manage-content__table-side",attrs:{slot:"side"},slot:"side"},[r("el-radio-group",{on:{change:function(t){return e.radioChange(t,a)}},model:{value:e.submitForm[a].radio,callback:function(t){e.$set(e.submitForm[a],"radio",t)},expression:"submitForm[index].radio"}},[r("el-radio",{attrs:{label:0}},[e._v("删除")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("已处理")])],1)],1),e._v(" "),r("div",{staticClass:"report-manage-content__table-main",attrs:{slot:"main"},slot:"main"},[r("p",[e._v("\n\t\t\t\t\t\t页面地址：\n\t\t\t\t\t\t"),r("a",{staticStyle:{color:"#3E4043"},attrs:{href:e.getUrl(t.user.pid,t.report.threadId,t.report.postId).href,target:"_blank"}},[e._v("\n\t\t\t\t\t\t\t"+e._s(e.getUrl(t.user.pid,t.report.threadId,t.report.postId).url)+"\n\t\t\t\t\t\t")])]),e._v(" "),r("p",[e._v("举报时间："+e._s(e.formatDate(t.report.updatedAt)))]),e._v(" "),r("p",[e._v("举报理由：")]),e._v(" "),r("p",[e._v(e._s(t.report.reason))])]),e._v(" "),r("div",{staticClass:"report-manage-content__table-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-popover",{ref:"popover-"+a,refInFor:!0,attrs:{width:"100",placement:"top"}},[r("p",[e._v("确定删除该项吗？")]),e._v(" "),r("div",{staticStyle:{"text-align":"right",margin:"10PX 0 0 0"}},[r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.closeDelet("popover-"+a)}}},[e._v("\n                  取消\n                ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.operationsSubmit("delete",1,t.report.id),e.closeDelet("popover-"+a)}}},[e._v("确定")])],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1),e._v(" "),r("i"),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(r){return e.operationsSubmit("handle",1,t.report.id)}}},[e._v("标记已处理")])],1)])})),e._v(" "),r("tableNoList",{directives:[{name:"show",rawName:"v-show",value:e.reportList.length<1,expression:"reportList.length < 1"}]}),e._v(" "),e.pageData.pageCount>1?r("Page",{attrs:{"current-page":e.pageData.pageNumber,"page-size":e.pageData.pageSize,total:e.pageData.pageTotal},on:{"current-change":e.handleCurrentChange}}):e._e()],2),e._v(" "),r("div",{staticClass:"report-manage-footer"},[r("el-button",{attrs:{size:"small",type:"primary",loading:e.subLoading},on:{click:e.submitClick}},[e._v("提交")]),e._v(" "),r("el-popover",{attrs:{width:"100",placement:"top"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[r("p",[e._v("确定删除该项吗？")]),e._v(" "),r("div",{staticStyle:{"text-align":"right",margin:"10PX 0 0 0"}},[r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.visible=!1}}},[e._v("\n                  取消\n                ")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.operationsSubmit("delete",2),e.visible=!1}}},[e._v("确定")])],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("全部删除")])],1),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:function(t){return e.operationsSubmit("handle",2)}}},[e._v("全部标记已处理")])],1)])},s=[]}}]);