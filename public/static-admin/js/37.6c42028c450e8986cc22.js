(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"03bQ":function(e,t,a){"use strict";a.r(t);var o=a("ffjV"),n=a("n9eR");for(var r in n)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(r);var i=a("KHd+"),s=Object(i.a)(n.default,o.a,o.b,!1,null,null,null);t.default=s.exports},"KHd+":function(e,t,a){"use strict";function o(e,t,a,o,n,r,i,s){var d,l="function"==typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=a,l._compiled=!0),o&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),i?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),n&&n.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},l._ssrRegister=d):n&&(d=s?function(){n.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:n),d)if(l.functional){l._injectStyles=d;var u=l.render;l.render=function(e,t){return d.call(t),u(e,t)}}else{var c=l.beforeCreate;l.beforeCreate=c?[].concat(c,d):[d]}return{exports:e,options:l}}a.d(t,"a",(function(){return o}))},ffjV:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return n}));var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"user-rol-box"},[a("div",{staticClass:"user-rol-table"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",selectable:e.checkSelectable}}),e._v(" "),a("el-table-column",{attrs:{label:"级别名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-input",{attrs:{maxlength:"20"},model:{value:t.row.name,callback:function(a){e.$set(t.row,"name",a)},expression:"scope.row.name"}})]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"100",label:"显示组名"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{disabled:7===t.row.id,"active-color":"#336699","inactive-color":"#bbbbbb"},model:{value:t.row.isDisplay,callback:function(a){e.$set(t.row,"isDisplay",a)},expression:"scope.row.isDisplay"}})]}}])}),e._v(" "),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"medium"},on:{click:function(a){return e.extension(t.row.id)}}},[e._v("邀请")]),e._v(" "),1!==t.row.id?a("el-button",{attrs:{disabled:e.addStatus&&e.tableData.length-1===t.$index,type:"text"},on:{click:function(a){return e.$router.push({path:"/admin/rol-permission",query:{id:t.row.id,name:t.row.name}})}}},[e._v("设置")]):e._e(),e._v(" "),a("el-popover",{ref:"popover-"+t.$index,attrs:{width:"100",placement:"top"}},[a("p",[e._v("确定删除该项吗？")]),e._v(" "),a("div",{staticStyle:{"text-align":"right",margin:"10PX 0 0 0"}},[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){t._self.$refs["popover-"+t.$index].doClose()}}},[e._v("\n                取消\n              ")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){e.singleDelete(t.$index,t.row.id),t._self.$refs["popover-"+t.$index].doClose()}}},[e._v("确定")])],1),e._v(" "),1!==t.row.id&&6!==t.row.id&&7!==t.row.id&&10!==t.row.id&&1!==t.row.default?a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")]):e._e()],1)]}}])}),e._v(" "),a("el-table-column",{attrs:{"min-width":"115"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!=t.row.id&&6!==t.row.id&&7!==t.row.id?a("el-radio",{attrs:{label:t.row.id},on:{change:function(a){return e.radioChange(t.row,t.$index)}},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("设为加入站点的默认级别")]):e._e()]}}])})],1)],1),e._v(" "),a("TableContAdd",{attrs:{cont:"新增"},on:{tableContAddClick:e.addList}}),e._v(" "),a("Card",{staticClass:"footer-btn"},[a("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"medium"},on:{click:e.submitClick}},[e._v("提交")]),e._v(" "),a("el-button",{attrs:{size:"medium",loading:e.delLoading,disabled:e.deleteStatus},on:{click:e.deleteClick}},[e._v("删除")])],1)],1)},n=[]},mHlf:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(a("4gYi")),n=i(a("pNQN")),r=i(a("kAKY"));function i(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{tableData:[],alternateLength:0,radio:"",alternateRadio:"",radioName:"",radioIndex:"",deleteStatus:!0,multipleSelection:[],addStatus:!1,btnLoading:!1,delLoading:!1,groupName:"",groupId:""}},methods:{handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelection.length>=1?this.deleteStatus=!1:this.deleteStatus=!0},radioChange:function(e,t){this.radioName=e.name,this.radioIndex=t,this.groupId=e.id},checkSelectable:function(e){switch(e.id){case 1:case 6:case 7:case 10:return!1;default:return!0}},addList:function(){this.alternateLength>=this.tableData.length&&this.tableData.push({name:"",type:"",color:"",icon:""}),this.addStatus=!0},submitClick:function(){var e=this;if(this.btnLoading=!0,this.addStatus){for(var t={type:"groups",name:"",default:""},a=this.alternateLength;a<this.tableData.length;a++)t.name=this.tableData[a].name;this.radioIndex+1===this.tableData.length&&(t.default=1),this.postGroups(t)}else{var o=[];this.tableData.forEach((function(t){o.push({name:t.name,id:t.id,isDisplay:t.isDisplay,default:t.id==e.radio})})),this.batchPatchGroup(o)}},singleDelete:function(e,t){e>this.alternateLength-1?(this.tableData.pop(),this.addStatus=!1):this.singleDeleteGroup(t)},deleteClick:function(){this.delLoading=!0;var e={id:[]};this.multipleSelection.forEach((function(t){e.id.push(t.id)})),this.batchDeleteGroup(e)},getGroups:function(){var e=this;this.appFetch({url:"groups_list_get_v3",method:"get",data:{}}).then((function(t){if(t.errors)e.$message.error(t.errors[0].code);else{if(0!==t.Code)return void e.$message.error(t.Message);e.tableData=t.Data,e.alternateLength=t.Data.length,e.tableData.forEach((function(t){e.groupName=t.isDisplay,1==t.default&&(e.radio=t.id,e.alternateRadio=t.id)}))}})).catch((function(e){}))},postGroups:function(e){var t=this;this.appFetch({url:"groups_create_post_v3",method:"post",data:e}).then((function(e){if(t.btnLoading=!1,e.errors)e.errors[0].detail?t.$message.error(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"提交成功！",type:"success"}),t.addStatus=!1,t.getGroups()}})).catch((function(e){}))},singleDeleteGroup:function(e){var t=this;this.appFetch({url:"groups_batchdelete_post_v3",method:"post",data:{ids:e}}).then((function(e){if(e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"删除成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},batchDeleteGroup:function(e){var t=this,a=e.id.toString();this.appFetch({url:"groups_batchdelete_post_v3",method:"post",data:{ids:a}}).then((function(e){if(t.delLoading=!1,e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"删除成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},batchPatchGroup:function(e){var t=this;this.appFetch({url:"groups_batchupdate_post_v3",method:"post",data:{data:e}}).then((function(e){if(t.btnLoading=!1,e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);t.$message({message:"提交成功！",type:"success"}),t.getGroups()}})).catch((function(e){}))},PermissionPurchaseAllowed:function(){this.appFetch({url:"groups",method:"PATCH",splice:"/"+this.groupId,data:{data:{attributes:{name:this.radioName,is_paid:0}}}}).then((function(e){})).catch((function(e){}))},extension:function(e){var t=this;this.appFetch({url:"invite_link_v3",method:"get",data:{groupId:e}}).then((function(e){if(e.errors)t.$message.error(e.errors[0].code);else{if(0!==e.Code)return void t.$message.error(e.Message);var a=document.createElement("input");a.value=window.location.protocol+"//"+window.location.host+"/forum/partner-invite?inviteCode="+e.Data.code,a.id="copyInput",document.body.appendChild(a),a.select(),document.execCommand("Copy"),t.$message({message:"链接已复制到剪贴板",type:"success"}),setTimeout((function(){a.remove()}),100)}}))}},created:function(){this.getGroups()},components:{Card:o.default,CardRow:n.default,TableContAdd:r.default}}},n9eR:function(e,t,a){"use strict";a.r(t);var o=a("u/uZ"),n=a.n(o);for(var r in o)["default"].indexOf(r)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(r);t.default=n.a},"u/uZ":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(a("QbLZ"));a("I1+7");var n=r(a("mHlf"));function r(e){return e&&e.__esModule?e:{default:e}}t.default=(0,o.default)({name:"user-rol-view"},n.default)}}]);