/*! For license information please see ../../LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{1015:function(e,t,n){},1147:function(e,t,n){"use strict";n(1015)},1242:function(e,t,n){"use strict";n.r(t);var r=n(85),o=n(9),l=(n(34),n(13),n(39),n(35),n(31),n(864)),c=n.n(l),d=n(891),f=n.n(d),head=n(715),h=n.n(head),m=n(714),v=n.n(m),y=n(734),w=n.n(y),C=n(800),k=n.n(C),S=n(162),E=n(904),_=n(725),x="posts.replyUser,user.groups,user,posts,posts.user,posts.likedUsers,posts.images,firstPost,firstPost.likedUsers,firstPost.images,firstPost.attachments,rewardedUsers,category,threadVideo,paidUsers",T="user,likedUsers,commentPosts,commentPosts.user,commentPosts.user.groups,commentPosts.replyUser,commentPosts.replyUser.groups,commentPosts.mentionUsers,commentPosts.images,images,attachments",O={name:"Comment",layout:"custom_layout",mixins:[h.a,w.a,v.a,k.a,c.a,f.a,c.a,f.a],asyncData:function(e){return Object(o.a)(regeneratorRuntime.mark((function t(){var n,r,o,l,c,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.store,r=e.query,S.a.isSpider){t.next=3;break}return t.abrupt("return",{});case 3:return o=r.threadId,l=r.commentId,t.prev=5,t.next=8,n.dispatch("jv/get",["threads/".concat(o),{params:{include:x}}]);case 8:return c=t.sent,t.next=11,n.dispatch("jv/get",["posts/".concat(l),{params:{include:T}}]);case 11:return d=t.sent,t.abrupt("return",{thread:c,comment:d});case 15:return t.prev=15,t.t0=t.catch(5),t.abrupt("return",{loading:!0});case 18:case"end":return t.stop()}}),t,null,[[5,15]])})))()},data:function(){return{forumsInfo:{},userInfo:{},thread:{},comment:{},afterPushReply:!0,pageLimit:5,pageNumber:1,replyCount:0,isPositiveSort:!0,replyList:[],replyLoading:!1,scrollLoading:!1,loading:!1,onReplyPublish:!1,replyPost:{text:"",imageList:[],attachedList:[]},replyType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的回复 ..."},commentPostId:"",commentUserId:"",editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},onEditCommentPublish:!1,editCommentPost:{text:"",imageList:[],attachedList:[]},editComment:{},editCommentID:"",editCommentIndex:-1,commentType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的回复 ..."}}},computed:{threadId:function(){return this.$route.query.threadId},commentId:function(){return this.$route.query.commentId}},mounted:function(){var e=this;0===Object.keys(this.comment).length&&this.getComment().then((function(){e.loading=!1})),0===Object.keys(this.thread).length&&this.getThread(),this.getReplyList("scroll"),this.getUserInfo(),this.getForumsInfo()},methods:{getUserInfo:function(){var e=this,t=this.$store.getters["session/get"]("userId");this.$store.dispatch("jv/get",["users/".concat(t),{params:{include:""}}]).then((function(t){t&&t._jv&&t._jv.id&&(e.userInfo=t)}))},getForumsInfo:function(){var e=this;this.$store.dispatch("jv/get",["forum",{params:{include:""}}]).then((function(t){t&&t._jv&&t._jv.id&&(e.forumsInfo=t)}))},getThread:function(){var e=this;return this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:x}}]).then((function(t){if(t.isDeleted)return e.$router.push("/404");e.thread=t}),(function(t){return e.handleError(t)}))},getComment:function(){var e=this;return this.$store.dispatch("jv/get",["posts/".concat(this.commentId),{params:{include:T}}]).then((function(t){if(t.isDeleted)return e.$router.push("/404");e.replyCount=t.replyCount,e.comment=t}),(function(t){return e.handleError(t)}))},getReplyList:function(e){var t=this;if(!this.replyLoading)return"commit"===e?this.replyLoading=!0:this.scrollLoading=!0,this.$store.dispatch("jv/get",["posts",{params:{"filter[thread]":this.threadId,"filter[reply]":this.commentId,"page[number]":this.pageNumber,"page[limit]":this.pageLimit,"filter[isDeleted]":"no","filter[isComment]":"yes",sort:this.isPositiveSort?"createdAt":"-createdAt",include:"replyUser,user.groups,user,images,commentUser"}}]).then((function(data){var e;(e=t.replyList).push.apply(e,Object(r.a)(data)),t.pageNumber+=1}),(function(e){return t.handleError(e)})).finally((function(){t.replyLoading=t.scrollLoading=!1}))},changeSort:function(e){this.scrollLoading=!0,this.pageNumber=1,this.replyList=[],this.isPositiveSort=e,this.getReplyList("commit")},deleteComment:function(e){var t=this,n=e.id,r=e.type,o={_jv:{type:"posts",id:n},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return t.$store.dispatch("jv/patch",o).then((function(){if("comment"===r)t.$router.push("/thread/".concat(t.thread._jv.id));else if("reply"===r){var e=t.replyList.filter((function(e){return e._jv.id===n}))[0];t.replyList.splice(t.replyList.indexOf(e),1),t.replyCount-=1}t.$message.success(t.$t("topic.deleteSuccess"))}),(function(e){return t.handleError(e)}))}),(function(){}))},onLike:function(e){var t=this,n=e.reply,r=e.index,o={pid:parseInt(n._jv.id),data:{attributes:{isLiked:!n.isLiked}}};return _.a.updatePosts({data:o}).then((function(data){t.replyList[r].isLiked=data.Data.isLiked,t.replyList[r].likeCount=data.Data.likeCount}),(function(e){return t.handleError(e)}))},isPublishNeedRealName:function(){if(!this.forumsInfo.other.publish_need_real_name)return!0;if(this.forumsInfo.other.publish_need_real_name){if(!this.userInfo.isReal)return this.$message.warning(this.$t("请先实名认证")),!1;if(this.userInfo.isReal)return!0}},isPublishNeedBindPhone:function(){if(!this.forumsInfo.other.publish_need_bind_phone)return!0;if(this.forumsInfo.other.publish_need_bind_phone){if(""===this.userInfo.mobile)return this.$message.warning(this.$t("请先绑定手机")),!1;if(""!==this.userInfo.mobile)return!0}},replyPublish:function(e){var t=this;if(this.isLogin()&&this.isPublishNeedRealName()&&this.isPublishNeedBindPhone()){if(!this.replyPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.replyPost.text.length>this.replyType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onReplyPublish=!0;var n={id:parseInt(this.threadId),content:this.replyPost.text,replyId:e,isComment:!0};return this.commentPostId&&(n.commentPostId=this.commentPostId,n.commentUserId=this.commentUserId),this.newPublishPostResource(n,this.replyPost),_.a.createPosts({data:n}).then((function(e){"操作太频繁了，请稍后再试"!==e.Message&&(t.afterPushReply=!1,t.$nextTick((function(){t.afterPushReply=!0})),t.replyPost.text="",t.replyPost.imageList=[],t.isPositiveSort?t.replyList.length===t.replyCount&&t.replyList.push(e.Data):t.replyList.unshift(e.Data),t.replyCount+=1,t.newPostLegalityCheck(e,t.$t("topic.replyPublishSuccess")))}),(function(e){return t.handleError(e)})).finally((function(){t.onReplyPublish=!1}))}},handleHTML:function(html){return Object(E.a)(html)},replyComment:function(e){document.querySelector("#replyCount").scrollIntoView(!0),this.commentPostId=e._jv.id,this.commentUserId=e.user._jv.id,this.replyType.placeholder="回复".concat(e.user.username)},onEditComment:function(e,t){this.editCommentID=this.commentId,this.editComment=e,this.editCommentPost.text=e.content,this.editCommentIndex=t,this.$nextTick((function(){var textarea=document.querySelector(".edit-comment-editor #textarea");textarea.style.height="".concat(textarea.scrollHeight,"px")})),e.images.length>0&&(this.initThreadResource(this.editCommentPost.imageList,e.images),this.editResourceShow.showUploadImg=!0)},initThreadResource:function(e,t){t.forEach((function(t){var n={name:t.fileName,url:t.thumbUrl,id:t._jv&&t._jv.id||t.id,deleted:!1};e.push(n)}))},postEditCommentPublish:function(){var e=this;if(this.isLogin()&&!this.onEditCommentPublish){if(!this.editCommentPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.editCommentPost.text.length>this.commentType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onEditCommentPublish=!0;var t={pid:this.editComment.id,data:{attributes:{content:this.editCommentPost.text},relationships:{}}};this.threadId&&(t.data.pid=this.threadId),t=this.editPublishPostResource(t,this.editCommentPost),this.deleteAttachmentsAfterEdit(this.editComment.images,this.editCommentPost.imageList),_.a.updatePosts({data:t}).then((function(t){e.scrollLoading=!0,e.pageNumber=1,e.replyList=[],e.getReplyList("commit"),e.postLegalityCheck(t,e.$t("topic.commentPublishSuccess")),e.closeEditPop()}),(function(t){return e.handleError(t)})).finally((function(){e.onEditCommentPublish=!1}))}},closeEditPop:function(){this.editComment={},this.editCommentPost.text="",this.editCommentPost.imageList=[],this.editResourceShow.showUploadImg=!1},clearReply:function(){this.commentPostId&&(this.commentPostId="",this.commentUserId="",this.replyType.placeholder="写下我的回复 ...")}},head:function(){return{title:this.comment&&this.comment.content?this.comment.content.slice(0,15):"评论详情页"}}},L=(n(1147),n(11)),component=Object(L.a)(O,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"page-comment",on:{click:e.clearReply}},[n("main",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[n("div",{staticClass:"container-comment"},[n("div",{staticClass:"title"},[n("avatar-component",{attrs:{author:e.comment.user||{}}},[e._v("\n          "+e._s(e.timerDiff(e.comment.updatedAt)+e.$t("topic.before"))+"..\n        ")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.comment.canHide,expression:"comment.canHide"}],staticClass:"delete-comment"},[n("div",{staticClass:"wrapper",on:{click:function(t){return e.deleteComment({id:e.comment._jv.id,type:"comment"})}}},[n("svg-icon",{staticStyle:{"font-size":"16px"},attrs:{type:"trash"}}),e._v(" "),n("span",[e._v(e._s(e.$t("topic.delete")))])],1)])],1),e._v(" "),n("topic-content",{attrs:{article:e.comment||{},"paid-information":{paid:!0,price:0},"thread-type":3,category:{},video:{}}}),e._v(" "),n("div",{staticClass:"thread-card"},[n("avatar-component",{attrs:{size:40,round:"",author:e.thread&&e.thread.user||{}}},[e._v("\n          "+e._s(e.timerDiff(e.thread.createdAt)+e.$t("topic.before"))+" ..\n        ")]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.thread&&e.thread.firstPost,expression:"thread && thread.firstPost"}],staticClass:"content-html",domProps:{innerHTML:e._s(e.thread&&e.thread.firstPost&&e.$xss(e.handleHTML(e.thread.firstPost.summary))||"")}}),e._v(" "),n("nuxt-link",{staticClass:"view-more",attrs:{to:"/thread/"+(e.thread._jv?e.thread._jv.id:"")}},[e._v(e._s(e.$t("topic.viewDetail")))]),e._v(" "),e.thread&&e.thread.isEssence?n("svg-icon",{staticClass:"essence",staticStyle:{"font-size":"50px"},attrs:{type:"essence-comment"}}):e._e()],1),e._v(" "),n("div",{staticClass:"container-reply",attrs:{id:"reply"},on:{click:function(e){e.stopPropagation()}}},[e.replyCount?n("comment-header",{attrs:{id:"replyCount","comment-count":e.replyCount,"is-positive-sort":e.isPositiveSort},on:{changeSort:e.changeSort}}):n("div",{staticClass:"without-comment"},[e._v(e._s(e.$t("topic.noComment")))]),e._v(" "),e.afterPushReply?n("editor",{staticClass:"reply-editor",staticStyle:{"margin-top":"20px","margin-bottom":"20px"},attrs:{"editor-style":"comment",selector:"reply-editor","type-information":e.replyType,post:e.replyPost,"on-publish":e.onReplyPublish},on:{"update:post":function(t){e.replyPost=t},publish:function(t){return e.replyPublish(e.comment._jv.id)}}}):e._e(),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.replyLoading,expression:"replyLoading"}]},[n("reply-list",{attrs:{"reply-list":e.replyList||[]},on:{delete:e.deleteComment,onLike:e.onLike,reply:e.replyComment,editComment:e.onEditComment}})],1),e._v(" "),n("list-load-more",{attrs:{loading:e.scrollLoading,length:e.replyList.length,"has-more":e.replyCount>e.replyList.length,"page-num":e.pageNumber},on:{loadMore:function(t){return e.getReplyList("scroll")}}})],1)],1)]),e._v(" "),n("topic-aside",{attrs:{author:e.thread&&e.thread.user||{}}}),e._v(" "),n("el-dialog",{attrs:{title:e.$t("topic.editComment"),visible:Object.keys(e.editComment).length>0,width:"820px","destroy-on-close":""},on:{close:e.closeEditPop}},[n("avatar-component",{attrs:{author:e.editComment.user||{},size:50}},[e._v("\n      "+e._s(e.$t("topic.publishAt")+" "+e.timerDiff(e.editComment.updatedAt)+e.$t("topic.before"))+"..\n    ")]),e._v(" "),n("editor",{staticClass:"edit-comment-editor",staticStyle:{"margin-top":"20px"},attrs:{"editor-style":"comment",selector:"edit-comment-editor","edit-resource-show":e.editResourceShow,"on-publish":e.onEditCommentPublish,"type-information":e.commentType,post:e.editCommentPost,"is-edit":!0},on:{"update:post":function(t){e.editCommentPost=t},publish:e.postEditCommentPublish}})],1)],1)}),[],!1,null,"76d57cbe",null);t.default=component.exports;installComponents(component,{AvatarComponent:n(753).default,SvgIcon:n(62).default,TopicContent:n(951).default,CommentHeader:n(952).default,Editor:n(796).default,ReplyList:n(1209).default,ListLoadMore:n(728).default,TopicAside:n(953).default})},717:function(e,t,n){"use strict";n(159),n(790),n(36),n(13),n(32),n(24),n(35),n(34);var r=n(27),o=n(791),l=n(747);n(52);function c(){c=function(e,t){return new n(e,void 0,t)};var e=RegExp.prototype,t=new WeakMap;function n(e,r,o){var c=new RegExp(e,r);return t.set(c,o||t.get(e)),Object(l.a)(c,n.prototype)}function d(e,n){var g=t.get(n);return Object.keys(g).reduce((function(t,n){return t[n]=e[g[n]],t}),Object.create(null))}return Object(o.a)(n,RegExp),n.prototype.exec=function(t){var n=e.exec.call(this,t);return n&&(n.groups=d(n,this)),n},n.prototype[Symbol.replace]=function(n,o){if("string"==typeof o){var l=t.get(this);return e[Symbol.replace].call(this,n,o.replace(/\$<([^>]+)>/g,(function(e,t){return"$"+l[t]})))}if("function"==typeof o){var c=this;return e[Symbol.replace].call(this,n,(function(){var e=arguments;return"object"!==Object(r.a)(e[e.length-1])&&(e=[].slice.call(e)).push(d(e,c)),o.apply(this,e)}))}return e[Symbol.replace].call(this,n,o)},c.apply(this,arguments)}var d={topic:function(text){if(text){var e=c(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="topic"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(e,(function(t){return t.replace(e,(function(content,e,text){var t="/topic/".concat(e);return'<a href="'.concat(t,'" class="content-topic a-blue">').concat(text,"</a> ")}))}))}},usermention:function(text){if(text){var e=c(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="member"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(e,(function(t){return t.replace(e,(function(content,e,text){var t="/user/".concat(e);return'<a href="'.concat(t,'" class="content-member a-blue">').concat(text,"</a> ")}))}))}},parseHtml1:function(text){if(text){var e=/&lt;/gim;return text.replace(e,(function(t){return t.replace(e,(function(content,e,text){return"<"}))}))}},parseHtml2:function(text){if(text){var e=/&gt;/gim;return text.replace(e,(function(t){return t.replace(e,(function(content,e,text){return">"}))}))}}};t.a={parse:function(text){for(var e in d)text=d[e](text);return text}}},729:function(e,t,n){"use strict";var r=n(831),o=n(832),l=n(833),c=n(834);function d(e){return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")}var f=function(){},h=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&void 0!==e[n]&&null!==e[n]&&(t[n]=e[n]);return t};function m(e){return map(e,(function(e){return"object"==typeof e?m(e):e}))}function v(e,source){return w(source,(function(t,n){e[n]=source[n]})),e}function y(e){return e instanceof Array}function w(e,t){for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)}function map(e,t){var n=y(e)?[]:{};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t(e[i],i));return n}var C,k,S,E,_,x=function(e,t){if(t=v({},t),"getAuth"!==e&&"getV4Auth"!==e&&"getObjectUrl"!==e){var n=t.Headers||{};if(t&&"object"==typeof t){!function(){for(var e in t)t.hasOwnProperty(e)&&e.indexOf("x-cos-")>-1&&(n[e]=t[e])}();O.each({"x-cos-mfa":"MFA","Content-MD5":"ContentMD5","Content-Length":"ContentLength","Content-Type":"ContentType",Expect:"Expect",Expires:"Expires","Cache-Control":"CacheControl","Content-Disposition":"ContentDisposition","Content-Encoding":"ContentEncoding",Range:"Range","If-Modified-Since":"IfModifiedSince","If-Unmodified-Since":"IfUnmodifiedSince","If-Match":"IfMatch","If-None-Match":"IfNoneMatch","x-cos-copy-source":"CopySource","x-cos-copy-source-Range":"CopySourceRange","x-cos-metadata-directive":"MetadataDirective","x-cos-copy-source-If-Modified-Since":"CopySourceIfModifiedSince","x-cos-copy-source-If-Unmodified-Since":"CopySourceIfUnmodifiedSince","x-cos-copy-source-If-Match":"CopySourceIfMatch","x-cos-copy-source-If-None-Match":"CopySourceIfNoneMatch","x-cos-acl":"ACL","x-cos-grant-read":"GrantRead","x-cos-grant-write":"GrantWrite","x-cos-grant-full-control":"GrantFullControl","x-cos-grant-read-acp":"GrantReadAcp","x-cos-grant-write-acp":"GrantWriteAcp","x-cos-storage-class":"StorageClass","x-cos-server-side-encryption-customer-algorithm":"SSECustomerAlgorithm","x-cos-server-side-encryption-customer-key":"SSECustomerKey","x-cos-server-side-encryption-customer-key-MD5":"SSECustomerKeyMD5","x-cos-server-side-encryption":"ServerSideEncryption","x-cos-server-side-encryption-cos-kms-key-id":"SSEKMSKeyId","x-cos-server-side-encryption-context":"SSEContext"},(function(e,r){void 0!==t[e]&&(n[r]=t[e])})),t.Headers=h(n)}}return t},T=function(e){return Date.now()+(e||0)},O={noop:f,formatParams:x,apiWrapper:function(e,t){return function(n,r){"function"==typeof n&&(r=n,n={}),n=x(e,n);var o=function(e){return e&&e.headers&&(e.headers["x-cos-version-id"]&&(e.VersionId=e.headers["x-cos-version-id"]),e.headers["x-cos-delete-marker"]&&(e.DeleteMarker=e.headers["x-cos-delete-marker"])),e},l=function(e,data){r&&r(o(e),o(data))};if("getService"!==e&&"abortUploadTask"!==e){var c;if(c=function(e,t){var n=t.Bucket,r=t.Region,o=t.Key;if(e.indexOf("Bucket")>-1||"deleteMultipleObject"===e||"multipartList"===e||"listObjectVersions"===e){if(!n)return"Bucket";if(!r)return"Region"}else if(e.indexOf("Object")>-1||e.indexOf("multipart")>-1||"sliceUploadFile"===e||"abortUploadTask"===e){if(!n)return"Bucket";if(!r)return"Region";if(!o)return"Key"}return!1}(e,n))return void l({error:"missing param "+c});if(n.Region){if(n.Region.indexOf("cos.")>-1)return void l({error:'param Region should not be start with "cos."'});if(!/^([a-z\d-]+)$/.test(n.Region))return void l({error:"Region format error."});this.options.CompatibilityMode||-1!==n.Region.indexOf("-")||"yfb"===n.Region||"default"===n.Region||console.warn("warning: param Region format error, find help here: https://cloud.tencent.com/document/product/436/6224")}if(n.Bucket){if(!/^([a-z\d-]+)-(\d+)$/.test(n.Bucket))if(n.AppId)n.Bucket=n.Bucket+"-"+n.AppId;else{if(!this.options.AppId)return void l({error:'Bucket should format as "test-1250000000".'});n.Bucket=n.Bucket+"-"+this.options.AppId}n.AppId&&(console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g Bucket:"test-1250000000" ).'),delete n.AppId)}!this.options.UseRawKey&&n.Key&&"/"===n.Key.substr(0,1)&&(n.Key=n.Key.substr(1))}var d=t.call(this,n,l);if("getAuth"===e||"getObjectUrl"===e)return d}},xml2json:l,json2xml:c,md5:r,clearKey:h,getFileMd5:function(e,t){!function(e,t){var n,r=new FileReader;FileReader.prototype.readAsBinaryString?(n=FileReader.prototype.readAsBinaryString,r.onload=function(){t(this.result)}):FileReader.prototype.readAsArrayBuffer?n=function(e){var n="",r=new FileReader;r.onload=function(e){for(var o=new Uint8Array(r.result),l=o.byteLength,i=0;i<l;i++)n+=String.fromCharCode(o[i]);t(n)},r.readAsArrayBuffer(e)}:console.error("FileReader not support readAsBinaryString"),n.call(r,e)}(e,(function(content){var e=r(content,!0);t(null,e)}))},binaryBase64:function(e){var i,t,n,r="";for(i=0,t=e.length/2;i<t;i++)n=parseInt(e[2*i]+e[2*i+1],16),r+=String.fromCharCode(n);return btoa(r)},extend:v,isArray:y,isInArray:function(e,t){for(var n=!1,i=0;i<e.length;i++)if(t===e[i]){n=!0;break}return n},each:w,map:map,filter:function(e,t){var n=y(e),r=n?[]:{};for(var i in e)e.hasOwnProperty(i)&&t(e[i],i)&&(n?r.push(e[i]):r[i]=e[i]);return r},clone:m,uuid:function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},camSafeUrlEncode:d,throttleOnProgress:function(e,t){var n,r,o=this,l=0,c=0,d=Date.now();function f(){if(r=0,t&&"function"==typeof t){n=Date.now();var o,f=Math.max(0,Math.round((c-l)/((n-d)/1e3)*100)/100);o=0===c&&0===e?1:Math.round(c/e*100)/100||0,d=n,l=c;try{t({loaded:c,total:e,speed:f,percent:o})}catch(e){}}}return function(t,n){if(t&&(c=t.loaded,e=t.total),n)clearTimeout(r),f();else{if(r)return;r=setTimeout(f,o.options.ProgressInterval)}}},getFileSize:function(e,t,n){var r;"string"==typeof t.Body&&(t.Body=new Blob([t.Body],{type:"text/plain"})),t.Body&&(t.Body instanceof Blob||"[object File]"===t.Body.toString()||"[object Blob]"===t.Body.toString())?(r=t.Body.size,t.ContentLength=r,n(null,r)):n({error:"params body format error, Only allow File|Blob|String."})},getSkewTime:T,getAuth:function(e){var t,n=(e=e||{}).SecretId,r=e.SecretKey,l=(e.method||e.Method||"get").toLowerCase(),c=m(e.Query||e.params||{}),f=m(e.Headers||e.headers||{}),h=e.Key||"";if(e.UseRawKey?t=e.Pathname||e.pathname||"/"+h:0!==(t=e.Pathname||e.pathname||h).indexOf("/")&&(t="/"+t),!n)return console.error("missing param SecretId");if(!r)return console.error("missing param SecretKey");var v=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.sort((function(a,b){return(a=a.toLowerCase())===(b=b.toLowerCase())?0:a>b?1:-1}))},y=function(e){var i,t,n,r=[],o=v(e);for(i=0;i<o.length;i++)n=void 0===e[t=o[i]]||null===e[t]?"":""+e[t],t=d(t=t.toLowerCase()),n=d(n)||"",r.push(t+"="+n);return r.join("&")},w=Math.round(T(e.SystemClockOffset)/1e3)-1,C=w,k=e.Expires||e.expires,S=n,E=w+";"+(C+=void 0===k?900:1*k||0),_=w+";"+C,x=v(f).join(";").toLowerCase(),O=v(c).join(";").toLowerCase(),L=o.HmacSHA1(_,r).toString(),A=[l,t,y(c),y(f),""].join("\n"),j=["sha1",E,o.SHA1(A).toString(),""].join("\n");return["q-sign-algorithm=sha1","q-ak="+S,"q-sign-time="+E,"q-key-time="+_,"q-header-list="+x,"q-url-param-list="+O,"q-signature="+o.HmacSHA1(j,L).toString()].join("&")},isBrowser:!0},L=(_=function(a,b){a=a.split("."),b=b.split(".");for(var i=0;i<b.length;i++)if(a[i]!==b[i])return parseInt(a[i])>parseInt(b[i])?1:-1;return 0},C=navigator&&navigator.userAgent,k=(C.match(/Chrome\/([.\d]+)/)||[])[1],S=(C.match(/QBCore\/([.\d]+)/)||[])[1],E=(C.match(/QQBrowser\/([.\d]+)/)||[])[1],k&&_(k,"53.0.2785.116")<0&&S&&_(S,"3.53.991.400")<0&&E&&_(E,"9.0.2524.400")<=0||!1);O.fileSlice=function(e,t,n,r,o){var l;if(e.slice?l=e.slice(t,n):e.mozSlice?l=e.mozSlice(t,n):e.webkitSlice&&(l=e.webkitSlice(t,n)),r&&L){var c=new FileReader;c.onload=function(e){l=null,o(new Blob([c.result]))},c.readAsArrayBuffer(l)}else o(l)},O.getFileUUID=function(e,t){return e.name&&e.size&&e.lastModifiedDate&&t?O.md5([e.name,e.size,e.lastModifiedDate,t].join("::")):null},O.getBodyMd5=function(e,t,n){n=n||f,e?"string"==typeof t?n(O.md5(t,!0)):Blob&&t instanceof Blob?O.getFileMd5(t,(function(e,t){n(t)})):n():n()},e.exports=O},739:function(e,t,n){e.exports=function(){"use strict";var e="millisecond",t="second",n="minute",r="hour",i="day",s="week",u="month",a="quarter",o="year",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,c=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},f={s:d,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+d(r,2,"0")+":"+d(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),i=t.add(r,u),s=n-i<0,a=t.add(r+(s?-1:1),u);return+(-(r+(n-i)/(s?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return{M:u,y:o,w:s,d:i,D:"date",h:r,m:n,s:t,ms:e,Q:a}[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",v={};v[m]=h;var y=function(e){return e instanceof k},w=function(e,t,n){var r;if(!e)return m;if("string"==typeof e)v[e]&&(r=e),t&&(v[e]=t,r=e);else{var i=e.name;v[i]=e,r=i}return!n&&r&&(m=r),r||!n&&m},g=function(e,t){if(y(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new k(n)},C=f;C.l=w,C.i=y,C.w=function(e,t){return g(e,{locale:t.$L,utc:t.$u,$offset:t.$offset})};var k=function(){function d(e){this.$L=this.$L||w(e.locale,null,!0),this.parse(e)}var f=d.prototype;return f.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(l);if(r){var i=r[2]-1||0;return n?new Date(Date.UTC(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)):new Date(r[1],i,r[3]||1,r[4]||0,r[5]||0,r[6]||0,r[7]||0)}}return new Date(t)}(e),this.init()},f.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},f.$utils=function(){return C},f.isValid=function(){return!("Invalid Date"===this.$d.toString())},f.isSame=function(e,t){var n=g(e);return this.startOf(t)<=n&&n<=this.endOf(t)},f.isAfter=function(e,t){return g(e)<this.startOf(t)},f.isBefore=function(e,t){return this.endOf(t)<g(e)},f.$g=function(e,t,n){return C.u(e)?this[t]:this.set(n,e)},f.year=function(e){return this.$g(e,"$y",o)},f.month=function(e){return this.$g(e,"$M",u)},f.day=function(e){return this.$g(e,"$W",i)},f.date=function(e){return this.$g(e,"$D","date")},f.hour=function(e){return this.$g(e,"$H",r)},f.minute=function(e){return this.$g(e,"$m",n)},f.second=function(e){return this.$g(e,"$s",t)},f.millisecond=function(t){return this.$g(t,"$ms",e)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(e,a){var l=this,c=!!C.u(a)||a,d=C.p(e),f=function(e,t){var n=C.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return c?n:n.endOf(i)},h=function(e,t){return C.w(l.toDate()[e].apply(l.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},m=this.$W,v=this.$M,y=this.$D,w="set"+(this.$u?"UTC":"");switch(d){case o:return c?f(1,0):f(31,11);case u:return c?f(1,v):f(0,v+1);case s:var g=this.$locale().weekStart||0,k=(m<g?m+7:m)-g;return f(c?y-k:y+(6-k),v);case i:case"date":return h(w+"Hours",0);case r:return h(w+"Minutes",1);case n:return h(w+"Seconds",2);case t:return h(w+"Milliseconds",3);default:return this.clone()}},f.endOf=function(e){return this.startOf(e,!1)},f.$set=function(s,a){var l,c=C.p(s),d="set"+(this.$u?"UTC":""),f=(l={},l.day=d+"Date",l.date=d+"Date",l[u]=d+"Month",l[o]=d+"FullYear",l[r]=d+"Hours",l[n]=d+"Minutes",l[t]=d+"Seconds",l[e]=d+"Milliseconds",l)[c],h=c===i?this.$D+(a-this.$W):a;if(c===u||c===o){var m=this.clone().set("date",1);m.$d[f](h),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).$d}else f&&this.$d[f](h);return this.init(),this},f.set=function(e,t){return this.clone().$set(e,t)},f.get=function(e){return this[C.p(e)]()},f.add=function(e,a){var l,c=this;e=Number(e);var d=C.p(a),f=function(t){var n=g(c);return C.w(n.date(n.date()+Math.round(t*e)),c)};if(d===u)return this.set(u,this.$M+e);if(d===o)return this.set(o,this.$y+e);if(d===i)return f(1);if(d===s)return f(7);var h=(l={},l[n]=6e4,l[r]=36e5,l[t]=1e3,l)[d]||1,m=this.$d.getTime()+e*h;return C.w(m,this)},f.subtract=function(e,t){return this.add(-1*e,t)},f.format=function(e){var t=this;if(!this.isValid())return"Invalid Date";var n=e||"YYYY-MM-DDTHH:mm:ssZ",r=C.z(this),i=this.$locale(),s=this.$H,u=this.$m,a=this.$M,o=i.weekdays,l=i.months,d=function(e,r,i,s){return e&&(e[r]||e(t,n))||i[r].substr(0,s)},f=function(e){return C.s(s%12||12,e,"0")},h=i.meridiem||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:C.s(a+1,2,"0"),MMM:d(i.monthsShort,a,l,3),MMMM:d(l,a),D:this.$D,DD:C.s(this.$D,2,"0"),d:String(this.$W),dd:d(i.weekdaysMin,this.$W,o,2),ddd:d(i.weekdaysShort,this.$W,o,3),dddd:o[this.$W],H:String(s),HH:C.s(s,2,"0"),h:f(1),hh:f(2),a:h(s,u,!0),A:h(s,u,!1),m:String(u),mm:C.s(u,2,"0"),s:String(this.$s),ss:C.s(this.$s,2,"0"),SSS:C.s(this.$ms,3,"0"),Z:r};return n.replace(c,(function(e,t){return t||m[e]||r.replace(":","")}))},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(e,l,c){var d,f=C.p(l),h=g(e),m=6e4*(h.utcOffset()-this.utcOffset()),v=this-h,y=C.m(this,h);return y=(d={},d[o]=y/12,d[u]=y,d[a]=y/3,d[s]=(v-m)/6048e5,d.day=(v-m)/864e5,d[r]=v/36e5,d[n]=v/6e4,d[t]=v/1e3,d)[f]||v,c?y:C.a(y)},f.daysInMonth=function(){return this.endOf(u).$D},f.$locale=function(){return v[this.$L]},f.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=w(e,t,!0);return r&&(n.$L=r),n},f.clone=function(){return C.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},d}();return g.prototype=k.prototype,g.extend=function(e,t){return e(t,k,g),g},g.locale=w,g.isDayjs=y,g.unix=function(e){return g(1e3*e)},g.en=v[m],g.Ls=v,g}()},776:function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,b){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,b){e.__proto__=b}||function(e,b){for(var p in b)b.hasOwnProperty(p)&&(e[p]=b[p])})(e,b)},function(e,b){function t(){this.constructor=e}r(e,b),e.prototype=null===b?Object.create(b):(t.prototype=b.prototype,new t)}),l=this&&this.__assign||function(){return(l=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e}).apply(this,arguments)},c=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,l){function c(e){try{f(r.next(e))}catch(e){l(e)}}function d(e){try{f(r.throw(e))}catch(e){l(e)}}function f(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,d)}f((r=r.apply(e,t||[])).next())}))},d=this&&this.__generator||function(e,body){var t,n,r,g,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return g={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function l(l){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,n&&(r=2&l[0]?n.return:l[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,l[1])).done)return r;switch(n=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return o.label++,{value:l[1],done:!1};case 5:o.label++,n=l[1],l=[0];continue;case 7:l=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){o=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){o.label=l[1];break}if(6===l[0]&&o.label<r[1]){o.label=r[1],r=l;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(l);break}r[2]&&o.ops.pop(),o.trys.pop();continue}l=body.call(e,o)}catch(e){l=[6,e],n=0}finally{t=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.UploaderEvent=t.vodAxios=void 0;var f,h=n(828),m=n(829),v=n(843),y=n(903),w=n(778),C=n(779),k=n(845);t.vodAxios=y.default.create(),function(e){e.video_progress="video_progress",e.media_progress="media_progress",e.video_upload="video_upload",e.media_upload="media_upload",e.cover_progress="cover_progress",e.cover_upload="cover_upload"}(f=t.UploaderEvent||(t.UploaderEvent={}));var S=function(e){function n(t){var n=e.call(this)||this;return n.sessionName="",n.vodSessionKey="",n.appId=0,n.reqKey=k(),n.reportId="",n.enableResume=!0,n.applyRequestTimeout=5e3,n.applyRequestRetryCount=3,n.commitRequestTimeout=5e3,n.commitRequestRetryCount=3,n.retryDelay=1e3,n.validateInitParams(t),n.videoFile=t.mediaFile||t.videoFile,n.getSignature=t.getSignature,n.enableResume=t.enableResume,n.videoName=t.mediaName||t.videoName,n.coverFile=t.coverFile,n.fileId=t.fileId,n.applyRequestTimeout=t.applyRequestTimeout||n.applyRequestTimeout,n.commitRequestTimeout=t.commitRequestTimeout||n.commitRequestTimeout,n.retryDelay=t.retryDelay||n.retryDelay,n.appId=t.appId||n.appId,n.reportId=t.reportId||n.reportId,n.genFileInfo(),n}return o(n,e),n.prototype.setStorage=function(e,t){if(e){var n="webugc_"+h(e);try{localStorage.setItem(n,t)}catch(e){}}},n.prototype.getStorage=function(e){if(e){var t="webugc_"+h(e),n=null;try{n=localStorage.getItem(t)}catch(e){}return n}},n.prototype.delStorage=function(e){if(e){var t="webugc_"+h(e);try{localStorage.removeItem(t)}catch(e){}}},n.prototype.validateInitParams=function(e){if(!w.default.isFunction(e.getSignature))throw new Error("getSignature must be a function");if(e.videoFile&&!w.default.isFile(e.videoFile))throw new Error("videoFile must be a File")},n.prototype.genFileInfo=function(){var e=this.videoFile;if(e){var t=e.name.lastIndexOf("."),n="";if(this.videoName){if(!w.default.isString(this.videoName))throw new Error("mediaName must be a string");if(/[:*?<>\"\\/|]/g.test(this.videoName))throw new Error('Cant use these chars in filename: \\ / : * ? " < > |');n=this.videoName}else n=e.name.substring(0,t);this.videoInfo={name:n,type:e.name.substring(t+1).toLowerCase(),size:e.size},this.sessionName+=e.name+"_"+e.size+";"}var r=this.coverFile;if(r){var o=r.name,l=o.lastIndexOf(".");this.coverInfo={name:o.substring(0,l),type:o.substring(l+1).toLowerCase(),size:r.size},this.sessionName+=r.name+"_"+r.size+";"}},n.prototype.applyUploadUGC=function(e){return void 0===e&&(e=0),c(this,void 0,void 0,(function(){function n(t){return c(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:if(r.emit(C.VodReportEvent.report_apply,{err:t,requestStartTime:v}),r.delStorage(r.sessionName),r.applyRequestRetryCount==e){if(t)throw t;throw new Error("apply upload failed")}return[4,w.default.delay(r.retryDelay)];case 1:return n.sent(),[2,r.applyUploadUGC(e+1)]}}))}))}var r,o,l,f,h,m,v,y,k,S,E,_;return d(this,(function(e){switch(e.label){case 0:return r=this,[4,this.getSignature()];case 1:if(o=e.sent(),f=this.videoInfo,h=this.coverInfo,m=this.vodSessionKey||this.enableResume&&this.getStorage(this.sessionName))l={signature:o,vodSessionKey:m};else if(f)l={signature:o,videoName:f.name,videoType:f.type,videoSize:f.size},h&&(l.coverName=h.name,l.coverType=h.type,l.coverSize=h.size);else{if(!this.fileId||!h)throw"Wrong params, please check and try again";l={signature:o,fileId:this.fileId,coverName:h.name,coverType:h.type,coverSize:h.size}}v=new Date,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.vodAxios.post("https://vod2.qcloud.com/v3/index.php?Action=ApplyUploadUGC",l,{timeout:this.applyRequestTimeout,withCredentials:!1})];case 3:return y=e.sent(),[3,5];case 4:return[2,n(e.sent())];case 5:return 0==(k=y.data).code?(S=k.data,E=S.vodSessionKey,this.setStorage(this.sessionName,E),this.vodSessionKey=E,this.appId=S.appId,this.emit(C.VodReportEvent.report_apply,{data:S,requestStartTime:v}),[2,S]):((_=new Error(k.message)).code=k.code,[2,n(_)])}}))}))},n.prototype.uploadToCos=function(e){return c(this,void 0,void 0,(function(){var t,n,r,o,h,v,y,k;return d(this,(function(S){switch(S.label){case 0:return t=this,n={bucket:e.storageBucket+"-"+e.storageAppId,region:e.storageRegionV5},r=new m({getAuthorization:function(t,n){return c(this,void 0,void 0,(function(){return d(this,(function(t){return n({TmpSecretId:e.tempCertificate.secretId,TmpSecretKey:e.tempCertificate.secretKey,XCosSecurityToken:e.tempCertificate.token,StartTime:e.timestamp,ExpiredTime:e.tempCertificate.expiredTime}),[2]}))}))}}),this.cos=r,o=[],this.videoFile&&(h=l(l({},n),{file:this.videoFile,key:e.video.storagePath,onProgress:function(data){t.emit(f.video_progress,data),t.emit(f.media_progress,data)},onUpload:function(data){t.emit(f.video_upload,data),t.emit(f.media_upload,data)},onTaskReady:function(e){t.taskId=e}}),o.push(h)),this.coverFile&&(v=l(l({},n),{file:this.coverFile,key:e.cover.storagePath,onProgress:function(data){t.emit(f.cover_progress,data)},onUpload:function(data){t.emit(f.cover_upload,data)},onTaskReady:w.default.noop}),o.push(v)),y=new Date,k=o.map((function(e){return new Promise((function(n,o){r.sliceUploadFile({Bucket:e.bucket,Region:e.region,Key:e.key,Body:e.file,onTaskReady:e.onTaskReady,onProgress:e.onProgress},(function(r,data){return e.file===t.videoFile&&t.emit(C.VodReportEvent.report_cos_upload,{err:r,requestStartTime:y}),r?(t.delStorage(t.sessionName),'{"error":"error","headers":{}}'===JSON.stringify(r)?o(new Error("cors error")):void o(r)):(e.onUpload(data),n())}))}))})),[4,Promise.all(k)];case 1:return[2,S.sent()]}}))}))},n.prototype.commitUploadUGC=function(e){return void 0===e&&(e=0),c(this,void 0,void 0,(function(){function n(t){return c(this,void 0,void 0,(function(){return d(this,(function(n){switch(n.label){case 0:if(r.emit(C.VodReportEvent.report_commit,{err:t,requestStartTime:f}),r.commitRequestRetryCount==e){if(t)throw t;throw new Error("commit upload failed")}return[4,w.default.delay(r.retryDelay)];case 1:return n.sent(),[2,r.commitUploadUGC(e+1)]}}))}))}var r,o,l,f,h,m,v;return d(this,(function(e){switch(e.label){case 0:return r=this,[4,this.getSignature()];case 1:o=e.sent(),this.delStorage(this.sessionName),l=this.vodSessionKey,f=new Date,e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.vodAxios.post("https://vod2.qcloud.com/v3/index.php?Action=CommitUploadUGC",{signature:o,vodSessionKey:l},{timeout:this.commitRequestTimeout,withCredentials:!1})];case 3:return h=e.sent(),[3,5];case 4:return[2,n(e.sent())];case 5:return 0==(m=h.data).code?(this.emit(C.VodReportEvent.report_commit,{data:m.data,requestStartTime:f}),[2,m.data]):((v=new Error(m.message)).code=m.code,[2,n(v)])}}))}))},n.prototype.start=function(){var e=this,t=new Date;this.donePromise=this._start().then((function(n){return e.emit(C.VodReportEvent.report_done,{err:{code:0},requestStartTime:t}),n})).catch((function(n){throw e.emit(C.VodReportEvent.report_done,{err:{code:n&&n.code||w.default.CLIENT_ERROR_CODE.UPLOAD_FAIL},requestStartTime:t}),n}))},n.prototype._start=function(){return c(this,void 0,void 0,(function(){var e;return d(this,(function(t){switch(t.label){case 0:return[4,this.applyUploadUGC()];case 1:return e=t.sent(),[4,this.uploadToCos(e)];case 2:return t.sent(),[4,this.commitUploadUGC()];case 3:return[2,t.sent()]}}))}))},n.prototype.done=function(){return this.donePromise},n.prototype.cancel=function(){this.cos.cancelTask(this.taskId)},n}(v.EventEmitter);t.default=S},777:function(e,t){var n=function(e){var t={},n=function(e){return!t[e]&&(t[e]=[]),t[e]};e.on=function(e,t){"task-list-update"===e&&console.warn('warning: Event "'+e+'" has been deprecated. Please use "list-update" instead.'),n(e).push(t)},e.off=function(e,t){for(var r=n(e),i=r.length-1;i>=0;i--)t===r[i]&&r.splice(i,1)},e.emit=function(e,data){for(var t=n(e).map((function(e){return e})),i=0;i<t.length;i++)t[i](data)}};e.exports.init=n,e.exports.EventProxy=function(){n(this)}},778:function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UPLOAD_FAIL=1]="UPLOAD_FAIL"}(r||(r={})),t.default={isFile:function(e){return"[object File]"==Object.prototype.toString.call(e)},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},noop:function(){},delay:function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))},isTest:!1,isDev:!1,CLIENT_ERROR_CODE:r}},779:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.VodReporter=t.VodReportEvent=void 0;var o,l,c=n(776),d=n(844),f=n(778);!function(e){e.report_apply="report_apply",e.report_cos_upload="report_cos_upload",e.report_commit="report_commit",e.report_done="report_done"}(o=t.VodReportEvent||(t.VodReportEvent={})),function(e){e[e.apply=10001]="apply",e[e.cos_upload=20001]="cos_upload",e[e.commit=10002]="commit",e[e.done=40001]="done"}(l||(l={}));var h=function(){function e(e,t){this.baseReportData={version:d.version,platform:3e3,device:navigator.userAgent},this.reportUrl="https://vodreport.qcloud.com/ugcupload_new",this.uploader=e,this.options=t,this.init()}return e.prototype.init=function(){this.uploader.on(o.report_apply,this.onApply.bind(this)),this.uploader.on(o.report_cos_upload,this.onCosUpload.bind(this)),this.uploader.on(o.report_commit,this.onCommit.bind(this)),this.uploader.on(o.report_done,this.onDone.bind(this))},e.prototype.onApply=function(e){try{var t=this.uploader;if(!t.videoFile)return;Object.assign(this.baseReportData,{appId:t.appId,fileSize:t.videoFile.size,fileName:t.videoFile.name,fileType:t.videoFile.type,vodSessionKey:t.vodSessionKey,reqKey:t.reqKey,reportId:t.reportId});var n={reqType:l.apply,errCode:0,vodErrCode:0,errMsg:"",reqTimeCost:Number(new Date)-Number(e.requestStartTime),reqTime:Number(e.requestStartTime)};e.err&&(n.errCode=1,n.vodErrCode=e.err.code,n.errMsg=e.err.message),e.data&&(this.baseReportData.cosRegion=e.data.storageRegionV5),this.report(n)}catch(e){if(console.error("onApply",e),f.default.isTest)throw e}},e.prototype.onCosUpload=function(e){try{var t={reqType:l.cos_upload,errCode:0,cosErrCode:"",errMsg:"",reqTimeCost:Number(new Date)-Number(e.requestStartTime),reqTime:Number(e.requestStartTime)};e.err&&(t.errCode=1,t.cosErrCode=e.err.error?e.err.error.Code:e.err,e.err&&"error"===e.err.error&&(t.cosErrCode="cors error"),t.errMsg=JSON.stringify(e.err)),this.report(t)}catch(e){if(console.error("onCosUpload",e),f.default.isTest)throw e}},e.prototype.onCommit=function(e){try{var t={reqType:l.commit,errCode:0,vodErrCode:0,errMsg:"",reqTimeCost:Number(new Date)-Number(e.requestStartTime),reqTime:Number(e.requestStartTime)};e.err&&(t.errCode=1,t.vodErrCode=e.err.code,t.errMsg=e.err.message),e.data&&(this.baseReportData.fileId=e.data.fileId),this.report(t)}catch(e){if(console.error("onCommit",e),f.default.isTest)throw e}},e.prototype.onDone=function(e){try{var t={reqType:l.done,errCode:e.err&&e.err.code,reqTimeCost:Number(new Date)-Number(e.requestStartTime),reqTime:Number(e.requestStartTime)};this.report(t)}catch(e){if(console.error("onDone",e),f.default.isTest)throw e}},e.prototype.report=function(e){e=r(r({},this.baseReportData),e),this.send(e)},e.prototype.send=function(e){f.default.isDev||f.default.isTest?console.log("send reportData",e):c.vodAxios.post(this.reportUrl,e)},e}();t.VodReporter=h},789:function(e,t,n){"use strict";n(52);t.a=function(e){return e[0]===e[1]&&"0"===e[0]&&(e=e.substr(0,1)),e.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,"")}},819:function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=25)}([function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return s})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return p})),n.d(t,"d",(function(){return f}));var r=n(2),i=n(3),o=n(1),a=function(e){var t;return getSelection().rangeCount>0&&(t=getSelection().getRangeAt(0),e.isEqualNode(t.startContainer)||e.contains(t.startContainer))||(e.focus(),(t=e.ownerDocument.createRange()).setStart(e,0),t.collapse(!0)),t},l=function(e){var t=window.getSelection().getRangeAt(0);if(!e.contains(t.startContainer)&&!Object(o.e)(t.startContainer,"vditor-panel--none"))return{left:0,top:0};var n,r=e.parentElement.getBoundingClientRect();if(0===t.getClientRects().length)if(3===t.startContainer.nodeType){var i=t.startContainer.parentElement;if(!(i&&i.getClientRects().length>0))return{left:0,top:0};n=i.getClientRects()[0]}else{var a=t.startContainer.children;if(a[t.startOffset]&&a[t.startOffset].getClientRects().length>0)n=a[t.startOffset].getClientRects()[0];else if(t.startContainer.childNodes.length>0){var l=t.cloneRange();t.selectNode(t.startContainer.childNodes[Math.max(0,t.startOffset-1)]),n=t.getClientRects()[0],t.setEnd(l.endContainer,l.endOffset),t.setStart(l.startContainer,l.startOffset)}else n=t.startContainer.getClientRects()[0];if(!n){for(var s=t.startContainer.childNodes[t.startOffset];!s.getClientRects||s.getClientRects&&0===s.getClientRects().length;)s=s.parentElement;n=s.getClientRects()[0]}}else n=t.getClientRects()[0];return{left:n.left-r.left,top:n.top-r.top}},s=function(e,t){if(!t){if(0===getSelection().rangeCount)return!1;t=getSelection().getRangeAt(0)}var n=t.commonAncestorContainer;return e.isEqualNode(n)||e.contains(n)},c=function(e){var t=window.getSelection();t.removeAllRanges(),t.addRange(e)},d=function(e,t,n){var r={end:0,start:0};if(!n){if(0===getSelection().rangeCount)return r;n=window.getSelection().getRangeAt(0)}if(s(t,n)){var i=n.cloneRange();e.childNodes[0]&&e.childNodes[0].childNodes[0]?i.setStart(e.childNodes[0].childNodes[0],0):i.selectNodeContents(e),i.setEnd(n.startContainer,n.startOffset),r.start=i.toString().length,r.end=r.start+n.toString().length}return r},u=function(e,t,n){var r=0,i=0,o=n.childNodes[i],a=!1,l=!1;e=Math.max(0,e),t=Math.max(0,t);var s=n.ownerDocument.createRange();for(s.setStart(o||n,0),s.collapse(!0);!l&&o;){var d=r+o.textContent.length;if(!a&&e>=r&&e<=d&&(0===e?s.setStart(o,0):3===o.childNodes[0].nodeType?s.setStart(o.childNodes[0],e-r):o.nextSibling?s.setStartBefore(o.nextSibling):s.setStartAfter(o),a=!0,e===t)){l=!0;break}a&&t>=r&&t<=d&&(0===t?s.setEnd(o,0):3===o.childNodes[0].nodeType?s.setEnd(o.childNodes[0],t-r):o.nextSibling?s.setEndBefore(o.nextSibling):s.setEndAfter(o),l=!0),r=d,o=n.childNodes[++i]}return!l&&n.childNodes[i-1]&&s.setStartBefore(n.childNodes[i-1]),c(s),s},p=function(e,t){var n=e.querySelector("wbr");if(n){if(n.previousElementSibling)if(n.previousElementSibling.isSameNode(n.previousSibling)){if(n.previousElementSibling.lastChild)return t.setStartBefore(n),t.collapse(!0),c(t),!Object(i.c)()||"EM"!==n.previousElementSibling.tagName&&"STRONG"!==n.previousElementSibling.tagName&&"S"!==n.previousElementSibling.tagName||(t.insertNode(document.createTextNode(r.a.ZWSP)),t.collapse(!1)),void n.remove();t.setStartAfter(n.previousElementSibling)}else t.setStart(n.previousSibling,n.previousSibling.textContent.length);else n.previousSibling?t.setStart(n.previousSibling,n.previousSibling.textContent.length):n.nextSibling?3===n.nextSibling.nodeType?t.setStart(n.nextSibling,0):t.setStartBefore(n.nextSibling):t.setStart(n.parentElement,0);t.collapse(!0),n.remove(),c(t)}},f=function(e,t){var n=document.createElement("div");n.innerHTML=e;var r=n.querySelectorAll("p");1===r.length&&!r[0].previousSibling&&!r[0].nextSibling&&t[t.currentMode].element.children.length>0&&(e=r[0].innerHTML.trim());var i=document.createElement("div");i.innerHTML=e;var l=a(t[t.currentMode].element);if(""!==l.toString()&&(t[t.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),i.firstElementChild&&"0"===i.firstElementChild.getAttribute("data-block")){i.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var s=Object(o.c)(l.startContainer);s?s.insertAdjacentHTML("afterend",i.innerHTML):t[t.currentMode].element.insertAdjacentHTML("beforeend",i.innerHTML),p(t[t.currentMode].element,l)}else{var d=document.createElement("template");d.innerHTML=e,l.insertNode(d.content.cloneNode(!0)),l.collapse(!1),c(l)}}},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return u}));var r=n(6),i=function(e,t){for(var n=d(e,t),r=!1,i=!1;n&&!n.classList.contains("vditor-reset")&&!i;)(r=d(n.parentElement,t))?n=r:i=!0;return n||!1},o=function(e,t){for(var n=Object(r.b)(e,t),i=!1,o=!1;n&&!n.classList.contains("vditor-reset")&&!o;)(i=Object(r.b)(n.parentElement,t))?n=i:o=!0;return n||!1},a=function(e){var t=o(e,"UL"),n=o(e,"OL"),r=t;return n&&(!t||t&&n.contains(t))&&(r=n),r},l=function(e,t,n){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var r=e,i=!1;r&&!i&&!r.classList.contains("vditor-reset");)r.getAttribute(t)===n?i=!0:r=r.parentElement;return i&&r},s=function(e){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);var t=e,n=!1,r=l(e,"data-block","0");if(r)return r;for(;t&&!n&&!t.classList.contains("vditor-reset");)"H1"===t.tagName||"H2"===t.tagName||"H3"===t.tagName||"H4"===t.tagName||"H5"===t.tagName||"H6"===t.tagName||"P"===t.tagName||"BLOCKQUOTE"===t.tagName||"OL"===t.tagName||"UL"===t.tagName?n=!0:t=t.parentElement;return n&&t},c=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var n=e,r=!1;n&&!r&&!n.classList.contains("vditor-reset");)n.nodeName===t?r=!0:n=n.parentElement;return r&&n},d=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var n=e,r=!1;n&&!r&&!n.classList.contains("vditor-reset");)n.classList.contains(t)?r=!0:n=n.parentElement;return r&&n},u=function(e){for(;e&&e.lastChild;)e=e.lastChild;return e}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r="3.5.2",i=function(){function e(){}return e.ZWSP="​",e.MOBILE_WIDTH=520,e.CLASS_MENU_DISABLED="vditor-menu--disabled",e.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],e.CODE_THEME=["abap","algol","algol_nu","arduino","autumn","borland","bw","colorful","dracula","emacs","friendly","fruity","github","igor","lovelace","manni","monokai","monokailight","murphy","native","paraiso-dark","paraiso-light","pastie","perldoc","pygments","rainbow_dash","rrt","solarized-dark","solarized-dark256","solarized-light","swapoff","tango","trac","vim","vs","xcode","ant-design"],e.CODE_LANGUAGES=["mermaid","echarts","mindmap","abc","graphviz","apache","bash","cs","cpp","css","coffeescript","diff","xml","http","ini","json","java","javascript","js","makefile","markdown","nginx","objectivec","php","perl","properties","python","ruby","sql","shell","dart","erb","go","gradle","julia","kotlin","less","lua","matlab","rust","scss","typescript","ts","yaml"],e.CDN="https://cdn.jsdelivr.net/npm/vditor@3.5.2",e.MARKDOWN_OPTIONS={autoSpace:!1,chinesePunct:!1,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",listStyle:!1,mark:!1,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},e.HLJS_OPTIONS={enable:!0,lineNumber:!1,style:"github"},e.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},e.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:e.CDN+"/dist/css/content-theme"},e}()},function(e,t,n){"use strict";n.d(t,"f",(function(){return r})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return l})),n.d(t,"g",(function(){return s})),n.d(t,"c",(function(){return c}));var r=function(){return navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome")},i=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},o=function(){try{return"undefined"!=typeof localStorage}catch(e){return!1}},a=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},l=function(e){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!(!e.metaKey||e.ctrlKey):!(e.metaKey||!e.ctrlKey)},s=function(e){return/Mac/.test(navigator.platform)||"iPhone"===navigator.platform?(e=e.replace("ctrl","⌘").replace("shift","⇧").replace("alt","⌥")).indexOf("⇧")>-1&&(e=i()?e.replace(";",":").replace("=","+"):e.replace(":",";").replace("+","=").replace("_","-")):(e=e.replace("⌘","ctrl").replace("⇧","shift").replace("⌥","alt")).indexOf("shift")>-1&&(e=e.replace(";",":").replace("=","+")),e},c=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={en_US:{alignCenter:"Center",alignLeft:"Left",alignRight:"Right",alternateText:"Alternate text",bold:"Blod",both:"editor & preview",check:"Task List",code:"Code Block","code-theme":"Code Block Theme Preview",column:"Column",confirm:"Confirm","content-theme":"Content Theme Preview",copied:"Copied",copy:"Copy","delete-column":"Delete Row","delete-row":"Delete Column",devtools:"DevTools",down:"Down",downloadTip:"The browser does not support the download function",edit:"Edit","edit-mode":"Toggle Edit Mode",emoji:"Emoji",export:"Export",fileTypeError:"file type is error",footnoteRef:"Footnote Ref",fullscreen:"Toggle Fullscreen",generate:"Generating",headings:"Headings",help:"Help",imageURL:"image URL",indent:"Indent",info:"Info","inline-code":"Inline Code","insert-after":"Insert line after","insert-before":"Insert line Before","insert-column":"Insert Column","insert-row":"Insert Row",instantRendering:"Instant Rendering",italic:"Italic",language:"Language",line:"Line",link:"Link",linkRef:"Link Ref",list:"List",more:"More",nameEmpty:"Name is empty","ordered-list":"Order List",outdent:"Outdent",outline:"Outline",over:"over",performanceTip:"Real-time preview requires ${x}ms, you can close it",preview:"Preview",quote:"Quote",record:"Start Record/End Record","record-tip":"The device does not support recording",recording:"recording...",redo:"Redo",remove:"Remove",row:"Row",splitView:"Split View",strike:"Strike",table:"Table",textIsNotEmpty:"text(no empty)",title:"Title",tooltipText:"Tooltip text",undo:"Undo",up:"Up",update:"Update",upload:"Upload image or file",uploadError:"upload error",uploading:"uploading...",wysiwyg:"WYSIWYG"},ja_JP:{alignCenter:"中央",alignLeft:"左側",alignRight:"右側",alternateText:"イメージタグ",bold:"太く",both:"エディター & プレビュー",check:"チェックリスト",code:"コードブロック挿入","code-theme":"コードブロックテーマ",column:"行列",confirm:"確認","content-theme":"コンテンツテーマ",copied:"コピー完了",copy:"コピー","delete-column":"列 消去","delete-row":"行 消去",devtools:"開発ツール",down:"ダウンロード",downloadTip:"ブラウザがダウンロード機能をサポートしていません。",edit:"修正","edit-mode":"編集モード",emoji:"絵文字",export:"書き出し",fileTypeError:"サポートしていません。",footnoteRef:"脚注参照",fullscreen:"全体画面",generate:"作成する",headings:"タイトル大きさ",help:"ヘルプ",imageURL:"イメージ URL",indent:"字下げ",info:"情報","inline-code":"インラインコード","insert-after":"ブロックの後ろに入力","insert-before":"ブロックの前に入力","insert-column":"列 挿入","insert-row":"行 挿入",instantRendering:"インスタントレンダリング",italic:"斜体",language:"言語",line:"段落分割",link:"リンク",linkRef:"リンク参照",list:"リスト",more:"詳しく見る",nameEmpty:"名前が入力されていません。","ordered-list":"順序のあるリスト",outdent:"ぶら下げインデント",outline:"概要",over:"オーバー",performanceTip:"リアルタイムプレビューには、${x}msが必要でエディター/プレビューボタンをクリックして閉じる事が出来ます。",preview:"プレビュー",quote:"引用段落",record:"録音開始/録音終了","record-tip":"録音がサポートされていません。",recording:"録音中...",redo:"戻る",remove:"消去",row:"列",splitView:"マークダウン",strike:"取り消し線",table:"表 挿入",textIsNotEmpty:"テキスト(no empty)",title:"題名",tooltipText:"ツールチップ",undo:"取り消す",up:"戻る",update:"アップデート",upload:"イメージをダウンロードする",uploadError:"アップロード失敗",uploading:"アップロード中",wysiwyg:"ウィジウィグ"},ko_KR:{alignCenter:"가운데",alignLeft:"왼쪽",alignRight:"오른쪽",alternateText:"이미지 태그",bold:"굵게",both:"에디터 & 미리보기",check:"체크박스",code:"코드블럭삽입","code-theme":"코드블럭테마",column:"행",confirm:"확인","content-theme":"컨텐츠테마",copied:"복사완료",copy:"복사","delete-column":"열 삭제","delete-row":"행 삭제",devtools:"개발툴",down:"다운",downloadTip:"브라우저가 다운로드 기능을 지원하지 않습니다",edit:"수정","edit-mode":"편집모드",emoji:"이모지",export:"내보내기",fileTypeError:"지원하지않습니다.",footnoteRef:"각주참조",fullscreen:"전체화면",generate:"생성",headings:"제목크기",help:"도움말",imageURL:"이미지 URL",indent:"들여쓰기",info:"정보","inline-code":"인라인코드","insert-after":"블락 뒤로 입력","insert-before":"블락 앞으로 입력","insert-column":"열 삽입","insert-row":"행 삽입",instantRendering:"타이포라",italic:"기울임꼴",language:"언어",line:"문단나눔",link:"링크",linkRef:"링크 참조",list:"순서없는 목록",more:"더보기",nameEmpty:"이름이 비어있습니다.","ordered-list":"순서있는 목록",outdent:"내어쓰기",outline:"개요",over:"오버",performanceTip:"실시간 미리보기에는 ${x}ms가 필요하며 에디터/미리보기 버튼을 클릭하여 닫을 수 있습니다.",preview:"미리보기",quote:"인용단락",record:"녹음시작/녹음종료","record-tip":"녹음을 지원하지 않습니다.",recording:"녹음중...",redo:"되돌리기",remove:"삭제",row:"열",splitView:"마크다운",strike:"취소선",table:"표삽입",textIsNotEmpty:"텍스트(no empty)",title:"표제",tooltipText:"툴팁",undo:"취소하기",up:"위로",update:"업데이트",upload:"이미지 업로드하기",uploadError:"업로드 실패",uploading:"업로드중...",wysiwyg:"위지위그"},zh_CN:{alignCenter:"居中",alignLeft:"居左",alignRight:"居右",alternateText:"替代文本",bold:"粗体",both:"编辑 & 预览",check:"任务列表",code:"代码块","code-theme":"代码块主题预览",column:"列",confirm:"确定","content-theme":"内容主题预览",copied:"已复制",copy:"复制","delete-column":"删除列","delete-row":"删除行",devtools:"开发者工具",down:"下",downloadTip:"该浏览器不支持下载功能",edit:"编辑","edit-mode":"切换编辑模式",emoji:"表情",export:"导出",fileTypeError:"文件类型不允许上传",footnoteRef:"脚注标识",fullscreen:"全屏切换",generate:"生成中",headings:"标题",help:"帮助",imageURL:"图片地址",indent:"列表缩进",info:"关于","inline-code":"行内代码","insert-after":"末尾插入行","insert-before":"起始插入行","insert-column":"插入列","insert-row":"插入行",instantRendering:"即时渲染",italic:"斜体",language:"语言",line:"分隔线",link:"链接",linkRef:"引用标识",list:"无序列表",more:"更多",nameEmpty:"文件名不能为空","ordered-list":"有序列表",outdent:"列表反向缩进",outline:"大纲",over:"超过",performanceTip:"实时预览需 ${x}ms，可点击编辑 & 预览按钮进行关闭",preview:"预览",quote:"引用",record:"开始录音/结束录音","record-tip":"该设备不支持录音功能",recording:"录音中...",redo:"重做",remove:"删除",row:"行",splitView:"分屏预览",strike:"删除线",table:"表格",textIsNotEmpty:"文本（不能为空）",title:"标题",tooltipText:"提示文本",undo:"撤销",up:"上",update:"更新",upload:"上传图片或文件",uploadError:"上传错误",uploading:"上传中...",wysiwyg:"所见即所得"}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=function(e,t){if(document.getElementById(t))return!1;var n=new XMLHttpRequest;n.open("GET",e,!1),n.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),n.send("");var r=document.createElement("script");r.type="text/javascript",r.text=n.responseText,r.id=t,document.head.appendChild(r)},i=function(e,t){return new Promise((function(n,r){if(document.getElementById(t))return n(),!1;var i=document.createElement("script");i.src=e,i.async=!0,document.head.appendChild(i),i.onload=function(){if(document.getElementById(t))return i.remove(),n(),!1;i.id=t,n()}}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=function(e,t){if(!e)return!1;3===e.nodeType&&(e=e.parentElement);for(var n=e,r=!1;n&&!r&&!n.classList.contains("vditor-reset");)0===n.nodeName.indexOf(t)?r=!0:n=n.parentElement;return r&&n},i=function(e){var t=r(e,"H");return!(!t||2!==t.tagName.length||"HR"===t.tagName)&&t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e,t){if(!document.getElementById(t)){var n=document.createElement("link");n.id=t,n.rel="stylesheet",n.type="text/css",n.href=e,document.getElementsByTagName("head")[0].appendChild(n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(7),i=function(e,t){if(e&&t){var n=document.getElementById("vditorContentTheme"),i=t+"/"+e+".css";n?n.href!==i&&(n.remove(),Object(r.a)(i,"vditorContentTheme")):Object(r.a)(i,"vditorContentTheme")}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){return e.replace(/\u00a0/g," ")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(5),o=function(e,t){void 0===e&&(e=document),void 0===t&&(t=r.a.CDN);var n=e.querySelectorAll(".language-abc");n.length>0&&Object(i.a)(t+"/dist/js/abcjs/abcjs_basic.min.js","vditorAbcjsScript").then((function(){n.forEach((function(e){var t=document.createElement("div");t.className="language-abc",e.parentNode.replaceChild(t,e),ABCJS.renderAbc(t,e.textContent.trim()),t.style.overflowX="auto"}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(5),o=function(e,t){void 0===e&&(e=document),void 0===t&&(t=r.a.CDN);var n=e.querySelectorAll(".language-echarts");n.length>0&&Object(i.a)(t+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){n.forEach((function(e){var t=e.innerText.trim();if(t)try{if("true"===e.getAttribute("data-processed"))return;var n=JSON.parse(t);echarts.init(e).setOption(n),e.setAttribute("data-processed","true")}catch(t){e.className="vditor-reset--error",e.innerHTML="echarts render error: <br>"+t}}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),i=n(9),o=function(e,t){void 0===t&&(t="zh_CN"),e.querySelectorAll("pre > code").forEach((function(n,o){if(!(n.classList.contains("language-mermaid")||n.classList.contains("language-echarts")||n.classList.contains("language-mindmap")||n.classList.contains("language-abc")||n.classList.contains("language-graphviz")||n.style.maxHeight.indexOf("px")>-1||e.classList.contains("vditor-preview")&&o>5)){var a=n.innerText;if(n.classList.contains("highlight-chroma")){var l=document.createElement("code");l.innerHTML=n.innerHTML,l.querySelectorAll(".highlight-ln").forEach((function(e){e.remove()})),a=l.innerText}var s=document.createElement("div");s.className="vditor-copy",s.innerHTML='<span aria-label="'+r.a[t].copy+"\"\nonmouseover=\"this.setAttribute('aria-label', '"+r.a[t].copy+"')\"\nclass=\"vditor-tooltipped vditor-tooltipped__w\"\nonclick=\"this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '"+r.a[t].copied+'\')"><svg><use xlink:href="#vditor-icon-copy"></use></svg></span>';var c=document.createElement("textarea");c.value=Object(i.a)(a),s.insertAdjacentElement("afterbegin",c),n.before(s),n.style.maxHeight=window.outerHeight-40+"px"}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(5),o=function(e,t){void 0===t&&(t=r.a.CDN);var n=e.querySelectorAll(".language-graphviz");0!==n.length&&Object(i.a)(t+"/dist/js/graphviz/viz.js","vditorGraphVizScript").then((function(){n.forEach((function(e){if("true"!==e.getAttribute("data-processed")){try{var t=new Blob(["importScripts('"+document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js")+"');"],{type:"application/javascript"}),n=(window.URL||window.webkitURL).createObjectURL(t),r=new Worker(n);new Viz({worker:r}).renderSVGElement(e.textContent).then((function(t){e.innerHTML=t.outerHTML})).catch((function(t){e.innerHTML="graphviz render error: <br>"+t,e.className="vditor-math vditor-reset--error"}))}catch(e){console.error("graphviz error",e)}e.setAttribute("data-processed","true")}}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(2),i=n(5),o=n(7),a=function(e,t,n){void 0===t&&(t=document),void 0===n&&(n=r.a.CDN);var a=e.style;r.a.CODE_THEME.includes(a)||(a="github");var l=document.getElementById("vditorHljsStyle"),s=n+"/dist/js/highlight.js/styles/"+a+".css";l&&l.href!==s&&l.remove(),Object(o.a)(n+"/dist/js/highlight.js/styles/"+a+".css","vditorHljsStyle"),!1!==e.enable&&0!==t.querySelectorAll("pre > code").length&&Object(i.a)(n+"/dist/js/highlight.js/highlight.pack.js","vditorHljsScript").then((function(){t.querySelectorAll("pre > code").forEach((function(t){if(!t.parentElement.classList.contains("vditor-ir__marker--pre")&&!t.parentElement.classList.contains("vditor-wysiwyg__pre")&&!(t.classList.contains("language-mermaid")||t.classList.contains("language-echarts")||t.classList.contains("language-mindmap")||t.classList.contains("language-abc")||t.classList.contains("language-graphviz"))&&(hljs.highlightBlock(t),e.lineNumber)){t.classList.add("vditor-linenumber");var n=t.querySelector(".vditor-linenumber__temp");n||((n=document.createElement("div")).className="vditor-linenumber__temp",t.insertAdjacentElement("beforeend",n));var r=getComputedStyle(t).whiteSpace,i=!1;"pre-wrap"!==r&&"pre-line"!==r||(i=!0);var o="",a=t.textContent.split(/\r\n|\r|\n/g);a.pop(),a.map((function(e){var t="";i&&(n.textContent=e||"\n",t=' style="height:'+n.getBoundingClientRect().height+'px"'),o+="<span"+t+"></span>"})),n.style.display="none",o='<span class="vditor-linenumber__rows">'+o+"</span>",t.insertAdjacentHTML("beforeend",o)}}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(2),i=n(5),o=n(7),a=n(9),l=function(e,t){var n=e.querySelectorAll(".vditor-math");if(0!==n.length){var l={cdn:r.a.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(t&&t.math&&(t.math=Object.assign({},l.math,t.math)),"KaTeX"===(t=Object.assign({},l,t)).math.engine)Object(o.a)(t.cdn+"/dist/js/katex/katex.min.css","vditorKatexStyle"),Object(i.a)(t.cdn+"/dist/js/katex/katex.min.js","vditorKatexScript").then((function(){n.forEach((function(e){if(!e.getAttribute("data-math")){var t=Object(a.a)(e.textContent);e.setAttribute("data-math",t);try{e.innerHTML=katex.renderToString(t,{displayMode:"DIV"===e.tagName,output:"html"})}catch(t){e.innerHTML=t.message,e.className="vditor-math vditor-reset--error"}e.addEventListener("copy",(function(e){e.stopPropagation(),e.preventDefault();var t=e.currentTarget.closest(".vditor-math");e.clipboardData.setData("text/html",t.innerHTML),e.clipboardData.setData("text/plain",t.getAttribute("data-math"))}))}}))}));else if("MathJax"===t.math.engine){window.MathJax||(window.MathJax={loader:{paths:{mathjax:t.cdn+"/dist/js/mathjax"}},tex:{macros:t.math.macros}}),Object(i.b)(t.cdn+"/dist/js/mathjax/tex-svg.js","vditorMathJaxScript");var s=function(){n.forEach((function(e){if(!e.getAttribute("data-math")){var t=Object(a.a)(e.textContent);if(e.setAttribute("data-math",t),t){window.MathJax.texReset();var n=window.MathJax.getMetricsFor(e);n.display="DIV"===e.tagName,window.MathJax.tex2svgPromise(t,n).then((function(t){e.innerHTML="",e.append(t),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var n=e.querySelector('[data-mml-node="merror"]');n&&""!==n.textContent.trim()&&(e.innerHTML=n.textContent.trim(),e.className="vditor-math vditor-reset--error")}))}}}))};window.MathJax.texReset?s():setTimeout((function(){s()}))}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(5),o=function(e,t,n){void 0===t&&(t=".language-mermaid"),void 0===n&&(n=r.a.CDN),0!==e.querySelectorAll(t).length&&Object(i.a)(n+"/dist/js/mermaid/mermaid.min.js","vditorMermaidScript").then((function(){mermaid.init({noteMargin:10},t)}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(5),o=function(e,t){void 0===e&&(e=document),void 0===t&&(t=r.a.CDN);var n=e.querySelectorAll(".language-mindmap");n.length>0&&Object(i.a)(t+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){n.forEach((function(e){var t=e.getAttribute("data-code");if(t)try{if("true"===e.getAttribute("data-processed"))return;var n={series:[{data:[JSON.parse(decodeURIComponent(t))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(e,t){var n;return(null===(n=null==t?void 0:t.data)||void 0===n?void 0:n.children)?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}};echarts.init(e).setOption(n),e.setAttribute("data-processed","true")}catch(t){e.className="vditor-reset--error",e.innerHTML="mindmap render error: <br>"+t}}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){e&&e.querySelectorAll("a").forEach((function(e){var t=e.getAttribute("href");t&&(t.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?function(e,t){e.insertAdjacentHTML("afterend",'<video controls="controls" src="'+t+'"></video>'),e.remove()}(e,t):t.match(/^.+.(mp3|wav|flac)$/)?function(e,t){e.insertAdjacentHTML("afterend",'<audio controls="controls" src="'+t+'"></audio>'),e.remove()}(e,t):function(e,t){var n=t.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),r=t.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),i=t.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),o=t.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),a=t.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),l=t.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),s=t.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),c=t.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);n&&11===n[1].length?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'+n[1]+(n[2]?"?start="+n[2]:"")+'"></iframe>'),e.remove()):r&&r[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'+r[1]+'"></iframe>'),e.remove()):i&&i[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='+i[1]+'"></iframe>'),e.remove()):o&&o[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="//coub.com/embed/'+o[1]+'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>'),e.remove()):a&&a[0]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="https://www.facebook.com/plugins/video.php?href='+encodeURIComponent(a[0])+'"></iframe>'),e.remove()):l&&l[2]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="https://www.dailymotion.com/embed/video/'+l[2]+'"></iframe>'),e.remove()):s&&s[1]?(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video"\n src="//player.bilibili.com/player.html?bvid='+s[1]+'"></iframe>'),e.remove()):c&&c[1]&&(e.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'+c[1]+'"></iframe>'),e.remove())}(e,t))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2),i=n(7),o=function(e,t){void 0===t&&(t=r.a.CDN),r.a.CODE_THEME.includes(e)||(e="github");var n=document.getElementById("vditorHljsStyle"),o=t+"/dist/js/highlight.js/styles/"+e+".css";n?n.href!==o&&(n.remove(),Object(i.a)(o,"vditorHljsStyle")):Object(i.a)(o,"vditorHljsStyle")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(6),i=function(e,t,n){var i="";Array.from(e.children).forEach((function(e,t){if(Object(r.a)(e)){var o=parseInt(e.tagName.substring(1),10),a=new Array(2*(o-1)).fill("&emsp;").join(""),l="";if(n&&"ir"===n.currentMode){var s=e.querySelector('[data-type="heading-marker"]');l="2"===s.getAttribute("data-render")?e.textContent.replace(s.textContent,"").trim():e.textContent.substring(o+1).trim()}else l=e.textContent.trim();var c=e.id.lastIndexOf("_"),d=e.id.substring(0,-1===c?void 0:c);e.id=d+"_"+t,i+='<div data-id="'+e.id+'" class="vditor-outline__item">'+a+l+"</div>"}})),t.innerHTML=i,t.querySelectorAll(".vditor-outline__item").forEach((function(r){r.addEventListener("click",(function(i){var o=document.getElementById(r.getAttribute("data-id"));if(o){if(n)if("auto"===n.options.height){var a=o.offsetTop+n.element.offsetTop;n.options.toolbarConfig.pin||(a+=n.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,a)}else n.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,n.element.offsetTop),n.preview.element.contains(e)?e.parentElement.scrollTop=o.offsetTop:e.scrollTop=o.offsetTop;else window.scrollTo(window.scrollX,o.offsetTop);t.querySelectorAll(".vditor-outline__item").forEach((function(e){e.classList.remove("vditor-outline__item--current")})),r.classList.add("vditor-outline__item--current")}}))}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n={},i=function(e){for(var t in e)e.hasOwnProperty(t)&&("[object Object]"===Object.prototype.toString.call(e[t])?n[t]=r(n[t],e[t]):n[t]=e[t])},o=0;o<e.length;o++)i(e[o]);return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r=function(e){var t=Lute.New();return t.PutEmojis(e.emojis),t.SetEmojiSite(e.emojiSite),t.SetHeadingAnchor(e.headingAnchor),t.SetInlineMathAllowDigitAfterOpenMarker(e.inlineMathDigit),t.SetAutoSpace(e.autoSpace),t.SetToC(e.toc),t.SetFootnotes(e.footnotes),t.SetChinesePunct(e.chinesePunct),t.SetFixTermTypo(e.fixTermTypo),t.SetVditorCodeBlockPreview(e.codeBlockPreview),t.SetSanitize(e.sanitize),t.SetChineseParagraphBeginningSpace(e.paragraphBeginningSpace),t.SetRenderListStyle(e.listStyle),t.SetLinkBase(e.linkBase),t.SetMark(e.mark),e.lazyLoadImage&&t.SetImageLazyLoading(e.lazyLoadImage),t}},function(e,t,n){"use strict";n.r(t);var r=n(10),i=n(11),o=n(12),a=n(13),l=n(14),s=function(e){void 0===e&&(e=document);var t=function(e){var t=document.createElement("img");t.src=e.getAttribute("data-src"),t.addEventListener("load",(function(){e.getAttribute("style")||e.getAttribute("class")||e.getAttribute("width")||e.getAttribute("height")||t.naturalHeight>t.naturalWidth&&t.naturalWidth/t.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&t.naturalHeight>window.innerHeight-40&&(e.style.height=window.innerHeight-40+"px"),e.src=t.src})),e.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return e.querySelectorAll("img").forEach((function(e){e.getAttribute("data-src")&&t(e)})),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),e.querySelectorAll("img").forEach((function(e){window.vditorImageIntersectionObserver.observe(e)}))):(window.vditorImageIntersectionObserver=new IntersectionObserver((function(e){e.forEach((function(e){(void 0===e.isIntersecting?0!==e.intersectionRatio:e.isIntersecting)&&e.target.getAttribute("data-src")&&t(e.target)}))})),e.querySelectorAll("img").forEach((function(e){window.vditorImageIntersectionObserver.observe(e)})))},c=n(15),d=n(18),u=n(16),p=n(17),f=n(20),h=n(2),m=n(8),v=n(5),g=n(21),b=n(22),y=n(0),w=function(e,t){if(void 0===t&&(t="zh_CN"),"undefined"!=typeof speechSynthesis&&"undefined"!=typeof SpeechSynthesisUtterance){var n='<svg><use xlink:href="#vditor-icon-play"></use></svg>',r='<svg><use xlink:href="#vditor-icon-pause"></use></svg>',i=document.querySelector(".vditor-speech");if(!i){(i=document.createElement("div")).className="vditor-speech",document.body.insertAdjacentElement("beforeend",i);var o=function(){var e,n;return speechSynthesis.getVoices().forEach((function(r){r.lang===t.replace("_","-")&&(e=r),r.default&&(n=r)})),e||(e=n),e};void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=o);var a=o();i.onclick=function(){if("vditor-speech"===i.className){var e=new SpeechSynthesisUtterance(i.getAttribute("data-text"));e.voice=a,e.onend=function(){i.className="vditor-speech",speechSynthesis.cancel(),i.innerHTML=n},speechSynthesis.speak(e),i.className="vditor-speech vditor-speech--current",i.innerHTML=r}else speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),i.innerHTML=r):(speechSynthesis.pause(),i.innerHTML=n));Object(y.h)(window.vditorSpeechRange)},document.body.addEventListener("click",(function(){""===getSelection().toString().trim()&&"block"===i.style.display&&(i.className="vditor-speech",speechSynthesis.cancel(),i.style.display="none")}))}e.addEventListener("mouseup",(function(e){var t=getSelection().toString().trim();if(speechSynthesis.cancel(),""!==getSelection().toString().trim()){window.vditorSpeechRange=getSelection().getRangeAt(0).cloneRange();var r=getSelection().getRangeAt(0).getBoundingClientRect();i.innerHTML=n,i.style.display="block",i.style.top=r.top+r.height+document.querySelector("html").scrollTop-20+"px",i.style.left=e.screenX+2+"px",i.setAttribute("data-text",t)}else"block"===i.style.display&&(i.className="vditor-speech",i.style.display="none")}))}},C=function(e){var t={anchor:0,cdn:h.a.CDN,customEmoji:{},emojiPath:(e&&e.emojiPath||h.a.CDN)+"/dist/images/emoji",hljs:h.a.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:h.a.MARKDOWN_OPTIONS,math:h.a.MATH_OPTIONS,speech:{enable:!1},theme:h.a.THEME_OPTIONS};return Object(g.a)(t,e)},k=function(e,t){var n=C(t);return Object(v.a)(n.cdn+"/dist/js/lute/lute.min.js","vditorLuteScript").then((function(){var r=Object(b.a)({autoSpace:n.markdown.autoSpace,chinesePunct:n.markdown.chinesePunct,codeBlockPreview:n.markdown.codeBlockPreview,emojiSite:n.emojiPath,emojis:n.customEmoji,fixTermTypo:n.markdown.fixTermTypo,footnotes:n.markdown.footnotes,headingAnchor:0!==n.anchor,inlineMathDigit:n.math.inlineDigit,lazyLoadImage:n.lazyLoadImage,linkBase:n.markdown.linkBase,listStyle:n.markdown.listStyle,paragraphBeginningSpace:n.markdown.paragraphBeginningSpace,sanitize:n.markdown.sanitize,toc:n.markdown.toc});return(null==t?void 0:t.renderers)&&r.SetJSRenderers({renderers:{Md2HTML:t.renderers}}),r.Md2HTML(e)}))},S=function(e,t,n){return function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function l(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))}(void 0,void 0,void 0,(function(){var f,h;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(g){switch(g.label){case 0:return f=C(n),[4,k(t,f)];case 1:return h=g.sent(),f.transform&&(h=f.transform(h)),e.innerHTML=h,e.classList.add("vditor-reset"),Object(m.a)(f.theme.current,f.theme.path),1===f.anchor&&e.classList.add("vditor-reset--anchor"),Object(o.a)(e,f.lang),Object(l.a)(f.hljs,e,f.cdn),Object(c.a)(e,{cdn:f.cdn,math:f.math}),Object(u.a)(e,".language-mermaid",f.cdn),Object(a.a)(e,f.cdn),Object(i.a)(e,f.cdn),Object(p.a)(e,f.cdn),Object(r.a)(e,f.cdn),Object(d.a)(e),f.speech.enable&&w(e,f.lang),0!==f.anchor&&(b=f.anchor,document.querySelectorAll(".vditor-anchor").forEach((function(e){1===b&&e.classList.add("vditor-anchor--left"),e.onclick=function(){var t=e.getAttribute("href").substr(1),n=document.getElementById("vditorAnchor-"+t).offsetTop;document.querySelector("html").scrollTop=n}})),window.onhashchange=function(){var e=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));e&&(document.querySelector("html").scrollTop=e.offsetTop)}),f.after&&f.after(),f.lazyLoadImage&&s(e),f.icon&&Object(v.a)(f.cdn+"/dist/js/icons/"+f.icon+".js","vditorIconScript"),[2]}var b}))}))},E=n(19),_=function(){function e(){}return e.codeRender=o.a,e.graphvizRender=a.a,e.highlightRender=l.a,e.mathRender=c.a,e.mermaidRender=u.a,e.chartRender=i.a,e.abcRender=r.a,e.mindmapRender=p.a,e.outlineRender=f.a,e.mediaRender=d.a,e.speechRender=w,e.lazyLoadImageRender=s,e.md2html=k,e.preview=S,e.setCodeTheme=E.a,e.setContentTheme=m.a,e}();t.default=_},function(e,t){var n=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32};n.Diff=function(e,t){return[e,t]},n.prototype.diff_main=function(e,t,r,i){void 0===i&&(i=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout);var o=i;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[new n.Diff(0,e)]:[];void 0===r&&(r=!0);var a=r,l=this.diff_commonPrefix(e,t),s=e.substring(0,l);e=e.substring(l),t=t.substring(l),l=this.diff_commonSuffix(e,t);var c=e.substring(e.length-l);e=e.substring(0,e.length-l),t=t.substring(0,t.length-l);var d=this.diff_compute_(e,t,a,o);return s&&d.unshift(new n.Diff(0,s)),c&&d.push(new n.Diff(0,c)),this.diff_cleanupMerge(d),d},n.prototype.diff_compute_=function(e,t,r,i){var o;if(!e)return[new n.Diff(1,t)];if(!t)return[new n.Diff(-1,e)];var a=e.length>t.length?e:t,l=e.length>t.length?t:e,s=a.indexOf(l);if(-1!=s)return o=[new n.Diff(1,a.substring(0,s)),new n.Diff(0,l),new n.Diff(1,a.substring(s+l.length))],e.length>t.length&&(o[0][0]=o[2][0]=-1),o;if(1==l.length)return[new n.Diff(-1,e),new n.Diff(1,t)];var c=this.diff_halfMatch_(e,t);if(c){var d=c[0],u=c[1],p=c[2],f=c[3],h=c[4],m=this.diff_main(d,p,r,i),v=this.diff_main(u,f,r,i);return m.concat([new n.Diff(0,h)],v)}return r&&e.length>100&&t.length>100?this.diff_lineMode_(e,t,i):this.diff_bisect_(e,t,i)},n.prototype.diff_lineMode_=function(e,t,r){var i=this.diff_linesToChars_(e,t);e=i.chars1,t=i.chars2;var o=i.lineArray,a=this.diff_main(e,t,!1,r);this.diff_charsToLines_(a,o),this.diff_cleanupSemantic(a),a.push(new n.Diff(0,""));for(var l=0,s=0,c=0,d="",u="";l<a.length;){switch(a[l][0]){case 1:c++,u+=a[l][1];break;case-1:s++,d+=a[l][1];break;case 0:if(s>=1&&c>=1){a.splice(l-s-c,s+c),l=l-s-c;for(var p=this.diff_main(d,u,!1,r),f=p.length-1;f>=0;f--)a.splice(l,0,p[f]);l+=p.length}c=0,s=0,d="",u=""}l++}return a.pop(),a},n.prototype.diff_bisect_=function(e,t,r){for(var i=e.length,o=t.length,a=Math.ceil((i+o)/2),l=a,s=2*a,c=new Array(s),d=new Array(s),u=0;u<s;u++)c[u]=-1,d[u]=-1;c[l+1]=0,d[l+1]=0;for(var p=i-o,f=p%2!=0,h=0,m=0,v=0,g=0,b=0;b<a&&!((new Date).getTime()>r);b++){for(var y=-b+h;y<=b-m;y+=2){for(var w=l+y,C=(x=y==-b||y!=b&&c[w-1]<c[w+1]?c[w+1]:c[w-1]+1)-y;x<i&&C<o&&e.charAt(x)==t.charAt(C);)x++,C++;if(c[w]=x,x>i)m+=2;else if(C>o)h+=2;else if(f&&(E=l+p-y)>=0&&E<s&&-1!=d[E]&&x>=(S=i-d[E]))return this.diff_bisectSplit_(e,t,x,C,r)}for(var k=-b+v;k<=b-g;k+=2){for(var S,E=l+k,_=(S=k==-b||k!=b&&d[E-1]<d[E+1]?d[E+1]:d[E-1]+1)-k;S<i&&_<o&&e.charAt(i-S-1)==t.charAt(o-_-1);)S++,_++;if(d[E]=S,S>i)g+=2;else if(_>o)v+=2;else if(!f){var x;if((w=l+p-k)>=0&&w<s&&-1!=c[w]&&(C=l+(x=c[w])-w,x>=(S=i-S)))return this.diff_bisectSplit_(e,t,x,C,r)}}}return[new n.Diff(-1,e),new n.Diff(1,t)]},n.prototype.diff_bisectSplit_=function(e,t,n,r,i){var o=e.substring(0,n),a=t.substring(0,r),l=e.substring(n),s=t.substring(r),c=this.diff_main(o,a,!1,i),d=this.diff_main(l,s,!1,i);return c.concat(d)},n.prototype.diff_linesToChars_=function(e,t){var n=[],r={};function i(e){for(var t="",i=0,a=-1,l=n.length;a<e.length-1;){-1==(a=e.indexOf("\n",i))&&(a=e.length-1);var s=e.substring(i,a+1);(r.hasOwnProperty?r.hasOwnProperty(s):void 0!==r[s])?t+=String.fromCharCode(r[s]):(l==o&&(s=e.substring(i),a=e.length),t+=String.fromCharCode(l),r[s]=l,n[l++]=s),i=a+1}return t}n[0]="";var o=4e4,a=i(e);return o=65535,{chars1:a,chars2:i(t),lineArray:n}},n.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],o=0;o<r.length;o++)i[o]=t[r.charCodeAt(o)];e[n][1]=i.join("")}},n.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(o,i)==t.substring(o,i)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,o=0;n<i;)e.substring(e.length-i,e.length-o)==t.substring(t.length-i,t.length-o)?o=n=i:r=i,i=Math.floor((r-n)/2+n);return i},n.prototype.diff_commonOverlap_=function(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;n>r?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var o=0,a=1;;){var l=e.substring(i-a),s=t.indexOf(l);if(-1==s)return o;a+=s,0!=s&&e.substring(i-a)!=t.substring(0,a)||(o=a,a++)}},n.prototype.diff_halfMatch_=function(e,t){if(this.Diff_Timeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var i=this;function o(e,t,n){for(var r,o,a,l,s=e.substring(n,n+Math.floor(e.length/4)),c=-1,d="";-1!=(c=t.indexOf(s,c+1));){var u=i.diff_commonPrefix(e.substring(n),t.substring(c)),p=i.diff_commonSuffix(e.substring(0,n),t.substring(0,c));d.length<p+u&&(d=t.substring(c-p,c)+t.substring(c,c+u),r=e.substring(0,n-p),o=e.substring(n+u),a=t.substring(0,c-p),l=t.substring(c+u))}return 2*d.length>=e.length?[r,o,a,l,d]:null}var a,l,s,c,d,u=o(n,r,Math.ceil(n.length/4)),p=o(n,r,Math.ceil(n.length/2));return u||p?(a=p?u&&u[4].length>p[4].length?u:p:u,e.length>t.length?(l=a[0],s=a[1],c=a[2],d=a[3]):(c=a[0],d=a[1],l=a[2],s=a[3]),[l,s,c,d,a[4]]):null},n.prototype.diff_cleanupSemantic=function(e){for(var t=!1,r=[],i=0,o=null,a=0,l=0,s=0,c=0,d=0;a<e.length;)0==e[a][0]?(r[i++]=a,l=c,s=d,c=0,d=0,o=e[a][1]):(1==e[a][0]?c+=e[a][1].length:d+=e[a][1].length,o&&o.length<=Math.max(l,s)&&o.length<=Math.max(c,d)&&(e.splice(r[i-1],0,new n.Diff(-1,o)),e[r[i-1]+1][0]=1,i--,a=--i>0?r[i-1]:-1,l=0,s=0,c=0,d=0,o=null,t=!0)),a++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),a=1;a<e.length;){if(-1==e[a-1][0]&&1==e[a][0]){var u=e[a-1][1],p=e[a][1],f=this.diff_commonOverlap_(u,p),h=this.diff_commonOverlap_(p,u);f>=h?(f>=u.length/2||f>=p.length/2)&&(e.splice(a,0,new n.Diff(0,p.substring(0,f))),e[a-1][1]=u.substring(0,u.length-f),e[a+1][1]=p.substring(f),a++):(h>=u.length/2||h>=p.length/2)&&(e.splice(a,0,new n.Diff(0,u.substring(0,h))),e[a-1][0]=1,e[a-1][1]=p.substring(0,p.length-h),e[a+1][0]=-1,e[a+1][1]=u.substring(h),a++),a++}a++}},n.prototype.diff_cleanupSemanticLossless=function(e){function t(e,t){if(!e||!t)return 6;var r=e.charAt(e.length-1),i=t.charAt(0),o=r.match(n.nonAlphaNumericRegex_),a=i.match(n.nonAlphaNumericRegex_),l=o&&r.match(n.whitespaceRegex_),s=a&&i.match(n.whitespaceRegex_),c=l&&r.match(n.linebreakRegex_),d=s&&i.match(n.linebreakRegex_),u=c&&e.match(n.blanklineEndRegex_),p=d&&t.match(n.blanklineStartRegex_);return u||p?5:c||d?4:o&&!l&&s?3:l||s?2:o||a?1:0}for(var r=1;r<e.length-1;){if(0==e[r-1][0]&&0==e[r+1][0]){var i=e[r-1][1],o=e[r][1],a=e[r+1][1],l=this.diff_commonSuffix(i,o);if(l){var s=o.substring(o.length-l);i=i.substring(0,i.length-l),o=s+o.substring(0,o.length-l),a=s+a}for(var c=i,d=o,u=a,p=t(i,o)+t(o,a);o.charAt(0)===a.charAt(0);){i+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var f=t(i,o)+t(o,a);f>=p&&(p=f,c=i,d=o,u=a)}e[r-1][1]!=c&&(c?e[r-1][1]=c:(e.splice(r-1,1),r--),e[r][1]=d,u?e[r+1][1]=u:(e.splice(r+1,1),r--))}r++}},n.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,n.whitespaceRegex_=/\s/,n.linebreakRegex_=/[\r\n]/,n.blanklineEndRegex_=/\n\r?\n$/,n.blanklineStartRegex_=/^\r?\n\r?\n/,n.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,r=[],i=0,o=null,a=0,l=!1,s=!1,c=!1,d=!1;a<e.length;)0==e[a][0]?(e[a][1].length<this.Diff_EditCost&&(c||d)?(r[i++]=a,l=c,s=d,o=e[a][1]):(i=0,o=null),c=d=!1):(-1==e[a][0]?d=!0:c=!0,o&&(l&&s&&c&&d||o.length<this.Diff_EditCost/2&&l+s+c+d==3)&&(e.splice(r[i-1],0,new n.Diff(-1,o)),e[r[i-1]+1][0]=1,i--,o=null,l&&s?(c=d=!0,i=0):(a=--i>0?r[i-1]:-1,c=d=!1),t=!0)),a++;t&&this.diff_cleanupMerge(e)},n.prototype.diff_cleanupMerge=function(e){e.push(new n.Diff(0,""));for(var t,r=0,i=0,o=0,a="",l="";r<e.length;)switch(e[r][0]){case 1:o++,l+=e[r][1],r++;break;case-1:i++,a+=e[r][1],r++;break;case 0:i+o>1?(0!==i&&0!==o&&(0!==(t=this.diff_commonPrefix(l,a))&&(r-i-o>0&&0==e[r-i-o-1][0]?e[r-i-o-1][1]+=l.substring(0,t):(e.splice(0,0,new n.Diff(0,l.substring(0,t))),r++),l=l.substring(t),a=a.substring(t)),0!==(t=this.diff_commonSuffix(l,a))&&(e[r][1]=l.substring(l.length-t)+e[r][1],l=l.substring(0,l.length-t),a=a.substring(0,a.length-t))),r-=i+o,e.splice(r,i+o),a.length&&(e.splice(r,0,new n.Diff(-1,a)),r++),l.length&&(e.splice(r,0,new n.Diff(1,l)),r++),r++):0!==r&&0==e[r-1][0]?(e[r-1][1]+=e[r][1],e.splice(r,1)):r++,o=0,i=0,a="",l=""}""===e[e.length-1][1]&&e.pop();var s=!1;for(r=1;r<e.length-1;)0==e[r-1][0]&&0==e[r+1][0]&&(e[r][1].substring(e[r][1].length-e[r-1][1].length)==e[r-1][1]?(e[r][1]=e[r-1][1]+e[r][1].substring(0,e[r][1].length-e[r-1][1].length),e[r+1][1]=e[r-1][1]+e[r+1][1],e.splice(r-1,1),s=!0):e[r][1].substring(0,e[r+1][1].length)==e[r+1][1]&&(e[r-1][1]+=e[r+1][1],e[r][1]=e[r][1].substring(e[r+1][1].length)+e[r+1][1],e.splice(r+1,1),s=!0)),r++;s&&this.diff_cleanupMerge(e)},n.prototype.diff_xIndex=function(e,t){var n,r=0,i=0,o=0,a=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),-1!==e[n][0]&&(i+=e[n][1].length),!(r>t));n++)o=r,a=i;return e.length!=n&&-1===e[n][0]?a:a+(t-o)},n.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,o=/\n/g,a=0;a<e.length;a++){var l=e[a][0],s=e[a][1].replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(o,"&para;<br>");switch(l){case 1:t[a]='<ins style="background:#e6ffe6;">'+s+"</ins>";break;case-1:t[a]='<del style="background:#ffe6e6;">'+s+"</del>";break;case 0:t[a]="<span>"+s+"</span>"}}return t.join("")},n.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},n.prototype.diff_levenshtein=function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var o=e[i][0],a=e[i][1];switch(o){case 1:n+=a.length;break;case-1:r+=a.length;break;case 0:t+=Math.max(n,r),n=0,r=0}}return t+Math.max(n,r)},n.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")},n.prototype.diff_fromDelta=function(e,t){for(var r=[],i=0,o=0,a=t.split(/\t/g),l=0;l<a.length;l++){var s=a[l].substring(1);switch(a[l].charAt(0)){case"+":try{r[i++]=new n.Diff(1,decodeURI(s))}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+s)}break;case"-":case"=":var c=parseInt(s,10);if(isNaN(c)||c<0)throw new Error("Invalid number in diff_fromDelta: "+s);var d=e.substring(o,o+=c);"="==a[l].charAt(0)?r[i++]=new n.Diff(0,d):r[i++]=new n.Diff(-1,d);break;default:if(a[l])throw new Error("Invalid diff operation in diff_fromDelta: "+a[l])}}if(o!=e.length)throw new Error("Delta length ("+o+") does not equal source text length ("+e.length+").");return r},n.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw new Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},n.prototype.match_bitap_=function(e,t,n){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),i=this;function o(e,r){var o=e/t.length,a=Math.abs(n-r);return i.Match_Distance?o+a/i.Match_Distance:a?1:o}var a=this.Match_Threshold,l=e.indexOf(t,n);-1!=l&&(a=Math.min(o(0,l),a),-1!=(l=e.lastIndexOf(t,n+t.length))&&(a=Math.min(o(0,l),a)));var s,c,d=1<<t.length-1;l=-1;for(var u,p=t.length+e.length,f=0;f<t.length;f++){for(s=0,c=p;s<c;)o(f,n+c)<=a?s=c:p=c,c=Math.floor((p-s)/2+s);p=c;var h=Math.max(1,n-c+1),m=Math.min(n+c,e.length)+t.length,v=Array(m+2);v[m+1]=(1<<f)-1;for(var g=m;g>=h;g--){var b=r[e.charAt(g-1)];if(v[g]=0===f?(v[g+1]<<1|1)&b:(v[g+1]<<1|1)&b|(u[g+1]|u[g])<<1|1|u[g+1],v[g]&d){var y=o(f,g-1);if(y<=a){if(a=y,!((l=g-1)>n))break;h=Math.max(1,2*n-l)}}}if(o(f+1,n)>a)break;u=v}return l},n.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},n.prototype.patch_addContext_=function(e,t){if(0!=t.length){if(null===e.start2)throw Error("patch not initialized");for(var r=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(r)!=t.lastIndexOf(r)&&r.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,r=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin;var o=t.substring(e.start2-i,e.start2);o&&e.diffs.unshift(new n.Diff(0,o));var a=t.substring(e.start2+e.length1,e.start2+e.length1+i);a&&e.diffs.push(new n.Diff(0,a)),e.start1-=o.length,e.start2-=o.length,e.length1+=o.length+a.length,e.length2+=o.length+a.length}},n.prototype.patch_make=function(e,t,r){var i,o;if("string"==typeof e&&"string"==typeof t&&void 0===r)i=e,(o=this.diff_main(i,t,!0)).length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(e&&"object"==typeof e&&void 0===t&&void 0===r)o=e,i=this.diff_text1(o);else if("string"==typeof e&&t&&"object"==typeof t&&void 0===r)i=e,o=t;else{if("string"!=typeof e||"string"!=typeof t||!r||"object"!=typeof r)throw new Error("Unknown call format to patch_make.");i=e,o=r}if(0===o.length)return[];for(var a=[],l=new n.patch_obj,s=0,c=0,d=0,u=i,p=i,f=0;f<o.length;f++){var h=o[f][0],m=o[f][1];switch(s||0===h||(l.start1=c,l.start2=d),h){case 1:l.diffs[s++]=o[f],l.length2+=m.length,p=p.substring(0,d)+m+p.substring(d);break;case-1:l.length1+=m.length,l.diffs[s++]=o[f],p=p.substring(0,d)+p.substring(d+m.length);break;case 0:m.length<=2*this.Patch_Margin&&s&&o.length!=f+1?(l.diffs[s++]=o[f],l.length1+=m.length,l.length2+=m.length):m.length>=2*this.Patch_Margin&&s&&(this.patch_addContext_(l,u),a.push(l),l=new n.patch_obj,s=0,u=p,c=d)}1!==h&&(c+=m.length),-1!==h&&(d+=m.length)}return s&&(this.patch_addContext_(l,u),a.push(l)),a},n.prototype.patch_deepCopy=function(e){for(var t=[],r=0;r<e.length;r++){var i=e[r],o=new n.patch_obj;o.diffs=[];for(var a=0;a<i.diffs.length;a++)o.diffs[a]=new n.Diff(i.diffs[a][0],i.diffs[a][1]);o.start1=i.start1,o.start2=i.start2,o.length1=i.length1,o.length2=i.length2,t[r]=o}return t},n.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var r=0,i=[],o=0;o<e.length;o++){var a,l,s=e[o].start2+r,c=this.diff_text1(e[o].diffs),d=-1;if(c.length>this.Match_MaxBits?-1!=(a=this.match_main(t,c.substring(0,this.Match_MaxBits),s))&&(-1==(d=this.match_main(t,c.substring(c.length-this.Match_MaxBits),s+c.length-this.Match_MaxBits))||a>=d)&&(a=-1):a=this.match_main(t,c,s),-1==a)i[o]=!1,r-=e[o].length2-e[o].length1;else if(i[o]=!0,r=a-s,c==(l=-1==d?t.substring(a,a+c.length):t.substring(a,d+this.Match_MaxBits)))t=t.substring(0,a)+this.diff_text2(e[o].diffs)+t.substring(a+c.length);else{var u=this.diff_main(c,l,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(u)/c.length>this.Patch_DeleteThreshold)i[o]=!1;else{this.diff_cleanupSemanticLossless(u);for(var p,f=0,h=0;h<e[o].diffs.length;h++){var m=e[o].diffs[h];0!==m[0]&&(p=this.diff_xIndex(u,f)),1===m[0]?t=t.substring(0,a+p)+m[1]+t.substring(a+p):-1===m[0]&&(t=t.substring(0,a+p)+t.substring(a+this.diff_xIndex(u,f+m[1].length))),-1!==m[0]&&(f+=m[1].length)}}}}return[t=t.substring(n.length,t.length-n.length),i]},n.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,r="",i=1;i<=t;i++)r+=String.fromCharCode(i);for(i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var o=e[0],a=o.diffs;if(0==a.length||0!=a[0][0])a.unshift(new n.Diff(0,r)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>a[0][1].length){var l=t-a[0][1].length;a[0][1]=r.substring(a[0][1].length)+a[0][1],o.start1-=l,o.start2-=l,o.length1+=l,o.length2+=l}return 0==(a=(o=e[e.length-1]).diffs).length||0!=a[a.length-1][0]?(a.push(new n.Diff(0,r)),o.length1+=t,o.length2+=t):t>a[a.length-1][1].length&&(l=t-a[a.length-1][1].length,a[a.length-1][1]+=r.substring(0,l),o.length1+=l,o.length2+=l),r},n.prototype.patch_splitMax=function(e){for(var t=this.Match_MaxBits,r=0;r<e.length;r++)if(!(e[r].length1<=t)){var i=e[r];e.splice(r--,1);for(var o=i.start1,a=i.start2,l="";0!==i.diffs.length;){var s=new n.patch_obj,c=!0;for(s.start1=o-l.length,s.start2=a-l.length,""!==l&&(s.length1=s.length2=l.length,s.diffs.push(new n.Diff(0,l)));0!==i.diffs.length&&s.length1<t-this.Patch_Margin;){var d=i.diffs[0][0],u=i.diffs[0][1];1===d?(s.length2+=u.length,a+=u.length,s.diffs.push(i.diffs.shift()),c=!1):-1===d&&1==s.diffs.length&&0==s.diffs[0][0]&&u.length>2*t?(s.length1+=u.length,o+=u.length,c=!1,s.diffs.push(new n.Diff(d,u)),i.diffs.shift()):(u=u.substring(0,t-s.length1-this.Patch_Margin),s.length1+=u.length,o+=u.length,0===d?(s.length2+=u.length,a+=u.length):c=!1,s.diffs.push(new n.Diff(d,u)),u==i.diffs[0][1]?i.diffs.shift():i.diffs[0][1]=i.diffs[0][1].substring(u.length))}l=(l=this.diff_text2(s.diffs)).substring(l.length-this.Patch_Margin);var p=this.diff_text1(i.diffs).substring(0,this.Patch_Margin);""!==p&&(s.length1+=p.length,s.length2+=p.length,0!==s.diffs.length&&0===s.diffs[s.diffs.length-1][0]?s.diffs[s.diffs.length-1][1]+=p:s.diffs.push(new n.Diff(0,p))),c||e.splice(++r,0,s)}}},n.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},n.prototype.patch_fromText=function(e){var t=[];if(!e)return t;for(var r=e.split("\n"),i=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<r.length;){var a=r[i].match(o);if(!a)throw new Error("Invalid patch string: "+r[i]);var l=new n.patch_obj;for(t.push(l),l.start1=parseInt(a[1],10),""===a[2]?(l.start1--,l.length1=1):"0"==a[2]?l.length1=0:(l.start1--,l.length1=parseInt(a[2],10)),l.start2=parseInt(a[3],10),""===a[4]?(l.start2--,l.length2=1):"0"==a[4]?l.length2=0:(l.start2--,l.length2=parseInt(a[4],10)),i++;i<r.length;){var s=r[i].charAt(0);try{var c=decodeURI(r[i].substring(1))}catch(e){throw new Error("Illegal escape in patch_fromText: "+c)}if("-"==s)l.diffs.push(new n.Diff(-1,c));else if("+"==s)l.diffs.push(new n.Diff(1,c));else if(" "==s)l.diffs.push(new n.Diff(0,c));else{if("@"==s)break;if(""!==s)throw new Error('Invalid patch mode "'+s+'" in: '+c)}i++}}return t},(n.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0}).prototype.toString=function(){for(var e,t=["@@ -"+(0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1)+" +"+(0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],n=0;n<this.diffs.length;n++){switch(this.diffs[n][0]){case 1:e="+";break;case-1:e="-";break;case 0:e=" "}t[n+1]=e+encodeURI(this.diffs[n][1])+"\n"}return t.join("").replace(/%20/g," ")},e.exports=n,e.exports.diff_match_patch=n,e.exports.DIFF_DELETE=-1,e.exports.DIFF_INSERT=1,e.exports.DIFF_EQUAL=0},function(e,t,n){"use strict";n.r(t);var r,i,o=n(23),a=n(2),l=n(9),s=function(e){return"sv"===e.currentMode?Object(l.a)((e.sv.element.textContent+"\n").replace(/\n\n$/,"\n")):"wysiwyg"===e.currentMode?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):"ir"===e.currentMode?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},c=n(5),d=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(e){var t=this;"block"===e.devtools.element.style.display&&Object(c.a)(e.options.cdn+"/dist/js/echarts/echarts.min.js","vditorEchartsScript").then((function(){t.ASTChart||(t.ASTChart=echarts.init(e.devtools.element.lastElementChild));try{t.element.lastElementChild.style.display="block",t.element.firstElementChild.innerHTML="",t.ASTChart.setOption({series:[{data:JSON.parse(e.lute.RenderEChartsJSON(s(e))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),t.ASTChart.resize()}catch(e){t.element.lastElementChild.style.display="none",t.element.firstElementChild.innerHTML=e}}))},e}(),u=n(3),p=function(e,t){t.forEach((function(t){if(e[t]){var n=e[t].children[0];n&&n.classList.contains("vditor-menu--current")&&n.classList.remove("vditor-menu--current")}}))},f=function(e,t){t.forEach((function(t){if(e[t]){var n=e[t].children[0];n&&!n.classList.contains("vditor-menu--current")&&n.classList.add("vditor-menu--current")}}))},h=function(e,t){t.forEach((function(t){if(e[t]){var n=e[t].children[0];n&&n.classList.contains(a.a.CLASS_MENU_DISABLED)&&n.classList.remove(a.a.CLASS_MENU_DISABLED)}}))},m=function(e,t){t.forEach((function(t){if(e[t]){var n=e[t].children[0];n&&!n.classList.contains(a.a.CLASS_MENU_DISABLED)&&n.classList.add(a.a.CLASS_MENU_DISABLED)}}))},v=function(e,t){t.forEach((function(t){e[t]&&e[t]&&(e[t].style.display="none")}))},g=function(e,t){t.forEach((function(t){e[t]&&e[t]&&(e[t].style.display="block")}))},b=function(e,t,n){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach((function(e){n&&e.isEqualNode(n)||(e.style.display="none")})),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},y=function(e,t,n,r){n.addEventListener(Object(u.b)(),(function(r){r.preventDefault(),r.stopPropagation(),n.classList.contains(a.a.CLASS_MENU_DISABLED)||(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach((function(e){e.classList.remove("vditor-hint--current")})),"block"===t.style.display?t.style.display="none":(b(e,["subToolbar","hint","popover"],n.parentElement.parentElement),n.classList.contains("vditor-tooltipped")||n.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-n.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))}))},w=n(1),C=n(6),k=function(e,t,n,r){r&&console.log(e+" - "+n+": "+t)},S=n(10),E=n(11),_=n(12),x=n(13),T=n(14),O=n(15),L=n(16),A=n(17),j=function(e,t){if(e){var n=e.querySelector("code");if(n){var r=n.className.replace("language-","");if("abc"===r)Object(S.a)(e,t.options.cdn);else if("mermaid"===r)Object(L.a)(e,".vditor-"+t.currentMode+"__preview .language-mermaid",t.options.cdn);else if("echarts"===r)Object(E.a)(e,t.options.cdn);else if("mindmap"===r)Object(A.a)(e,t.options.cdn);else if("graphviz"===r)Object(x.a)(e,t.options.cdn);else if("math"===r){var i="div";"SPAN"===e.tagName&&(i="span"),e.innerHTML='<code class="language-math"><'+i+' class="vditor-math">'+e.innerHTML+"</"+i+"></code>",Object(O.a)(e.parentElement,{cdn:t.options.cdn,math:t.options.preview.math})}else Object(T.a)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),Object(_.a)(e,t.options.lang);e.setAttribute("data-render","1")}else"html-block"===e.parentElement.getAttribute("data-type")&&(e.style.backgroundColor="var(--preview-background-color)",e.style.padding="0.2em 0.4em",e.setAttribute("data-render","1"))}},M=n(0),R=function(e,t,n,r){void 0===n&&(n=!1);var i=Object(w.c)(t.startContainer);if(i&&!n&&"code-block"!==i.getAttribute("data-type")){if($e(i.innerHTML)&&i.previousElementSibling||Ve(i.innerHTML))return;for(var o=Object(M.c)(i,e.ir.element,t).start,l=!0,s=o-1;s>i.textContent.substr(0,o).lastIndexOf("\n");s--)if(" "!==i.textContent.charAt(s)&&"\t"!==i.textContent.charAt(s)){l=!1;break}0===o&&(l=!1);var c=!0;for(s=o-1;s<i.textContent.length;s++)if(" "!==i.textContent.charAt(s)&&"\n"!==i.textContent.charAt(s)){c=!1;break}if(l)return;if(c&&!Object(w.e)(t.startContainer,"vditor-ir__marker")){var d=t.startContainer.previousSibling;return void(d&&3!==d.nodeType&&d.classList.contains("vditor-ir__node--expand")&&d.classList.remove("vditor-ir__node--expand"))}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach((function(e){e.classList.remove("vditor-ir__node--expand")})),i||(i=e.ir.element),!i.querySelector("wbr")){var u=Object(w.e)(t.startContainer,"vditor-ir__preview");u?u.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}i.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),"link-ref-defs-block"===i.getAttribute("data-type")&&(i=e.ir.element);var p=i.isEqualNode(e.ir.element),f=Object(w.d)(i,"data-type","footnotes-block"),h="";if(p)h=i.innerHTML;else{var m,v,g=Object(C.b)(t.startContainer,"BLOCKQUOTE"),b=Object(w.b)(t.startContainer);if(b&&(i=b),g&&(!b||b&&!g.contains(b))&&(i=g),f&&(i=f),h=i.outerHTML,"UL"===i.tagName||"OL"===i.tagName){var y=i.previousElementSibling,S=i.nextElementSibling;!y||"UL"!==y.tagName&&"OL"!==y.tagName||(h=y.outerHTML+h,y.remove()),!S||"UL"!==S.tagName&&"OL"!==S.tagName||(h+=S.outerHTML,S.remove()),h=h.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else i.previousElementSibling&&""!==i.previousElementSibling.textContent.replace(a.a.ZWSP,"")&&r&&"insertParagraph"===r.inputType&&(h=i.previousElementSibling.outerHTML+h,i.previousElementSibling.remove());(m=e.ir.element.querySelector("[data-type='link-ref-defs-block']"))&&!i.isEqualNode(m)&&(h+=m.outerHTML,m.remove()),(v=e.ir.element.querySelector("[data-type='footnotes-block']"))&&!i.isEqualNode(v)&&(h+=v.outerHTML,v.remove())}if(k("SpinVditorIRDOM",h,"argument",e.options.debugger),h=e.lute.SpinVditorIRDOM(h),k("SpinVditorIRDOM",h,"result",e.options.debugger),p)i.innerHTML=h;else if(i.outerHTML=h,(m=e.ir.element.querySelector("[data-type='link-ref-defs-block']"))&&e.ir.element.insertAdjacentElement("beforeend",m),(v=e.ir.element.querySelector("[data-type='footnotes-block']"))&&e.ir.element.insertAdjacentElement("beforeend",v),f){var E=Object(w.d)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(E){var _=E.textContent,x=_.substring(1,_.indexOf("]:")),T=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'+x+'"]');T&&T.setAttribute("aria-label",_.substr(x.length+3).trim().substr(0,24))}}Object(M.f)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(t){j(t,e)})),Xe(e),pt(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},H=function(e,t){var n=Object(u.g)(e).split("-"),r=n.length>2&&("shift"===n[1]||"⇧"===n[1]),i=(r?n[2]:n[1])||"-";return!r||"-"!==i||!Object(u.e)()&&/Mac/.test(navigator.platform)||(i="_"),!(!Object(u.d)(t)||t.key.toLowerCase()!==i.toLowerCase()||t.altKey||!(!r&&!t.shiftKey||r&&t.shiftKey))},D=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach((function(e){e.classList.remove("vditor-ir__node--expand")}));var n=Object(w.g)(e.startContainer,"vditor-ir__node"),r=!e.collapsed&&Object(w.g)(e.endContainer,"vditor-ir__node");if(e.collapsed||n&&n===r){n&&(n.classList.add("vditor-ir__node--expand"),n.classList.remove("vditor-ir__node--hidden"),Object(M.h)(e));var i=function(e){var t=e.startContainer;if(3===t.nodeType&&t.nodeValue.length!==e.startOffset)return!1;for(var n=t.nextSibling;n&&""===n.textContent;)n=n.nextSibling;if(!n){var r=Object(w.e)(t,"vditor-ir__marker");if(r&&!r.nextSibling){var i=t.parentElement.parentElement.nextSibling;if(i&&3!==i.nodeType&&i.classList.contains("vditor-ir__node"))return i}return!1}return!(!n||3===n.nodeType||!n.classList.contains("vditor-ir__node")||n.getAttribute("data-block"))&&n}(e);if(i)return i.classList.add("vditor-ir__node--expand"),void i.classList.remove("vditor-ir__node--hidden");var o=function(e){var t=e.startContainer,n=t.previousSibling;return!(3!==t.nodeType||0!==e.startOffset||!n||3===n.nodeType||!n.classList.contains("vditor-ir__node")||n.getAttribute("data-block"))&&n}(e);return o?(o.classList.add("vditor-ir__node--expand"),void o.classList.remove("vditor-ir__node--hidden")):void 0}},N=function(e,t){var n,r=getSelection().getRangeAt(0).cloneRange(),i=r.startContainer;3!==r.startContainer.nodeType&&"DIV"===r.startContainer.tagName&&(i=r.startContainer.childNodes[r.startOffset-1]);var o=Object(w.d)(i,"data-block","0");if(o&&t&&("deleteContentBackward"===t.inputType||" "===t.data)){for(var a=Object(M.c)(o,e.sv.element,r).start,l=!0,s=a-1;s>o.textContent.substr(0,a).lastIndexOf("\n");s--)if(" "!==o.textContent.charAt(s)&&"\t"!==o.textContent.charAt(s)){l=!1;break}if(0===a&&(l=!1),l)return void Oe(e);if("deleteContentBackward"===t.inputType){var c=Object(w.d)(i,"data-type","code-block-open-marker")||Object(w.d)(i,"data-type","code-block-close-marker");if(c){var d;if("code-block-close-marker"===c.getAttribute("data-type")&&(d=_e(i,"code-block-open-marker")))return d.textContent=c.textContent,void Oe(e);if("code-block-open-marker"===c.getAttribute("data-type")&&(d=_e(i,"code-block-close-marker",!1)))return d.textContent=c.textContent,void Oe(e)}o.querySelectorAll('[data-type="code-block-open-marker"]').forEach((function(e){1===e.textContent.length&&e.remove()})),o.querySelectorAll('[data-type="code-block-close-marker"]').forEach((function(e){1===e.textContent.length&&e.remove()}));var u=Object(w.d)(i,"data-type","heading-marker");if(u&&-1===u.textContent.indexOf("#"))return void Oe(e)}if((" "===t.data||"deleteContentBackward"===t.inputType)&&(Object(w.d)(i,"data-type","padding")||Object(w.d)(i,"data-type","li-marker")||Object(w.d)(i,"data-type","task-marker")||Object(w.d)(i,"data-type","blockquote-marker")))return void Oe(e)}if(o&&"$$"===o.textContent.trimRight())Oe(e);else{o||(o=e.sv.element),"link-ref-defs-block"===(null===(n=o.firstElementChild)||void 0===n?void 0:n.getAttribute("data-type"))&&(o=e.sv.element),Object(w.d)(i,"data-type","footnotes-link")&&(o=e.sv.element),-1===o.textContent.indexOf(Lute.Caret)&&r.insertNode(document.createTextNode(Lute.Caret)),o.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),o.querySelectorAll("font").forEach((function(e){e.outerHTML=e.innerHTML}));var p,f,h=o.textContent,m=o.isEqualNode(e.sv.element);m?h=o.textContent:(o.previousElementSibling&&(h=o.previousElementSibling.textContent+h,o.previousElementSibling.remove()),o.previousElementSibling&&0===h.indexOf("---\n")&&(h=o.previousElementSibling.textContent+h,o.previousElementSibling.remove()),(p=e.sv.element.querySelector("[data-type='link-ref-defs-block']"))&&!o.isEqualNode(p.parentElement)&&(h+=p.parentElement.textContent,p.parentElement.remove()),(f=e.sv.element.querySelector("[data-type='footnotes-link']"))&&!o.isEqualNode(f.parentElement)&&(h+=f.parentElement.textContent,f.parentElement.remove())),h=xe(h,e),m?o.innerHTML=h:(o.outerHTML=h,(p=e.sv.element.querySelector("[data-type='link-ref-defs-block']"))&&e.sv.element.insertAdjacentElement("beforeend",p.parentElement),(f=e.sv.element.querySelector("[data-type='footnotes-link']"))&&e.sv.element.insertAdjacentElement("beforeend",f.parentElement)),Object(M.f)(e.sv.element,r),Ce(e),Oe(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})}},P=n(4),I=n(8),q=function(e){"dark"===e.options.theme?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},B=function(e){var t=window.innerWidth<=a.a.MOBILE_WIDTH?10:35;if("none"!==e.wysiwyg.element.parentElement.style.display){var n=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px "+Math.max(t,n)+"px"}"none"!==e.ir.element.parentElement.style.display&&(n=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2,e.ir.element.style.padding="10px "+Math.max(t,n)+"px"),"block"===e.preview.element.style.display&&"sv"!==e.currentMode||(e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+e.outline.element.offsetWidth)+"px")},U=function(e){if(e.options.typewriterMode){var t=window.innerHeight;"number"==typeof e.options.height&&(t=e.options.height,"number"==typeof e.options.minHeight&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)),e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}},F=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout((function(){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")&&Object(M.e)(e[e.currentMode].element)){p(e.toolbar.elements,a.a.EDIT_TOOLBARS),h(e.toolbar.elements,a.a.EDIT_TOOLBARS);var t=Object(M.b)(e[e.currentMode].element),n=t.startContainer;3===t.startContainer.nodeType&&(n=t.startContainer.parentElement),n.classList.contains("vditor-reset")&&(n=n.childNodes[t.startOffset]),("sv"===e.currentMode?Object(w.d)(n,"data-type","heading"):Object(C.a)(n))&&f(e.toolbar.elements,["headings"]),("sv"===e.currentMode?Object(w.d)(n,"data-type","blockquote"):Object(w.f)(n,"BLOCKQUOTE"))&&f(e.toolbar.elements,["quote"]),Object(w.d)(n,"data-type","strong")&&f(e.toolbar.elements,["bold"]),Object(w.d)(n,"data-type","em")&&f(e.toolbar.elements,["italic"]),Object(w.d)(n,"data-type","s")&&f(e.toolbar.elements,["strike"]),Object(w.d)(n,"data-type","a")&&f(e.toolbar.elements,["link"]);var r=Object(w.f)(n,"LI");r?(r.classList.contains("vditor-task")?f(e.toolbar.elements,["check"]):"OL"===r.parentElement.tagName?f(e.toolbar.elements,["ordered-list"]):"UL"===r.parentElement.tagName&&f(e.toolbar.elements,["list"]),h(e.toolbar.elements,["outdent","indent"])):m(e.toolbar.elements,["outdent","indent"]),Object(w.d)(n,"data-type","code-block")&&(m(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),f(e.toolbar.elements,["code"])),Object(w.d)(n,"data-type","code")&&(m(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),f(e.toolbar.elements,["inline-code"])),Object(w.d)(n,"data-type","table")&&m(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}}),200)},K=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout((function(){if(!e.wysiwyg.composingLock){var n=s(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(n),e.options.counter.enable&&e.counter.render(e,n),e.options.cache.enable&&Object(u.a)()&&(localStorage.setItem(e.options.cache.id,n),e.options.cache.after&&e.options.cache.after(n)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}}),800)},z=function(e){for(var t="",n=e.nextSibling;n;)3===n.nodeType?t+=n.textContent:t+=n.outerHTML,n=n.nextSibling;return t},$=function(e){for(var t="",n=e.previousSibling;n;)t=3===n.nodeType?n.textContent+t:n.outerHTML+t,n=n.previousSibling;return t},V=function(e,t){Array.from(e.wysiwyg.element.childNodes).find((function(n){if(3===n.nodeType){var r=document.createElement("p");r.setAttribute("data-block","0"),r.textContent=n.textContent;var i=3===t.startContainer.nodeType?t.startOffset:n.textContent.length;return n.parentNode.insertBefore(r,n),n.remove(),t.setStart(r.firstChild,Math.min(r.firstChild.textContent.length,i)),t.collapse(!0),Object(M.h)(t),!0}if(!n.getAttribute("data-block"))return"P"===n.tagName?n.remove():("DIV"===n.tagName?(t.insertNode(document.createElement("wbr")),n.outerHTML='<p data-block="0">'+n.innerHTML+"</p>"):"BR"===n.tagName?n.outerHTML='<p data-block="0">'+n.outerHTML+"<wbr></p>":(t.insertNode(document.createElement("wbr")),n.outerHTML='<p data-block="0">'+n.outerHTML+"</p>"),Object(M.f)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0}))},W=function(e,t){var n=Object(M.b)(e.wysiwyg.element),r=Object(w.c)(n.startContainer);r||(r=n.startContainer.childNodes[n.startOffset]),r||0!==e.wysiwyg.element.children.length||(r=e.wysiwyg.element),r&&!r.classList.contains("vditor-wysiwyg__block")&&(n.insertNode(document.createElement("wbr")),"<wbr>"===r.innerHTML.trim()&&(r.innerHTML="<wbr><br>"),"BLOCKQUOTE"===r.tagName||r.classList.contains("vditor-reset")?r.innerHTML="<"+t+' data-block="0">'+r.innerHTML.trim()+"</"+t+">":r.outerHTML="<"+t+' data-block="0">'+r.innerHTML.trim()+"</"+t+">",Object(M.f)(e.wysiwyg.element,n),Xe(e))},X=function(e){var t=getSelection().getRangeAt(0),n=Object(w.c)(t.startContainer);n||(n=t.startContainer.childNodes[t.startOffset]),n&&(t.insertNode(document.createElement("wbr")),n.outerHTML='<p data-block="0">'+n.innerHTML+"</p>",Object(M.f)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},G=function(e,t,n){void 0===n&&(n=!0);var r=e.previousElementSibling,i=r.ownerDocument.createRange();"CODE"===r.tagName?(r.style.display="inline-block",n?i.setStart(r.firstChild,1):i.selectNodeContents(r)):(r.style.display="block",r.firstChild.firstChild||r.firstChild.appendChild(document.createTextNode("")),i.selectNodeContents(r.firstChild)),n?i.collapse(!0):i.collapse(!1),Object(M.h)(i),e.firstElementChild.classList.contains("language-mindmap")||Ce(t)},J=function(e,t){if(H("⌘-⇧-X",t)){var n=e.wysiwyg.popover.querySelector('[data-type="remove"]');if(n)return n.click(),t.preventDefault(),!0}},Z=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout((function(){var t;if("false"!==e.wysiwyg.element.getAttribute("contenteditable")&&Object(M.e)(e.wysiwyg.element)){p(e.toolbar.elements,a.a.EDIT_TOOLBARS),h(e.toolbar.elements,a.a.EDIT_TOOLBARS);var n=getSelection().getRangeAt(0),r=n.startContainer;r=3===n.startContainer.nodeType?n.startContainer.parentElement:r.childNodes[n.startOffset>=r.childNodes.length?r.childNodes.length-1:n.startOffset];var i=Object(w.d)(r,"data-type","footnotes-block");if(i)return e.wysiwyg.popover.innerHTML="",ne(i,e),void Y(e,i);var o=Object(w.f)(r,"LI");o?(o.classList.contains("vditor-task")?f(e.toolbar.elements,["check"]):"OL"===o.parentElement.tagName?f(e.toolbar.elements,["ordered-list"]):"UL"===o.parentElement.tagName&&f(e.toolbar.elements,["list"]),h(e.toolbar.elements,["outdent","indent"])):m(e.toolbar.elements,["outdent","indent"]),Object(w.f)(r,"BLOCKQUOTE")&&f(e.toolbar.elements,["quote"]),(Object(w.f)(r,"B")||Object(w.f)(r,"STRONG"))&&f(e.toolbar.elements,["bold"]),(Object(w.f)(r,"I")||Object(w.f)(r,"EM"))&&f(e.toolbar.elements,["italic"]),(Object(w.f)(r,"STRIKE")||Object(w.f)(r,"S"))&&f(e.toolbar.elements,["strike"]);var l=Object(w.f)(r,"A");l&&f(e.toolbar.elements,["link"]);var s=Object(w.f)(r,"TABLE"),c=Object(C.a)(r);Object(w.f)(r,"CODE")?Object(w.f)(r,"PRE")?(m(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),f(e.toolbar.elements,["code"])):(m(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),f(e.toolbar.elements,["inline-code"])):c?(m(e.toolbar.elements,["bold"]),f(e.toolbar.elements,["headings"])):s&&m(e.toolbar.elements,["table"]);var d=Object(w.e)(r,"vditor-toc");d||(B=Object(w.d)(r,"data-block","0"))&&(null===(t=B.previousElementSibling)||void 0===t?void 0:t.classList.contains("vditor-toc"))&&(d=B.previousElementSibling),d&&(e.wysiwyg.popover.innerHTML="",ne(d,e),Y(e,d));var v=Object(C.b)(r,"BLOCKQUOTE");if(v&&(e.wysiwyg.popover.innerHTML="",ee(n,v,e),te(n,v,e),ne(v,e),Y(e,v)),o&&(e.wysiwyg.popover.innerHTML="",ee(n,o,e),te(n,o,e),ne(o,e),Y(e,o)),s){e.wysiwyg.popover.innerHTML="";var g=function(){var e=s.rows.length,t=s.rows[0].cells.length,n=parseInt(R.value,10)||e,r=parseInt(D.value,10)||t;if(n!==e||t!==r){if(t!==r)for(var i=r-t,o=0;o<s.rows.length;o++)if(i>0)for(var a=0;a<i;a++)0===o?s.rows[o].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):s.rows[o].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var l=t-1;l>=r;l--)s.rows[o].cells[l].remove();if(e!==n){var c=n-e;if(c>0){for(var d="<tr>",u=0;u<r;u++)d+="<td> </td>";for(var p=0;p<c;p++)s.querySelector("tbody")?s.querySelector("tbody").insertAdjacentHTML("beforeend",d):s.querySelector("thead").insertAdjacentHTML("afterend",d+"</tr>")}else for(u=e-1;u>=n;u--)s.rows[u].remove(),1===s.rows.length&&s.querySelector("tbody").remove()}}},b=function(t){ze(s,t),"right"===t?(E.classList.remove("vditor-icon--current"),_.classList.remove("vditor-icon--current"),x.classList.add("vditor-icon--current")):"center"===t?(E.classList.remove("vditor-icon--current"),x.classList.remove("vditor-icon--current"),_.classList.add("vditor-icon--current")):(_.classList.remove("vditor-icon--current"),x.classList.remove("vditor-icon--current"),E.classList.add("vditor-icon--current")),Object(M.h)(n),K(e)},y=Object(w.f)(r,"TD"),k=Object(w.f)(r,"TH"),S="left";y?S=y.getAttribute("align")||"left":k&&(S=k.getAttribute("align")||"center");var E=document.createElement("button");E.setAttribute("type","button"),E.setAttribute("aria-label",P.a[e.options.lang].alignLeft+"<"+Object(u.g)("⌘-⇧-L")+">"),E.setAttribute("data-type","left"),E.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',E.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("left"===S?" vditor-icon--current":""),E.onclick=function(){b("left")};var _=document.createElement("button");_.setAttribute("type","button"),_.setAttribute("aria-label",P.a[e.options.lang].alignCenter+"<"+Object(u.g)("⌘-⇧-C")+">"),_.setAttribute("data-type","center"),_.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',_.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("center"===S?" vditor-icon--current":""),_.onclick=function(){b("center")};var x=document.createElement("button");x.setAttribute("type","button"),x.setAttribute("aria-label",P.a[e.options.lang].alignRight+"<"+Object(u.g)("⌘-⇧-R")+">"),x.setAttribute("data-type","right"),x.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',x.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+("right"===S?" vditor-icon--current":""),x.onclick=function(){b("right")};var T=document.createElement("button");T.setAttribute("type","button"),T.setAttribute("aria-label",P.a[e.options.lang]["insert-row"]+"<"+Object(u.g)("⌘-=")+">"),T.setAttribute("data-type","insertRow"),T.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',T.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",T.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,r=Object(w.f)(t,"TD")||Object(w.f)(t,"TH");r&&Qe(e,n,r)};var O=document.createElement("button");O.setAttribute("type","button"),O.setAttribute("aria-label",P.a[e.options.lang]["insert-column"]+"<"+Object(u.g)("⌘-⇧-=")+">"),O.setAttribute("data-type","insertColumn"),O.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',O.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",O.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,n=Object(w.f)(t,"TD")||Object(w.f)(t,"TH");n&&rt(e,s,n)};var L=document.createElement("button");L.setAttribute("type","button"),L.setAttribute("aria-label",P.a[e.options.lang]["delete-row"]+"<"+Object(u.g)("⌘--")+">"),L.setAttribute("data-type","deleteRow"),L.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',L.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",L.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,r=Object(w.f)(t,"TD")||Object(w.f)(t,"TH");r&&et(e,n,r)};var A=document.createElement("button");A.setAttribute("type","button"),A.setAttribute("aria-label",P.a[e.options.lang]["delete-column"]+"<"+Object(u.g)("⌘-⇧--")+">"),A.setAttribute("data-type","deleteColumn"),A.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',A.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",A.onclick=function(){var t=getSelection().getRangeAt(0).startContainer,r=Object(w.f)(t,"TD")||Object(w.f)(t,"TH");r&&tt(e,n,s,r)},(V=document.createElement("span")).setAttribute("aria-label",P.a[e.options.lang].row),V.className="vditor-tooltipped vditor-tooltipped__n";var R=document.createElement("input");V.appendChild(R),R.type="number",R.min="1",R.className="vditor-input",R.style.width="42px",R.style.textAlign="center",R.setAttribute("placeholder",P.a[e.options.lang].row),R.value=s.rows.length.toString(),R.oninput=function(){g()},R.onkeydown=function(t){if(!t.isComposing)return"Tab"===t.key?(D.focus(),D.select(),void t.preventDefault()):void J(e,t)};var H=document.createElement("span");H.setAttribute("aria-label",P.a[e.options.lang].column),H.className="vditor-tooltipped vditor-tooltipped__n";var D=document.createElement("input");H.appendChild(D),D.type="number",D.min="1",D.className="vditor-input",D.style.width="42px",D.style.textAlign="center",D.setAttribute("placeholder",P.a[e.options.lang].column),D.value=s.rows[0].cells.length.toString(),D.oninput=function(){g()},D.onkeydown=function(t){if(!t.isComposing)return"Tab"===t.key?(R.focus(),R.select(),void t.preventDefault()):void J(e,t)},ee(n,s,e),te(n,s,e),ne(s,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",E),e.wysiwyg.popover.insertAdjacentElement("beforeend",_),e.wysiwyg.popover.insertAdjacentElement("beforeend",x),e.wysiwyg.popover.insertAdjacentElement("beforeend",T),e.wysiwyg.popover.insertAdjacentElement("beforeend",O),e.wysiwyg.popover.insertAdjacentElement("beforeend",L),e.wysiwyg.popover.insertAdjacentElement("beforeend",A),e.wysiwyg.popover.insertAdjacentElement("beforeend",V),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",H),Y(e,s)}var N=Object(w.d)(r,"data-type","link-ref");N&&Q(e,N);var I=Object(w.d)(r,"data-type","footnotes-ref");if(I){e.wysiwyg.popover.innerHTML="",(V=document.createElement("span")).setAttribute("aria-label",P.a[e.options.lang].footnoteRef+"<"+Object(u.g)("⌥-Enter")+">"),V.className="vditor-tooltipped vditor-tooltipped__n";var q=document.createElement("input");V.appendChild(q),q.className="vditor-input",q.setAttribute("placeholder",P.a[e.options.lang].footnoteRef+"<"+Object(u.g)("⌥-Enter")+">"),q.style.width="120px",q.value=I.getAttribute("data-footnotes-label"),q.oninput=function(){""!==q.value.trim()&&I.setAttribute("data-footnotes-label",q.value)},q.onkeydown=function(t){if(!t.isComposing)return Object(u.d)(t)||t.shiftKey||!t.altKey||"Enter"!==t.key?void J(e,t):(n.selectNodeContents(I),n.collapse(!1),Object(M.h)(n),void t.preventDefault())},ne(I,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",V),Y(e,I)}var B,U=Object(w.e)(r,"vditor-wysiwyg__block");if(U&&U.getAttribute("data-type").indexOf("block")>-1){if(e.wysiwyg.popover.innerHTML="",ee(n,U,e),te(n,U,e),ne(U,e),"code-block"===U.getAttribute("data-type")){var F=document.createElement("span");F.setAttribute("aria-label",P.a[e.options.lang].language+"<"+Object(u.g)("⌥-Enter")+">"),F.className="vditor-tooltipped vditor-tooltipped__n";var z=document.createElement("input");F.appendChild(z);var $=U.firstElementChild.firstElementChild;z.className="vditor-input",z.setAttribute("placeholder",P.a[e.options.lang].language+"<"+Object(u.g)("⌥-Enter")+">"),z.value=$.className.indexOf("language-")>-1?$.className.split("-")[1].split(" ")[0]:"",z.oninput=function(){""!==z.value.trim()?$.className="language-"+z.value:($.className="",e.hint.recentLanguage=""),U.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(U.lastElementChild.innerHTML=U.firstElementChild.innerHTML,j(U.lastElementChild,e)),K(e)},z.onkeydown=function(t){if(!t.isComposing&&!J(e,t)){if("Escape"===t.key&&"block"===e.hint.element.style.display)return e.hint.element.style.display="none",void t.preventDefault();Object(u.d)(t)||t.shiftKey||!t.altKey||"Enter"!==t.key||(n.setStart($.firstChild,0),n.collapse(!0),Object(M.h)(n)),e.hint.select(t,e)}},z.onkeyup=function(t){if(!t.isComposing&&"Enter"!==t.key&&"ArrowUp"!==t.key&&"Escape"!==t.key&&"ArrowDown"!==t.key){var n=[],r=z.value.substring(0,z.selectionStart);a.a.CODE_LANGUAGES.forEach((function(e){e.indexOf(r.toLowerCase())>-1&&n.push({html:e,value:e})})),e.hint.genHTML(n,r,e),t.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",F)}Y(e,U)}else U||e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach((function(e){e.previousElementSibling.style.display="none"})),U=void 0;if(c){var V;e.wysiwyg.popover.innerHTML="",(V=document.createElement("span")).setAttribute("aria-label","ID<"+Object(u.g)("⌥-Enter")+">"),V.className="vditor-tooltipped vditor-tooltipped__n";var W=document.createElement("input");V.appendChild(W),W.className="vditor-input",W.setAttribute("placeholder","ID<"+Object(u.g)("⌥-Enter")+">"),W.style.width="120px",W.value=c.getAttribute("data-id")||"",W.oninput=function(){c.setAttribute("data-id",W.value)},W.onkeydown=function(t){if(!t.isComposing)return Object(u.d)(t)||t.shiftKey||!t.altKey||"Enter"!==t.key?void J(e,t):(n.selectNodeContents(c),n.collapse(!1),Object(M.h)(n),void t.preventDefault())},ee(n,c,e),te(n,c,e),ne(c,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",V),Y(e,c)}l&&ie(e,l),v||o||s||U||l||N||I||c||d||((B=Object(w.d)(r,"data-block","0"))&&B.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",ee(n,B,e),te(n,B,e),ne(B,e),Y(e,B)):e.wysiwyg.popover.style.display="none"),e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach((function(e){e.style.display="none"}));var X=Object(w.d)(n.startContainer,"data-type","backslash");X&&(X.querySelector("span").style.display="inline")}}),200)},Y=function(e,t){var n=t,r=Object(w.f)(t,"TABLE");r&&(n=r),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,n.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(n.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(n.offsetTop-21).toString())},Q=function(e,t){e.wysiwyg.popover.innerHTML="";var n=function(){""!==i.value.trim()&&("IMG"===t.tagName?t.setAttribute("alt",i.value):t.textContent=i.value),""!==a.value.trim()&&t.setAttribute("data-link-label",a.value)},r=document.createElement("span");r.setAttribute("aria-label",P.a[e.options.lang].textIsNotEmpty),r.className="vditor-tooltipped vditor-tooltipped__n";var i=document.createElement("input");r.appendChild(i),i.className="vditor-input",i.setAttribute("placeholder",P.a[e.options.lang].textIsNotEmpty),i.style.width="120px",i.value=t.getAttribute("alt")||t.textContent,i.oninput=function(){n()},i.onkeydown=function(n){J(e,n)||re(e.wysiwyg.element,t,n,a)};var o=document.createElement("span");o.setAttribute("aria-label",P.a[e.options.lang].linkRef),o.className="vditor-tooltipped vditor-tooltipped__n";var a=document.createElement("input");o.appendChild(a),a.className="vditor-input",a.setAttribute("placeholder",P.a[e.options.lang].linkRef),a.value=t.getAttribute("data-link-label"),a.oninput=function(){n()},a.onkeydown=function(n){J(e,n)||re(e.wysiwyg.element,t,n,i)},ne(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",r),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),Y(e,t)},ee=function(e,t,n){var r=t.previousElementSibling;if(r&&(t.parentElement.isEqualNode(n.wysiwyg.element)||"LI"===t.tagName)){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","up"),i.setAttribute("aria-label",P.a[n.options.lang].up+"<"+Object(u.g)("⌘-⇧-U")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){e.insertNode(document.createElement("wbr")),r.insertAdjacentElement("beforebegin",t),Object(M.f)(n.wysiwyg.element,e),K(n),Z(n),Ce(n)},n.wysiwyg.popover.insertAdjacentElement("beforeend",i)}},te=function(e,t,n){var r=t.nextElementSibling;if(r&&(t.parentElement.isEqualNode(n.wysiwyg.element)||"LI"===t.tagName)){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","down"),i.setAttribute("aria-label",P.a[n.options.lang].down+"<"+Object(u.g)("⌘-⇧-D")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){e.insertNode(document.createElement("wbr")),r.insertAdjacentElement("afterend",t),Object(M.f)(n.wysiwyg.element,e),K(n),Z(n),Ce(n)},n.wysiwyg.popover.insertAdjacentElement("beforeend",i)}},ne=function(e,t){var n=document.createElement("button");n.setAttribute("type","button"),n.setAttribute("data-type","remove"),n.setAttribute("aria-label",P.a[t.options.lang].remove+"<"+Object(u.g)("⌘-⇧-X")+">"),n.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',n.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",n.onclick=function(){var n=Object(M.b)(t.wysiwyg.element);n.setStartAfter(e),Object(M.h)(n),e.remove(),K(t),Z(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",n)},re=function(e,t,n,r){if(!n.isComposing){if("Tab"===n.key)return r.focus(),r.select(),void n.preventDefault();if(!Object(u.d)(n)&&!n.shiftKey&&n.altKey&&"Enter"===n.key){var i=Object(M.b)(e);t.insertAdjacentHTML("afterend",a.a.ZWSP),i.setStartAfter(t.nextSibling),i.collapse(!0),Object(M.h)(i),n.preventDefault()}}},ie=function(e,t){e.wysiwyg.popover.innerHTML="";var n=function(){""!==i.value.trim()&&(t.innerHTML=i.value),t.setAttribute("href",a.value),t.setAttribute("title",s.value)};t.querySelectorAll("[data-marker]").forEach((function(e){e.removeAttribute("data-marker")}));var r=document.createElement("span");r.setAttribute("aria-label",P.a[e.options.lang].textIsNotEmpty),r.className="vditor-tooltipped vditor-tooltipped__n";var i=document.createElement("input");r.appendChild(i),i.className="vditor-input",i.setAttribute("placeholder",P.a[e.options.lang].textIsNotEmpty),i.style.width="120px",i.value=t.innerHTML||"",i.oninput=function(){n()},i.onkeydown=function(n){J(e,n)||re(e.wysiwyg.element,t,n,a)};var o=document.createElement("span");o.setAttribute("aria-label",P.a[e.options.lang].link),o.className="vditor-tooltipped vditor-tooltipped__n";var a=document.createElement("input");o.appendChild(a),a.className="vditor-input",a.setAttribute("placeholder",P.a[e.options.lang].link),a.value=t.getAttribute("href")||"",a.oninput=function(){n()},a.onkeydown=function(n){J(e,n)||re(e.wysiwyg.element,t,n,s)};var l=document.createElement("span");l.setAttribute("aria-label",P.a[e.options.lang].tooltipText),l.className="vditor-tooltipped vditor-tooltipped__n";var s=document.createElement("input");l.appendChild(s),s.className="vditor-input",s.setAttribute("placeholder",P.a[e.options.lang].tooltipText),s.style.width="60px",s.value=t.getAttribute("title")||"",s.oninput=function(){n()},s.onkeydown=function(n){J(e,n)||re(e.wysiwyg.element,t,n,i)},ne(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",r),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",l),Y(e,t)},oe=function(e){"wysiwyg"===e.currentMode?Z(e):"ir"===e.currentMode&&F(e)},ae=function(e,t,n){void 0===n&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var r=e.wysiwyg.element;r.innerHTML=e.lute.Md2VditorDOM(t),r.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){j(t,e),t.previousElementSibling.setAttribute("style","display:none")})),K(e,n)},se=function(e,t){var n,r=this;this.element=document.createElement("div"),t.className&&(n=this.element.classList).add.apply(n,t.className.split(" "));var i=t.hotkey?" <"+Object(u.g)(t.hotkey)+">":"";2===t.level&&(i=t.hotkey?" &lt;"+Object(u.g)(t.hotkey)+"&gt;":"");var o=t.tip?t.tip+i:P.a[e.options.lang][t.name]+i,l="upload"===t.name?"div":"button";if(2===t.level)this.element.innerHTML="<"+l+' data-type="'+t.name+'">'+o+"</"+l+">";else{this.element.classList.add("vditor-toolbar__item");var s=document.createElement(l);s.setAttribute("data-type",t.name),s.className="vditor-tooltipped vditor-tooltipped__"+t.tipPosition,s.setAttribute("aria-label",o),s.innerHTML=t.icon,this.element.appendChild(s)}t.prefix&&this.element.children[0].addEventListener(Object(u.b)(),(function(n){n.preventDefault(),r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||("wysiwyg"===e.currentMode?function(e,t,n){if(!(e.wysiwyg.composingLock&&n instanceof CustomEvent)){var r=!0,i=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var o=Object(M.b)(e.wysiwyg.element),l=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if("strike"===l&&(l="strikeThrough"),"quote"===l){var s=Object(w.f)(o.startContainer,"BLOCKQUOTE");s||(s=o.startContainer.childNodes[o.startOffset]),s&&(r=!1,t.classList.remove("vditor-menu--current"),o.insertNode(document.createElement("wbr")),s.outerHTML=""===s.innerHTML.trim()?'<p data-block="0">'+s.innerHTML+"</p>":s.innerHTML,Object(M.f)(e.wysiwyg.element,o))}else if("inline-code"===l){var c=Object(w.f)(o.startContainer,"CODE");c||(c=o.startContainer.childNodes[o.startOffset]),c&&(c.outerHTML=c.innerHTML.replace(a.a.ZWSP,"")+"<wbr>",Object(M.f)(e.wysiwyg.element,o))}else"link"===l?o.collapsed?(o.selectNode(o.startContainer.parentElement),document.execCommand("unlink",!1,"")):document.execCommand("unlink",!1,""):"check"===l||"list"===l||"ordered-list"===l?(Ue(e,o,l),Object(M.f)(e.wysiwyg.element,o),r=!1,t.classList.remove("vditor-menu--current")):(r=!1,t.classList.remove("vditor-menu--current"),""===o.toString()?function(e,t,n){for(var r=e.startContainer.parentElement,i=!1,o="",l="",s=function(e){var t=$(e.startContainer),n=z(e.startContainer),r=e.startContainer.textContent,i=e.startOffset,o="",l="";return(""!==r.substr(0,i)&&r.substr(0,i)!==a.a.ZWSP||t)&&(o=""+t+r.substr(0,i)),(""!==r.substr(i)&&r.substr(i)!==a.a.ZWSP||n)&&(l=""+r.substr(i)+n),{afterHTML:l,beforeHTML:o}}(e),c=s.beforeHTML,d=s.afterHTML;r&&!i;){var u=r.tagName;if("STRIKE"===u&&(u="S"),"I"===u&&(u="EM"),"B"===u&&(u="STRONG"),"S"===u||"STRONG"===u||"EM"===u){var p="",f="",h="";"0"!==r.parentElement.getAttribute("data-block")&&(f=$(r),h=z(r)),(c||f)&&(c=p=f+"<"+u+">"+c+"</"+u+">"),("bold"===n&&"STRONG"===u||"italic"===n&&"EM"===u||"strikeThrough"===n&&"S"===u)&&(p+=""+o+a.a.ZWSP+"<wbr>"+l,i=!0),(d||h)&&(p+=d="<"+u+">"+d+"</"+u+">"+h),"0"!==r.parentElement.getAttribute("data-block")?(r=r.parentElement).innerHTML=p:(r.outerHTML=p,r=r.parentElement),o="<"+u+">"+o,l="</"+u+">"+l}else i=!0}Object(M.f)(t.wysiwyg.element,e)}(o,e,l):document.execCommand(l,!1,""));else{0===e.wysiwyg.element.childNodes.length&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',Object(M.f)(e.wysiwyg.element,o));var d=Object(w.c)(o.startContainer);if("quote"===l){if(d||(d=o.startContainer.childNodes[o.startOffset]),d){r=!1,t.classList.add("vditor-menu--current"),o.insertNode(document.createElement("wbr"));var u=Object(w.f)(o.startContainer,"LI");u&&d.contains(u)?u.innerHTML='<blockquote data-block="0">'+u.innerHTML+"</blockquote>":d.outerHTML='<blockquote data-block="0">'+d.outerHTML+"</blockquote>",Object(M.f)(e.wysiwyg.element,o)}}else if("check"===l||"list"===l||"ordered-list"===l)Ue(e,o,l,!1),Object(M.f)(e.wysiwyg.element,o),r=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if("inline-code"===l){if(""===o.toString())(f=document.createElement("code")).textContent=a.a.ZWSP,o.insertNode(f),o.setStart(f.firstChild,1),o.collapse(!0),Object(M.h)(o);else if(3===o.startContainer.nodeType){var f=document.createElement("code");o.surroundContents(f),o.insertNode(f),Object(M.h)(o)}t.classList.add("vditor-menu--current")}else if("code"===l)(f=document.createElement("div")).className="vditor-wysiwyg__block",f.setAttribute("data-type","code-block"),f.setAttribute("data-block","0"),f.setAttribute("data-marker","```"),""===o.toString()?f.innerHTML="<pre><code><wbr>\n</code></pre>":(f.innerHTML="<pre><code>"+o.toString()+"<wbr></code></pre>",o.deleteContents()),o.insertNode(f),d&&(d.outerHTML=e.lute.SpinVditorDOM(d.outerHTML)),Object(M.f)(e.wysiwyg.element,o),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){j(t,e)})),t.classList.add("vditor-menu--disabled");else if("link"===l){if(""===o.toString()){var h=document.createElement("a");h.innerText=a.a.ZWSP,o.insertNode(h),o.setStart(h.firstChild,1),o.collapse(!0),ie(e,h);var m=e.wysiwyg.popover.querySelector("input");m.value="",m.focus(),i=!1}else{(f=document.createElement("a")).setAttribute("href",""),f.innerHTML=o.toString(),o.surroundContents(f),o.insertNode(f),Object(M.h)(o),ie(e,f);var v=e.wysiwyg.popover.querySelectorAll("input");v[0].value=f.innerText,v[1].focus()}r=!1,t.classList.add("vditor-menu--current")}else if("table"===l){var g='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(""===o.toString().trim())d&&""===d.innerHTML.trim().replace(a.a.ZWSP,"")?d.outerHTML=g:document.execCommand("insertHTML",!1,g),o.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),Object(M.h)(o);else{g='<table data-block="0"><thead><tr>';var b=o.toString().split("\n"),y=b[0].split(",").length>b[0].split("\t").length?",":"\t";b.forEach((function(e,t){0===t?(e.split(y).forEach((function(e,t){g+=0===t?"<th>"+e+"<wbr></th>":"<th>"+e+"</th>"})),g+="</tr></thead>"):(g+=1===t?"<tbody><tr>":"<tr>",e.split(y).forEach((function(e){g+="<td>"+e+"</td>"})),g+="</tr>")})),g+="</tbody></table>",document.execCommand("insertHTML",!1,g),Object(M.f)(e.wysiwyg.element,o)}r=!1,t.classList.add("vditor-menu--disabled")}else if("line"===l){if(d){var C='<hr data-block="0"><p data-block="0"><wbr>\n</p>';""===d.innerHTML.trim()?d.outerHTML=C:d.insertAdjacentHTML("afterend",C),Object(M.f)(e.wysiwyg.element,o)}}else if(r=!1,t.classList.add("vditor-menu--current"),"strike"===l&&(l="strikeThrough"),""!==o.toString()||"bold"!==l&&"italic"!==l&&"strikeThrough"!==l)document.execCommand(l,!1,"");else{var k="strong";"italic"===l?k="em":"strikeThrough"===l&&(k="s"),(f=document.createElement(k)).textContent=a.a.ZWSP,o.insertNode(f),f.previousSibling&&f.previousSibling.textContent===a.a.ZWSP&&(f.previousSibling.textContent=""),o.setStart(f.firstChild,1),o.collapse(!0),Object(M.h)(o)}}r&&Z(e),i&&K(e)}}(e,r.element.children[0],n):"ir"===e.currentMode?mt(e,r.element.children[0],t.prefix||"",t.suffix||""):Ae(e,r.element.children[0],t.prefix||"",t.suffix||""))}))},le=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),ce=function(e,t,n){var r;if("string"!=typeof n?(b(e,["subToolbar","hint"]),n.preventDefault(),r=s(e)):r=n,e.currentMode!==t||"string"==typeof n){if(e.devtools&&e.devtools.renderEchart(e),"both"===e.options.preview.mode&&"sv"===t?e.preview.element.style.display="block":e.preview.element.style.display="none",h(e.toolbar.elements,a.a.EDIT_TOOLBARS),p(e.toolbar.elements,a.a.EDIT_TOOLBARS),m(e.toolbar.elements,["outdent","indent"]),"ir"===t)v(e.toolbar.elements,["both"]),g(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(r),pt(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),B(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(t){j(t,e)}));else if("wysiwyg"===t)v(e.toolbar.elements,["both"]),g(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.currentMode="wysiwyg",B(e),ae(e,r,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.popover.style.display="none";else if("sv"===t){g(e.toolbar.elements,["both"]),v(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",("both"===e.options.preview.mode||"editor"===e.options.preview.mode)&&(e.sv.element.style.display="block"),e.currentMode="sv";var i=xe(r,e);"<div data-block='0'></div>"===i&&(i=""),e.sv.element.innerHTML=i,Oe(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),B(e)}e.undo.resetIcon(e),"string"!=typeof n&&(e[e.currentMode].element.focus(),oe(e)),"string"==typeof n&&e.outline.render(e),U(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach((function(e){e.classList.remove("vditor-menu--current")})),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'+e.currentMode+'"]').classList.add("vditor-menu--current")),e.outline.toggle(e,"sv"!==e.currentMode&&e.options.outline)}},ue=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=document.createElement("div");return i.className="vditor-hint"+(2===n.level?"":" vditor-panel--arrow"),i.innerHTML='<button data-mode="wysiwyg">'+P.a[t.options.lang].wysiwyg+" &lt;"+Object(u.g)("⌘-⌥-7")+'></button>\n<button data-mode="ir">'+P.a[t.options.lang].instantRendering+" &lt;"+Object(u.g)("⌘-⌥-8")+'></button>\n<button data-mode="sv">'+P.a[t.options.lang].splitView+" &lt;"+Object(u.g)("⌘-⌥-9")+"></button>",r.element.appendChild(i),r._bindEvent(t,i,n),r}return le(t,e),t.prototype._bindEvent=function(e,t,n){var r=this.element.children[0];y(e,t,r,n.level),t.children.item(0).addEventListener(Object(u.b)(),(function(t){ce(e,"wysiwyg",t),t.preventDefault(),t.stopPropagation()})),t.children.item(1).addEventListener(Object(u.b)(),(function(t){ce(e,"ir",t),t.preventDefault(),t.stopPropagation()})),t.children.item(2).addEventListener(Object(u.b)(),(function(t){ce(e,"sv",t),t.preventDefault(),t.stopPropagation()}))},t}(se),de=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},pe=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach((function(n){t.setRequestHeader(n,e.options.upload.headers[n])}))},fe=function(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"},he=function(e,t,n){for(var r,i=[],o=!0===e.options.upload.multiple?t.length:1,a=0;a<o;a++){var l=t[a];l instanceof DataTransferItem&&(l=l.getAsFile()),i.push(l)}if(e.options.upload.handler)return"string"==typeof(r=e.options.upload.handler(i))?void e.tip.show(r):void 0;if(!e.options.upload.url||!e.upload)return n&&(n.value=""),void e.tip.show("please config: options.upload.url");if(e.options.upload.file&&(i=e.options.upload.file(i)),e.options.upload.validate&&"string"==typeof(r=e.options.upload.validate(i)))e.tip.show(r);else{var s=de(e);e.upload.range=Object(M.b)(s);var c=function(e,t){e.tip.hide();for(var n=[],r="",i="",o=e.options.lang,a=function(a,l){var s=t[l],c=!0;s.name||(r+="<li>"+P.a[o].nameEmpty+"</li>",c=!1),s.size>e.options.upload.max&&(r+="<li>"+s.name+" "+P.a[o].over+" "+e.options.upload.max/1024/1024+"M</li>",c=!1);var d=s.name.lastIndexOf("."),u=s.name.substr(d),p=e.options.upload.filename(s.name.substr(0,d))+u;e.options.upload.accept&&(e.options.upload.accept.split(",").some((function(e){var t=e.trim();if(0===t.indexOf(".")){if(u.toLowerCase()===t.toLowerCase())return!0}else if(s.type.split("/")[0]===t.split("/")[0])return!0;return!1}))||(r+="<li>"+s.name+" "+P.a[o].fileTypeError+"</li>",c=!1)),c&&(n.push(s),i+="<li>"+p+" "+P.a[o].uploading+"</li>")},l=t.length,s=0;s<l;s++)a(0,s);return e.tip.show("<ul>"+r+i+"</ul>"),n}(e,i);if(0!==c.length){for(var d=new FormData,u=e.options.upload.extraData,p=0,f=Object.keys(u);p<f.length;p++){var h=f[p];d.append(h,u[h])}a=0;for(var m=c.length;a<m;a++)d.append(e.options.upload.fieldName,c[a]);var v=new XMLHttpRequest;v.open("POST",e.options.upload.url),e.options.upload.token&&v.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(v.withCredentials=!0),pe(e,v),e.upload.isUploading=!0,s.setAttribute("contenteditable","false"),v.onreadystatechange=function(){if(v.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,s.setAttribute("contenteditable","true"),200===v.status)if(e.options.upload.success)e.options.upload.success(s,v.responseText);else{var r=v.responseText;e.options.upload.format&&(r=e.options.upload.format(t,v.responseText)),function(e,t){de(t).focus();var n=JSON.parse(e),r="";1===n.code&&(r=""+n.msg),n.data.errFiles&&n.data.errFiles.length>0&&(r="<ul><li>"+r+"</li>",n.data.errFiles.forEach((function(e){var n=e.lastIndexOf("."),i=t.options.upload.filename(e.substr(0,n))+e.substr(n);r+="<li>"+i+" "+P.a[t.options.lang].uploadError+"</li>"})),r+="</ul>"),r?t.tip.show(r):t.tip.hide();var i="";Object.keys(n.data.succMap).forEach((function(e){var r=n.data.succMap[e],o=e.lastIndexOf("."),a=e.substr(o),l=t.options.upload.filename(e.substr(0,o))+a;0===(a=a.toLowerCase()).indexOf(".wav")||0===a.indexOf(".mp3")||0===a.indexOf(".ogg")?"wysiwyg"===t.currentMode?i+='<div class="vditor-wysiwyg__block" data-type="html-block"\n data-block="0"><pre><code>&lt;audio controls="controls" src="'+r+'"&gt;&lt;/audio&gt;</code></pre>':"ir"===t.currentMode?i+='<audio controls="controls" src="'+r+'"></audio>\n':i+="["+l+"]("+r+")\n":0===a.indexOf(".apng")||0===a.indexOf(".bmp")||0===a.indexOf(".gif")||0===a.indexOf(".ico")||0===a.indexOf(".cur")||0===a.indexOf(".jpg")||0===a.indexOf(".jpeg")||0===a.indexOf(".jfif")||0===a.indexOf(".pjp")||0===a.indexOf(".pjpeg")||0===a.indexOf(".png")||0===a.indexOf(".svg")||0===a.indexOf(".webp")?"wysiwyg"===t.currentMode?i+='<img alt="'+l+'" src="'+r+'">':i+="!["+l+"]("+r+")\n":"wysiwyg"===t.currentMode?i+='<a href="'+r+'">'+l+"</a>":i+="["+l+"]("+r+")\n"})),Object(M.h)(t.upload.range),document.execCommand("insertHTML",!1,i),t.upload.range=getSelection().getRangeAt(0).cloneRange()}(r,e)}else e.options.upload.error?e.options.upload.error(v.responseText):e.tip.show(v.responseText);n&&(n.value=""),e.upload.element.style.display="none"}},v.upload.onprogress=function(t){if(t.lengthComputable){var n=t.loaded/t.total*100;e.upload.element.style.display="block",e.upload.element.style.width=n+"%"}},v.send(d)}else n&&(n.value="")}},me=function(e,t){return Object(M.e)(e,t)?getSelection().toString():""},ve=function(e,t){t.addEventListener("focus",(function(){e.options.focus&&e.options.focus(s(e)),b(e,["subToolbar"])}))},ge=function(e,t){t.addEventListener("blur",(function(){if("ir"===e.currentMode){var t=e.ir.element.querySelector(".vditor-ir__node--expand");t&&t.classList.remove("vditor-ir__node--expand")}e.options.blur&&e.options.blur(s(e))}))},ye=function(e,t){(e.options.upload.url||e.options.upload.handler)&&t.addEventListener("drop",(function(t){if("Files"===t.dataTransfer.types[0]){var n=t.dataTransfer.items;n.length>0&&he(e,n),t.preventDefault()}}))},be=function(e,t,n){t.addEventListener("copy",(function(t){return n(t,e)}))},we=function(e,t,n){t.addEventListener("cut",(function(t){n(t,e),document.execCommand("delete")}))},Ce=function(e){if(e.options.typewriterMode){var t=e[e.currentMode].element,n=Object(M.a)(t).top;"string"!=typeof e.options.height||e.element.classList.contains("vditor--fullscreen")||window.scrollTo(window.scrollX,n+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),("number"==typeof e.options.height||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=n+t.scrollTop-t.clientHeight/2+10)}},ke=function(e,t){t.addEventListener("keydown",(function(t){if(!(e.options.hint.extend.length>1||e.toolbar.elements.emoji)||!e.hint.select(t,e)){if("sv"===e.currentMode){if(function(e,t){var n,r,i,o,a;if(e.sv.composingLock=t.isComposing,t.isComposing)return!1;if(-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!Object(u.d)(t)&&"Escape"!==t.key)return!1;var l=Object(M.b)(e.sv.element),s=l.startContainer;3!==l.startContainer.nodeType&&"DIV"===l.startContainer.tagName&&(s=l.startContainer.childNodes[l.startOffset-1]);var c=Object(w.d)(s,"data-type","text"),d=Object(w.d)(s,"data-type","blockquote-marker");if(!d&&0===l.startOffset&&c&&c.previousElementSibling&&"blockquote-marker"===c.previousElementSibling.getAttribute("data-type")&&(d=c.previousElementSibling),d&&"Enter"===t.key&&!Object(u.d)(t)&&!t.altKey&&""===d.nextElementSibling.textContent.trim()&&Object(M.c)(d,e.sv.element,l).start===d.textContent.length)return"padding"===(null===(n=d.previousElementSibling)||void 0===n?void 0:n.getAttribute("data-type"))&&d.previousElementSibling.setAttribute("data-action","enter-remove"),d.remove(),Oe(e),t.preventDefault(),!0;var p=Object(w.d)(s,"data-type","li-marker"),f=Object(w.d)(s,"data-type","task-marker"),h=p;if(h||f&&"task-marker"!==f.nextElementSibling.getAttribute("data-type")&&(h=f),h||0!==l.startOffset||!c||!c.previousElementSibling||"li-marker"!==c.previousElementSibling.getAttribute("data-type")&&"task-marker"!==c.previousElementSibling.getAttribute("data-type")||(h=c.previousElementSibling),h){var m=Object(M.c)(h,e.sv.element,l).start,v="task-marker"===h.getAttribute("data-type"),g=h;if(v&&(g=h.previousElementSibling.previousElementSibling.previousElementSibling),m===h.textContent.length){if("Enter"===t.key&&!Object(u.d)(t)&&!t.altKey&&!t.shiftKey&&""===h.nextElementSibling.textContent.trim())return"padding"===(null===(r=g.previousElementSibling)||void 0===r?void 0:r.getAttribute("data-type"))?(g.previousElementSibling.remove(),N(e)):(v&&(g.remove(),h.previousElementSibling.previousElementSibling.remove(),h.previousElementSibling.remove()),h.nextElementSibling.remove(),h.remove(),Oe(e)),t.preventDefault(),!0;if("Tab"===t.key)return g.insertAdjacentHTML("beforebegin",'<span data-type="padding">'+g.textContent.replace(/\S/g," ")+"</span>"),/^\d/.test(g.textContent)&&(g.textContent=g.textContent.replace(/^\d{1,}/,"1"),l.selectNodeContents(h.firstChild),l.collapse(!1)),N(e),t.preventDefault(),!0}}if(Ze(e,l,t))return!0;var b=Object(w.d)(s,"data-block","0"),y=Object(C.b)(s,"SPAN");if("Enter"===t.key&&!Object(u.d)(t)&&!t.altKey&&!t.shiftKey&&b){var k=!1,S=b.textContent.match(/^\n+/);Object(M.c)(b,e.sv.element).start<=(S?S[0].length:0)&&(k=!0);var E="\n";if(y){if("enter-remove"===(null===(i=y.previousElementSibling)||void 0===i?void 0:i.getAttribute("data-action")))return y.previousElementSibling.remove(),Oe(e),t.preventDefault(),!0;E+=Te(y)}return l.insertNode(document.createTextNode(E)),l.collapse(!1),b&&""!==b.textContent.trim()&&!k?N(e):Oe(e),t.preventDefault(),!0}if("Backspace"===t.key&&!Object(u.d)(t)&&!t.altKey&&!t.shiftKey){if(y&&"newline"===(null===(o=y.previousElementSibling)||void 0===o?void 0:o.getAttribute("data-type"))&&1===Object(M.c)(y,e.sv.element,l).start&&-1===y.getAttribute("data-type").indexOf("code-block-"))return l.setStart(y,0),l.extractContents(),""!==y.textContent.trim()?N(e):Oe(e),t.preventDefault(),!0;if(b&&0===Object(M.c)(b,e.sv.element,l).start&&b.previousElementSibling){l.extractContents();var _=b.previousElementSibling.lastElementChild;return"newline"===_.getAttribute("data-type")&&(_.remove(),_=b.previousElementSibling.lastElementChild),"newline"!==_.getAttribute("data-type")&&(_.insertAdjacentHTML("afterend",b.innerHTML),b.remove()),""===b.textContent.trim()||(null===(a=b.previousElementSibling)||void 0===a?void 0:a.querySelector('[data-type="code-block-open-marker"]'))?("newline"!==_.getAttribute("data-type")&&(l.selectNodeContents(_.lastChild),l.collapse(!1)),Oe(e)):N(e),t.preventDefault(),!0}}return!1}(e,t))return}else if("wysiwyg"===e.currentMode){if(function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t);var n=Object(M.b)(e.wysiwyg.element),r=n.startContainer;if(!Me(t,e,r))return!1;if(Re(n,e,t),st(n),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!Object(u.d)(t)&&"Escape"!==t.key)return!1;var i=Object(w.c)(r),o=Object(w.f)(r,"P");if(Ye(t,e,o,n))return!0;if(Je(n,e,o,t))return!0;if(nt(e,t,n))return!0;var l=Object(w.e)(r,"vditor-wysiwyg__block");if(l){if("Escape"===t.key&&2===l.children.length)return e.wysiwyg.popover.style.display="none",l.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!Object(u.d)(t)&&!t.shiftKey&&t.altKey&&"Enter"===t.key&&"code-block"===l.getAttribute("data-type")){var s=e.wysiwyg.popover.querySelector(".vditor-input");return s.focus(),s.select(),t.preventDefault(),!0}if("0"===l.getAttribute("data-block")){if(it(e,t,l.firstElementChild,n))return!0;if(Be(e,t,n,l.firstElementChild,l))return!0;if("yaml-front-matter"!==l.getAttribute("data-type")&&qe(e,t,n,l.firstElementChild,l))return!0}}if(ot(e,n,t,o))return!0;var c=Object(w.h)(r,"BLOCKQUOTE");if(c&&!t.shiftKey&&t.altKey&&"Enter"===t.key){Object(u.d)(t)?n.setStartBefore(c):n.setStartAfter(c),Object(M.h)(n);var d=document.createElement("p");return d.setAttribute("data-block","0"),d.innerHTML="\n",n.insertNode(d),n.collapse(!0),Object(M.h)(n),K(e),Ce(e),t.preventDefault(),!0}var p,f=Object(C.a)(r);if(f){if("H6"===f.tagName&&r.textContent.length===n.startOffset&&!Object(u.d)(t)&&!t.shiftKey&&!t.altKey&&"Enter"===t.key){var h=document.createElement("p");return h.textContent="\n",h.setAttribute("data-block","0"),r.parentElement.insertAdjacentElement("afterend",h),n.setStart(h,0),Object(M.h)(n),K(e),Ce(e),t.preventDefault(),!0}var m;if(H("⌘-=",t))return(m=parseInt(f.tagName.substr(1),10)-1)>0&&(W(e,"h"+m),K(e)),t.preventDefault(),!0;if(H("⌘--",t))return(m=parseInt(f.tagName.substr(1),10)+1)<7&&(W(e,"h"+m),K(e)),t.preventDefault(),!0;"Backspace"!==t.key||Object(u.d)(t)||t.shiftKey||t.altKey||""!==f.textContent||X(e)}if(at(e,n,t))return!0;if(t.altKey&&"Enter"===t.key&&!Object(u.d)(t)&&!t.shiftKey){var v=Object(w.f)(r,"A"),g=Object(w.d)(r,"data-type","link-ref"),b=Object(w.d)(r,"data-type","footnotes-ref");if(v||g||b||f&&2===f.tagName.length){var y=e.wysiwyg.popover.querySelector("input");y.focus(),y.select()}}if(J(e,t))return!0;if(H("⌘-⇧-U",t)&&(p=e.wysiwyg.popover.querySelector('[data-type="up"]')))return p.click(),t.preventDefault(),!0;if(H("⌘-⇧-D",t)&&(p=e.wysiwyg.popover.querySelector('[data-type="down"]')))return p.click(),t.preventDefault(),!0;if(Ze(e,n,t))return!0;if(!Object(u.d)(t)&&t.shiftKey&&!t.altKey&&"Enter"===t.key&&"LI"!==r.parentElement.tagName&&"P"!==r.parentElement.tagName)return["STRONG","S","STRONG","I","EM","B"].includes(r.parentElement.tagName)?n.insertNode(document.createTextNode("\n"+a.a.ZWSP)):n.insertNode(document.createTextNode("\n")),n.collapse(!1),Object(M.h)(n),K(e),Ce(e),t.preventDefault(),!0;if("Backspace"===t.key&&!Object(u.d)(t)&&!t.shiftKey&&!t.altKey&&""===n.toString()){if(dt(e,n,t,o))return!0;if(i){if(i.previousElementSibling&&i.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&"0"===i.previousElementSibling.getAttribute("data-block")){var k=Object(M.c)(i,e.wysiwyg.element,n).start;if(0===k||1===k&&i.innerText.startsWith(a.a.ZWSP))return G(i.previousElementSibling.lastElementChild,e,!1),""===i.innerHTML.trim().replace(a.a.ZWSP,"")&&(i.remove(),K(e)),t.preventDefault(),!0}var S=n.startOffset;if(""===n.toString()&&3===r.nodeType&&"\n"===r.textContent.charAt(S-2)&&r.textContent.charAt(S-1)!==a.a.ZWSP&&["STRONG","S","STRONG","I","EM","B"].includes(r.parentElement.tagName))return r.textContent=r.textContent.substring(0,S-1)+a.a.ZWSP,n.setStart(r,S),n.collapse(!0),K(e),t.preventDefault(),!0;r.textContent===a.a.ZWSP&&1===n.startOffset&&!r.previousSibling&&function(e){for(var t=e.startContainer.nextSibling;t&&""===t.textContent;)t=t.nextSibling;return!(!t||3===t.nodeType||"CODE"!==t.tagName&&"math-inline"!==t.getAttribute("data-type")&&"html-entity"!==t.getAttribute("data-type")&&"html-inline"!==t.getAttribute("data-type"))}(n)&&(r.textContent=""),i.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach((function(e){e.firstElementChild.style.display="inline",e.lastElementChild.style.display="none"})),i.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach((function(e){e.firstElementChild.style.display="inline",e.lastElementChild.style.display="none"}))}}if(Object(u.e)()&&1===n.startOffset&&r.textContent.indexOf(a.a.ZWSP)>-1&&r.previousSibling&&3!==r.previousSibling.nodeType&&"CODE"===r.previousSibling.tagName&&("Backspace"===t.key||"ArrowLeft"===t.key))return n.selectNodeContents(r.previousSibling),n.collapse(!1),t.preventDefault(),!0;if(lt(t,i,n))return t.preventDefault(),!0;if(He(n,t.key),"ArrowDown"===t.key){var E=r.nextSibling;E&&3!==E.nodeType&&"math-inline"===E.getAttribute("data-type")&&n.setStartAfter(E)}return!1}(e,t))return}else if("ir"===e.currentMode&&function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;-1!==t.key.indexOf("Arrow")||"Meta"===t.key||"Control"===t.key||"Alt"===t.key||"Shift"===t.key||"CapsLock"===t.key||"Escape"===t.key||/^F\d{1,2}$/.test(t.key)||e.undo.recordFirstPosition(e,t);var n=Object(M.b)(e.ir.element),r=n.startContainer;if(!Me(t,e,r))return!1;if(Re(n,e,t),st(n),"Enter"!==t.key&&"Tab"!==t.key&&"Backspace"!==t.key&&-1===t.key.indexOf("Arrow")&&!Object(u.d)(t)&&"Escape"!==t.key)return!1;var i=Object(w.d)(r,"data-newline","1");if(!Object(u.d)(t)&&!t.altKey&&!t.shiftKey&&"Enter"===t.key&&i&&n.startOffset<i.textContent.length){var o=i.previousElementSibling;o&&(n.insertNode(document.createTextNode(o.textContent)),n.collapse(!1));var l=i.nextSibling;l&&(n.insertNode(document.createTextNode(l.textContent)),n.collapse(!0))}var s=Object(w.f)(r,"P");if(Ye(t,e,s,n))return!0;if(Je(n,e,s,t))return!0;if(ot(e,n,t,s))return!0;if(s&&s.previousElementSibling&&s.previousElementSibling.classList.contains("vditor-toc")&&qe(e,t,n,s,s.previousElementSibling))return!0;var c=Object(w.e)(r,"vditor-ir__marker--pre");if(c&&"PRE"===c.tagName){var d=c.firstChild;if(it(e,t,c,n))return!0;if(("math-block"===d.getAttribute("data-type")||"html-block"===d.getAttribute("data-type"))&&qe(e,t,n,d,c.parentElement))return!0;if(Be(e,t,n,d,c.parentElement))return!0}var p=Object(w.d)(r,"data-type","code-block-info");if(p){if("Enter"===t.key||"Tab"===t.key)return n.selectNodeContents(p.nextElementSibling.firstChild),n.collapse(!0),t.preventDefault(),b(e,["hint"]),!0;if("Backspace"===t.key){var f=Object(M.c)(p,e.ir.element).start;1===f&&n.setStart(r,0),2===f&&(e.hint.recentLanguage="")}if(qe(e,t,n,p,p.parentElement))return b(e,["hint"]),!0}var h=Object(w.f)(r,"TD")||Object(w.f)(r,"TH");if(t.key.indexOf("Arrow")>-1&&h){var m=Ne(h);if(m&&qe(e,t,n,h,m))return!0;var v=Pe(h);if(v&&Be(e,t,n,h,v))return!0}if(nt(e,t,n))return!0;if(at(e,n,t))return!0;if(Ze(e,n,t))return!0;var g=Object(C.a)(r);if(g){var y;if(H("⌘-=",t))return(y=g.querySelector(".vditor-ir__marker--heading"))&&y.textContent.trim().length>1&&ft(e,y.textContent.substr(1)),t.preventDefault(),!0;if(H("⌘--",t))return(y=g.querySelector(".vditor-ir__marker--heading"))&&y.textContent.trim().length<6&&ft(e,y.textContent.trim()+"# "),t.preventDefault(),!0}var k=Object(w.c)(r);if("Backspace"===t.key&&!Object(u.d)(t)&&!t.shiftKey&&!t.altKey&&""===n.toString()){if(dt(e,n,t,s))return!0;if(k&&k.previousElementSibling&&("code-block"===k.previousElementSibling.getAttribute("data-type")||"math-block"===k.previousElementSibling.getAttribute("data-type"))){var S=Object(M.c)(k,e.ir.element,n).start;if(0===S||1===S&&k.innerText.startsWith(a.a.ZWSP))return n.selectNodeContents(k.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),n.collapse(!1),D(n,e),""===k.textContent.trim().replace(a.a.ZWSP,"")&&(k.remove(),pt(e)),t.preventDefault(),!0}if(g){var E=g.firstElementChild.textContent.length;Object(M.c)(g,e.ir.element).start===E&&(n.setStart(g.firstElementChild.firstChild,E-1),n.collapse(!0),Object(M.h)(n))}}return!("ArrowUp"!==t.key&&"ArrowDown"!==t.key||!k||(k.querySelectorAll(".vditor-ir__node").forEach((function(e){e.contains(r)||e.classList.add("vditor-ir__node--hidden")})),!lt(t,k,n)))||(He(n,t.key),!1)}(e,t))return;if(e.options.ctrlEnter&&H("⌘-Enter",t))return e.options.ctrlEnter(s(e)),void t.preventDefault();if(H("⌘-Z",t)&&!e.toolbar.elements.undo)return e.undo.undo(e),void t.preventDefault();if(H("⌘-Y",t)&&!e.toolbar.elements.redo)return e.undo.redo(e),void t.preventDefault();if("Escape"===t.key)return"block"===e.hint.element.style.display?e.hint.element.style.display="none":e.options.esc&&!t.isComposing&&e.options.esc(s(e)),void t.preventDefault();if(Object(u.d)(t)&&t.altKey&&!t.shiftKey&&/^Digit[1-6]$/.test(t.code)){if("wysiwyg"===e.currentMode){var n=t.code.replace("Digit","H");Object(w.f)(getSelection().getRangeAt(0).startContainer,n)?X(e):W(e,n),K(e)}else"sv"===e.currentMode?Le(e,"#".repeat(parseInt(t.code.replace("Digit",""),10))+" "):"ir"===e.currentMode&&ft(e,"#".repeat(parseInt(t.code.replace("Digit",""),10))+" ");return t.preventDefault(),!0}if(Object(u.d)(t)&&t.altKey&&!t.shiftKey&&/^Digit[7-9]$/.test(t.code))return"Digit7"===t.code?ce(e,"wysiwyg",t):"Digit8"===t.code?ce(e,"ir",t):"Digit9"===t.code&&ce(e,"sv",t),!0;e.options.toolbar.find((function(n){return!n.hotkey||n.toolbar?!!n.toolbar&&!!n.toolbar.find((function(n){return!!n.hotkey&&(H(n.hotkey,t)?(e.toolbar.elements[n.name].children[0].dispatchEvent(new CustomEvent(Object(u.b)())),t.preventDefault(),!0):void 0)})):H(n.hotkey,t)?(e.toolbar.elements[n.name].children[0].dispatchEvent(new CustomEvent(Object(u.b)())),t.preventDefault(),!0):void 0}))}}))},Se=function(e,t){e.options.select&&t.addEventListener("selectstart",(function(n){t.onmouseup=function(){var t=me(e[e.currentMode].element);t&&e.options.select(t)}}))},Ee=function(e,t){var n=Object(M.b)(e.sv.element);n.extractContents(),n.insertNode(document.createTextNode(Lute.Caret)),n.insertNode(document.createTextNode(t));var r=Object(w.d)(n.startContainer,"data-block","0");r||(r=e.sv.element);var i="<div data-block='0'>"+e.lute.Md2VditorSVDOM(r.textContent).replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,'<span data-type="newline"><br /><span style="display: none">\n</span></span><span data-type="newline"><br /><span style="display: none">\n</span></span></div><div data-block="0"><')+"</div>";r.isEqualNode(e.sv.element)?r.innerHTML=i:r.outerHTML=i,Object(M.f)(e.sv.element,n),Ce(e)},_e=function(e,t,n){void 0===n&&(n=!0);var r=e;for(3===r.nodeType&&(r=r.parentElement);r;){if(r.getAttribute("data-type")===t)return r;r=n?r.previousElementSibling:r.nextElementSibling}return!1},xe=function(e,t){return k("SpinVditorSVDOM",e,"argument",t.options.debugger),e="<div data-block='0'>"+t.lute.SpinVditorSVDOM(e).replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,'<span data-type="newline"><br /><span style="display: none">\n</span></span><span data-type="newline"><br /><span style="display: none">\n</span></span></div><div data-block="0"><')+"</div>",k("SpinVditorSVDOM",e,"result",t.options.debugger),e},Te=function(e){var t=e.getAttribute("data-type"),n=e.previousElementSibling,r=t&&"text"!==t&&"heading-marker"!==t&&"newline"!==t&&"yaml-front-matter-open-marker"!==t&&"yaml-front-matter-close-marker"!==t&&"code-block-info"!==t&&"code-block-close-marker"!==t&&"code-block-open-marker"!==t?e.textContent:"",i=!1;for("newline"===t&&(i=!0);n&&!i;){var o=n.getAttribute("data-type");if("li-marker"===o||"blockquote-marker"===o||"task-marker"===o||"padding"===o){var a=n.textContent;if("li-marker"!==o||"code-block-open-marker"!==t&&"code-block-info"!==t)if("code-block-close-marker"===t&&n.nextElementSibling.isSameNode(e)){var l=_e(e,"code-block-open-marker");l&&l.previousElementSibling&&(n=l.previousElementSibling,r=a+r)}else r=a+r;else r=a.replace(/\S/g," ")+r}else"newline"===o&&(i=!0);n=n.previousElementSibling}return r},Oe=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var n=s(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(n),e.options.counter.enable&&e.counter.render(e,n),e.options.cache.enable&&Object(u.a)()&&(localStorage.setItem(e.options.cache.id,n),e.options.cache.after&&e.options.cache.after(n)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout((function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)}),800)},Le=function(e,t){var n=Object(M.b)(e.sv.element),r=Object(C.b)(n.startContainer,"SPAN");r&&""!==r.textContent.trim()&&(t="\n"+t),n.collapse(!0),document.execCommand("insertHTML",!1,t)},Ae=function(e,t,n,r){var i=Object(M.b)(e.sv.element),o=t.getAttribute("data-type");0===e.sv.element.childNodes.length&&(e.sv.element.innerHTML='<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">\n</span></span>',Object(M.f)(e.sv.element,i));var a=Object(w.c)(i.startContainer),l=Object(C.b)(i.startContainer,"SPAN");if(a){if("link"===o){var s=void 0;return s=""===i.toString()?""+n+Lute.Caret+r:""+n+i.toString()+r.replace(")",Lute.Caret+")"),void document.execCommand("insertHTML",!1,s)}if("italic"===o||"bold"===o||"strike"===o||"inline-code"===o||"code"===o||"table"===o||"line"===o)return s=void 0,s=""===i.toString()?""+n+Lute.Caret+("code"===o?"":r):""+n+i.toString()+Lute.Caret+("code"===o?"":r),"table"===o||"code"===o&&l&&""!==l.textContent?s="\n\n"+s:"line"===o&&(s="\n\n"+n+"\n"+Lute.Caret),void document.execCommand("insertHTML",!1,s);if(("check"===o||"list"===o||"ordered-list"===o||"quote"===o)&&l){var c="* ";"check"===o?c="* [ ] ":"ordered-list"===o?c="1. ":"quote"===o&&(c="> ");var d=_e(l,"newline");return d?d.insertAdjacentText("afterend",c):a.insertAdjacentText("afterbegin",c),void N(e)}Object(M.f)(e.sv.element,i),Oe(e)}},je=function(e,t,n){var r=Object(w.c)(t.startContainer);if(r||(r=e.wysiwyg.element),n&&"formatItalic"!==n.inputType&&"deleteByDrag"!==n.inputType&&"insertFromDrop"!==n.inputType&&"formatBold"!==n.inputType&&"formatRemove"!==n.inputType&&"formatStrikeThrough"!==n.inputType&&"insertUnorderedList"!==n.inputType&&"insertOrderedList"!==n.inputType&&"formatOutdent"!==n.inputType&&"formatIndent"!==n.inputType&&""!==n.inputType||!n){var i=function(e){for(var t=e.previousSibling;t;){if(3!==t.nodeType&&"A"===t.tagName&&!t.previousSibling&&""===t.innerHTML.replace(a.a.ZWSP,"")&&t.nextSibling)return t;t=t.previousSibling}return!1}(t.startContainer);i&&i.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach((function(e){e.remove()})),t.insertNode(document.createElement("wbr")),r.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")}));var o="";("link-ref-defs-block"===r.getAttribute("data-type")||We(r.innerText))&&(r=e.wysiwyg.element);var l=r.isEqualNode(e.wysiwyg.element),s=Object(w.d)(r,"data-type","footnotes-block");if(l)o=r.innerHTML;else{var c,d,u=Object(w.b)(t.startContainer);if(u&&!s&&(r=Object(C.b)(t.startContainer,"BLOCKQUOTE")?Object(w.c)(t.startContainer)||r:u),s&&(r=s),o=r.outerHTML,"UL"===r.tagName||"OL"===r.tagName){var p=r.previousElementSibling,f=r.nextElementSibling;!p||"UL"!==p.tagName&&"OL"!==p.tagName||(o=p.outerHTML+o,p.remove()),!f||"UL"!==f.tagName&&"OL"!==f.tagName||(o+=f.outerHTML,f.remove()),o=o.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}(c=e.wysiwyg.element.querySelector("[data-type='link-ref-defs-block']"))&&!r.isEqualNode(c)&&(o+=c.outerHTML,c.remove()),(d=e.wysiwyg.element.querySelector("[data-type='footnotes-block']"))&&!r.isEqualNode(d)&&(o+=d.outerHTML,d.remove())}if('<p data-block="0">```<wbr></p>'===(o=o.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""))&&e.hint.recentLanguage&&(o='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),k("SpinVditorDOM",o,"argument",e.options.debugger),o=e.lute.SpinVditorDOM(o),k("SpinVditorDOM",o,"result",e.options.debugger),l)r.innerHTML=o;else if(r.outerHTML=o,(c=e.wysiwyg.element.querySelector("[data-type='link-ref-defs-block']"))&&e.wysiwyg.element.insertAdjacentElement("beforeend",c),(d=e.wysiwyg.element.querySelector("[data-type='footnotes-block']"))&&e.wysiwyg.element.insertAdjacentElement("beforeend",d),s){var h=Object(w.h)(e.wysiwyg.element.querySelector("wbr"),"LI");if(h){var m=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'+h.getAttribute("data-marker")+'"]');m&&m.setAttribute("aria-label",h.textContent.trim().substr(0,24))}}(Object(C.a)(r)||o.startsWith("<h")||"deleteContentBackward"===(null==n?void 0:n.inputType)||"deleteContentForward"===(null==n?void 0:n.inputType))&&Xe(e),Object(M.f)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach((function(t){j(t,e)}))}K(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Me=function(e,t,n){if(229===e.keyCode&&""===e.code&&"Unidentified"===e.key&&"sv"!==t.currentMode){var r=Object(w.c)(n);if(r&&""===r.textContent.trim())return t[t.currentMode].composingLock=!0,!1}return!0},Re=function(e,t,n){if(!("Enter"===n.key||"Tab"===n.key||"Backspace"===n.key||n.key.indexOf("Arrow")>-1||Object(u.d)(n)||"Escape"===n.key||n.shiftKey||n.altKey)){var r=Object(w.f)(e.startContainer,"P")||Object(w.f)(e.startContainer,"LI");if(r&&0===Object(M.c)(r,t[t.currentMode].element,e).start){var i=document.createTextNode(a.a.ZWSP);e.insertNode(i),e.setStartAfter(i)}}},He=function(e,t){if("ArrowDown"===t||"ArrowUp"===t){var n=Object(w.d)(e.startContainer,"data-type","math-inline")||Object(w.d)(e.startContainer,"data-type","html-entity")||Object(w.d)(e.startContainer,"data-type","html-inline");n&&("ArrowDown"===t&&e.setStartAfter(n.parentElement),"ArrowUp"===t&&e.setStartBefore(n.parentElement))}},De=function(e,t){var n=Object(M.b)(e[e.currentMode].element),r=Object(w.c)(n.startContainer);r&&(r.insertAdjacentHTML(t,'<p data-block="0">'+a.a.ZWSP+"<wbr>\n</p>"),Object(M.f)(e[e.currentMode].element,n),oe(e),Ge(e))},Ne=function(e){var t=Object(w.f)(e,"TABLE");return!(!t||!t.rows[0].cells[0].isSameNode(e))&&t},Pe=function(e){var t=Object(w.f)(e,"TABLE");return!(!t||!t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e))&&t},Ie=function(e,t,n){void 0===n&&(n=!0);var r=e.previousElementSibling;return r||(r=e.parentElement.previousElementSibling?e.parentElement.previousElementSibling.lastElementChild:"TBODY"===e.parentElement.parentElement.tagName&&e.parentElement.parentElement.previousElementSibling?e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:null),r&&(t.selectNodeContents(r),n||t.collapse(!1),Object(M.h)(t)),r},Be=function(e,t,n,r,i){var o=Object(M.c)(r,e[e.currentMode].element,n);if("ArrowDown"===t.key&&-1===r.textContent.trimRight().substr(o.start).indexOf("\n")||"ArrowRight"===t.key&&o.start>=r.textContent.trimRight().length){var l=i.nextElementSibling;return!l||l&&("TABLE"===l.tagName||l.getAttribute("data-type"))?(i.insertAdjacentHTML("afterend",'<p data-block="0">'+a.a.ZWSP+"<wbr></p>"),Object(M.f)(e[e.currentMode].element,n)):(n.selectNodeContents(l),n.collapse(!0),Object(M.h)(n)),t.preventDefault(),!0}return!1},qe=function(e,t,n,r,i){var o=Object(M.c)(r,e[e.currentMode].element,n);if("ArrowUp"===t.key&&-1===r.textContent.substr(o.start).indexOf("\n")||("ArrowLeft"===t.key||"Backspace"===t.key&&""===n.toString())&&0===o.start){var l=i.previousElementSibling;return!l||l&&("TABLE"===l.tagName||l.getAttribute("data-type"))?(i.insertAdjacentHTML("beforebegin",'<p data-block="0">'+a.a.ZWSP+"<wbr></p>"),Object(M.f)(e[e.currentMode].element,n)):(n.selectNodeContents(l),n.collapse(!1),Object(M.h)(n)),t.preventDefault(),!0}return!1},Ue=function(e,t,n,r){void 0===r&&(r=!0);var i=Object(w.f)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),t.insertNode(document.createElement("wbr")),r&&i){for(var o="",a=0;a<i.parentElement.childElementCount;a++){var l=i.parentElement.children[a].querySelector("input");l&&l.remove(),o+='<p data-block="0">'+i.parentElement.children[a].innerHTML.trimLeft()+"</p>"}i.parentElement.insertAdjacentHTML("beforebegin",o),i.parentElement.remove()}else if(i)if("check"===n)i.parentElement.querySelectorAll("li").forEach((function(e){e.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'+(0===e.textContent.indexOf(" ")?"":" ")),e.classList.add("vditor-task")}));else{i.querySelector("input")&&i.parentElement.querySelectorAll("li").forEach((function(e){e.querySelector("input").remove(),e.classList.remove("vditor-task")}));var s=void 0;(s="list"===n?document.createElement("ul"):document.createElement("ol")).innerHTML=i.parentElement.innerHTML,i.parentElement.parentNode.replaceChild(s,i.parentElement)}else{var c=Object(w.d)(t.startContainer,"data-block","0");c||(e[e.currentMode].element.querySelector("wbr").remove(),(c=e[e.currentMode].element.querySelector("p")).innerHTML="<wbr>"),"check"===n?(c.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '+c.innerHTML+"</li></ul>"),c.remove()):"list"===n?(c.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'+c.innerHTML+"</li></ul>"),c.remove()):"ordered-list"===n&&(c.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'+c.innerHTML+"</li></ol>"),c.remove())}},Fe=function(e,t,n){if(t&&t.previousElementSibling){e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),n.insertNode(document.createElement("wbr"));var r=t.parentElement,i=t.getAttribute("data-marker");1!==i.length&&(i="1"+i.slice(-1)),t.previousElementSibling.insertAdjacentHTML("beforeend","<"+r.tagName+' data-block="0"><li data-marker="'+i+'">'+t.innerHTML+"</li></"+r.tagName+">"),t.remove(),"wysiwyg"===e.currentMode?r.outerHTML=e.lute.SpinVditorDOM(r.outerHTML):r.outerHTML=e.lute.SpinVditorIRDOM(r.outerHTML),Object(M.f)(e[e.currentMode].element,n);var o=Object(w.b)(n.startContainer);o&&o.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){j(t,e),"wysiwyg"===e.currentMode&&t.previousElementSibling.setAttribute("style","display:none")})),Ge(e),oe(e)}else e[e.currentMode].element.focus()},Ke=function(e,t,n,r){var i=Object(w.f)(t.parentElement,"LI");if(i){e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),n.insertNode(document.createElement("wbr"));var o=t.parentElement,a=o.cloneNode(),l=!1,s="";o.querySelectorAll("li").forEach((function(e){l&&(s+=e.outerHTML,e.nextElementSibling||e.previousElementSibling?e.remove():e.parentElement.remove()),e.isSameNode(t)&&(l=!0)})),i.insertAdjacentElement("afterend",t),s&&(a.innerHTML=s,t.insertAdjacentElement("beforeend",a)),"wysiwyg"===e.currentMode?r.outerHTML=e.lute.SpinVditorDOM(r.outerHTML):r.outerHTML=e.lute.SpinVditorIRDOM(r.outerHTML),Object(M.f)(e[e.currentMode].element,n);var c=Object(w.b)(n.startContainer);c&&c.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){j(t,e),"wysiwyg"===e.currentMode&&t.previousElementSibling.setAttribute("style","display:none")})),Ge(e),oe(e)}else e[e.currentMode].element.focus()},ze=function(e,t){for(var n=getSelection().getRangeAt(0).startContainer.parentElement,r=e.rows[0].cells.length,i=e.rows.length,o=0,a=0;a<i;a++)for(var l=0;l<r;l++)if(e.rows[a].cells[l].isSameNode(n)){o=l;break}for(var s=0;s<i;s++)e.rows[s].cells[o].setAttribute("align",t)},$e=function(e){var t=e.trimRight().split("\n").pop();return""!==t&&(""===t.replace(/ |-/g,"")||""===t.replace(/ |_/g,"")||""===t.replace(/ |\*/g,""))&&t.replace(/ /g,"").length>2&&!(t.indexOf("-")>-1&&-1===t.trimLeft().indexOf(" ")&&e.trimRight().split("\n").length>1)&&0!==t.indexOf("    ")&&0!==t.indexOf("\t")},Ve=function(e){var t=e.trimRight().split("\n");return 0!==(e=t.pop()).indexOf("    ")&&0!==e.indexOf("\t")&&""!==(e=e.trimLeft())&&0!==t.length&&(""===e.replace(/-/g,"")||""===e.replace(/=/g,""))},We=function(e){return"[toc]"===e.trim().toLowerCase()},Xe=function(e){var t=e[e.currentMode].element;e.outline.render(e);var n=t.querySelector('[data-type="toc-block"]');if(n){var r="";Array.from(t.children).forEach((function(t){if(Object(C.a)(t)){var n=parseInt(t.tagName.substring(1),10),i=new Array(2*(n-1)).fill("&emsp;").join("");"ir"===e.currentMode?r+=i+'<span data-type="toc-h">'+t.textContent.substring(n+1).trim()+"</span><br>":r+=i+'<span data-type="toc-h">'+t.textContent.trim()+"</span><br>"}})),n.innerHTML=r||"[ToC]"}},Ge=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),"wysiwyg"===e.currentMode?K(e,t):"ir"===e.currentMode?pt(e,t):"sv"===e.currentMode&&Oe(e,t)},Je=function(e,t,n,r){var i=e.startContainer,o=Object(w.f)(i,"LI");if(o){if(!Object(u.d)(r)&&!r.altKey&&"Enter"===r.key&&!r.shiftKey&&n&&o.contains(n)&&n.nextElementSibling)return o&&!o.textContent.endsWith("\n")&&o.insertAdjacentText("beforeend","\n"),e.insertNode(document.createTextNode("\n\n")),e.collapse(!1),Ge(t),r.preventDefault(),!0;if(!(Object(u.d)(r)||r.shiftKey||r.altKey||"Backspace"!==r.key||o.previousElementSibling||""!==e.toString()||0!==Object(M.c)(o,t[t.currentMode].element,e).start))return o.nextElementSibling?(o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'+o.innerHTML+"</p>"),o.remove()):o.parentElement.outerHTML='<p data-block="0"><wbr>'+o.innerHTML+"</p>",Object(M.f)(t[t.currentMode].element,e),Ge(t),r.preventDefault(),!0;if(!Object(u.d)(r)&&!r.altKey&&"Tab"===r.key){var a=!1;if((0===e.startOffset&&(3===i.nodeType&&!i.previousSibling||3!==i.nodeType&&"LI"===i.nodeName)||o.classList.contains("vditor-task")&&1===e.startOffset&&3!==i.previousSibling.nodeType&&"INPUT"===i.previousSibling.tagName)&&(a=!0),a)return r.shiftKey?Ke(t,o,e,o.parentElement):Fe(t,o,e),r.preventDefault(),!0}}return!1},Ze=function(e,t,n){if(e.options.tab&&"Tab"===n.key)return n.shiftKey||(""===t.toString()?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),Object(M.h)(t),Ge(e),n.preventDefault(),!0},Ye=function(e,t,n,r){if(n){if(!Object(u.d)(e)&&!e.altKey&&"Enter"===e.key){var o=String.raw(i||(i=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}(["",""],["",""])),n.textContent).replace(/\\\|/g,"").trim(),a=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&a.length>3){var l=a.map((function(){return"---"})).join("|");return l=n.textContent+"\n"+l.substring(3,l.length-3)+"\n|<wbr>",n.outerHTML=t.lute.SpinVditorDOM(l),Object(M.f)(t[t.currentMode].element,r),Ge(t),Ce(t),e.preventDefault(),!0}if($e(n.innerHTML)&&n.previousElementSibling){var s="",c=n.innerHTML.trimRight().split("\n");return c.length>1&&(c.pop(),s='<p data-block="0">'+c.join("\n")+"</p>"),n.insertAdjacentHTML("afterend",s+'<hr data-block="0"><p data-block="0"><wbr>\n</p>'),n.remove(),Object(M.f)(t[t.currentMode].element,r),Ge(t),Ce(t),e.preventDefault(),!0}if(Ve(n.innerHTML))return"wysiwyg"===t.currentMode?n.outerHTML=t.lute.SpinVditorDOM(n.innerHTML+'<p data-block="0"><wbr>\n</p>'):n.outerHTML=t.lute.SpinVditorIRDOM(n.innerHTML+'<p data-block="0"><wbr>\n</p>'),Object(M.f)(t[t.currentMode].element,r),Ge(t),Ce(t),e.preventDefault(),!0}if(r.collapsed&&n.previousElementSibling&&"Backspace"===e.key&&!Object(u.d)(e)&&!e.altKey&&!e.shiftKey&&n.textContent.trimRight().split("\n").length>1&&0===Object(M.c)(n,t[t.currentMode].element,r).start){var d=Object(w.a)(n.previousElementSibling);return d.textContent.endsWith("\n")||(d.textContent=d.textContent+"\n"),d.parentElement.insertAdjacentHTML("beforeend","<wbr>"+n.innerHTML),n.remove(),Object(M.f)(t[t.currentMode].element,r),!1}return!1}},Qe=function(e,t,n){for(var r="",i=0;i<n.parentElement.childElementCount;i++)r+="<td>"+(0===i?" <wbr>":" ")+"</td>";"TH"===n.tagName?n.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>"+r+"</tr></tbody>"):n.parentElement.insertAdjacentHTML("afterend","<tr>"+r+"</tr>"),Object(M.f)(e[e.currentMode].element,t),Ge(e),Ce(e)},rt=function(e,t,n){for(var r=0,i=n.previousElementSibling;i;)r++,i=i.previousElementSibling;for(var o=0;o<t.rows.length;o++)0===o?t.rows[o].cells[r].insertAdjacentHTML("afterend","<th> </th>"):t.rows[o].cells[r].insertAdjacentHTML("afterend","<td> </td>");Ge(e)},et=function(e,t,n){if("TD"===n.tagName){var r=n.parentElement.parentElement;n.parentElement.previousElementSibling?t.selectNodeContents(n.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(r.previousElementSibling.lastElementChild.lastElementChild),1===r.childElementCount?r.remove():n.parentElement.remove(),t.collapse(!1),Object(M.h)(t),Ge(e)}},tt=function(e,t,n,r){for(var i=0,o=r.previousElementSibling;o;)i++,o=o.previousElementSibling;(r.previousElementSibling||r.nextElementSibling)&&(t.selectNodeContents(r.previousElementSibling||r.nextElementSibling),t.collapse(!0));for(var a=0;a<n.rows.length;a++){var l=n.rows[a].cells;if(1===l.length){n.remove(),oe(e);break}l[i].remove()}Object(M.h)(t),Ge(e)},nt=function(e,t,n){var r=n.startContainer,i=Object(w.f)(r,"TD")||Object(w.f)(r,"TH");if(i){if(!Object(u.d)(t)&&!t.altKey&&"Enter"===t.key){i.lastElementChild&&(!i.lastElementChild||i.lastElementChild.isSameNode(i.lastChild)&&"BR"===i.lastElementChild.tagName)||i.insertAdjacentHTML("beforeend","<br>");var o=document.createElement("br");return n.insertNode(o),n.setStartAfter(o),Ge(e),Ce(e),t.preventDefault(),!0}if("Tab"===t.key)return t.shiftKey?(Ie(i,n),t.preventDefault(),!0):((d=i.nextElementSibling)||(d=i.parentElement.nextElementSibling?i.parentElement.nextElementSibling.firstElementChild:"THEAD"===i.parentElement.parentElement.tagName&&i.parentElement.parentElement.nextElementSibling?i.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:null),d&&(n.selectNodeContents(d),Object(M.h)(n)),t.preventDefault(),!0);var a=i.parentElement.parentElement.parentElement;if("ArrowUp"===t.key){if(t.preventDefault(),"TH"===i.tagName)return a.previousElementSibling?(n.selectNodeContents(a.previousElementSibling),n.collapse(!1),Object(M.h)(n)):De(e,"beforebegin"),!0;for(var l=0,s=i.parentElement;l<s.cells.length&&!s.cells[l].isSameNode(i);l++);var c=s.previousElementSibling;return c||(c=s.parentElement.previousElementSibling.firstChild),n.selectNodeContents(c.cells[l]),n.collapse(!1),Object(M.h)(n),!0}if("ArrowDown"===t.key){var d;if(t.preventDefault(),!(s=i.parentElement).nextElementSibling&&"TD"===i.tagName)return a.nextElementSibling?(n.selectNodeContents(a.nextElementSibling),n.collapse(!0),Object(M.h)(n)):De(e,"afterend"),!0;for(l=0;l<s.cells.length&&!s.cells[l].isSameNode(i);l++);return(d=s.nextElementSibling)||(d=s.parentElement.nextElementSibling.firstChild),n.selectNodeContents(d.cells[l]),n.collapse(!0),Object(M.h)(n),!0}if("wysiwyg"===e.currentMode&&!Object(u.d)(t)&&"Enter"===t.key&&!t.shiftKey&&t.altKey){var p=e.wysiwyg.popover.querySelector(".vditor-input");return p.focus(),p.select(),t.preventDefault(),!0}if(!Object(u.d)(t)&&!t.shiftKey&&!t.altKey&&"Backspace"===t.key&&0===n.startOffset&&""===n.toString())return!Ie(i,n,!1)&&a&&(""===a.textContent.trim()?(a.outerHTML='<p data-block="0"><wbr>\n</p>',Object(M.f)(e[e.currentMode].element,n)):(n.setStartBefore(a),n.collapse(!0)),Ge(e)),t.preventDefault(),!0;if(H("⌘-=",t))return Qe(e,n,i),t.preventDefault(),!0;if(H("⌘-⇧-=",t))return rt(e,a,i),t.preventDefault(),!0;if(H("⌘--",t))return et(e,n,i),t.preventDefault(),!0;if(H("⌘-⇧--",t))return tt(e,n,a,i),t.preventDefault(),!0;if(H("⌘-⇧-L",t)){if("ir"===e.currentMode)return ze(a,"left"),Ge(e),t.preventDefault(),!0;if(f=e.wysiwyg.popover.querySelector('[data-type="left"]'))return f.click(),t.preventDefault(),!0}if(H("⌘-⇧-C",t)){if("ir"===e.currentMode)return ze(a,"center"),Ge(e),t.preventDefault(),!0;if(f=e.wysiwyg.popover.querySelector('[data-type="center"]'))return f.click(),t.preventDefault(),!0}if(H("⌘-⇧-R",t)){if("ir"===e.currentMode)return ze(a,"right"),Ge(e),t.preventDefault(),!0;var f;if(f=e.wysiwyg.popover.querySelector('[data-type="right"]'))return f.click(),t.preventDefault(),!0}}return!1},it=function(e,t,n,r){if("PRE"===n.tagName&&H("⌘-A",t))return r.selectNodeContents(n.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&"Tab"===t.key&&!t.shiftKey&&""===r.toString())return r.insertNode(document.createTextNode(e.options.tab)),r.collapse(!1),Ge(e),t.preventDefault(),!0;if("Backspace"===t.key&&!Object(u.d)(t)&&!t.shiftKey&&!t.altKey){var i=Object(M.c)(n,e[e.currentMode].element,r);if((0===i.start||1===i.start&&"\n"===n.innerText)&&""===r.toString())return n.parentElement.outerHTML='<p data-block="0"><wbr>'+n.firstElementChild.innerHTML+"</p>",Object(M.f)(e[e.currentMode].element,r),Ge(e),t.preventDefault(),!0}return!Object(u.d)(t)&&!t.altKey&&"Enter"===t.key&&(n.firstElementChild.textContent.endsWith("\n")||n.firstElementChild.insertAdjacentText("beforeend","\n"),r.extractContents(),r.insertNode(document.createTextNode("\n")),r.collapse(!1),Object(M.h)(r),"wysiwyg"===e.currentMode?je(e,r):R(e,r),Ce(e),t.preventDefault(),!0)},ot=function(e,t,n,r){var i=t.startContainer,o=Object(w.f)(i,"BLOCKQUOTE");if(o&&""===t.toString()){if("Backspace"===n.key&&!Object(u.d)(n)&&!n.shiftKey&&!n.altKey&&0===Object(M.c)(o,e[e.currentMode].element,t).start)return t.insertNode(document.createElement("wbr")),o.outerHTML=o.innerHTML,Object(M.f)(e[e.currentMode].element,t),Ge(e),n.preventDefault(),!0;if(r&&"Enter"===n.key&&!Object(u.d)(n)&&!n.shiftKey&&!n.altKey&&"BLOCKQUOTE"===r.parentElement.tagName){var l=!1;if("\n"===r.innerHTML.replace(a.a.ZWSP,"")||""===r.innerHTML.replace(a.a.ZWSP,"")?(l=!0,r.remove()):r.innerHTML.endsWith("\n\n")&&Object(M.c)(r,e[e.currentMode].element,t).start===r.textContent.length-1&&(r.innerHTML=r.innerHTML.substr(0,r.innerHTML.length-2),l=!0),l)return o.insertAdjacentHTML("afterend",'<p data-block="0">'+a.a.ZWSP+"<wbr>\n</p>"),Object(M.f)(e[e.currentMode].element,t),Ge(e),n.preventDefault(),!0}var s=Object(w.c)(i);if("wysiwyg"===e.currentMode&&s&&H("⌘-⇧-:",n))return t.insertNode(document.createElement("wbr")),s.outerHTML='<blockquote data-block="0">'+s.outerHTML+"</blockquote>",Object(M.f)(e.wysiwyg.element,t),K(e),n.preventDefault(),!0}return!1},at=function(e,t,n){var r=t.startContainer,i=Object(w.e)(r,"vditor-task");if(i){if(H("⌘-⇧-J",n)){var o=i.firstElementChild;return o.checked?o.removeAttribute("checked"):o.setAttribute("checked","checked"),Ge(e),n.preventDefault(),!0}if("Backspace"===n.key&&!Object(u.d)(n)&&!n.shiftKey&&!n.altKey&&""===t.toString()&&1===t.startOffset&&(3===r.nodeType&&r.previousSibling&&"INPUT"===r.previousSibling.tagName||3!==r.nodeType)){var a=i.previousElementSibling;return i.querySelector("input").remove(),a?(Object(w.a)(a).parentElement.insertAdjacentHTML("beforeend","<wbr>"+i.innerHTML.trim()),i.remove()):(i.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'+(i.innerHTML.trim()||"\n")+"</p>"),i.nextElementSibling?i.remove():i.parentElement.remove()),Object(M.f)(e[e.currentMode].element,t),Ge(e),n.preventDefault(),!0}if("Enter"===n.key&&!Object(u.d)(n)&&!n.shiftKey&&!n.altKey){if(""===i.textContent.trim())if(Object(w.e)(i.parentElement,"vditor-task")){var l=Object(w.b)(r);l&&Ke(e,i,t,l)}else if(i.nextElementSibling){var s="",c="",d=!1;Array.from(i.parentElement.children).forEach((function(e){i.isSameNode(e)?d=!0:d?s+=e.outerHTML:c+=e.outerHTML}));var p=i.parentElement.tagName,f="OL"===i.parentElement.tagName?"":' data-marker="'+i.parentElement.getAttribute("data-marker")+'"',h="";c&&(h="UL"===i.parentElement.tagName?"":' start="1"',c="<"+p+' data-tight="true"'+f+' data-block="0">'+c+"</"+p+">"),i.parentElement.outerHTML=c+'<p data-block="0"><wbr>\n</p><'+p+'\n data-tight="true"'+f+' data-block="0"'+h+">"+s+"</"+p+">"}else i.parentElement.insertAdjacentHTML("afterend",'<p data-block="0"><wbr>\n</p>'),1===i.parentElement.querySelectorAll("li").length?i.parentElement.remove():i.remove();else 3!==r.nodeType&&0===t.startOffset&&"INPUT"===r.firstChild.tagName?t.setStart(r.childNodes[1],1):(t.setEndAfter(i.lastChild),i.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'+i.getAttribute("data-marker")+'"><input type="checkbox"> <wbr></li>'),document.querySelector("wbr").after(t.extractContents()));return Object(M.f)(e[e.currentMode].element,t),Ge(e),Ce(e),n.preventDefault(),!0}}return!1},dt=function(e,t,n,r){if(3!==t.startContainer.nodeType){var i=t.startContainer.children[t.startOffset];if(i&&"HR"===i.tagName)return t.selectNodeContents(i.previousElementSibling),t.collapse(!1),n.preventDefault(),!0}if(r){var o=r.previousElementSibling;if(o&&0===Object(M.c)(r,e[e.currentMode].element,t).start&&(Object(u.e)()&&"HR"===o.tagName||"TABLE"===o.tagName)){if("TABLE"===o.tagName){var a=o.lastElementChild.lastElementChild.lastElementChild;a.innerHTML=a.innerHTML.trimLeft()+"<wbr>"+r.textContent.trim(),r.remove()}else o.remove();return Object(M.f)(e[e.currentMode].element,t),Ge(e),n.preventDefault(),!0}}return!1},st=function(e){Object(u.e)()&&3!==e.startContainer.nodeType&&"HR"===e.startContainer.tagName&&e.setStartBefore(e.startContainer)},lt=function(e,t,n){var r,i;if(!Object(u.e)())return!1;if("ArrowUp"===e.key&&t&&"TABLE"===(null===(r=t.previousElementSibling)||void 0===r?void 0:r.tagName)){var o=t.previousElementSibling;return n.selectNodeContents(o.rows[o.rows.length-1].lastElementChild),n.collapse(!1),e.preventDefault(),!0}return!("ArrowDown"!==e.key||!t||"TABLE"!==(null===(i=t.nextElementSibling)||void 0===i?void 0:i.tagName)||(n.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),n.collapse(!0),e.preventDefault(),0))},ct=function(e,t,n){var r;t.stopPropagation(),t.preventDefault();var i=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),l={},s=function(t){var n=t.TokensStr();if(34===t.__internal_object__.Parent.Type&&n&&-1===n.indexOf("file://")&&e.options.upload.linkToImgUrl){var r=new XMLHttpRequest;r.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&r.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(r.withCredentials=!0),pe(e,r),r.setRequestHeader("Content-Type","application/json; charset=utf-8"),r.onreadystatechange=function(){if(r.readyState===XMLHttpRequest.DONE){if(200===r.status){var t=JSON.parse(r.responseText);if(0!==t.code)return void e.tip.show(t.msg);var n=t.data.originalURL;if("sv"===e.currentMode)e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach((function(e){e.textContent===n&&(e.textContent=t.data.url)}));else{var i=e[e.currentMode].element.querySelector('img[src="'+n+'"]');i.src=t.data.url,"ir"===e.currentMode&&(i.previousElementSibling.previousElementSibling.innerHTML=t.data.url)}Ge(e)}else e.tip.show(r.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(r.responseText)}},r.send(JSON.stringify({url:n}))}return"ir"===e.currentMode?['<span class="vditor-ir__marker vditor-ir__marker--link">'+n+"</span>",Lute.WalkStop]:"wysiwyg"===e.currentMode?["",Lute.WalkStop]:['<span class="vditor-sv__marker--link">'+n+"</span>",Lute.WalkStop]};i.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/gi,"").trim()!=='<a href="'+o+'">'+o+"</a>"&&i.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/gi,"").trim()!=='\x3c!--StartFragment--\x3e<a href="'+o+'">'+o+"</a>\x3c!--EndFragment--\x3e"||(i="");var c=(new DOMParser).parseFromString(i,"text/html");c.body&&(i=c.body.innerHTML);var d=function(e,t,n){void 0===n&&(n="sv");var r=document.createElement("div");r.innerHTML=e;var i=!1;1===r.childElementCount&&r.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(i=!0);var o=r.querySelectorAll("pre");if(1===r.childElementCount&&1===o.length&&"vditor-wysiwyg"!==o[0].className&&"vditor-sv"!==o[0].className&&(i=!0),0===e.indexOf('\n<p class="p1">')&&(i=!0),1===r.childElementCount&&"TABLE"===r.firstElementChild.tagName&&r.querySelector(".line-number")&&r.querySelector(".line-content")&&(i=!0),i){var a=t||e;return/\n/.test(a)||1===o.length?"wysiwyg"===n?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'+a.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"<wbr></code></pre></div>":"\n```\n"+a.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":"wysiwyg"===n?"<code>"+a.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"</code><wbr>":"`"+a+"`"}return!1}(i,o,e.currentMode),u="sv"===e.currentMode?Object(w.d)(t.target,"data-type","code-block"):Object(w.f)(t.target,"CODE");if(u)if("sv"===e.currentMode)document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;"));else{var p=Object(M.c)(t.target,e[e.currentMode].element);"PRE"!==u.parentElement.tagName&&(o+=a.a.ZWSP),u.textContent=u.textContent.substring(0,p.start)+o+u.textContent.substring(p.end),Object(M.g)(p.start+o.length,p.start+o.length,u.parentElement),(null===(r=u.parentElement)||void 0===r?void 0:r.nextElementSibling.classList.contains("vditor-"+e.currentMode+"__preview"))&&(u.parentElement.nextElementSibling.innerHTML=u.outerHTML,j(u.parentElement.nextElementSibling,e))}else if(d)n.pasteCode(d);else if(""!==i.trim()){var f=document.createElement("div");f.innerHTML=i,f.querySelectorAll("[style]").forEach((function(e){e.removeAttribute("style")})),f.querySelectorAll(".vditor-copy").forEach((function(e){e.remove()})),"ir"===e.currentMode?(l.HTML2VditorIRDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Object(M.d)(e.lute.HTML2VditorIRDOM(f.innerHTML),e)):"wysiwyg"===e.currentMode?(l.HTML2VditorDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Object(M.d)(e.lute.HTML2VditorDOM(f.innerHTML),e)):(l.Md2VditorSVDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Ee(e,e.lute.HTML2Md(f.innerHTML).trimRight())),e.outline.render(e)}else t.clipboardData.files.length>0&&e.options.upload.url?he(e,t.clipboardData.files):""!==o.trim()&&0===t.clipboardData.files.length&&("ir"===e.currentMode?(l.Md2VditorIRDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Object(M.d)(e.lute.Md2VditorIRDOM(o),e)):"wysiwyg"===e.currentMode?(l.Md2VditorDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Object(M.d)(e.lute.Md2VditorDOM(o),e)):(l.Md2VditorSVDOM={renderLinkDest:s},e.lute.SetJSRenderers({renderers:l}),Ee(e,o)),e.outline.render(e));if("sv"!==e.currentMode){var h=Object(w.c)(Object(M.b)(e[e.currentMode].element).startContainer);if(h){var m=Object(M.b)(e[e.currentMode].element);e[e.currentMode].element.querySelectorAll("wbr").forEach((function(e){e.remove()})),m.insertNode(document.createElement("wbr")),"wysiwyg"===e.currentMode?h.outerHTML=e.lute.SpinVditorDOM(h.outerHTML):h.outerHTML=e.lute.SpinVditorIRDOM(h.outerHTML),Object(M.f)(e[e.currentMode].element,m)}e[e.currentMode].element.querySelectorAll(".vditor-"+e.currentMode+"__preview[data-render='2']").forEach((function(t){j(t,e)}))}Ge(e)},ut=function(e){e.hint.render(e);var t=Object(M.b)(e.ir.element).startContainer,n=Object(w.d)(t,"data-type","code-block-info");if(n)if(""===n.textContent.replace(a.a.ZWSP,"")&&e.hint.recentLanguage)n.textContent=a.a.ZWSP+e.hint.recentLanguage,Object(M.b)(e.ir.element).selectNodeContents(n);else{var r=[],i=n.textContent.substring(0,Object(M.c)(n,e.ir.element).start).replace(a.a.ZWSP,"");a.a.CODE_LANGUAGES.forEach((function(e){e.indexOf(i.toLowerCase())>-1&&r.push({html:e,value:e})})),e.hint.genHTML(r,i,e)}},pt=function(e,t){void 0===t&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&ut(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout((function(){if(!e.ir.composingLock){var n=s(e);"function"==typeof e.options.input&&t.enableInput&&e.options.input(n),e.options.counter.enable&&e.counter.render(e,n),e.options.cache.enable&&Object(u.a)()&&(localStorage.setItem(e.options.cache.id,n),e.options.cache.after&&e.options.cache.after(n)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}}),800)},ft=function(e,t){var n=Object(M.b)(e.ir.element),r=Object(w.c)(n.startContainer)||n.startContainer;if(r){var i=r.querySelector(".vditor-ir__marker--heading");i?i.innerHTML=t:(r.insertAdjacentText("afterbegin",t),n.selectNodeContents(r),n.collapse(!1)),R(e,n.cloneRange()),F(e)}},ht=function(e,t,n){var r=Object(w.d)(e.startContainer,"data-type",n);if(r){r.firstElementChild.remove(),r.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var i=document.createElement("div");i.innerHTML=t.lute.SpinVditorIRDOM(r.outerHTML),r.outerHTML=i.firstElementChild.innerHTML.trim()}},mt=function(e,t,n,r){var i=Object(M.b)(e.ir.element),o=t.getAttribute("data-type"),a=i.startContainer;3===a.nodeType&&(a=a.parentElement);var l=!0;if(t.classList.contains("vditor-menu--current"))if("quote"===o){var s=Object(w.f)(a,"BLOCKQUOTE");s&&(i.insertNode(document.createElement("wbr")),s.outerHTML=""===s.innerHTML.trim()?'<p data-block="0">'+s.innerHTML+"</p>":s.innerHTML)}else if("link"===o){var c=Object(w.d)(i.startContainer,"data-type","a");if(c){var d=Object(w.e)(i.startContainer,"vditor-ir__link");d?(i.insertNode(document.createElement("wbr")),c.outerHTML=d.innerHTML):c.outerHTML=c.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else"italic"===o?ht(i,e,"em"):"bold"===o?ht(i,e,"strong"):"strike"===o?ht(i,e,"s"):"inline-code"===o?ht(i,e,"code"):"check"!==o&&"list"!==o&&"ordered-list"!==o||(Ue(e,i,o),l=!1,t.classList.remove("vditor-menu--current"));else{0===e.ir.element.childNodes.length&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',Object(M.f)(e.ir.element,i));var u=Object(w.c)(i.startContainer);if("line"===o){if(u){var f='<hr data-block="0"><p data-block="0"><wbr>\n</p>';""===u.innerHTML.trim()?u.outerHTML=f:u.insertAdjacentHTML("afterend",f)}}else if("quote"===o)u&&(i.insertNode(document.createElement("wbr")),u.outerHTML='<blockquote data-block="0">'+u.outerHTML+"</blockquote>",l=!1,t.classList.add("vditor-menu--current"));else if("link"===o){var h=void 0;h=""===i.toString()?n+"<wbr>"+r:""+n+i.toString()+r.replace(")","<wbr>)"),document.execCommand("insertHTML",!1,h),l=!1,t.classList.add("vditor-menu--current")}else"italic"===o||"bold"===o||"strike"===o||"inline-code"===o||"code"===o||"table"===o?(h=void 0,h=""===i.toString()?n+"<wbr>"+r:""+n+i.toString()+"<wbr>"+r,"table"===o||"code"===o?(h="\n"+h,t.classList.add("vditor-menu--disabled")):t.classList.add("vditor-menu--current"),document.execCommand("insertHTML",!1,h),"table"===o&&(i.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),Object(M.h)(i)),"code"!==o&&"inline-code"!==o&&(l=!1)):"check"!==o&&"list"!==o&&"ordered-list"!==o||(Ue(e,i,o,!1),l=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}Object(M.f)(e.ir.element,i),pt(e),l&&F(e)},vt=function(){function e(e){var t=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(e,n){t.element.style.display="none";var r=e.getAttribute("data-value"),i=window.getSelection().getRangeAt(0);if("ir"===n.currentMode){var o=Object(w.d)(i.startContainer,"data-type","code-block-info");if(o)return o.textContent=a.a.ZWSP+r.trimRight(),i.selectNodeContents(o),i.collapse(!1),pt(n),o.parentElement.querySelectorAll("code").forEach((function(e){e.className="language-"+r.trimRight()})),j(o.parentElement.querySelector(".vditor-ir__preview"),n),void(t.recentLanguage=r.trimRight())}if("wysiwyg"===n.currentMode&&3!==i.startContainer.nodeType&&i.startContainer.firstElementChild.classList.contains("vditor-input")){var l=i.startContainer.firstElementChild;return l.value=r.trimRight(),i.selectNodeContents(l),i.collapse(!1),l.dispatchEvent(new CustomEvent("input")),void(t.recentLanguage=r.trimRight())}if(i.setStart(i.startContainer,t.lastIndex),i.deleteContents(),":"===t.splitChar&&r.indexOf(":")>-1&&"sv"!==n.currentMode?(Object(M.d)(n.lute.SpinVditorDOM(r),n),i.insertNode(document.createTextNode(" "))):i.insertNode(document.createTextNode(r)),i.collapse(!1),Object(M.h)(i),"wysiwyg"===n.currentMode)(s=Object(w.e)(i.startContainer,"vditor-wysiwyg__block"))&&s.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(s.lastElementChild.innerHTML=s.firstElementChild.innerHTML,j(s.lastElementChild,n));else if("ir"===n.currentMode){var s;(s=Object(w.e)(i.startContainer,"vditor-ir__marker--pre"))&&s.nextElementSibling.classList.contains("vditor-ir__preview")&&(s.nextElementSibling.innerHTML=s.innerHTML,j(s.nextElementSibling,n))}Ge(n)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",e.push({key:":"})}return e.prototype.render=function(e){var t=this;if(window.getSelection().focusNode){var n,r=getSelection().getRangeAt(0);n=r.startContainer.textContent.substring(0,r.startOffset)||"";var i=this.getKey(n,e.options.hint.extend);if(void 0===i)this.element.style.display="none",clearTimeout(this.timeId);else if(":"===this.splitChar){var o=""===i?e.options.hint.emoji:e.lute.GetEmojis(),a=[];Object.keys(o).forEach((function(e){0===e.indexOf(i.toLowerCase())&&(o[e].indexOf(".")>-1?a.push({html:'<img src="'+o[e]+'" title=":'+e+':"/> :'+e+":",value:":"+e+":"}):a.push({html:'<span class="vditor-hint__emoji">'+o[e]+"</span>"+e,value:o[e]}))})),this.genHTML(a,i,e)}else e.options.hint.extend.forEach((function(n){n.key===t.splitChar&&(clearTimeout(t.timeId),t.timeId=window.setTimeout((function(){t.genHTML(n.hint(i),i,e)}),e.options.hint.delay))}))}},e.prototype.genHTML=function(e,t,n){var r=this;if(0!==e.length){var i=n[n.currentMode].element,o=Object(M.a)(i),a=o.left+n.outline.element.offsetWidth,l=o.top,s="";e.forEach((function(e,n){if(!(n>7)){var r=e.html;if(""!==t){var i=r.lastIndexOf(">")+1,o=r.substr(i),a=o.toLowerCase().indexOf(t.toLowerCase());a>-1&&(o=o.substring(0,a)+"<b>"+o.substring(a,a+t.length)+"</b>"+o.substring(a+t.length),r=r.substr(0,i)+o)}s+='<button data-value="'+e.value+' "\n'+(0===n?"class='vditor-hint--current'":"")+"> "+r+"</button>"}})),this.element.innerHTML=s;var c=parseInt(document.defaultView.getComputedStyle(i,null).getPropertyValue("line-height"),10);this.element.style.top=l+(c||22)+"px",this.element.style.left=a+"px",this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach((function(e){e.addEventListener("click",(function(t){r.fillEmoji(e,n),t.preventDefault()}))})),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top=l-this.element.offsetHeight+"px"),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")}else this.element.style.display="none"},e.prototype.select=function(e,t){if(0===this.element.querySelectorAll("button").length||"none"===this.element.style.display)return!1;var n=this.element.querySelector(".vditor-hint--current");if("ArrowDown"===e.key)return e.preventDefault(),e.stopPropagation(),n.removeAttribute("class"),n.nextElementSibling?n.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if("ArrowUp"===e.key){if(e.preventDefault(),e.stopPropagation(),n.removeAttribute("class"),n.previousElementSibling)n.previousElementSibling.className="vditor-hint--current";else{var r=this.element.children.length;this.element.children[r-1].className="vditor-hint--current"}return!0}return!(Object(u.d)(e)||e.shiftKey||e.altKey||"Enter"!==e.key||(e.preventDefault(),e.stopPropagation(),this.fillEmoji(n,t),0))},e.prototype.getKey=function(e,t){var n,r=this;if(this.lastIndex=-1,this.splitChar="",t.forEach((function(t){var n=e.lastIndexOf(t.key);r.lastIndex<n&&(r.splitChar=t.key,r.lastIndex=n)})),-1===this.lastIndex)return n;var i=e.split(this.splitChar),o=i[i.length-1];if(i.length>1&&o.trim()===o)if(2===i.length&&""===i[0]&&i[1].length<32)n=i[1];else{var a=i[i.length-2].slice(-1);" "===Object(l.a)(a)&&o.length<32&&(n=o)}return n},e}(),gt=function(){function e(e){this.composingLock=!1;var t=document.createElement("div");t.className="vditor-ir",t.innerHTML='<pre class="vditor-reset" placeholder="'+e.options.placeholder+'"\n contenteditable="true" spellcheck="false"></pre>',this.element=t.firstElementChild,this.bindEvent(e),ve(e,this.element),ge(e,this.element),ke(e,this.element),Se(e,this.element),ye(e,this.element),be(e,this.element,this.copy),we(e,this.element,this.copy)}return e.prototype.copy=function(e,t){var n=getSelection().getRangeAt(0);if(""!==n.toString()){e.stopPropagation(),e.preventDefault();var r=document.createElement("div");r.appendChild(n.cloneContents()),e.clipboardData.setData("text/plain",t.lute.VditorIRDOM2Md(r.innerHTML).trim()),e.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("paste",(function(t){ct(e,t,{pasteCode:function(e){document.execCommand("insertHTML",!1,e)}})})),this.element.addEventListener("compositionstart",(function(e){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(n){Object(u.e)()||R(e,getSelection().getRangeAt(0).cloneRange()),t.composingLock=!1})),this.element.addEventListener("input",(function(n){t.preventInput?t.preventInput=!1:t.composingLock||R(e,getSelection().getRangeAt(0).cloneRange(),!1,n)})),this.element.addEventListener("click",(function(n){if("INPUT"===n.target.tagName)return n.target.checked?n.target.setAttribute("checked","checked"):n.target.removeAttribute("checked"),t.preventInput=!0,void pt(e);var r=Object(M.b)(t.element),i=Object(w.e)(n.target,"vditor-ir__preview");if(i||(i=Object(w.e)(r.startContainer,"vditor-ir__preview")),i&&(i.previousElementSibling.firstElementChild?r.selectNodeContents(i.previousElementSibling.firstElementChild):r.selectNodeContents(i.previousElementSibling),r.collapse(!0),Object(M.h)(r),Ce(e)),"IMG"===n.target.tagName){var o=n.target.parentElement.querySelector(".vditor-ir__marker--link");o&&(r.selectNode(o),Object(M.h)(r))}if(n.target.isEqualNode(t.element)&&t.element.lastElementChild&&r.collapsed){var l=t.element.lastElementChild.getBoundingClientRect();n.y>l.top+l.height&&("P"===t.element.lastElementChild.tagName&&""===t.element.lastElementChild.textContent.trim().replace(a.a.ZWSP,"")?(r.selectNodeContents(t.element.lastElementChild),r.collapse(!1)):(t.element.insertAdjacentHTML("beforeend",'<p data-block="0">'+a.a.ZWSP+"<wbr></p>"),Object(M.f)(t.element,r)))}""===r.toString()?D(r,e):setTimeout((function(){D(Object(M.b)(t.element),e)})),F(e)})),this.element.addEventListener("keyup",(function(n){if(!n.isComposing&&!Object(u.d)(n))if("Enter"===n.key&&Ce(e),F(e),"Backspace"!==n.key&&"Delete"!==n.key||""===e.ir.element.innerHTML||1!==e.ir.element.childNodes.length||!e.ir.element.firstElementChild||"P"!==e.ir.element.firstElementChild.tagName||0!==e.ir.element.firstElementChild.childElementCount||""!==e.ir.element.textContent&&"\n"!==e.ir.element.textContent){var r=Object(M.b)(t.element);"Backspace"===n.key?(Object(u.e)()&&"\n"===r.startContainer.textContent&&1===r.startOffset&&(r.startContainer.textContent="",D(r,e)),t.element.querySelectorAll(".language-math").forEach((function(e){var t=e.querySelector("br");t&&t.remove()}))):n.key.indexOf("Arrow")>-1?("ArrowLeft"!==n.key&&"ArrowRight"!==n.key||ut(e),D(r,e)):229===n.keyCode&&""===n.code&&"Unidentified"===n.key&&D(r,e);var i=Object(w.e)(r.startContainer,"vditor-ir__preview");if(i){if("ArrowUp"===n.key||"ArrowLeft"===n.key)return i.previousElementSibling.firstElementChild?r.selectNodeContents(i.previousElementSibling.firstElementChild):r.selectNodeContents(i.previousElementSibling),r.collapse(!1),n.preventDefault(),!0;if("SPAN"===i.tagName&&("ArrowDown"===n.key||"ArrowRight"===n.key))return"html-entity"===i.parentElement.getAttribute("data-type")?(i.parentElement.insertAdjacentText("afterend",a.a.ZWSP),r.setStart(i.parentElement.nextSibling,1)):r.selectNodeContents(i.parentElement.lastElementChild),r.collapse(!1),n.preventDefault(),!0}}else e.ir.element.innerHTML=""}))},e}(),yt=function(e){return"sv"===e.currentMode?e.lute.Md2HTML(s(e)):"wysiwyg"===e.currentMode?e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML):"ir"===e.currentMode?e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML):void 0},bt=n(22),wt=n(20),Ct=function(){function e(e){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'+e+'</div>\n<div class="vditor-outline__content"></div>'}return e.prototype.render=function(e){"block"===this.element.style.display&&("block"===e.preview.element.style.display?Object(wt.a)(e.preview.element.lastElementChild,this.element.lastElementChild,e):Object(wt.a)(e[e.currentMode].element,this.element.lastElementChild,e))},e.prototype.toggle=function(e,t){var n;void 0===t&&(t=!0);var r=null===(n=e.toolbar.elements.outline)||void 0===n?void 0:n.firstElementChild;t&&window.innerWidth>=a.a.MOBILE_WIDTH?(this.element.style.display="block",this.render(e),null==r||r.classList.add("vditor-menu--current")):(this.element.style.display="none",null==r||r.classList.remove("vditor-menu--current")),B(e)},e}(),kt=n(18),St=function(){function e(e){var t=this;this.element=document.createElement("div"),this.element.className="vditor-preview";var n=document.createElement("div");n.className="vditor-reset",e.options.classes.preview&&n.classList.add(e.options.classes.preview),n.style.maxWidth=e.options.preview.maxWidth+"px",n.addEventListener("copy",(function(n){var r=document.createElement("div");r.className="vditor-reset",r.appendChild(getSelection().getRangeAt(0).cloneContents()),t.copyToX(e,r),n.preventDefault()}));var r=e.options.preview.actions,i=document.createElement("div");i.className="vditor-preview__action";for(var o=[],a=0;a<r.length;a++){var l=r[a];if("object"!=typeof l)switch(l){case"desktop":o.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":o.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":o.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":o.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":o.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>')}else o.push('<button type="button" data-type="'+l.key+'" class="'+l.className+'">'+l.text+"</button>")}i.innerHTML=o.join(""),this.element.appendChild(i),this.element.appendChild(n),i.addEventListener(Object(u.b)(),(function(o){var a=Object(C.b)(o.target,"BUTTON");if(a){var l=a.getAttribute("data-type"),s=r.find((function(e){return(null==e?void 0:e.key)===l}));s?s.click(l):"mp-wechat"!==l&&"zhihu"!==l?(n.style.width="desktop"===l?"auto":"tablet"===l?"780px":"360px",n.scrollWidth>n.parentElement.clientWidth&&(n.style.width="auto"),t.render(e),i.querySelectorAll("button").forEach((function(e){e.classList.remove("vditor-preview__action--current")})),a.classList.add("vditor-preview__action--current")):t.copyToX(e,t.element.lastElementChild.cloneNode(!0),l)}}))}return e.prototype.render=function(e,t){var n=this;if(clearTimeout(this.mdTimeoutId),"none"!==this.element.style.display)if(t)this.element.lastElementChild.innerHTML=t;else if(""!==s(e).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")){var r=(new Date).getTime(),i=s(e);this.mdTimeoutId=window.setTimeout((function(){if(e.options.preview.url){var t=new XMLHttpRequest;t.open("POST",e.options.preview.url),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE)if(200===t.status){var o=JSON.parse(t.responseText);if(0!==o.code)return void e.tip.show(o.msg);e.options.preview.transform&&(o.data=e.options.preview.transform(o.data)),n.element.lastElementChild.innerHTML=o.data,n.afterRender(e,r)}else{var a=e.lute.Md2HTML(i);e.options.preview.transform&&(a=e.options.preview.transform(a)),n.element.lastElementChild.innerHTML=a,n.afterRender(e,r)}},t.send(JSON.stringify({markdownText:i}))}else{var o=e.lute.Md2HTML(i);e.options.preview.transform&&(o=e.options.preview.transform(o)),n.element.lastElementChild.innerHTML=o,n.afterRender(e,r)}}),e.options.preview.delay)}else this.element.lastElementChild.innerHTML="";else"renderPerformance"===this.element.getAttribute("data-type")&&e.tip.hide()},e.prototype.afterRender=function(e,t){e.options.preview.parse&&e.options.preview.parse(this.element);var n=(new Date).getTime()-t;(new Date).getTime()-t>2600?(e.tip.show(P.a[e.options.lang].performanceTip.replace("${x}",n.toString())),e.preview.element.setAttribute("data-type","renderPerformance")):"renderPerformance"===e.preview.element.getAttribute("data-type")&&(e.tip.hide(),e.preview.element.removeAttribute("data-type")),Object(_.a)(e.preview.element.lastElementChild,e.options.lang),Object(T.a)(e.options.preview.hljs,e.preview.element.lastElementChild,e.options.cdn),Object(O.a)(e.preview.element.lastElementChild,{cdn:e.options.cdn,math:e.options.preview.math}),Object(L.a)(e.preview.element.lastElementChild,".language-mermaid",e.options.cdn),Object(x.a)(e.preview.element.lastElementChild,e.options.cdn),Object(E.a)(e.preview.element.lastElementChild,e.options.cdn),Object(A.a)(e.preview.element.lastElementChild,e.options.cdn),Object(S.a)(e.preview.element.lastElementChild,e.options.cdn),Object(kt.a)(e.preview.element.lastElementChild)},e.prototype.copyToX=function(e,t,n){void 0===n&&(n="mp-wechat"),"zhihu"!==n?t.querySelectorAll(".katex-html .base").forEach((function(e){e.style.display="initial"})):t.querySelectorAll(".vditor-math").forEach((function(e){e.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'+e.getAttribute("data-math")+'\\" style="display: block; margin: 0 auto; max-width: 100%;">'})),t.style.backgroundColor="#fff",t.querySelectorAll("code").forEach((function(e){e.style.backgroundImage="none"})),this.element.append(t);var r=t.ownerDocument.createRange();r.selectNode(t),Object(M.h)(r),document.execCommand("copy"),this.element.lastElementChild.remove(),e.tip.show("已复制，可到"+("zhihu"===n?"知乎":"微信公众号平台")+"进行粘贴")},e}(),Et=function(){function e(e){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--"+e.options.resize.position,this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(e)}return e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("mousedown",(function(n){var r=document,i=n.clientY,o=e.element.offsetHeight,a=63+e.element.querySelector(".vditor-toolbar").clientHeight;r.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),t.element.classList.add("vditor-resize--selected"),r.onmousemove=function(t){"top"===e.options.resize.position?e.element.style.height=Math.max(a,o+(i-t.clientY))+"px":e.element.style.height=Math.max(a,o+(t.clientY-i))+"px",e.options.typewriterMode&&(e.sv.element.style.paddingBottom=e.sv.element.parentElement.offsetHeight/2+"px")},r.onmouseup=function(){e.options.resize.after&&e.options.resize.after(e.element.offsetHeight-o),window.captureEvents&&window.captureEvents(),r.onmousemove=null,r.onmouseup=null,r.ondragstart=null,r.onselectstart=null,r.onselect=null,t.element.classList.remove("vditor-resize--selected")}}))},e}(),_t=function(){function e(e){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",e.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(e),ve(e,this.element),ge(e,this.element),ke(e,this.element),Se(e,this.element),ye(e,this.element),be(e,this.element,this.copy),we(e,this.element,this.copy)}return e.prototype.copy=function(e,t){e.stopPropagation(),e.preventDefault(),e.clipboardData.setData("text/plain",me(t[t.currentMode].element))},e.prototype.bindEvent=function(e){var t=this;this.element.addEventListener("paste",(function(t){ct(e,t,{pasteCode:function(e){document.execCommand("insertHTML",!1,e)}})})),this.element.addEventListener("scroll",(function(){if("block"===e.preview.element.style.display){var n=t.element.scrollTop,r=t.element.clientHeight,i=t.element.scrollHeight-parseFloat(t.element.style.paddingBottom||"0"),o=e.preview.element;o.scrollTop=n/r>.5?(n+r)*o.scrollHeight/i-r:n*o.scrollHeight/i}})),this.element.addEventListener("compositionstart",(function(e){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(n){Object(u.e)()||N(e,n),t.composingLock=!1})),this.element.addEventListener("input",(function(n){t.composingLock||(t.preventInput?t.preventInput=!1:N(e,n))})),this.element.addEventListener("keyup",(function(t){t.isComposing||Object(u.d)(t)||("Backspace"!==t.key&&"Delete"!==t.key||""===e.sv.element.innerHTML||1!==e.sv.element.childNodes.length||!e.sv.element.firstElementChild||"DIV"!==e.sv.element.firstElementChild.tagName||2!==e.sv.element.firstElementChild.childElementCount||""!==e.sv.element.firstElementChild.textContent&&"\n"!==e.sv.element.textContent?"Enter"===t.key&&Ce(e):e.sv.element.innerHTML="")}))},e}(),xt=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(e,t){var n=this;if(void 0===t&&(t=6e3),this.element.className="vditor-tip vditor-tip--show",0===t)return this.element.innerHTML='<div class="vditor-tip__content">'+e+'\n<div class="vditor-tip__close">X</div></div>',void this.element.querySelector(".vditor-tip__close").addEventListener("click",(function(){n.hide()}));this.element.innerHTML='<div class="vditor-tip__content">'+e+"</div>",setTimeout((function(){n.hide()}),t)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),Tt=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),f(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",p(t.toolbar.elements,["both"])}t.devtools&&t.devtools.renderEchart(t)}},Ot=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return"both"===t.options.preview.mode&&r.element.children[0].classList.add("vditor-menu--current"),r.element.children[0].addEventListener(Object(u.b)(),(function(e){r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||(e.preventDefault(),"sv"===t.currentMode&&("both"===t.options.preview.mode?Tt("editor",t):Tt("both",t)))})),r}return Ot(t,e),t}(se),At=function(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"},jt=n(19),Mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Rt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=r.element.children[0],o=document.createElement("div");o.className="vditor-hint"+(2===n.level?"":" vditor-panel--arrow");var l="";return a.a.CODE_THEME.forEach((function(e){l+="<button>"+e+"</button>"})),o.innerHTML='<div style="overflow: auto;max-height:'+window.innerHeight/2+'px">'+l+"</div>",o.addEventListener(Object(u.b)(),(function(e){"BUTTON"===e.target.tagName&&(b(t,["subToolbar"]),t.options.preview.hljs.style=e.target.textContent,Object(jt.a)(e.target.textContent,t.options.cdn),e.preventDefault(),e.stopPropagation())})),r.element.appendChild(o),y(t,o,i,n.level),r}return Mt(t,e),t}(se),Ht=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=r.element.children[0],o=document.createElement("div");o.className="vditor-hint"+(2===n.level?"":" vditor-panel--arrow");var a="";return Object.keys(t.options.preview.theme.list).forEach((function(e){a+='<button data-type="'+e+'">'+t.options.preview.theme.list[e]+"</button>"})),o.innerHTML='<div style="overflow: auto;max-height:'+window.innerHeight/2+'px">'+a+"</div>",o.addEventListener(Object(u.b)(),(function(e){"BUTTON"===e.target.tagName&&(b(t,["subToolbar"]),t.options.preview.theme.current=e.target.getAttribute("data-type"),Object(I.a)(t.options.preview.theme.current,t.options.preview.theme.path),e.preventDefault(),e.stopPropagation())})),r.element.appendChild(o),y(t,o,i,n.level),r}return Ht(t,e),t}(se),Nt=function(){function e(e){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(e,"")}return e.prototype.render=function(e,t){var n=t.endsWith("\n")?t.length-1:t.length;if("text"===e.options.counter.type&&e[e.currentMode]){var r=e[e.currentMode].element.cloneNode(!0);r.querySelectorAll(".vditor-wysiwyg__preview").forEach((function(e){e.remove()})),n=r.textContent.length}"number"==typeof e.options.counter.max?(n>e.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML=n+"/"+e.options.counter.max):this.element.innerHTML=""+n,this.element.setAttribute("aria-label",e.options.counter.type)},e}(),Pt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].innerHTML=n.icon,r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),n.click()})),r}return Pt(t,e),t}(se),Bt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),qt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.firstElementChild.addEventListener(Object(u.b)(),(function(e){var n=r.element.firstElementChild;n.classList.contains(a.a.CLASS_MENU_DISABLED)||(e.preventDefault(),n.classList.contains("vditor-menu--current")?(n.classList.remove("vditor-menu--current"),t.devtools.element.style.display="none",B(t)):(n.classList.add("vditor-menu--current"),t.devtools.element.style.display="block",B(t),t.devtools.renderEchart(t)))})),r}return Bt(t,e),t}(se),Ut=function(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"},Ft=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=document.createElement("div");i.className="vditor-panel vditor-panel--arrow";var o="";Object.keys(t.options.hint.emoji).forEach((function(e){var n=t.options.hint.emoji[e];n.indexOf(".")>-1?o+='<button data-value=":'+e+': " data-key=":'+e+':"><img\ndata-value=":'+e+': " data-key=":'+e+':" class="vditor-emojis__icon" src="'+n+'"/></button>':o+='<button data-value="'+n+' "\n data-key="'+e+'"><span class="vditor-emojis__icon">'+n+"</span></button>"}));var a='<div class="vditor-emojis__tail">\n    <span class="vditor-emojis__tip"></span><span>'+(t.options.hint.emojiTail||"")+"</span>\n</div>";return i.innerHTML='<div class="vditor-emojis" style="max-height: '+("auto"===t.options.height?"auto":t.options.height-80)+'px">'+o+"</div>"+a,r.element.appendChild(i),y(t,i,r.element.children[0],n.level),r._bindEvent(t,i),r}return Ft(t,e),t.prototype._bindEvent=function(e,t){t.querySelectorAll(".vditor-emojis button").forEach((function(n){n.addEventListener(Object(u.b)(),(function(r){r.preventDefault();var i=n.getAttribute("data-value"),o=Object(M.b)(e[e.currentMode].element),a=i;if("wysiwyg"===e.currentMode?a=e.lute.SpinVditorDOM(i):"ir"===e.currentMode&&(a=e.lute.SpinVditorIRDOM(i)),i.indexOf(":")>-1&&"sv"!==e.currentMode){var l=document.createElement("div");l.innerHTML=a,a=l.firstElementChild.firstElementChild.outerHTML+" ",Object(M.d)(a,e)}else o.extractContents(),o.insertNode(document.createTextNode(i));o.collapse(!1),Object(M.h)(o),t.style.display="none",Ge(e)})),n.addEventListener("mouseover",(function(e){"BUTTON"===e.target.tagName&&(t.querySelector(".vditor-emojis__tip").innerHTML=e.target.getAttribute("data-key"))}))}))},t}(se),zt=function(e,t,n){var r=document.createElement("a");"download"in r?(r.download=n,r.style.display="none",r.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(r),r.click(),r.remove()):e.tip.show(P.a[e.options.lang].downloadTip,0)},$t=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=r.element.children[0],o=document.createElement("div");return o.className="vditor-hint"+(2===n.level?"":" vditor-panel--arrow"),o.innerHTML='<button data-type="markdown">Markdown</button>\n<button data-type="pdf">PDF</button>\n<button data-type="html">HTML</button>',o.addEventListener(Object(u.b)(),(function(e){var n=e.target;if("BUTTON"===n.tagName){switch(n.getAttribute("data-type")){case"markdown":!function(e){var t=s(e);zt(e,t,t.substr(0,10)+".md")}(t);break;case"pdf":!function(e){e.tip.show(P.a[e.options.lang].generate,3800);var t=document.querySelector("iframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'+e.options.cdn+'/dist/index.css"/>\n<script src="'+e.options.cdn+'/dist/method.min.js"><\/script>\n<div id="preview"></div>\n<script>\nwindow.addEventListener("message", (e) => {\n  if(!e.data) {\n    return;\n  }\n  Vditor.preview(document.getElementById(\'preview\'), e.data, {\n    markdown: {\n      theme: "'+e.options.preview.theme+'"\n    },\n    hljs: {\n      style: "'+e.options.preview.hljs.style+'"\n    }\n  });\n  setTimeout(() => {\n        window.print();\n    }, 3600);\n}, false);\n<\/script>'),t.contentDocument.close(),setTimeout((function(){t.contentWindow.postMessage(s(e),"*")}),200)}(t);break;case"html":!function(e){var t=yt(e),n='<html><head><link rel="stylesheet" type="text/css" href="'+e.options.cdn+'/dist/index.css"/>\n<script src="'+e.options.cdn+'/dist/method.min.js"><\/script></head>\n<body><div class="vditor-reset" id="preview">'+t+"</div>\n<script>\n    const previewElement = document.getElementById('preview')\n    Vditor.setContentTheme('"+e.options.preview.theme.current+"', '"+e.options.preview.theme.path+"');\n    Vditor.codeRender(previewElement, '"+e.options.lang+"');\n    Vditor.highlightRender("+JSON.stringify(e.options.preview.hljs)+", previewElement, '"+e.options.cdn+"');\n    Vditor.mathRender(previewElement, {\n        cdn: '"+e.options.cdn+"',\n        math: "+JSON.stringify(e.options.preview.math)+',\n    });\n    Vditor.mermaidRender(previewElement, ".language-mermaid", \''+e.options.cdn+"');\n    Vditor.graphvizRender(previewElement, '"+e.options.cdn+"');\n    Vditor.chartRender(previewElement, '"+e.options.cdn+"');\n    Vditor.mindmapRender(previewElement, '"+e.options.cdn+"');\n    Vditor.abcRender(previewElement, '"+e.options.cdn+"');\n    Vditor.mediaRender(previewElement);\n<\/script></body></html>";zt(e,n,t.substr(0,10)+".html")}(t)}b(t,["subToolbar"]),e.preventDefault(),e.stopPropagation()}})),r.element.appendChild(o),y(t,o,i,n.level),r}return $t(t,e),t}(se),Wt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Xt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._bindEvent(t,n),r}return Wt(t,e),t.prototype._bindEvent=function(e,t){this.element.children[0].addEventListener(Object(u.b)(),(function(n){n.preventDefault(),e.element.className.includes("vditor--fullscreen")?(t.level||(this.innerHTML=t.icon),e.element.classList.remove("vditor--fullscreen"),Object.keys(e.toolbar.elements).forEach((function(t){var n=e.toolbar.elements[t].firstChild;n&&(n.className=n.className.replace("__s","__n"))})),e.counter&&(e.counter.element.className=e.counter.element.className.replace("__s","__n"))):(t.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),e.element.classList.add("vditor--fullscreen"),Object.keys(e.toolbar.elements).forEach((function(t){var n=e.toolbar.elements[t].firstChild;n&&(n.className=n.className.replace("__n","__s"))})),e.counter&&(e.counter.element.className=e.counter.element.className.replace("__n","__s"))),e.devtools&&e.devtools.renderEchart(e),t.click&&t.click(e.element.classList.contains("vditor--fullscreen")),B(e),U(e)}))},t}(se),Gt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Jt=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=document.createElement("div");return i.className="vditor-hint vditor-panel--arrow",i.innerHTML='<button data-tag="h1" data-value="# ">Heading 1 '+Object(u.g)("&lt;⌘-⌥-1>")+'</button>\n<button data-tag="h2" data-value="## ">Heading 2 &lt;'+Object(u.g)("⌘-⌥-2")+'></button>\n<button data-tag="h3" data-value="### ">Heading 3 &lt;'+Object(u.g)("⌘-⌥-3")+'></button>\n<button data-tag="h4" data-value="#### ">Heading 4 &lt;'+Object(u.g)("⌘-⌥-4")+'></button>\n<button data-tag="h5" data-value="##### ">Heading 5 &lt;'+Object(u.g)("⌘-⌥-5")+'></button>\n<button data-tag="h6" data-value="###### ">Heading 6 &lt;'+Object(u.g)("⌘-⌥-6")+"></button>",r.element.appendChild(i),r._bindEvent(t,i),r}return Gt(t,e),t.prototype._bindEvent=function(e,t){var n=this.element.children[0];n.addEventListener(Object(u.b)(),(function(r){r.preventDefault(),n.classList.contains(a.a.CLASS_MENU_DISABLED)||(n.blur(),n.classList.contains("vditor-menu--current")?("wysiwyg"===e.currentMode?(X(e),K(e)):"ir"===e.currentMode&&ft(e,""),n.classList.remove("vditor-menu--current")):(b(e,["subToolbar"]),t.style.display="block"))}));for(var r=0;r<6;r++)t.children.item(r).addEventListener(Object(u.b)(),(function(r){r.preventDefault(),"wysiwyg"===e.currentMode?(W(e,r.target.getAttribute("data-tag")),K(e),n.classList.add("vditor-menu--current")):"ir"===e.currentMode?(ft(e,r.target.getAttribute("data-value")),n.classList.add("vditor-menu--current")):Le(e,r.target.getAttribute("data-value")),t.style.display="none"}))},t}(se),Zt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yt=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),t.tip.show('<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">\n<div style="margin-top: 14px;flex: 1">\n    <div>Markdown 使用指南</div>\n    <ul style="list-style: none">\n        <li><a href="https://hacpai.com/article/1583308420519" target="_blank">语法速查手册</a></li>\n        <li><a href="https://hacpai.com/article/1583129520165" target="_blank">基础语法</a></li>\n        <li><a href="https://hacpai.com/article/1583305480675" target="_blank">扩展语法</a></li>\n        <li><a href="https://hacpai.com/article/1582778815353" target="_blank">键盘快捷键</a></li>\n    </ul>\n</div>\n<div style="margin-top: 14px;flex: 1">\n    <div>Vditor 支持</div>\n    <ul style="list-style: none">\n        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>\n        <li><a href="https://hacpai.com/tag/vditor" target="_blank">官方讨论区</a></li>\n        <li><a href="https://hacpai.com/article/1549638745630" target="_blank">开发手册</a></li>\n        <li><a href="https://hacpai.com/guide/markdown" target="_blank">演示地址</a></li>\n    </ul>\n</div></div>',0)})),r}return Zt(t,e),t}(se),Qt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),en=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){if(e.preventDefault(),!r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)&&"sv"!==t.currentMode){var n=Object(M.b)(t[t.currentMode].element),i=Object(w.f)(n.startContainer,"LI");i&&Fe(t,i,n)}})),r}return Qt(t,e),t}(se),tn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),t.tip.show('<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">\n<p style="text-align: center;margin: 14px 0">\n    <em>下一代的 Markdown 编辑器，为未来而构建</em>\n</p>\n<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">\n    <img src="https://cdn.jsdelivr.net/npm/vditor/src/assets/images/logo.png" style="margin: 0 auto;height: 68px"/>\n    <div>&nbsp;&nbsp;</div>\n    <div style="flex: 1;min-width: 250px">\n        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。\n        它使用 TypeScript 实现，支持原生 JavaScript、Vue、React、Angular，提供<a target="_blank" href="https://b3log.org/siyuan">桌面版</a>。\n    </div>\n</div>\n<div style="display: flex;flex-wrap: wrap;">\n    <ul style="list-style: none;flex: 1;min-width:148px">\n        <li>\n        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>\n        </li>\n        <li>\n        开源协议：MIT\n        </li>\n    </ul>\n    <ul style="list-style: none;margin-right: 18px">\n        <li>\n        组件版本：Vditor v'+a.b+" / Lute v"+Lute.Version+'\n        </li>\n        <li>\n        赞助捐赠：<a href="https://hacpai.com/sponsor" target="_blank">https://hacpai.com/sponsor</a>\n        </li>\n    </ul>\n</div>\n</div>',0)})),r}return tn(t,e),t}(se),rn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),on=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||"sv"===t.currentMode||De(t,"afterend")})),r}return rn(t,e),t}(se),an=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),sn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||"sv"===t.currentMode||De(t,"beforebegin")})),r}return an(t,e),t}(se),ln=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),cn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.element.children[0].addEventListener(Object(u.b)(),(function(e){if(e.preventDefault(),!r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)&&"sv"!==t.currentMode){var n=Object(M.b)(t[t.currentMode].element),i=Object(w.f)(n.startContainer,"LI");i&&Ke(t,i,n,i.parentElement)}})),r}return ln(t,e),t}(se),un=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),dn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return t.options.outline&&r.element.firstElementChild.classList.add("vditor-menu--current"),r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),t.toolbar.elements.outline.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||(t.options.outline=!r.element.firstElementChild.classList.contains("vditor-menu--current"),t.outline.toggle(t,t.options.outline))})),r}return un(t,e),t}(se),pn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._bindEvent(t),r}return pn(t,e),t.prototype._bindEvent=function(e){var t=this;this.element.children[0].addEventListener(Object(u.b)(),(function(n){n.preventDefault();var r=t.element.firstElementChild;if(!r.classList.contains(a.a.CLASS_MENU_DISABLED)){var i=a.a.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);r.classList.contains("vditor-menu--current")?(r.classList.remove("vditor-menu--current"),"sv"===e.currentMode?(e.sv.element.style.display="block","both"===e.options.preview.mode?e.preview.element.style.display="block":e.preview.element.style.display="none"):(e[e.currentMode].element.parentElement.style.display="block",e.preview.element.style.display="none"),h(e.toolbar.elements,i),e.outline.render(e)):(m(e.toolbar.elements,i),e.preview.element.style.display="block","sv"===e.currentMode?e.sv.element.style.display="none":e[e.currentMode].element.parentElement.style.display="none",e.preview.render(e),r.classList.add("vditor-menu--current"),b(e,["subToolbar","hint","popover"]),setTimeout((function(){e.outline.render(e)}),e.options.preview.delay+10)),B(e)}}))},t}(se),hn=function(){function e(e){var t;if(this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0,"undefined"!=typeof AudioContext)t=new AudioContext;else{if(!webkitAudioContext)return;t=new webkitAudioContext}this.DEFAULT_SAMPLE_RATE=t.sampleRate;var n=t.createGain();t.createMediaStreamSource(e).connect(n),this.recorder=t.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,n.connect(this.recorder),this.recorder.connect(t.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(e,t){this.leftChannel.push(new Float32Array(e)),this.rightChannel.push(new Float32Array(t)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var e=this.mergeBuffers(this.leftChannel),t=this.mergeBuffers(this.rightChannel),n=new Float32Array(e.length),r=0;r<e.length;++r)n[r]=.5*(e[r]+t[r]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(n=this.downSampleBuffer(n,this.SAMPLE_RATE));var i=44+2*n.length,o=new ArrayBuffer(i),a=new DataView(o);this.writeUTFBytes(a,0,"RIFF"),a.setUint32(4,i,!0),this.writeUTFBytes(a,8,"WAVE"),this.writeUTFBytes(a,12,"fmt "),a.setUint32(16,16,!0),a.setUint16(20,1,!0),a.setUint16(22,1,!0),a.setUint32(24,this.SAMPLE_RATE,!0),a.setUint32(28,2*this.SAMPLE_RATE,!0),a.setUint16(32,2,!0),a.setUint16(34,16,!0);var l=2*n.length;this.writeUTFBytes(a,36,"data"),a.setUint32(40,l,!0);for(var s=n.length,c=44,d=0;d<s;d++)a.setInt16(c,32767*n[d],!0),c+=2;return new Blob([a],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(e,t){if(t===this.DEFAULT_SAMPLE_RATE)return e;if(t>this.DEFAULT_SAMPLE_RATE)return e;for(var n=this.DEFAULT_SAMPLE_RATE/t,r=Math.round(e.length/n),i=new Float32Array(r),o=0,a=0;o<i.length;){for(var l=Math.round((o+1)*n),s=0,c=0,d=a;d<l&&d<e.length;d++)s+=e[d],c++;i[o]=s/c,o++,a=l}return i},e.prototype.mergeBuffers=function(e){for(var t=new Float32Array(this.recordingLength),n=0,r=e.length,i=0;i<r;++i){var o=e[i];t.set(o,n),n+=o.length}return t},e.prototype.writeUTFBytes=function(e,t,n){for(var r=n.length,i=0;i<r;i++)e.setUint8(t+i,n.charCodeAt(i))},e}(),mn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._bindEvent(t),r}return mn(t,e),t.prototype._bindEvent=function(e){var t,n=this;this.element.children[0].addEventListener(Object(u.b)(),(function(r){if(r.preventDefault(),!n.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)){var i=e[e.currentMode].element;if(t)if(t.isRecording){t.stopRecording(),e.tip.hide();var o=new File([t.buildWavFileBlob()],"record"+(new Date).getTime()+".wav",{type:"video/webm"});he(e,[o]),n.element.children[0].classList.remove("vditor-menu--current")}else e.tip.show(P.a[e.options.lang].recording),i.setAttribute("contenteditable","false"),t.startRecordingNewWavFile(),n.element.children[0].classList.add("vditor-menu--current");else navigator.mediaDevices.getUserMedia({audio:!0}).then((function(r){(t=new hn(r)).recorder.onaudioprocess=function(e){if(t.isRecording){var n=e.inputBuffer.getChannelData(0),r=e.inputBuffer.getChannelData(1);t.cloneChannelData(n,r)}},t.startRecordingNewWavFile(),e.tip.show(P.a[e.options.lang].recording),i.setAttribute("contenteditable","false"),n.element.children[0].classList.add("vditor-menu--current")})).catch((function(){e.tip.show(P.a[e.options.lang]["record-tip"])}))}}))},t}(se),gn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),yn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return m({redo:r.element},["redo"]),r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||t.undo.redo(t)})),r}return gn(t,e),t}(se),bn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),wn=function(e){function t(t,n){var r=e.call(this,t,n)||this;return m({undo:r.element},["undo"]),r.element.children[0].addEventListener(Object(u.b)(),(function(e){e.preventDefault(),r.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||t.undo.undo(t)})),r}return bn(t,e),t}(se),Cn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kn=function(e){function t(t,n){var r=e.call(this,t,n)||this,i='<input type="file"';return t.options.upload.multiple&&(i+=' multiple="multiple"'),t.options.upload.accept&&(i+=' accept="'+t.options.upload.accept+'"'),r.element.children[0].innerHTML=""+(n.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>')+i+">",r._bindEvent(t),r}return Cn(t,e),t.prototype._bindEvent=function(e){var t=this;this.element.querySelector("input").addEventListener("change",(function(n){t.element.firstElementChild.classList.contains(a.a.CLASS_MENU_DISABLED)||0!==n.target.files.length&&he(e,n.target.files,n.target)}))},t}(se),Sn=function(){function e(e){var t=this,n=e.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",n.toolbar.forEach((function(n,r){var i=t.genItem(e,n,r);if(t.element.appendChild(i),n.toolbar){var o=document.createElement("div");o.className="vditor-hint vditor-panel--arrow",o.addEventListener(Object(u.b)(),(function(e){o.style.display="none"})),n.toolbar.forEach((function(n,i){n.level=2,o.appendChild(t.genItem(e,n,r+i))})),i.appendChild(o),y(e,o,i.children[0])}})),e.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),e.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),e.options.counter.enable&&(e.counter=new Nt(e),this.element.appendChild(e.counter.element))}return e.prototype.genItem=function(e,t,n){var r;switch(t.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":r=new se(e,t);break;case"emoji":r=new Kt(e,t);break;case"headings":r=new Jt(e,t);break;case"|":r=new Ut;break;case"br":r=new At;break;case"undo":r=new wn(e,t);break;case"redo":r=new yn(e,t);break;case"help":r=new Yt(e,t);break;case"both":r=new Lt(e,t);break;case"preview":r=new fn(e,t);break;case"fullscreen":r=new Xt(e,t);break;case"upload":r=new kn(e,t);break;case"record":r=new vn(e,t);break;case"info":r=new nn(e,t);break;case"edit-mode":r=new ue(e,t);break;case"devtools":r=new qt(e,t);break;case"outdent":r=new cn(e,t);break;case"indent":r=new en(e,t);break;case"outline":r=new dn(e,t);break;case"insert-after":r=new on(e,t);break;case"insert-before":r=new sn(e,t);break;case"code-theme":r=new Rt(e,t);break;case"content-theme":r=new Dt(e,t);break;case"export":r=new Vt(e,t);break;default:r=new It(e,t)}if(r){var i=t.name;return"br"!==i&&"|"!==i||(i+=n),this.elements[i]=r.element,r.element}},e}(),En=n(24),_n=n.n(En),xn=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new _n.a}return e.prototype.clearStack=function(e){this.resetStack(),this.resetIcon(e)},e.prototype.resetIcon=function(e){e.toolbar&&(this[e.currentMode].undoStack.length>1?h(e.toolbar.elements,["undo"]):m(e.toolbar.elements,["undo"]),0!==this[e.currentMode].redoStack.length?h(e.toolbar.elements,["redo"]):m(e.toolbar.elements,["redo"]))},e.prototype.undo=function(e){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")&&!(this[e.currentMode].undoStack.length<2)){var t=this[e.currentMode].undoStack.pop();t&&(this[e.currentMode].redoStack.push(t),this.renderDiff(t,e),this[e.currentMode].hasUndo=!0,b(e,["hint"]))}},e.prototype.redo=function(e){if("false"!==e[e.currentMode].element.getAttribute("contenteditable")){var t=this[e.currentMode].redoStack.pop();t&&(this[e.currentMode].undoStack.push(t),this.renderDiff(t,e,!0))}},e.prototype.recordFirstPosition=function(e,t){if(0!==getSelection().rangeCount&&!(1!==this[e.currentMode].undoStack.length||0===this[e.currentMode].undoStack[0].length||this[e.currentMode].redoStack.length>0||Object(u.e)()&&"Backspace"===t.key||Object(u.f)())){var n=this.addCaret(e);n.replace("<wbr>","")===this[e.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[e.currentMode].undoStack[0][0].diffs[0][1]=n,this[e.currentMode].lastText=n)}},e.prototype.addToUndoStack=function(e){var t=this.addCaret(e,!0),n=this.dmp.diff_main(t,this[e.currentMode].lastText,!0),r=this.dmp.patch_make(t,this[e.currentMode].lastText,n);0===r.length&&this[e.currentMode].undoStack.length>0||(this[e.currentMode].lastText=t,this[e.currentMode].undoStack.push(r),this[e.currentMode].undoStack.length>this.stackSize&&this[e.currentMode].undoStack.shift(),this[e.currentMode].hasUndo&&(this[e.currentMode].redoStack=[],this[e.currentMode].hasUndo=!1,m(e.toolbar.elements,["redo"])),this[e.currentMode].undoStack.length>1&&h(e.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(e,t,n){var r;if(void 0===n&&(n=!1),n){var i=this.dmp.patch_deepCopy(e).reverse();i.forEach((function(e){e.diffs.forEach((function(e){e[0]=-e[0]}))})),r=this.dmp.patch_apply(i,this[t.currentMode].lastText)[0]}else r=this.dmp.patch_apply(e,this[t.currentMode].lastText)[0];if(this[t.currentMode].lastText=r,t[t.currentMode].element.innerHTML=r,"sv"!==t.currentMode&&t[t.currentMode].element.querySelectorAll(".vditor-"+t.currentMode+"__preview[data-render='2']").forEach((function(e){j(e,t)})),t[t.currentMode].element.querySelector("wbr"))Object(M.f)(t[t.currentMode].element,t[t.currentMode].element.ownerDocument.createRange()),Ce(t);else{var o=getSelection().getRangeAt(0);o.setEndBefore(t[t.currentMode].element),o.collapse(!1)}Ge(t,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),oe(t),this[t.currentMode].undoStack.length>1?h(t.toolbar.elements,["undo"]):m(t.toolbar.elements,["undo"]),0!==this[t.currentMode].redoStack.length?h(t.toolbar.elements,["redo"]):m(t.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(e,t){var n;if(void 0===t&&(t=!1),0!==getSelection().rangeCount&&!e[e.currentMode].element.querySelector("wbr")){var r=getSelection().getRangeAt(0);if(e[e.currentMode].element.contains(r.startContainer)){n=r.cloneRange();var i=document.createElement("span");i.className="vditor-wbr",r.insertNode(i)}}var o=e[e.currentMode].element.innerHTML;return e[e.currentMode].element.querySelectorAll(".vditor-wbr").forEach((function(e){e.remove()})),t&&n&&Object(M.h)(n),o.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),Tn=n(21),On=function(){function e(e){this.defaultOptions={after:void 0,cache:{enable:!0},cdn:a.a.CDN,classes:{preview:""},counter:{enable:!1,type:"markdown"},debugger:!1,height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:a.a.CDN+"/dist/images/emoji",extend:[]},icon:"ant",lang:"zh_CN",mode:"ir",outline:!1,placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:a.a.HLJS_OPTIONS,markdown:a.a.MARKDOWN_OPTIONS,math:a.a.MATH_OPTIONS,maxWidth:800,mode:"both",theme:a.a.THEME_OPTIONS},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,upload:{extraData:{},fieldName:"file[]",filename:function(e){return e.replace(/\W/g,"")},linkToImgUrl:"",max:10485760,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=e}return e.prototype.merge=function(){var e,t,n;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),(null===(t=null===(e=this.options.preview)||void 0===e?void 0:e.theme)||void 0===t?void 0:t.list)&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),(null===(n=this.options.hint)||void 0===n?void 0:n.emoji)&&(this.defaultOptions.hint.emoji=this.options.hint.emoji));var r=Object(Tn.a)(this.defaultOptions,this.options);if(r.cache.enable&&!r.cache.id)throw new Error("need options.cache.id, see https://hacpai.com/article/1549638745630#options");return r},e.prototype.mergeToolbar=function(e){var t=this,n=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘-E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘-H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘-B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘-I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘-D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘-K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘-L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘-O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘-J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⌘-⇧-I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⌘-⇧-O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘-;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⌘-⇧-H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘-U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘-G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⌘-⇧-B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⌘-⇧-E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘-M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:" | col2 | col3 |\n| --- | --- | --- |\n|  |  |  |\n|  |  |  |",tipPosition:"n"},{name:"|"},{hotkey:"⌘-Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘-Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘-'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘-P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],r=[];return e.forEach((function(e){var i=e;n.forEach((function(t){"string"==typeof e&&t.name===e&&(i=t),"object"==typeof e&&t.name===e.name&&(i=Object.assign({},t,e))})),e.toolbar&&(i.toolbar=t.mergeToolbar(e.toolbar)),r.push(i)})),r},e}(),Ln=function(){function e(e){this.composingLock=!1;var t=document.createElement("div");t.className="vditor-wysiwyg",t.innerHTML='<pre class="vditor-reset" placeholder="'+e.options.placeholder+'"\n contenteditable="true" spellcheck="false"></pre>\n<div class="vditor-panel vditor-panel--none"></div>',this.element=t.firstElementChild,this.popover=t.lastElementChild,this.bindEvent(e),ve(e,this.element),ge(e,this.element),ke(e,this.element),Se(e,this.element),ye(e,this.element),be(e,this.element,this.copy),we(e,this.element,this.copy)}return e.prototype.copy=function(e,t){var n=getSelection().getRangeAt(0);if(""!==n.toString()){e.stopPropagation(),e.preventDefault();var r,o=Object(w.f)(n.startContainer,"CODE"),i=Object(w.f)(n.endContainer,"CODE");if(o&&i&&i.isSameNode(o))return r="PRE"===o.parentElement.tagName?n.toString():"`"+n.toString()+"`",e.clipboardData.setData("text/plain",r),void e.clipboardData.setData("text/html","");var a=Object(w.f)(n.startContainer,"A"),l=Object(w.f)(n.endContainer,"A");if(a&&l&&l.isSameNode(a)){var s=a.getAttribute("title")||"";return s&&(s=' "'+s+'"'),e.clipboardData.setData("text/plain","["+n.toString()+"]("+a.getAttribute("href")+s+")"),void e.clipboardData.setData("text/html","")}var c=document.createElement("div");c.appendChild(n.cloneContents()),e.clipboardData.setData("text/plain",t.lute.VditorDOM2Md(c.innerHTML).trim()),e.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(e){var t=this;window.addEventListener("scroll",(function(){if(b(e,["hint"]),"block"===t.popover.style.display){var n=parseInt(t.popover.getAttribute("data-top"),10);"auto"===e.options.height?e.options.toolbarConfig.pin&&(t.popover.style.top=Math.max(n,window.scrollY-e.element.offsetTop-8)+"px"):e.options.toolbarConfig.pin&&0===e.toolbar.element.getBoundingClientRect().top&&(t.popover.style.top=Math.max(window.scrollY-e.element.offsetTop-8,Math.min(n-e.wysiwyg.element.scrollTop,t.element.clientHeight-21))+"px")}})),this.element.addEventListener("scroll",(function(){if(b(e,["hint"]),"block"===t.popover.style.display){var n=parseInt(t.popover.getAttribute("data-top"),10)-e.wysiwyg.element.scrollTop,r=-8;e.options.toolbarConfig.pin&&0===e.toolbar.element.getBoundingClientRect().top&&(r=window.scrollY-e.element.offsetTop+r),t.popover.style.top=Math.max(r,Math.min(n,t.element.clientHeight-21))+"px"}})),this.element.addEventListener("paste",(function(n){ct(e,n,{pasteCode:function(n){var r=Object(M.b)(t.element),i=document.createElement("template");i.innerHTML=n,r.insertNode(i.content.cloneNode(!0));var o=Object(w.d)(r.startContainer,"data-block","0");o?o.outerHTML=e.lute.SpinVditorDOM(o.outerHTML):e.wysiwyg.element.innerHTML=e.lute.SpinVditorDOM(e.wysiwyg.element.innerHTML),Object(M.f)(e.wysiwyg.element,r)}})})),this.element.addEventListener("compositionstart",(function(){t.composingLock=!0})),this.element.addEventListener("compositionend",(function(n){var r=Object(C.a)(getSelection().getRangeAt(0).startContainer);r&&""===r.textContent?Xe(e):(Object(u.e)()||je(e,getSelection().getRangeAt(0).cloneRange(),n),t.composingLock=!1)})),this.element.addEventListener("input",(function(n){if(t.preventInput)t.preventInput=!1;else if(!t.composingLock){var r=getSelection().getRangeAt(0),i=Object(w.c)(r.startContainer);if(i||(V(e,r),i=Object(w.c)(r.startContainer)),i){for(var o=Object(M.c)(i,e.wysiwyg.element,r).start,a=!0,l=o-1;l>i.textContent.substr(0,o).lastIndexOf("\n");l--)if(" "!==i.textContent.charAt(l)&&"\t"!==i.textContent.charAt(l)){a=!1;break}0===o&&(a=!1);var s=!0;for(l=o-1;l<i.textContent.length;l++)if(" "!==i.textContent.charAt(l)&&"\n"!==i.textContent.charAt(l)){s=!1;break}var c=Object(C.a)(getSelection().getRangeAt(0).startContainer);c&&""===c.textContent?Xe(e):a&&"code-block"!==i.getAttribute("data-type")||s||Ve(i.innerHTML)||$e(i.innerHTML)&&i.previousElementSibling||je(e,r,n)}}})),this.element.addEventListener("click",(function(n){if("INPUT"===n.target.tagName){var r=n.target;return r.checked?r.setAttribute("checked","checked"):r.removeAttribute("checked"),t.preventInput=!0,void K(e)}if("IMG"!==n.target.tagName){var i=Object(M.b)(t.element);if(n.target.isEqualNode(t.element)&&t.element.lastElementChild&&i.collapsed){var o=t.element.lastElementChild.getBoundingClientRect();n.y>o.top+o.height&&("P"===t.element.lastElementChild.tagName&&""===t.element.lastElementChild.textContent.trim().replace(a.a.ZWSP,"")?(i.selectNodeContents(t.element.lastElementChild),i.collapse(!1)):(t.element.insertAdjacentHTML("beforeend",'<p data-block="0">'+a.a.ZWSP+"<wbr></p>"),Object(M.f)(t.element,i)))}Z(e);var l=Object(w.e)(n.target,"vditor-wysiwyg__preview");l||(l=Object(w.e)(Object(M.b)(t.element).startContainer,"vditor-wysiwyg__preview")),l&&G(l,e)}else"link-ref"===n.target.getAttribute("data-type")?Q(e,n.target):function(e,t){var n=e.target;t.wysiwyg.popover.innerHTML="";var r=function(){n.setAttribute("src",o.value),n.setAttribute("alt",l.value),n.setAttribute("title",c.value)},i=document.createElement("span");i.setAttribute("aria-label",P.a[t.options.lang].imageURL),i.className="vditor-tooltipped vditor-tooltipped__n";var o=document.createElement("input");i.appendChild(o),o.className="vditor-input",o.setAttribute("placeholder",P.a[t.options.lang].imageURL),o.value=n.getAttribute("src")||"",o.oninput=function(){r()},o.onkeydown=function(e){J(t,e)};var a=document.createElement("span");a.setAttribute("aria-label",P.a[t.options.lang].alternateText),a.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");a.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",P.a[t.options.lang].alternateText),l.style.width="52px",l.value=n.getAttribute("alt")||"",l.oninput=function(){r()},l.onkeydown=function(e){J(t,e)};var s=document.createElement("span");s.setAttribute("aria-label",P.a[t.options.lang].title),s.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");s.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",P.a[t.options.lang].title),c.value=n.getAttribute("title")||"",c.oninput=function(){r()},c.onkeydown=function(e){J(t,e)},ne(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",i),t.wysiwyg.popover.insertAdjacentElement("beforeend",a),t.wysiwyg.popover.insertAdjacentElement("beforeend",s),Y(t,n)}(n,e)})),this.element.addEventListener("keyup",(function(n){if(!n.isComposing&&!Object(u.d)(n)){"Enter"===n.key&&Ce(e),"Backspace"!==n.key&&"Delete"!==n.key||""===e.wysiwyg.element.innerHTML||1!==e.wysiwyg.element.childNodes.length||!e.wysiwyg.element.firstElementChild||"P"!==e.wysiwyg.element.firstElementChild.tagName||0!==e.wysiwyg.element.firstElementChild.childElementCount||""!==e.wysiwyg.element.textContent&&"\n"!==e.wysiwyg.element.textContent||(e.wysiwyg.element.innerHTML="");var r=Object(M.b)(t.element);if("Backspace"===n.key&&Object(u.e)()&&"\n"===r.startContainer.textContent&&1===r.startOffset&&(r.startContainer.textContent=""),V(e,r),Z(e),"ArrowDown"===n.key||"ArrowRight"===n.key||"Backspace"===n.key||"ArrowLeft"===n.key||"ArrowUp"===n.key){"ArrowLeft"!==n.key&&"ArrowRight"!==n.key||e.hint.render(e);var i=Object(w.e)(r.startContainer,"vditor-wysiwyg__preview");if(!i&&3!==r.startContainer.nodeType&&r.startOffset>0&&(a=r.startContainer).classList.contains("vditor-wysiwyg__block")&&(i=a.lastElementChild),i)if("none"!==i.previousElementSibling.style.display){var o=i.previousElementSibling;if("PRE"===o.tagName&&(o=o.firstElementChild),"ArrowDown"===n.key||"ArrowRight"===n.key){var a,l=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling}(a=i.parentElement);if(l&&3!==l.nodeType){var s=l.querySelector(".vditor-wysiwyg__preview");if(s)return void G(s,e)}if(3===l.nodeType){for(;0===l.textContent.length&&l.nextSibling;)l=l.nextSibling;r.setStart(l,1)}else r.setStart(l.firstChild,0)}else r.selectNodeContents(o),r.collapse(!1)}else"ArrowDown"===n.key||"ArrowRight"===n.key?G(i,e):G(i,e,!1)}}}))},e}(),An=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jn=function(e){function t(t,n){var r=e.call(this)||this;r.version=a.b,"string"==typeof t&&(n?n.cache?n.cache.id||(n.cache.id="vditor"+t):n.cache={id:"vditor"+t}:n={cache:{id:"vditor"+t}},t=document.getElementById(t));var i=new On(n).merge();if(!["en_US","ja_JP","ko_KR","zh_CN"].includes(i.lang))throw new Error("options.lang error, see https://hacpai.com/article/1549638745630#options");return r.vditor={currentMode:i.mode,element:t,hint:new vt(i.hint.extend),lute:void 0,options:i,originalInnerHTML:t.innerHTML,outline:new Ct(P.a[i.lang].outline),tip:new xt},r.vditor.sv=new _t(r.vditor),r.vditor.undo=new xn,r.vditor.wysiwyg=new Ln(r.vditor),r.vditor.ir=new gt(r.vditor),r.vditor.toolbar=new Sn(r.vditor),i.resize.enable&&(r.vditor.resize=new Et(r.vditor)),r.vditor.toolbar.elements.devtools&&(r.vditor.devtools=new d),(i.upload.url||i.upload.handler)&&(r.vditor.upload=new fe),Object(c.a)(n._lutePath||i.cdn+"/dist/js/lute/lute.min.js","vditorLuteScript").then((function(){r.vditor.lute=Object(bt.a)({autoSpace:r.vditor.options.preview.markdown.autoSpace,chinesePunct:r.vditor.options.preview.markdown.chinesePunct,codeBlockPreview:r.vditor.options.preview.markdown.codeBlockPreview,emojiSite:r.vditor.options.hint.emojiPath,emojis:r.vditor.options.hint.emoji,fixTermTypo:r.vditor.options.preview.markdown.fixTermTypo,footnotes:r.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:r.vditor.options.preview.math.inlineDigit,linkBase:r.vditor.options.preview.markdown.linkBase,listStyle:r.vditor.options.preview.markdown.listStyle,mark:r.vditor.options.preview.markdown.mark,paragraphBeginningSpace:r.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:r.vditor.options.preview.markdown.sanitize,toc:r.vditor.options.preview.markdown.toc}),r.vditor.preview=new St(r.vditor),function(e){e.element.innerHTML="",e.element.classList.add("vditor"),q(e),Object(I.a)(e.options.preview.theme.current,e.options.preview.theme.path),"number"==typeof e.options.height&&(e.element.style.height=e.options.height+"px"),"number"==typeof e.options.minHeight&&(e.element.style.minHeight=e.options.minHeight+"px"),"number"==typeof e.options.width?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content",t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe style="width: 100%;height: 0;border: 0"></iframe>'),ce(e,e.options.mode,function(e,t){U(e),window.addEventListener("resize",(function(){B(e),U(e)}));var n=Object(u.a)()&&localStorage.getItem(e.options.cache.id);return e.options.cache.enable&&n||(e.options.value?n=e.options.value:e.originalInnerHTML?n=e.lute.HTML2Md(e.originalInnerHTML):e.options.cache.enable||(n="")),n||""}(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&void 0!==window.visualViewport){var n=!1,r=function(t){n||(n=!0,requestAnimationFrame((function(){n=!1;var t=e.toolbar.element;t.style.transform="none",t.getBoundingClientRect().top<0&&(t.style.transform="translate(0, "+-t.getBoundingClientRect().top+"px)")})))};window.visualViewport.addEventListener("scroll",r),window.visualViewport.addEventListener("resize",r)}}(r.vditor),i.after&&i.after()})),i.icon&&Object(c.a)(i.cdn+"/dist/js/icons/"+i.icon+".js","vditorIconScript"),r}return An(t,e),t.prototype.setTheme=function(e,t,n,r){this.vditor.options.theme=e,q(this.vditor),t&&(this.vditor.options.preview.theme.current=t,Object(I.a)(t,r||this.vditor.options.preview.theme.path)),n&&(this.vditor.options.preview.hljs.style=n,Object(jt.a)(n,this.vditor.options.cdn))},t.prototype.getValue=function(){return s(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){"sv"===this.vditor.currentMode?this.vditor.sv.element.focus():"wysiwyg"===this.vditor.currentMode?this.vditor.wysiwyg.element.focus():"ir"===this.vditor.currentMode&&this.vditor.ir.element.focus()},t.prototype.blur=function(){"sv"===this.vditor.currentMode?this.vditor.sv.element.blur():"wysiwyg"===this.vditor.currentMode?this.vditor.wysiwyg.element.blur():"ir"===this.vditor.currentMode&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){b(this.vditor,["subToolbar","hint","popover"]),m(this.vditor.toolbar.elements,a.a.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){h(this.vditor.toolbar.elements,a.a.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){return"wysiwyg"===this.vditor.currentMode?me(this.vditor.wysiwyg.element):"sv"===this.vditor.currentMode?me(this.vditor.sv.element):"ir"===this.vditor.currentMode?me(this.vditor.ir.element):void 0},t.prototype.renderPreview=function(e){this.vditor.preview.render(this.vditor,e)},t.prototype.getCursorPosition=function(){return Object(M.a)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://hacpai.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(e){return this.vditor.lute.HTML2Md(e)},t.prototype.getHTML=function(){return yt(this.vditor)},t.prototype.tip=function(e,t){this.vditor.tip.show(e,t)},t.prototype.setPreviewMode=function(e){Tt(e,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(e){document.execCommand("insertHTML",!1,e)},t.prototype.insertValue=function(e,t){void 0===t&&(t=!0),Object(M.b)(this.vditor[this.vditor.currentMode].element).collapse(!0),"sv"===this.vditor.currentMode?(this.vditor.sv.preventInput=!0,document.execCommand("insertText",!1,e),t&&N(this.vditor)):"wysiwyg"===this.vditor.currentMode?(this.vditor.wysiwyg.preventInput=!0,document.execCommand("insertText",!1,e),t&&je(this.vditor,getSelection().getRangeAt(0))):"ir"===this.vditor.currentMode&&(this.vditor.ir.preventInput=!0,document.execCommand("insertText",!1,e),t&&R(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.setValue=function(e,t){var n=this;void 0===t&&(t=!1),"sv"===this.vditor.currentMode?(this.vditor.sv.element.innerHTML=this.vditor.lute.SpinVditorSVDOM(e),Oe(this.vditor,{enableAddUndoStack:t,enableHint:!1,enableInput:!1})):"wysiwyg"===this.vditor.currentMode?ae(this.vditor,e,{enableAddUndoStack:t,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(e),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach((function(e){j(e,n.vditor)})),pt(this.vditor,{enableAddUndoStack:t,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),e||(b(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),t&&this.clearStack()},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style"),document.getElementById("vditorIconScript").remove(),this.clearCache()},t}(o.default);t.default=jn}]).default},827:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var s,i=1,t=arguments.length;i<t;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(e[p]=s[p]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=n(776),l=n(779),c=function(){function e(e){this.allowReport=!0,this.enableResume=!0,this.getSignature=e.getSignature,void 0!==e.allowReport&&(this.allowReport=e.allowReport),void 0!==e.enableResume&&(this.enableResume=e.enableResume),this.appId=e.appId,this.reportId=e.reportId}return e.prototype.upload=function(e){var t=r({getSignature:this.getSignature,appId:this.appId,reportId:this.reportId,enableResume:this.enableResume},e),n=new o.default(t);return this.allowReport&&this.initReporter(n),n.start(),n},e.prototype.initReporter=function(e){new l.VodReporter(e)},e}();t.default=c},828:function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var root="object"==typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=global);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD=__webpack_require__(902),HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(e){return function(t){return new Sha1(!0).update(t)[e]()}},createMethod=function(){var e=createOutputMethod("hex");NODE_JS&&(e=nodeWrap(e)),e.create=function(){return new Sha1},e.update=function(t){return e.create().update(t)};for(var i=0;i<OUTPUT_TYPES.length;++i){var t=OUTPUT_TYPES[i];e[t]=createOutputMethod(t)}return e},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("sha1").update(e,"utf8").digest("hex");if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(void 0===e.length)return method(e);return crypto.createHash("sha1").update(new Buffer(e)).digest("hex")};return nodeMethod};function Sha1(e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(e){if(!this.finalized){var t="string"!=typeof e;t&&e.constructor===root.ArrayBuffer&&(e=new Uint8Array(e));for(var code,i,n=0,r=e.length||0,o=this.blocks;n<r;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),t)for(i=this.start;n<r&&i<64;++n)o[i>>2]|=e[n]<<SHIFT[3&i++];else for(i=this.start;n<r&&i<64;++n)(code=e.charCodeAt(n))<128?o[i>>2]|=code<<SHIFT[3&i++]:code<2048?(o[i>>2]|=(192|code>>6)<<SHIFT[3&i++],o[i>>2]|=(128|63&code)<<SHIFT[3&i++]):code<55296||code>=57344?(o[i>>2]|=(224|code>>12)<<SHIFT[3&i++],o[i>>2]|=(128|code>>6&63)<<SHIFT[3&i++],o[i>>2]|=(128|63&code)<<SHIFT[3&i++]):(code=65536+((1023&code)<<10|1023&e.charCodeAt(++n)),o[i>>2]|=(240|code>>18)<<SHIFT[3&i++],o[i>>2]|=(128|code>>12&63)<<SHIFT[3&i++],o[i>>2]|=(128|code>>6&63)<<SHIFT[3&i++],o[i>>2]|=(128|63&code)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=o[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,i=this.lastByteIndex;e[16]=this.block,e[i>>2]|=EXTRA[3&i],this.block=e[16],i>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var e,t,a=this.h0,b=this.h1,n=this.h2,r=this.h3,o=this.h4,l=this.blocks;for(e=16;e<80;++e)t=l[e-3]^l[e-8]^l[e-14]^l[e-16],l[e]=t<<1|t>>>31;for(e=0;e<20;e+=5)a=(t=(b=(t=(n=(t=(r=(t=(o=(t=a<<5|a>>>27)+(b&n|~b&r)+o+1518500249+l[e]<<0)<<5|o>>>27)+(a&(b=b<<30|b>>>2)|~a&n)+r+1518500249+l[e+1]<<0)<<5|r>>>27)+(o&(a=a<<30|a>>>2)|~o&b)+n+1518500249+l[e+2]<<0)<<5|n>>>27)+(r&(o=o<<30|o>>>2)|~r&a)+b+1518500249+l[e+3]<<0)<<5|b>>>27)+(n&(r=r<<30|r>>>2)|~n&o)+a+1518500249+l[e+4]<<0,n=n<<30|n>>>2;for(;e<40;e+=5)a=(t=(b=(t=(n=(t=(r=(t=(o=(t=a<<5|a>>>27)+(b^n^r)+o+1859775393+l[e]<<0)<<5|o>>>27)+(a^(b=b<<30|b>>>2)^n)+r+1859775393+l[e+1]<<0)<<5|r>>>27)+(o^(a=a<<30|a>>>2)^b)+n+1859775393+l[e+2]<<0)<<5|n>>>27)+(r^(o=o<<30|o>>>2)^a)+b+1859775393+l[e+3]<<0)<<5|b>>>27)+(n^(r=r<<30|r>>>2)^o)+a+1859775393+l[e+4]<<0,n=n<<30|n>>>2;for(;e<60;e+=5)a=(t=(b=(t=(n=(t=(r=(t=(o=(t=a<<5|a>>>27)+(b&n|b&r|n&r)+o-1894007588+l[e]<<0)<<5|o>>>27)+(a&(b=b<<30|b>>>2)|a&n|b&n)+r-1894007588+l[e+1]<<0)<<5|r>>>27)+(o&(a=a<<30|a>>>2)|o&b|a&b)+n-1894007588+l[e+2]<<0)<<5|n>>>27)+(r&(o=o<<30|o>>>2)|r&a|o&a)+b-1894007588+l[e+3]<<0)<<5|b>>>27)+(n&(r=r<<30|r>>>2)|n&o|r&o)+a-1894007588+l[e+4]<<0,n=n<<30|n>>>2;for(;e<80;e+=5)a=(t=(b=(t=(n=(t=(r=(t=(o=(t=a<<5|a>>>27)+(b^n^r)+o-899497514+l[e]<<0)<<5|o>>>27)+(a^(b=b<<30|b>>>2)^n)+r-899497514+l[e+1]<<0)<<5|r>>>27)+(o^(a=a<<30|a>>>2)^b)+n-899497514+l[e+2]<<0)<<5|n>>>27)+(r^(o=o<<30|o>>>2)^a)+b-899497514+l[e+3]<<0)<<5|b>>>27)+(n^(r=r<<30|r>>>2)^o)+a-899497514+l[e+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+a<<0,this.h1=this.h1+b<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+o<<0},Sha1.prototype.hex=function(){this.finalize();var e=this.h0,h1=this.h1,h2=this.h2,h3=this.h3,h4=this.h4;return HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[h1>>28&15]+HEX_CHARS[h1>>24&15]+HEX_CHARS[h1>>20&15]+HEX_CHARS[h1>>16&15]+HEX_CHARS[h1>>12&15]+HEX_CHARS[h1>>8&15]+HEX_CHARS[h1>>4&15]+HEX_CHARS[15&h1]+HEX_CHARS[h2>>28&15]+HEX_CHARS[h2>>24&15]+HEX_CHARS[h2>>20&15]+HEX_CHARS[h2>>16&15]+HEX_CHARS[h2>>12&15]+HEX_CHARS[h2>>8&15]+HEX_CHARS[h2>>4&15]+HEX_CHARS[15&h2]+HEX_CHARS[h3>>28&15]+HEX_CHARS[h3>>24&15]+HEX_CHARS[h3>>20&15]+HEX_CHARS[h3>>16&15]+HEX_CHARS[h3>>12&15]+HEX_CHARS[h3>>8&15]+HEX_CHARS[h3>>4&15]+HEX_CHARS[15&h3]+HEX_CHARS[h4>>28&15]+HEX_CHARS[h4>>24&15]+HEX_CHARS[h4>>20&15]+HEX_CHARS[h4>>16&15]+HEX_CHARS[h4>>12&15]+HEX_CHARS[h4>>8&15]+HEX_CHARS[h4>>4&15]+HEX_CHARS[15&h4]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var e=this.h0,h1=this.h1,h2=this.h2,h3=this.h3,h4=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,h1>>24&255,h1>>16&255,h1>>8&255,255&h1,h2>>24&255,h2>>16&255,h2>>8&255,255&h2,h3>>24&255,h3>>16&255,h3>>8&255,255&h3,h4>>24&255,h4>>16&255,h4>>8&255,255&h4]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var exports=createMethod();COMMON_JS?module.exports=exports:(root.sha1=exports,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)))}()}).call(this,__webpack_require__(161),__webpack_require__(17))},829:function(e,t,n){var r=n(830);e.exports=r},830:function(e,t,n){"use strict";var r=n(729),o=n(777),l=n(835),base=n(836),c=n(841),d={AppId:"",SecretId:"",SecretKey:"",XCosSecurityToken:"",FileParallelLimit:3,ChunkParallelLimit:3,ChunkRetryTimes:3,ChunkSize:1048576,SliceSize:1048576,CopyChunkParallelLimit:20,CopyChunkSize:10485760,CopySliceSize:10485760,MaxPartNumber:1e4,ProgressInterval:1e3,UploadQueueSize:1e4,Domain:"",ServiceDomain:"",Protocol:"",CompatibilityMode:!1,ForcePathStyle:!1,UseRawKey:!1,Timeout:0,CorrectClockSkew:!0,SystemClockOffset:0,UploadCheckContentMd5:!1,UploadIdCacheLimit:50},f=function(e){this.options=r.extend(r.clone(d),e||{}),this.options.FileParallelLimit=Math.max(1,this.options.FileParallelLimit),this.options.ChunkParallelLimit=Math.max(1,this.options.ChunkParallelLimit),this.options.ChunkRetryTimes=Math.max(0,this.options.ChunkRetryTimes),this.options.ChunkSize=Math.max(1048576,this.options.ChunkSize),this.options.CopyChunkParallelLimit=Math.max(1,this.options.CopyChunkParallelLimit),this.options.CopyChunkSize=Math.max(1048576,this.options.CopyChunkSize),this.options.CopySliceSize=Math.max(0,this.options.CopySliceSize),this.options.MaxPartNumber=Math.max(1024,Math.min(1e4,this.options.MaxPartNumber)),this.options.Timeout=Math.max(0,this.options.Timeout),this.options.AppId&&console.warn('warning: AppId has been deprecated, Please put it at the end of parameter Bucket(E.g: "test-1250000000").'),o.init(this),l.init(this)};base.init(f,l),c.init(f,l),f.getAuthorization=r.getAuth,f.version="0.5.16",e.exports=f},831:function(e,t){function n(e,t){var a=e[0],b=e[1],n=e[2],r=e[3];a=o(a,b,n,r,t[0],7,-680876936),r=o(r,a,b,n,t[1],12,-389564586),n=o(n,r,a,b,t[2],17,606105819),b=o(b,n,r,a,t[3],22,-1044525330),a=o(a,b,n,r,t[4],7,-176418897),r=o(r,a,b,n,t[5],12,1200080426),n=o(n,r,a,b,t[6],17,-1473231341),b=o(b,n,r,a,t[7],22,-45705983),a=o(a,b,n,r,t[8],7,1770035416),r=o(r,a,b,n,t[9],12,-1958414417),n=o(n,r,a,b,t[10],17,-42063),b=o(b,n,r,a,t[11],22,-1990404162),a=o(a,b,n,r,t[12],7,1804603682),r=o(r,a,b,n,t[13],12,-40341101),n=o(n,r,a,b,t[14],17,-1502002290),a=l(a,b=o(b,n,r,a,t[15],22,1236535329),n,r,t[1],5,-165796510),r=l(r,a,b,n,t[6],9,-1069501632),n=l(n,r,a,b,t[11],14,643717713),b=l(b,n,r,a,t[0],20,-373897302),a=l(a,b,n,r,t[5],5,-701558691),r=l(r,a,b,n,t[10],9,38016083),n=l(n,r,a,b,t[15],14,-660478335),b=l(b,n,r,a,t[4],20,-405537848),a=l(a,b,n,r,t[9],5,568446438),r=l(r,a,b,n,t[14],9,-1019803690),n=l(n,r,a,b,t[3],14,-187363961),b=l(b,n,r,a,t[8],20,1163531501),a=l(a,b,n,r,t[13],5,-1444681467),r=l(r,a,b,n,t[2],9,-51403784),n=l(n,r,a,b,t[7],14,1735328473),a=c(a,b=l(b,n,r,a,t[12],20,-1926607734),n,r,t[5],4,-378558),r=c(r,a,b,n,t[8],11,-2022574463),n=c(n,r,a,b,t[11],16,1839030562),b=c(b,n,r,a,t[14],23,-35309556),a=c(a,b,n,r,t[1],4,-1530992060),r=c(r,a,b,n,t[4],11,1272893353),n=c(n,r,a,b,t[7],16,-155497632),b=c(b,n,r,a,t[10],23,-1094730640),a=c(a,b,n,r,t[13],4,681279174),r=c(r,a,b,n,t[0],11,-358537222),n=c(n,r,a,b,t[3],16,-722521979),b=c(b,n,r,a,t[6],23,76029189),a=c(a,b,n,r,t[9],4,-640364487),r=c(r,a,b,n,t[12],11,-421815835),n=c(n,r,a,b,t[15],16,530742520),a=d(a,b=c(b,n,r,a,t[2],23,-995338651),n,r,t[0],6,-198630844),r=d(r,a,b,n,t[7],10,1126891415),n=d(n,r,a,b,t[14],15,-1416354905),b=d(b,n,r,a,t[5],21,-57434055),a=d(a,b,n,r,t[12],6,1700485571),r=d(r,a,b,n,t[3],10,-1894986606),n=d(n,r,a,b,t[10],15,-1051523),b=d(b,n,r,a,t[1],21,-2054922799),a=d(a,b,n,r,t[8],6,1873313359),r=d(r,a,b,n,t[15],10,-30611744),n=d(n,r,a,b,t[6],15,-1560198380),b=d(b,n,r,a,t[13],21,1309151649),a=d(a,b,n,r,t[4],6,-145523070),r=d(r,a,b,n,t[11],10,-1120210379),n=d(n,r,a,b,t[2],15,718787259),b=d(b,n,r,a,t[9],21,-343485551),e[0]=y(a,e[0]),e[1]=y(b,e[1]),e[2]=y(n,e[2]),e[3]=y(r,e[3])}function r(q,a,b,e,s,t){return a=y(y(a,q),y(e,t)),y(a<<s|a>>>32-s,b)}function o(a,b,e,t,n,s,o){return r(b&e|~b&t,a,b,n,s,o)}function l(a,b,e,t,n,s,o){return r(b&t|e&~t,a,b,n,s,o)}function c(a,b,e,t,n,s,o){return r(b^e^t,a,b,n,s,o)}function d(a,b,e,t,n,s,o){return r(e^(b|~t),a,b,n,s,o)}function f(s){var i,e=[];for(i=0;i<64;i+=4)e[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return e}var h="0123456789abcdef".split("");function m(e){for(var s="",t=0;t<4;t++)s+=h[e>>8*t+4&15]+h[e>>8*t&15];return s}function v(s,e){return e||(s=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(s)),function(e){for(var i=0;i<e.length;i++)e[i]=m(e[i]);return e.join("")}(function(s){var i,e=s.length,t=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=s.length;i+=64)n(t,f(s.substring(i-64,i)));s=s.substring(i-64);var r=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)r[i>>2]|=s.charCodeAt(i)<<(i%4<<3);if(r[i>>2]|=128<<(i%4<<3),i>55)for(n(t,r),i=0;i<16;i++)r[i]=0;return r[14]=8*e,n(t,r),t}(s))}var y=function(a,b){return a+b&4294967295};"5d41402abc4b2a76b9719d911017c592"!=v("hello")&&(y=function(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}),e.exports=v},832:function(e,t,n){var g,r,o,l,c,d,f,h=h||function(g,e){var t={},n=t.lib={},r=function(){},o=n.Base={extend:function(a){r.prototype=this;var e=new r;return a&&e.mixIn(a),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var e in a)a.hasOwnProperty(e)&&(this[e]=a[e]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},p=n.WordArray=o.extend({init:function(a,e){a=this.words=a||[],this.sigBytes=null!=e?e:4*a.length},toString:function(a){return(a||l).stringify(this)},concat:function(a){var e=this.words,q=a.words,t=this.sigBytes;if(a=a.sigBytes,this.clamp(),t%4)for(var b=0;b<a;b++)e[t+b>>>2]|=(q[b>>>2]>>>24-b%4*8&255)<<24-(t+b)%4*8;else if(65535<q.length)for(b=0;b<a;b+=4)e[t+b>>>2]=q[b>>>2];else e.push.apply(e,q);return this.sigBytes+=a,this},clamp:function(){var a=this.words,e=this.sigBytes;a[e>>>2]&=4294967295<<32-e%4*8,a.length=g.ceil(e/4)},clone:function(){var a=o.clone.call(this);return a.words=this.words.slice(0),a},random:function(a){for(var e=[],b=0;b<a;b+=4)e.push(4294967296*g.random()|0);return new p.init(e,a)}}),b=t.enc={},l=b.Hex={stringify:function(a){var e=a.words;a=a.sigBytes;for(var b=[],t=0;t<a;t++){var n=e[t>>>2]>>>24-t%4*8&255;b.push((n>>>4).toString(16)),b.push((15&n).toString(16))}return b.join("")},parse:function(a){for(var e=a.length,b=[],t=0;t<e;t+=2)b[t>>>3]|=parseInt(a.substr(t,2),16)<<24-t%8*4;return new p.init(b,e/2)}},c=b.Latin1={stringify:function(a){var e=a.words;a=a.sigBytes;for(var b=[],t=0;t<a;t++)b.push(String.fromCharCode(e[t>>>2]>>>24-t%4*8&255));return b.join("")},parse:function(a){for(var e=a.length,b=[],t=0;t<e;t++)b[t>>>2]|=(255&a.charCodeAt(t))<<24-t%4*8;return new p.init(b,e)}},d=b.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},f=n.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new p.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=d.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(a){var e=this._data,b=e.words,t=e.sigBytes,n=this.blockSize,r=t/(4*n);if(a=(r=a?g.ceil(r):g.max((0|r)-this._minBufferSize,0))*n,t=g.min(4*a,t),a){for(var o=0;o<a;o+=n)this._doProcessBlock(b,o);o=b.splice(0,a),e.sigBytes-=t}return new p.init(o,t)},clone:function(){var a=o.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});n.Hasher=f.extend({cfg:o.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,e){return new a.init(e).finalize(b)}},_createHmacHelper:function(a){return function(b,e){return new s.HMAC.init(a,e).finalize(b)}}});var s=t.algo={};return t}(Math);r=(c=(g=h).lib).WordArray,o=c.Hasher,l=[],c=g.algo.SHA1=o.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var b=this._hash.words,n=b[0],r=b[1],o=b[2],g=b[3],c=b[4],a=0;80>a;a++){if(16>a)l[a]=0|e[t+a];else{var d=l[a-3]^l[a-8]^l[a-14]^l[a-16];l[a]=d<<1|d>>>31}d=(n<<5|n>>>27)+c+l[a],d=20>a?d+(1518500249+(r&o|~r&g)):40>a?d+(1859775393+(r^o^g)):60>a?d+((r&o|r&g|o&g)-1894007588):d+((r^o^g)-899497514),c=g,g=o,o=r<<30|r>>>2,r=n,n=d}b[0]=b[0]+n|0,b[1]=b[1]+r|0,b[2]=b[2]+o|0,b[3]=b[3]+g|0,b[4]=b[4]+c|0},_doFinalize:function(){var e=this._data,t=e.words,b=8*this._nDataBytes,g=8*e.sigBytes;return t[g>>>5]|=128<<24-g%32,t[14+(g+64>>>9<<4)]=Math.floor(b/4294967296),t[15+(g+64>>>9<<4)]=b,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}}),g.SHA1=o._createHelper(c),g.HmacSHA1=o._createHmacHelper(c),function(){var g=h,e=g.enc.Utf8;g.algo.HMAC=g.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var g=t.blockSize,r=4*g;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var p=this._oKey=n.clone(),b=this._iKey=n.clone(),o=p.words,l=b.words,c=0;c<g;c++)o[c]^=1549556828,l[c]^=909522486;p.sigBytes=b.sigBytes=r,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}})}(),f=(d=h).lib.WordArray,d.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,map=this._map;e.clamp();for(var r=[],i=0;i<n;i+=3)for(var o=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,l=0;l<4&&i+.75*l<n;l++)r.push(map.charAt(o>>>6*(3-l)&63));var c=map.charAt(64);if(c)for(;r.length%4;)r.push(c);return r.join("")},parse:function(e){var t=e.length,map=this._map,n=map.charAt(64);if(n){var r=e.indexOf(n);-1!=r&&(t=r)}for(var o=[],l=0,i=0;i<t;i++)if(i%4){var c=map.indexOf(e.charAt(i-1))<<i%4*2,d=map.indexOf(e.charAt(i))>>>6-i%4*2;o[l>>>2]|=(c|d)<<24-l%4*8,l++}return f.create(o,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},e.exports=h},833:function(e,t,n){var r=n(885).DOMParser,o=function(){this.version="1.3.5";var e={mergeCDATA:!0,normalize:!0,stripElemPrefix:!0},t=new RegExp(/(?!xmlns)^.*:/);new RegExp(/^\s+|\s+$/g);return this.grokType=function(e){return/^\s*$/.test(e)?null:/^(?:true|false)$/i.test(e)?"true"===e.toLowerCase():isFinite(e)?parseFloat(e):e},this.parseString=function(e,t){if(e){var n=this.stringToXML(e);return n.getElementsByTagName("parsererror").length?null:this.parseXML(n,t)}return null},this.parseXML=function(n,r){for(var l in r)e[l]=r[l];var c={},d=0,f="";if(n.childNodes.length)for(var h,m,v,y=0;y<n.childNodes.length;y++)4===(h=n.childNodes.item(y)).nodeType?e.mergeCDATA&&(f+=h.nodeValue):3===h.nodeType?f+=h.nodeValue:1===h.nodeType&&(0===d&&(c={}),m=e.stripElemPrefix?h.nodeName.replace(t,""):h.nodeName,v=o.parseXML(h),c.hasOwnProperty(m)?(c[m].constructor!==Array&&(c[m]=[c[m]]),c[m].push(v)):(c[m]=v,d++));return Object.keys(c).length||(c=f||""),c},this.xmlToString=function(e){try{return e.xml?e.xml:(new XMLSerializer).serializeToString(e)}catch(e){return null}},this.stringToXML=function(e){try{var t=null;return window.DOMParser?t=(new r).parseFromString(e,"text/xml"):((t=new ActiveXObject("Microsoft.XMLDOM")).async=!1,t.loadXML(e),t)}catch(e){return null}},this}.call({});e.exports=function(e){return o.parseString(e)}},834:function(e,t){var n=new RegExp("^([^a-zA-Z_À-ÖØ-öø-ÿͰ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿿、-퟿豈-﷏ﷰ-�])|^((x|X)(m|M)(l|L))|([^a-zA-Z_À-ÖØ-öø-ÿͰ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿿、-퟿豈-﷏ﷰ-�-.0-9·̀-ͯ‿⁀])","g"),r=/[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm,o=function(e){var t=[];if(e instanceof Object)for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},l=function(e,t){var l=function(e,content,r,o,l){var c=void 0!==t.indent?t.indent:"\t",d=t.prettyPrint?"\n"+new Array(o).join(c):"";t.removeIllegalNameCharacters&&(e=e.replace(n,"_"));var f=[d,"<",e,r||""];return content&&content.length>0?(f.push(">"),f.push(content),l&&f.push(d),f.push("</"),f.push(e),f.push(">")):f.push("/>"),f.join("")};return function e(n,c,d){var f=typeof n;switch((Array.isArray?Array.isArray(n):n instanceof Array)?f="array":n instanceof Date&&(f="date"),f){case"array":var h=[];return n.map((function(t){h.push(e(t,1,d+1))})),t.prettyPrint&&h.push("\n"),h.join("");case"date":return n.toJSON?n.toJSON():n+"";case"object":var m=[];for(var v in n)if(n.hasOwnProperty(v))if(n[v]instanceof Array)for(var y=0;y<n[v].length;y++)n[v].hasOwnProperty(y)&&m.push(l(v,e(n[v][y],0,d+1),null,d+1,o(n[v][y]).length));else m.push(l(v,e(n[v],0,d+1),null,d+1));return t.prettyPrint&&m.length>0&&m.push("\n"),m.join("");case"function":return n();default:return t.escape?(""+n).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(r,""):""+n}}(e,0,0)},c=function(e){var t=['<?xml version="1.0" encoding="UTF-8"'];return e&&t.push(' standalone="yes"'),t.push("?>"),t.join("")};e.exports=function(e,t){if(t||(t={xmlHeader:{standalone:!0},prettyPrint:!0,indent:"  ",escape:!0}),"string"==typeof e)try{e=JSON.parse(e.toString())}catch(e){return!1}var n="",r="";return t&&("object"==typeof t?(t.xmlHeader&&(n=c(!!t.xmlHeader.standalone)),void 0!==t.docType&&(r="<!DOCTYPE "+t.docType+">")):n=c()),[n,(t=t||{}).prettyPrint&&r?"\n":"",r,l(e,t)].join("").replace(/\n{2,}/g,"\n").replace(/\s+$/g,"")}},835:function(e,t,n){var r=n(729),o={};e.exports.transferToTaskMethod=function(e,t){o[t]=e[t],e[t]=function(e,n){e.SkipTask?o[t].call(this,e,n):this._addTask(t,e,n)}},e.exports.init=function(e){var t=[],n={},l=0,c=0,d=function(e){var t={id:e.id,Bucket:e.Bucket,Region:e.Region,Key:e.Key,FilePath:e.FilePath,state:e.state,loaded:e.loaded,size:e.size,speed:e.speed,percent:e.percent,hashPercent:e.hashPercent,error:e.error};return e.FilePath&&(t.FilePath=e.FilePath),t},f=function(){e.emit("task-list-update",{list:r.map(t,d)}),e.emit("list-update",{list:r.map(t,d)})},h=function(){if(!(t.length<=e.options.UploadQueueSize)){for(var i=0;i<c&&i<t.length&&t.length>e.options.UploadQueueSize;){var r="waiting"===t[i].state||"checking"===t[i].state||"uploading"===t[i].state;t[i]&&r?i++:(n[t[i].id]&&delete n[t[i].id],t.splice(i,1),c--)}f()}},m=function(){if(c<t.length&&l<e.options.FileParallelLimit){var n=t[c];if(c++,"waiting"===n.state){l++,n.state="checking",n.params.onTaskStart&&n.params.onTaskStart(d(n)),!n.params.UploadData&&(n.params.UploadData={});var v=r.formatParams(n.api,n.params);o[n.api].call(e,v,(function(t,data){e._isRunningTask(n.id)&&("checking"!==n.state&&"uploading"!==n.state||(n.state=t?"error":"success",t&&(n.error=t),l--,f(),m(e),n.callback&&n.callback(t,data),"success"===n.state&&(n.params&&(delete n.params.UploadData,delete n.params.Body,delete n.params),delete n.callback)),h())})),f()}m(e)}},v=function(t,r){var o=n[t];if(o){var c=o&&"waiting"===o.state,d=o&&("checking"===o.state||"uploading"===o.state);if("canceled"===r&&"canceled"!==o.state||"paused"===r&&c||"paused"===r&&d){if("paused"===r&&o.params.Body&&"function"==typeof o.params.Body.pipe)return void console.error("stream not support pause");o.state=r,e.emit("inner-kill-task",{TaskId:t,toState:r}),f(),d&&(l--,m(e)),"canceled"===r&&(o.params&&(delete o.params.UploadData,delete o.params.Body,delete o.params),delete o.callback)}h()}};e._addTasks=function(t){r.each(t,(function(t){e._addTask(t.api,t.params,t.callback,!0)})),f()};var y=!0;e._addTask=function(o,l,c,d){l=r.formatParams(o,l);var v=r.uuid();l.TaskId=v,l.onTaskReady&&l.onTaskReady(v),l.TaskReady&&(l.TaskReady(v),y&&console.warn('warning: Param "TaskReady" has been deprecated. Please use "onTaskReady" instead.'),y=!1);var w={params:l,callback:c,api:o,index:t.length,id:v,Bucket:l.Bucket,Region:l.Region,Key:l.Key,FilePath:l.FilePath||"",state:"waiting",loaded:0,size:0,speed:0,percent:0,hashPercent:0,error:null},C=l.onHashProgress;l.onHashProgress=function(t){e._isRunningTask(w.id)&&(w.hashPercent=t.percent,C&&C(t),f())};var k=l.onProgress;return l.onProgress=function(t){e._isRunningTask(w.id)&&("checking"===w.state&&(w.state="uploading"),w.loaded=t.loaded,w.speed=t.speed,w.percent=t.percent,k&&k(t),f())},r.getFileSize(o,l,(function(r,o){r?c(r):(n[v]=w,t.push(w),w.size=o,!d&&f(),m(e),h())})),v},e._isRunningTask=function(e){var t=n[e];return!(!t||"checking"!==t.state&&"uploading"!==t.state)},e.getTaskList=function(){return r.map(t,d)},e.cancelTask=function(e){v(e,"canceled")},e.pauseTask=function(e){v(e,"paused")},e.restartTask=function(e){var t=n[e];!t||"paused"!==t.state&&"error"!==t.state||(t.state="waiting",f(),c=Math.min(c,t.index),m())},e.isUploadRunning=function(){return l||c<t.length}}},836:function(e,t,n){var r=n(837),o=n(729);function l(e){var t={GrantFullControl:[],GrantWrite:[],GrantRead:[],GrantReadAcp:[],GrantWriteAcp:[],ACL:""},n={FULL_CONTROL:"GrantFullControl",WRITE:"GrantWrite",READ:"GrantRead",READ_ACP:"GrantReadAcp",WRITE_ACP:"GrantWriteAcp"},r=e.AccessControlList.Grant;r&&(r=o.isArray(r)?r:[r]);var l={READ:0,WRITE:0,FULL_CONTROL:0};return r.length&&o.each(r,(function(r){"qcs::cam::anyone:anyone"===r.Grantee.ID||"http://cam.qcloud.com/groups/global/AllUsers"===r.Grantee.URI?l[r.Permission]=1:r.Grantee.ID!==e.Owner.ID&&t[n[r.Permission]].push('id="'+r.Grantee.ID+'"')})),l.FULL_CONTROL||l.WRITE&&l.READ?t.ACL="public-read-write":l.READ?t.ACL="public-read":t.ACL="private",o.each(n,(function(e){t[e]=c(t[e].join(","))})),t}function c(e){var i,t,n=e.split(","),r={};for(i=0;i<n.length;)r[t=n[i].trim()]?n.splice(i,1):(r[t]=!0,n[i]=t,i++);return n.join(",")}function d(e){var t=e.bucket,n=t.substr(0,t.lastIndexOf("-")),r=t.substr(t.lastIndexOf("-")+1),l=e.domain,c=e.region,object=e.object,d=e.protocol||(o.isBrowser&&"http:"===location.protocol?"http:":"https:");l||(l=["cn-south","cn-south-2","cn-north","cn-east","cn-southwest","sg"].indexOf(c)>-1?"{Region}.myqcloud.com":"cos.{Region}.myqcloud.com",e.ForcePathStyle||(l="{Bucket}."+l)),l=(l=l.replace(/\{\{AppId\}\}/gi,r).replace(/\{\{Bucket\}\}/gi,n).replace(/\{\{Region\}\}/gi,c).replace(/\{\{.*?\}\}/gi,"")).replace(/\{AppId\}/gi,r).replace(/\{BucketName\}/gi,n).replace(/\{Bucket\}/gi,t).replace(/\{Region\}/gi,c).replace(/\{.*?\}/gi,""),/^[a-zA-Z]+:\/\//.test(l)||(l=d+"//"+l),"/"===l.slice(-1)&&(l=l.slice(0,-1));var f=l;return e.ForcePathStyle&&(f+="/"+t),f+="/",object&&(f+=o.camSafeUrlEncode(object).replace(/%2F/g,"/")),e.isLocation&&(f=f.replace(/^https?:\/\//,"")),f}function f(e,t){var n=o.clone(e.Headers);delete n["Content-Type"],delete n["Cache-Control"],o.each(n,(function(e,t){""===e&&delete n[t]}));var r=function(e){var n=!1,r=e.Authorization;if(r)if(r.indexOf(" ")>-1)n=!1;else if(r.indexOf("q-sign-algorithm=")>-1&&r.indexOf("q-ak=")>-1&&r.indexOf("q-sign-time=")>-1&&r.indexOf("q-key-time=")>-1&&r.indexOf("q-url-param-list=")>-1)n=!0;else try{(r=atob(r)).indexOf("a=")>-1&&r.indexOf("k=")>-1&&r.indexOf("t=")>-1&&r.indexOf("r=")>-1&&r.indexOf("b=")>-1&&(n=!0)}catch(e){}n?t&&t(null,e):t&&t("authorization error")},l=this,c=e.Bucket||"",d=e.Region||"",f=e.Key||"";l.options.ForcePathStyle&&c&&(f=c+"/"+f);var h="/"+f,m={},v=e.Scope;if(!v){var y=e.Action||"",w=e.ResourceKey||e.Key||"";v=e.Scope||[{action:y,bucket:c,region:d,prefix:w}]}var C=o.md5(JSON.stringify(v));l._StsCache=l._StsCache||[],function(){var i,e;for(i=l._StsCache.length-1;i>=0;i--){e=l._StsCache[i];var t=Math.round(o.getSkewTime(l.options.SystemClockOffset)/1e3)+30;if(e.StartTime&&t<e.StartTime||t>=e.ExpiredTime)l._StsCache.splice(i,1);else if(!e.ScopeLimit||e.ScopeLimit&&e.ScopeKey===C){m=e;break}}}();var k,S=function(){var t={Authorization:o.getAuth({SecretId:m.TmpSecretId,SecretKey:m.TmpSecretKey,Method:e.Method,Pathname:h,Query:e.Query,Headers:n,Expires:e.Expires,UseRawKey:l.options.UseRawKey,SystemClockOffset:l.options.SystemClockOffset}),XCosSecurityToken:m.XCosSecurityToken||"",Token:m.Token||"",ClientIP:m.ClientIP||"",ClientUA:m.ClientUA||""};r(t)};if(m.ExpiredTime&&m.ExpiredTime-o.getSkewTime(l.options.SystemClockOffset)/1e3>60)S();else if(l.options.getAuthorization)l.options.getAuthorization.call(l,{Bucket:c,Region:d,Method:e.Method,Key:f,Pathname:h,Query:e.Query,Headers:n,Scope:v},(function(e){"string"==typeof e&&(e={Authorization:e}),e.TmpSecretId&&e.TmpSecretKey&&e.XCosSecurityToken&&e.ExpiredTime?((m=e||{}).Scope=v,m.ScopeKey=C,l._StsCache.push(m),S()):r(e)}));else{if(!l.options.getSTS)return k={Authorization:o.getAuth({SecretId:e.SecretId||l.options.SecretId,SecretKey:e.SecretKey||l.options.SecretKey,Method:e.Method,Pathname:h,Query:e.Query,Headers:n,Expires:e.Expires,UseRawKey:l.options.UseRawKey,SystemClockOffset:l.options.SystemClockOffset}),XCosSecurityToken:l.options.XCosSecurityToken},r(k),k;l.options.getSTS.call(l,{Bucket:c,Region:d},(function(data){(m=data||{}).Scope=v,m.ScopeKey=C,m.TmpSecretId=m.SecretId,m.TmpSecretKey=m.SecretKey,l._StsCache.push(m),S()}))}return""}function h(e){var t=!1,n=!1,r=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var l=e.error.Code,c=e.error.Message;("RequestTimeTooSkewed"===l||"AccessDenied"===l&&"Request has expired"===c)&&(n=!0)}catch(e){}if(e)if(n&&r){var d=Date.parse(r);this.options.CorrectClockSkew&&Math.abs(o.getSkewTime(this.options.SystemClockOffset)-d)>=3e4&&(console.error("error: Local time is too skewed."),this.options.SystemClockOffset=d-Date.now(),t=!0)}else 5===Math.round(e.statusCode/100)&&(t=!0);return t}function m(e,t){var n=this;!e.headers&&(e.headers={}),!e.qs&&(e.qs={}),e.VersionId&&(e.qs.versionId=e.VersionId),e.qs=o.clearKey(e.qs),e.headers&&(e.headers=o.clearKey(e.headers)),e.qs&&(e.qs=o.clearKey(e.qs));var r=o.clone(e.qs);e.action&&(r[e.action]="");var l=function(o){var c=n.options.SystemClockOffset;f.call(n,{Bucket:e.Bucket||"",Region:e.Region||"",Method:e.method,Key:e.Key,Query:r,Headers:e.headers,Action:e.Action,ResourceKey:e.ResourceKey,Scope:e.Scope},(function(r,d){r?t(r):(e.AuthData=d,v.call(n,e,(function(r,data){r&&o<2&&(c!==n.options.SystemClockOffset||h.call(n,r))?(e.headers&&(delete e.headers.Authorization,delete e.headers.token,delete e.headers.clientIP,delete e.headers.clientUA,delete e.headers["x-cos-security-token"]),l(o+1)):t(r,data)})))}))};l(0)}function v(e,t){var n=this,l=e.TaskId;if(!l||n._isRunningTask(l)){var c=e.Bucket,f=e.Region,object=e.Key,h=e.method||"GET",m=e.url,body=e.body,v=e.json,y=e.rawBody;m=m||d({ForcePathStyle:n.options.ForcePathStyle,protocol:n.options.Protocol,domain:n.options.Domain,bucket:c,region:f,object:object}),e.action&&(m=m+"?"+e.action);var w={method:h,url:m,headers:e.headers,qs:e.qs,body:body,json:v};if(w.headers.Authorization=e.AuthData.Authorization,e.AuthData.Token&&(w.headers.token=e.AuthData.Token),e.AuthData.ClientIP&&(w.headers.clientIP=e.AuthData.ClientIP),e.AuthData.ClientUA&&(w.headers.clientUA=e.AuthData.ClientUA),e.AuthData.XCosSecurityToken&&(w.headers["x-cos-security-token"]=e.AuthData.XCosSecurityToken),w.headers&&(w.headers=o.clearKey(w.headers)),w=o.clearKey(w),e.onProgress&&"function"==typeof e.onProgress){var C=body&&(body.size||body.length)||0;w.onProgress=function(t){if(!l||n._isRunningTask(l)){var r=t?t.loaded:0;e.onProgress({loaded:r,total:C})}}}this.options.Timeout&&(w.timeout=this.options.Timeout),n.emit("before-send",w);var k=r(w,(function(e,r,body){if("abort"!==e){var c,d=function(e,data){if(l&&n.off("inner-kill-task",S),!c){c=!0;var d={};r&&r.statusCode&&(d.statusCode=r.statusCode),r&&r.headers&&(d.headers=r.headers),e?(e=o.extend(e||{},d),t(e,null)):(data=o.extend(data||{},d),t(null,data)),k=null}};if(e)d({error:e});else{var f;try{f=body&&body.indexOf("<")>-1&&body.indexOf(">")>-1&&o.xml2json(body)||{}}catch(e){f=body||{}}var h=r.statusCode;2===Math.floor(h/100)?(y&&((f={}).body=body),f.Error?d({error:f.Error}):d(null,f)):d({error:f.Error||f})}}})),S=function(data){data.TaskId===l&&(k&&k.abort&&k.abort(),n.off("inner-kill-task",S))};l&&n.on("inner-kill-task",S)}}var y={getBucket:function(e,t){var n={};n.prefix=e.Prefix||"",n.delimiter=e.Delimiter,n.marker=e.Marker,n["max-keys"]=e.MaxKeys,n["encoding-type"]=e.EncodingType,m.call(this,{Action:"name/cos:GetBucket",ResourceKey:n.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:n},(function(e,data){if(e)return t(e);var n=data.ListBucketResult||{},r=n.Contents||[],l=n.CommonPrefixes||[];r=o.isArray(r)?r:[r],l=o.isArray(l)?l:[l];var c=o.clone(n);o.extend(c,{Contents:r,CommonPrefixes:l,statusCode:data.statusCode,headers:data.headers}),t(null,c)}))},headBucket:function(e,t){m.call(this,{Action:"name/cos:HeadBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"HEAD"},(function(e,data){t(e,data)}))},deleteBucket:function(e,t){m.call(this,{Action:"name/cos:DeleteBucket",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,method:"DELETE"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},getBucketAcl:function(e,t){m.call(this,{Action:"name/cos:GetBucketACL",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"acl"},(function(e,data){if(e)return t(e);var n=data.AccessControlPolicy||{},r=n.Owner||{},c=n.AccessControlList.Grant||[];c=o.isArray(c)?c:[c];var d=l(n);data.headers&&data.headers["x-cos-acl"]&&(d.ACL=data.headers["x-cos-acl"]),d=o.extend(d,{Owner:r,Grants:c,statusCode:data.statusCode,headers:data.headers}),t(null,d)}))},putBucketAcl:function(e,t){var n=e.Headers,r="";if(e.AccessControlPolicy){var l=o.clone(e.AccessControlPolicy||{}),d=l.Grants||l.Grant;d=o.isArray(d)?d:[d],delete l.Grant,delete l.Grants,l.AccessControlList={Grant:d},r=o.json2xml({AccessControlPolicy:l}),n["Content-Type"]="application/xml",n["Content-MD5"]=o.binaryBase64(o.md5(r))}o.each(n,(function(e,t){0===t.indexOf("x-cos-grant-")&&(n[t]=c(n[t]))})),m.call(this,{Action:"name/cos:PutBucketACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,headers:n,action:"acl",body:r},(function(e,data){if(e)return t(e);t(null,{statusCode:data.statusCode,headers:data.headers})}))},getBucketCors:function(e,t){m.call(this,{Action:"name/cos:GetBucketCORS",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},(function(e,data){if(e)if(404===e.statusCode&&e.error&&"NoSuchCORSConfiguration"===e.error.Code){var n={CORSRules:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else t(e);else{var r=data.CORSConfiguration||{},l=r.CORSRules||r.CORSRule||[];l=o.clone(o.isArray(l)?l:[l]),o.each(l,(function(e){o.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],(function(t,n){var r=t+"s",l=e[r]||e[t]||[];delete e[t],e[r]=o.isArray(l)?l:[l]}))})),t(null,{CORSRules:l,statusCode:data.statusCode,headers:data.headers})}}))},putBucketCors:function(e,t){var n=(e.CORSConfiguration||{}).CORSRules||e.CORSRules||[];n=o.clone(o.isArray(n)?n:[n]),o.each(n,(function(e){o.each(["AllowedOrigin","AllowedHeader","AllowedMethod","ExposeHeader"],(function(t,n){var r=t+"s",l=e[r]||e[t]||[];delete e[r],e[t]=o.isArray(l)?l:[l]}))}));var r=o.json2xml({CORSConfiguration:{CORSRule:n}}),l=e.Headers;l["Content-Type"]="application/xml",l["Content-MD5"]=o.binaryBase64(o.md5(r)),m.call(this,{Action:"name/cos:PutBucketCORS",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"cors",headers:l},(function(e,data){if(e)return t(e);t(null,{statusCode:data.statusCode,headers:data.headers})}))},deleteBucketCors:function(e,t){m.call(this,{Action:"name/cos:DeleteBucketCORS",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"cors"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode||e.statusCode,headers:data.headers})}))},getBucketLocation:function(e,t){m.call(this,{Action:"name/cos:GetBucketLocation",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"location"},(function(e,data){if(e)return t(e);t(null,data)}))},putBucketTagging:function(e,t){var n=e.Tagging||{},r=n.TagSet||n.Tags||e.Tags||[];r=o.clone(o.isArray(r)?r:[r]);var l=o.json2xml({Tagging:{TagSet:{Tag:r}}}),c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=o.binaryBase64(o.md5(l)),m.call(this,{Action:"name/cos:PutBucketTagging",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:l,action:"tagging",headers:c},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},getBucketTagging:function(e,t){m.call(this,{Action:"name/cos:GetBucketTagging",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},(function(e,data){if(e)if(404!==e.statusCode||!e.error||"Not Found"!==e.error&&"NoSuchTagSet"!==e.error.Code)t(e);else{var n={Tags:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else{var r=[];try{r=data.Tagging.TagSet.Tag||[]}catch(e){}r=o.clone(o.isArray(r)?r:[r]),t(null,{Tags:r,statusCode:data.statusCode,headers:data.headers})}}))},deleteBucketTagging:function(e,t){m.call(this,{Action:"name/cos:DeleteBucketTagging",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"tagging"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},getBucketPolicy:function(e,t){m.call(this,{Action:"name/cos:GetBucketPolicy",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy",rawBody:!0},(function(e,data){if(e)return e.statusCode&&403===e.statusCode?t({ErrorStatus:"Access Denied"}):e.statusCode&&405===e.statusCode?t({ErrorStatus:"Method Not Allowed"}):e.statusCode&&404===e.statusCode?t({ErrorStatus:"Policy Not Found"}):t(e);var n={};try{n=JSON.parse(data.body)}catch(e){}t(null,{Policy:n,statusCode:data.statusCode,headers:data.headers})}))},putBucketPolicy:function(e,t){var n=e.Policy,r=n;try{"string"==typeof n?n=JSON.parse(r):r=JSON.stringify(n)}catch(e){t({error:"Policy format error"})}var l=e.Headers;l["Content-Type"]="application/json",l["Content-MD5"]=o.binaryBase64(o.md5(r)),m.call(this,{Action:"name/cos:PutBucketPolicy",method:"PUT",Bucket:e.Bucket,Region:e.Region,action:"policy",body:o.isBrowser?r:n,headers:l,json:!0},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},deleteBucketPolicy:function(e,t){m.call(this,{Action:"name/cos:DeleteBucketPolicy",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"policy"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode||e.statusCode,headers:data.headers})}))},getBucketLifecycle:function(e,t){m.call(this,{Action:"name/cos:GetBucketLifecycle",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},(function(e,data){if(e)if(404===e.statusCode&&e.error&&"NoSuchLifecycleConfiguration"===e.error.Code){var n={Rules:[],statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else t(e);else{var r=[];try{r=data.LifecycleConfiguration.Rule||[]}catch(e){}r=o.clone(o.isArray(r)?r:[r]),t(null,{Rules:r,statusCode:data.statusCode,headers:data.headers})}}))},putBucketLifecycle:function(e,t){var n=(e.LifecycleConfiguration||{}).Rules||[];n=o.clone(n);var r=o.json2xml({LifecycleConfiguration:{Rule:n}}),l=e.Headers;l["Content-Type"]="application/xml",l["Content-MD5"]=o.binaryBase64(o.md5(r)),m.call(this,{Action:"name/cos:PutBucketLifecycle",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"lifecycle",headers:l},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},deleteBucketLifecycle:function(e,t){m.call(this,{Action:"name/cos:DeleteBucketLifecycle",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"lifecycle"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},putBucketVersioning:function(e,t){if(e.VersioningConfiguration){var n=e.VersioningConfiguration||{},r=o.json2xml({VersioningConfiguration:n}),l=e.Headers;l["Content-Type"]="application/xml",l["Content-MD5"]=o.binaryBase64(o.md5(r)),m.call(this,{Action:"name/cos:PutBucketVersioning",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"versioning",headers:l},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))}else t({error:"missing param VersioningConfiguration"})},getBucketVersioning:function(e,t){m.call(this,{Action:"name/cos:GetBucketVersioning",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"versioning"},(function(e,data){e||!data.VersioningConfiguration&&(data.VersioningConfiguration={}),t(e,data)}))},putBucketReplication:function(e,t){var n=o.clone(e.ReplicationConfiguration),r=o.json2xml({ReplicationConfiguration:n});r=(r=r.replace(/<(\/?)Rules>/gi,"<$1Rule>")).replace(/<(\/?)Tags>/gi,"<$1Tag>");var l=e.Headers;l["Content-Type"]="application/xml",l["Content-MD5"]=o.binaryBase64(o.md5(r)),m.call(this,{Action:"name/cos:PutBucketReplication",method:"PUT",Bucket:e.Bucket,Region:e.Region,body:r,action:"replication",headers:l},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},getBucketReplication:function(e,t){m.call(this,{Action:"name/cos:GetBucketReplication",method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},(function(e,data){if(e)if(404!==e.statusCode||!e.error||"Not Found"!==e.error&&"ReplicationConfigurationnotFoundError"!==e.error.Code)t(e);else{var n={ReplicationConfiguration:{Rules:[]},statusCode:e.statusCode};e.headers&&(n.headers=e.headers),t(null,n)}else e||!data.ReplicationConfiguration&&(data.ReplicationConfiguration={}),data.ReplicationConfiguration.Rule&&(data.ReplicationConfiguration.Rules=data.ReplicationConfiguration.Rule,delete data.ReplicationConfiguration.Rule),t(e,data)}))},deleteBucketReplication:function(e,t){m.call(this,{Action:"name/cos:DeleteBucketReplication",method:"DELETE",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,action:"replication"},(function(e,data){return e&&204===e.statusCode?t(null,{statusCode:e.statusCode}):e?t(e):void t(null,{statusCode:data.statusCode,headers:data.headers})}))},getObject:function(e,t){var n={};n["response-content-type"]=e.ResponseContentType,n["response-content-language"]=e.ResponseContentLanguage,n["response-expires"]=e.ResponseExpires,n["response-cache-control"]=e.ResponseCacheControl,n["response-content-disposition"]=e.ResponseContentDisposition,n["response-content-encoding"]=e.ResponseContentEncoding,m.call(this,{Action:"name/cos:GetObject",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers,qs:n,rawBody:!0},(function(n,data){if(n){var r=n.statusCode;return e.Headers["If-Modified-Since"]&&r&&304===r?t(null,{NotModified:!0}):t(n)}var l={};l.Body=data.body,data.headers&&data.headers.etag&&(l.ETag=data.headers&&data.headers.etag),o.extend(l,{statusCode:data.statusCode,headers:data.headers}),t(null,l)}))},headObject:function(e,t){m.call(this,{Action:"name/cos:HeadObject",method:"HEAD",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},(function(n,data){if(n){var r=n.statusCode;return e.Headers["If-Modified-Since"]&&r&&304===r?t(null,{NotModified:!0,statusCode:r}):t(n)}data.headers&&data.headers.etag&&(data.ETag=data.headers&&data.headers.etag),t(null,data)}))},listObjectVersions:function(e,t){var n={};n.prefix=e.Prefix||"",n.delimiter=e.Delimiter,n["key-marker"]=e.KeyMarker,n["version-id-marker"]=e.VersionIdMarker,n["max-keys"]=e.MaxKeys,n["encoding-type"]=e.EncodingType,m.call(this,{Action:"name/cos:GetBucketObjectVersions",ResourceKey:n.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:n,action:"versions"},(function(e,data){if(e)return t(e);var n=data.ListVersionsResult||{},r=n.DeleteMarker||[];r=o.isArray(r)?r:[r];var l=n.Version||[];l=o.isArray(l)?l:[l];var c=o.clone(n);delete c.DeleteMarker,delete c.Version,o.extend(c,{DeleteMarkers:r,Versions:l,statusCode:data.statusCode,headers:data.headers}),t(null,c)}))},putObject:function(e,t){var n=this,r=e.ContentLength,l=o.throttleOnProgress.call(n,r,e.onProgress),c=e.Headers;!c["Cache-Control"]&&(c["Cache-Control"]="");var f=c["Content-Type"]||e.Body&&e.Body.type;!c["Content-Type"]&&f&&(c["Content-Type"]=f),o.getBodyMd5(n.options.UploadCheckContentMd5,e.Body,(function(c){c&&(e.Headers["Content-MD5"]=o.binaryBase64(c)),void 0!==e.ContentLength&&(e.Headers["Content-Length"]=e.ContentLength),m.call(n,{Action:"name/cos:PutObject",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,body:e.Body,onProgress:l},(function(o,data){if(o)return l(null,!0),t(o);if(l({loaded:r,total:r},!0),data&&data.headers&&data.headers.etag){var c=d({ForcePathStyle:n.options.ForcePathStyle,protocol:n.options.Protocol,domain:n.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key});return c=c.substr(c.indexOf("://")+3),t(null,{Location:c,ETag:data.headers.etag,statusCode:data.statusCode,headers:data.headers})}t(null,data)}))}))},deleteObject:function(e,t){m.call(this,{Action:"name/cos:DeleteObject",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,VersionId:e.VersionId},(function(e,data){if(e){var n=e.statusCode;return n&&204===n?t(null,{statusCode:n}):n&&404===n?t(null,{BucketNotFound:!0,statusCode:n}):t(e)}t(null,{statusCode:data.statusCode,headers:data.headers})}))},getObjectAcl:function(e,t){m.call(this,{Action:"name/cos:GetObjectACL",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,action:"acl"},(function(e,data){if(e)return t(e);var n=data.AccessControlPolicy||{},r=n.Owner||{},c=n.AccessControlList&&n.AccessControlList.Grant||[];c=o.isArray(c)?c:[c];var d=l(n);data.headers&&data.headers["x-cos-acl"]&&(d.ACL=data.headers["x-cos-acl"]),d=o.extend(d,{Owner:r,Grants:c,statusCode:data.statusCode,headers:data.headers}),t(null,d)}))},putObjectAcl:function(e,t){var n=e.Headers,r="";if(e.AccessControlPolicy){var l=o.clone(e.AccessControlPolicy||{}),d=l.Grants||l.Grant;d=o.isArray(d)?d:[d],delete l.Grant,delete l.Grants,l.AccessControlList={Grant:d},r=o.json2xml({AccessControlPolicy:l}),n["Content-Type"]="application/xml",n["Content-MD5"]=o.binaryBase64(o.md5(r))}o.each(n,(function(e,t){0===t.indexOf("x-cos-grant-")&&(n[t]=c(n[t]))})),m.call(this,{Action:"name/cos:PutObjectACL",method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"acl",headers:n,body:r},(function(e,data){if(e)return t(e);t(null,{statusCode:data.statusCode,headers:data.headers})}))},optionsObject:function(e,t){var n=e.Headers;n.Origin=e.Origin,n["Access-Control-Request-Method"]=e.AccessControlRequestMethod,n["Access-Control-Request-Headers"]=e.AccessControlRequestHeaders,m.call(this,{Action:"name/cos:OptionsObject",method:"OPTIONS",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:n},(function(e,data){if(e)return e.statusCode&&403===e.statusCode?t(null,{OptionsForbidden:!0,statusCode:e.statusCode}):t(e);var n=data.headers||{};t(null,{AccessControlAllowOrigin:n["access-control-allow-origin"],AccessControlAllowMethods:n["access-control-allow-methods"],AccessControlAllowHeaders:n["access-control-allow-headers"],AccessControlExposeHeaders:n["access-control-expose-headers"],AccessControlMaxAge:n["access-control-max-age"],statusCode:data.statusCode,headers:data.headers})}))},putObjectCopy:function(e,t){var n=e.Headers;!n["Cache-Control"]&&(n["Cache-Control"]="");var r=(e.CopySource||"").match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^/]+\/(.+)$/);if(r){var l=r[1],c=r[3],d=decodeURIComponent(r[4]);m.call(this,{Scope:[{action:"name/cos:GetObject",bucket:l,region:c,prefix:d},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,headers:e.Headers},(function(e,data){if(e)return t(e);var n=o.clone(data.CopyObjectResult||{});o.extend(n,{statusCode:data.statusCode,headers:data.headers}),t(null,n)}))}else t({error:"CopySource format error"})},deleteMultipleObject:function(e,t){var n=e.Objects||[],r=e.Quiet;n=o.isArray(n)?n:[n];var l=o.json2xml({Delete:{Object:n,Quiet:r||!1}}),c=e.Headers;c["Content-Type"]="application/xml",c["Content-MD5"]=o.binaryBase64(o.md5(l));var d=o.map(n,(function(t){return{action:"name/cos:DeleteObject",bucket:e.Bucket,region:e.Region,prefix:t.Key}}));m.call(this,{Scope:d,method:"POST",Bucket:e.Bucket,Region:e.Region,body:l,action:"delete",headers:c},(function(e,data){if(e)return t(e);var n=data.DeleteResult||{},r=n.Deleted||[],l=n.Error||[];r=o.isArray(r)?r:[r],l=o.isArray(l)?l:[l];var c=o.clone(n);o.extend(c,{Error:l,Deleted:r,statusCode:data.statusCode,headers:data.headers}),t(null,c)}))},restoreObject:function(e,t){var n=e.Headers;if(e.RestoreRequest){var r=e.RestoreRequest||{},l=o.json2xml({RestoreRequest:r});n["Content-Type"]="application/xml",n["Content-MD5"]=o.binaryBase64(o.md5(l)),m.call(this,{Action:"name/cos:RestoreObject",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,body:l,action:"restore",headers:n},(function(e,data){t(e,data)}))}else t({error:"missing param RestoreRequest"})},uploadPartCopy:function(e,t){var n=(e.CopySource||"").match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^/]+\/(.+)$/);if(n){var r=n[1],l=n[3],c=decodeURIComponent(n[4]);m.call(this,{Scope:[{action:"name/cos:GetObject",bucket:r,region:l,prefix:c},{action:"name/cos:PutObject",bucket:e.Bucket,region:e.Region,prefix:e.Key}],method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,VersionId:e.VersionId,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers},(function(e,data){if(e)return t(e);var n=o.clone(data.CopyPartResult||{});o.extend(n,{statusCode:data.statusCode,headers:data.headers}),t(null,n)}))}else t({error:"CopySource format error"})},multipartInit:function(e,t){var n,r=e.Headers,l=(navigator&&navigator.userAgent||"").match(/ TBS\/(\d{6}) /);"http:"===location.protocol&&l&&l[1].length<=6&&l[1]<"044429"&&(n=o.json2xml({}),r["Content-MD5"]=o.binaryBase64(o.md5(n)),r["Content-Type"]||(r["Content-Type"]=e.Body&&e.Body.type||"application/octet-stream")),!r["Cache-Control"]&&(r["Cache-Control"]=""),m.call(this,{Action:"name/cos:InitiateMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,action:"uploads",headers:e.Headers,body:n},(function(e,data){return e?t(e):(data=o.clone(data||{}))&&data.InitiateMultipartUploadResult?t(null,o.extend(data.InitiateMultipartUploadResult,{statusCode:data.statusCode,headers:data.headers})):void t(null,data)}))},multipartUpload:function(e,t){var n=this;o.getFileSize("multipartUpload",e,(function(){o.getBodyMd5(n.options.UploadCheckContentMd5,e.Body,(function(r){r&&(e.Headers["Content-MD5"]=o.binaryBase64(r)),m.call(n,{Action:"name/cos:UploadPart",TaskId:e.TaskId,method:"PUT",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{partNumber:e.PartNumber,uploadId:e.UploadId},headers:e.Headers,onProgress:e.onProgress,body:e.Body||null},(function(e,data){if(e)return t(e);data.headers=data.headers||{},t(null,{ETag:data.headers.etag||"",statusCode:data.statusCode,headers:data.headers})}))}))}))},multipartComplete:function(e,t){for(var n=this,r=e.UploadId,l=e.Parts,i=0,c=l.length;i<c;i++)0!==l[i].ETag.indexOf('"')&&(l[i].ETag='"'+l[i].ETag+'"');var f=o.json2xml({CompleteMultipartUpload:{Part:l}}),h=e.Headers;h["Content-Type"]="application/xml",h["Content-MD5"]=o.binaryBase64(o.md5(f)),m.call(this,{Action:"name/cos:CompleteMultipartUpload",method:"POST",Bucket:e.Bucket,Region:e.Region,Key:e.Key,qs:{uploadId:r},body:f,headers:h},(function(r,data){if(r)return t(r);var l=d({ForcePathStyle:n.options.ForcePathStyle,protocol:n.options.Protocol,domain:n.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key,isLocation:!0}),c=data.CompleteMultipartUploadResult||{},f=o.extend(c,{Location:l,statusCode:data.statusCode,headers:data.headers});t(null,f)}))},multipartList:function(e,t){var n={};n.delimiter=e.Delimiter,n["encoding-type"]=e.EncodingType,n.prefix=e.Prefix||"",n["max-uploads"]=e.MaxUploads,n["key-marker"]=e.KeyMarker,n["upload-id-marker"]=e.UploadIdMarker,n=o.clearKey(n),m.call(this,{Action:"name/cos:ListMultipartUploads",ResourceKey:n.prefix,method:"GET",Bucket:e.Bucket,Region:e.Region,headers:e.Headers,qs:n,action:"uploads"},(function(e,data){if(e)return t(e);if(data&&data.ListMultipartUploadsResult){var n=data.ListMultipartUploadsResult.Upload||[],r=data.ListMultipartUploadsResult.CommonPrefixes||[];r=o.isArray(r)?r:[r],n=o.isArray(n)?n:[n],data.ListMultipartUploadsResult.Upload=n,data.ListMultipartUploadsResult.CommonPrefixes=r}var l=o.clone(data.ListMultipartUploadsResult||{});o.extend(l,{statusCode:data.statusCode,headers:data.headers}),t(null,l)}))},multipartListPart:function(e,t){var n={};n.uploadId=e.UploadId,n["encoding-type"]=e.EncodingType,n["max-parts"]=e.MaxParts,n["part-number-marker"]=e.PartNumberMarker,m.call(this,{Action:"name/cos:ListParts",method:"GET",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:n},(function(e,data){if(e)return t(e);var n=data.ListPartsResult||{},r=n.Part||[];r=o.isArray(r)?r:[r],n.Part=r;var l=o.clone(n);o.extend(l,{statusCode:data.statusCode,headers:data.headers}),t(null,l)}))},multipartAbort:function(e,t){var n={};n.uploadId=e.UploadId,m.call(this,{Action:"name/cos:AbortMultipartUpload",method:"DELETE",Bucket:e.Bucket,Region:e.Region,Key:e.Key,headers:e.Headers,qs:n},(function(e,data){if(e)return t(e);t(null,{statusCode:data.statusCode,headers:data.headers})}))},getObjectUrl:function(e,t){var n=d({ForcePathStyle:this.options.ForcePathStyle,protocol:e.Protocol||this.options.Protocol,domain:this.options.Domain,bucket:e.Bucket,region:e.Region,object:e.Key});if(void 0!==e.Sign&&!e.Sign)return t(null,{Url:n}),n;var r=f.call(this,{Action:"PUT"===(e.Method||"").toUpperCase()?"name/cos:PutObject":"name/cos:GetObject",Bucket:e.Bucket||"",Region:e.Region||"",Method:e.Method||"get",Key:e.Key,Expires:e.Expires},(function(e,r){if(t)if(e)t(e);else{var o=n;o+="?"+(r.Authorization.indexOf("q-signature")>-1?r.Authorization:"sign="+encodeURIComponent(r.Authorization)),r.XCosSecurityToken&&(o+="&x-cos-security-token="+r.XCosSecurityToken),r.ClientIP&&(o+="&clientIP="+r.ClientIP),r.ClientUA&&(o+="&clientUA="+r.ClientUA),r.Token&&(o+="&token="+r.Token),setTimeout((function(){t(null,{Url:o})}))}}));return r?n+"?"+r.Authorization+(r.XCosSecurityToken?"&x-cos-security-token="+r.XCosSecurityToken:""):n},getAuth:function(e){return o.getAuth({SecretId:e.SecretId||this.options.SecretId||"",SecretKey:e.SecretKey||this.options.SecretKey||"",Method:e.Method,Key:e.Key,Query:e.Query,Headers:e.Headers,Expires:e.Expires,UseRawKey:this.options.UseRawKey,SystemClockOffset:this.options.SystemClockOffset})}};e.exports.init=function(e,t){t.transferToTaskMethod(y,"putObject"),o.each(y,(function(t,n){e.prototype[n]=o.apiWrapper(n,t),function(e,t,n){o.each(["Cors","Acl"],(function(r){if(e.slice(-r.length)===r){var l=e.slice(0,-r.length)+r.toUpperCase(),c=o.apiWrapper(e,t),d=!1;n[l]=function(){!d&&console.warn("warning: cos."+l+" has been deprecated. Please Use cos."+e+" instead."),d=!0,c.apply(this,arguments)}}}))}(n,t,e.prototype)}))}},837:function(e,t,n){var r=n(838),o=function(){var e=[],t=e.slice,n=e.concat,r=e.push,o=e.indexOf,l={},c=l.toString,d=l.hasOwnProperty,f={},h="1.11.1 -css,-css/addGetHookIf,-css/curCSS,-css/defaultDisplay,-css/hiddenVisibleSelectors,-css/support,-css/swap,-css/var/cssExpand,-css/var/isHidden,-css/var/rmargin,-css/var/rnumnonpx,-effects,-effects/Tween,-effects/animatedSelector,-effects/support,-dimensions,-offset,-deprecated,-event-alias,-wrap",m=function(e,t){return new m.fn.init(e,t)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,y=/^-ms-/,w=/-([\da-z])/gi,C=function(e,t){return t.toUpperCase()};function k(e){var t=e.length,n=m.type(e);return"function"!==n&&!m.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}m.fn=m.prototype={jquery:h,constructor:m,selector:"",length:0,toArray:function(){return t.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:t.call(this)},pushStack:function(e){var t=m.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return m.each(this,e,t)},map:function(e){return this.pushStack(m.map(this,(function(t,i){return e.call(t,i,t)})))},slice:function(){return this.pushStack(t.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var e=this.length,t=+i+(i<0?e:0);return this.pushStack(t>=0&&t<e?[this[t]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:r,sort:e.sort,splice:e.splice},m.extend=m.fn.extend=function(){var e,t,n,r,o,l,c=arguments[0]||{},i=1,d=arguments.length,f=!1;for("boolean"==typeof c&&(f=c,c=arguments[i]||{},i++),"object"==typeof c||m.isFunction(c)||(c={}),i===d&&(c=this,i--);i<d;i++)if(null!=(o=arguments[i]))for(r in o)e=c[r],c!==(n=o[r])&&(f&&n&&(m.isPlainObject(n)||(t=m.isArray(n)))?(t?(t=!1,l=e&&m.isArray(e)?e:[]):l=e&&m.isPlainObject(e)?e:{},c[r]=m.extend(f,l,n)):void 0!==n&&(c[r]=n));return c},m.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===m.type(e)},isArray:Array.isArray||function(e){return"array"===m.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!m.isArray(e)&&e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==m.type(e)||e.nodeType||m.isWindow(e))return!1;try{if(e.constructor&&!d.call(e,"constructor")&&!d.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(f.ownLast)for(t in e)return d.call(e,t);for(t in e);return void 0===t||d.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[c.call(e)]||"object":typeof e},globalEval:function(data){data&&m.trim(data)&&(window.execScript||function(data){window.eval.call(window,data)})(data)},camelCase:function(e){return e.replace(y,"ms-").replace(w,C)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var i=0,r=e.length,o=k(e);if(n){if(o)for(;i<r&&!1!==t.apply(e[i],n);i++);else for(i in e)if(!1===t.apply(e[i],n))break}else if(o)for(;i<r&&!1!==t.call(e[i],i,e[i]);i++);else for(i in e)if(!1===t.call(e[i],i,e[i]))break;return e},trim:function(text){return null==text?"":(text+"").replace(v,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(k(Object(e))?m.merge(n,"string"==typeof e?[e]:e):r.call(n,e)),n},inArray:function(e,t,i){var n;if(t){if(o)return o.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;)e[i++]=t[r++];if(n!=n)for(;void 0!==t[r];)e[i++]=t[r++];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,l=!n;i<o;i++)!t(e[i],i)!==l&&r.push(e[i]);return r},map:function(e,t,r){var o,i=0,l=e.length,c=[];if(k(e))for(;i<l;i++)null!=(o=t(e[i],i,r))&&c.push(o);else for(i in e)null!=(o=t(e[i],i,r))&&c.push(o);return n.apply([],c)},guid:1,proxy:function(e,n){var r,o,l;if("string"==typeof n&&(l=e[n],n=e,e=l),m.isFunction(e))return r=t.call(arguments,2),(o=function(){return e.apply(n||this,r.concat(t.call(arguments)))}).guid=e.guid=e.guid||m.guid++,o},now:function(){return+new Date},support:f}),m.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(i,e){l["[object "+e+"]"]=e.toLowerCase()}));var S,E=window.document,_=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(m.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(!(n="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:_.exec(e))||!n[1]&&t)return!t||t.jquery?(t||S).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof m?t[0]:t,m.merge(this,m.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:E,!0)),rsingleTag.test(n[1])&&m.isPlainObject(t))for(n in t)m.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}if((r=E.getElementById(n[2]))&&r.parentNode){if(r.id!==n[2])return S.find(e);this.length=1,this[0]=r}return this.context=E,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):m.isFunction(e)?void 0!==S.ready?S.ready(e):e(m):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),m.makeArray(e,this))}).prototype=m.fn,S=m(E);var x,T=/\S+/g,O={};function L(){E.addEventListener?(E.removeEventListener("DOMContentLoaded",A,!1),window.removeEventListener("load",A,!1)):(E.detachEvent("onreadystatechange",A),window.detachEvent("onload",A))}function A(){(E.addEventListener||"load"===event.type||"complete"===E.readyState)&&(L(),m.ready())}m.Callbacks=function(e){e="string"==typeof e?O[e]||function(e){var object=O[e]={};return m.each(e.match(T)||[],(function(e,t){object[t]=!0})),object}(e):m.extend({},e);var t,n,r,o,l,c,d=[],f=!e.once&&[],h=function(data){for(n=e.memory&&data,r=!0,l=c||0,c=0,o=d.length,t=!0;d&&l<o;l++)if(!1===d[l].apply(data[0],data[1])&&e.stopOnFalse){n=!1;break}t=!1,d&&(f?f.length&&h(f.shift()):n?d=[]:v.disable())},v={add:function(){if(d){var r=d.length;!function t(n){m.each(n,(function(n,r){var o=m.type(r);"function"===o?e.unique&&v.has(r)||d.push(r):r&&r.length&&"string"!==o&&t(r)}))}(arguments),t?o=d.length:n&&(c=r,h(n))}return this},remove:function(){return d&&m.each(arguments,(function(e,n){for(var r;(r=m.inArray(n,d,r))>-1;)d.splice(r,1),t&&(r<=o&&o--,r<=l&&l--)})),this},has:function(e){return e?m.inArray(e,d)>-1:!(!d||!d.length)},empty:function(){return d=[],o=0,this},disable:function(){return d=f=n=void 0,this},disabled:function(){return!d},lock:function(){return f=void 0,n||v.disable(),this},locked:function(){return!f},fireWith:function(e,n){return!d||r&&!f||(n=[e,(n=n||[]).slice?n.slice():n],t?f.push(n):h(n)),this},fire:function(){return v.fireWith(this,arguments),this},fired:function(){return!!r}};return v},m.extend({Deferred:function(e){var t=[["resolve","done",m.Callbacks("once memory"),"resolved"],["reject","fail",m.Callbacks("once memory"),"rejected"],["notify","progress",m.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return m.Deferred((function(n){m.each(t,(function(i,t){var l=m.isFunction(e[i])&&e[i];o[t[1]]((function(){var e=l&&l.apply(this,arguments);e&&m.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[t[0]+"With"](this===r?n.promise():this,l?[e]:arguments)}))})),e=null})).promise()},promise:function(e){return null!=e?m.extend(e,r):r}},o={};return r.pipe=r.then,m.each(t,(function(i,e){var l=e[2],c=e[3];r[e[1]]=l.add,c&&l.add((function(){n=c}),t[1^i][2].disable,t[2][2].lock),o[e[0]]=function(){return o[e[0]+"With"](this===o?r:this,arguments),this},o[e[0]+"With"]=l.fireWith})),r.promise(o),e&&e.call(o,o),o},when:function(e){var n,r,o,i=0,l=t.call(arguments),c=l.length,d=1!==c||e&&m.isFunction(e.promise)?c:0,f=1===d?e:m.Deferred(),h=function(i,e,r){return function(o){e[i]=this,r[i]=arguments.length>1?t.call(arguments):o,r===n?f.notifyWith(e,r):--d||f.resolveWith(e,r)}};if(c>1)for(n=new Array(c),r=new Array(c),o=new Array(c);i<c;i++)l[i]&&m.isFunction(l[i].promise)?l[i].promise().done(h(i,o,l)).fail(f.reject).progress(h(i,r,n)):--d;return d||f.resolveWith(o,l),f.promise()}}),m.fn.ready=function(e){return m.ready.promise().done(e),this},m.extend({isReady:!1,readyWait:1,holdReady:function(e){e?m.readyWait++:m.ready(!0)},ready:function(e){if(!(!0===e?--m.readyWait:m.isReady)){if(!E.body)return setTimeout(m.ready);m.isReady=!0,!0!==e&&--m.readyWait>0||(x.resolveWith(E,[m]),m.fn.triggerHandler&&(m(E).triggerHandler("ready"),m(E).off("ready")))}}}),m.ready.promise=function(e){if(!x)if(x=m.Deferred(),"complete"===E.readyState)setTimeout(m.ready);else if(E.addEventListener)E.addEventListener("DOMContentLoaded",A,!1),window.addEventListener("load",A,!1);else{E.attachEvent("onreadystatechange",A),window.attachEvent("onload",A);var t=!1;try{t=null==window.frameElement&&E.documentElement}catch(e){}t&&t.doScroll&&function e(){if(!m.isReady){try{t.doScroll("left")}catch(t){return setTimeout(e,50)}L(),m.ready()}}()}return x.promise(e)};var i;for(i in m(f))break;f.ownLast="0"!==i,f.inlineBlockNeedsLayout=!1,m((function(){var e,div,body,t;(body=E.getElementsByTagName("body")[0])&&body.style&&(div=E.createElement("div"),(t=E.createElement("div")).style.cssText="position:absolute;border:0;width:0;height:0;top:0;left:-9999px",body.appendChild(t).appendChild(div),void 0!==div.style.zoom&&(div.style.cssText="display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1",f.inlineBlockNeedsLayout=e=3===div.offsetWidth,e&&(body.style.zoom=1)),body.removeChild(t))})),function(){var div=E.createElement("div");if(null==f.deleteExpando){f.deleteExpando=!0;try{delete div.test}catch(e){f.deleteExpando=!1}}div=null}(),m.acceptData=function(e){var t=m.noData[(e.nodeName+" ").toLowerCase()],n=+e.nodeType||1;return(1===n||9===n)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var j=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,M=/([A-Z])/g;function R(e,t,data){if(void 0===data&&1===e.nodeType){var n="data-"+t.replace(M,"-$1").toLowerCase();if("string"==typeof(data=e.getAttribute(n))){try{data="true"===data||"false"!==data&&("null"===data?null:+data+""===data?+data:j.test(data)?m.parseJSON(data):data)}catch(e){}m.data(e,t,data)}else data=void 0}return data}function H(e){var t;for(t in e)if(("data"!==t||!m.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function D(t,n,data,r){if(m.acceptData(t)){var o,l,c=m.expando,d=t.nodeType,f=d?m.cache:t,h=d?t[c]:t[c]&&c;if(h&&f[h]&&(r||f[h].data)||void 0!==data||"string"!=typeof n)return h||(h=d?t[c]=e.pop()||m.guid++:c),f[h]||(f[h]=d?{}:{toJSON:m.noop}),"object"!=typeof n&&"function"!=typeof n||(r?f[h]=m.extend(f[h],n):f[h].data=m.extend(f[h].data,n)),l=f[h],r||(l.data||(l.data={}),l=l.data),void 0!==data&&(l[m.camelCase(n)]=data),"string"==typeof n?null==(o=l[n])&&(o=l[m.camelCase(n)]):o=l,o}}function N(e,t,n){if(m.acceptData(e)){var r,i,o=e.nodeType,l=o?m.cache:e,c=o?e[m.expando]:m.expando;if(l[c]){if(t&&(r=n?l[c]:l[c].data)){i=(t=m.isArray(t)?t.concat(m.map(t,m.camelCase)):t in r||(t=m.camelCase(t))in r?[t]:t.split(" ")).length;for(;i--;)delete r[t[i]];if(n?!H(r):!m.isEmptyObject(r))return}(n||(delete l[c].data,H(l[c])))&&(o?m.cleanData([e],!0):f.deleteExpando||l!=l.window?delete l[c]:l[c]=null)}}}m.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?m.cache[e[m.expando]]:e[m.expando])&&!H(e)},data:function(e,t,data){return D(e,t,data)},removeData:function(e,t){return N(e,t)},_data:function(e,t,data){return D(e,t,data,!0)},_removeData:function(e,t){return N(e,t,!0)}}),m.fn.extend({data:function(e,t){var i,n,data,r=this[0],o=r&&r.attributes;if(void 0===e){if(this.length&&(data=m.data(r),1===r.nodeType&&!m._data(r,"parsedAttrs"))){for(i=o.length;i--;)o[i]&&0===(n=o[i].name).indexOf("data-")&&R(r,n=m.camelCase(n.slice(5)),data[n]);m._data(r,"parsedAttrs",!0)}return data}return"object"==typeof e?this.each((function(){m.data(this,e)})):arguments.length>1?this.each((function(){m.data(this,e,t)})):r?R(r,e,m.data(r,e)):void 0},removeData:function(e){return this.each((function(){m.removeData(this,e)}))}}),m.extend({queue:function(e,t,data){var n;if(e)return t=(t||"fx")+"queue",n=m._data(e,t),data&&(!n||m.isArray(data)?n=m._data(e,t,m.makeArray(data)):n.push(data)),n||[]},dequeue:function(e,t){t=t||"fx";var n=m.queue(e,t),r=n.length,o=n.shift(),l=m._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),r--),o&&("fx"===t&&n.unshift("inprogress"),delete l.stop,o.call(e,(function(){m.dequeue(e,t)}),l)),!r&&l&&l.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return m._data(e,n)||m._data(e,n,{empty:m.Callbacks("once memory").add((function(){m._removeData(e,t+"queue"),m._removeData(e,n)}))})}}),m.fn.extend({queue:function(e,data){var t=2;return"string"!=typeof e&&(data=e,e="fx",t--),arguments.length<t?m.queue(this[0],e):void 0===data?this:this.each((function(){var t=m.queue(this,e,data);m._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&m.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){m.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,o=m.Deferred(),l=this,i=this.length,c=function(){--r||o.resolveWith(l,[l])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";i--;)(n=m._data(l[i],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(c));return c(),o.promise(t)}}),m.event={global:{},add:function(e,t,n,data,r){var o,l,c,d,f,h,v,y,w,C,k,S=m._data(e);if(S){for(n.handler&&(n=(d=n).handler,r=d.selector),n.guid||(n.guid=m.guid++),(l=S.events)||(l=S.events={}),(h=S.handle)||((h=S.handle=function(e){return void 0===m||e&&m.event.triggered===e.type?void 0:m.event.dispatch.apply(h.elem,arguments)}).elem=e),c=(t=(t||"").match(T)||[""]).length;c--;)w=k=(o=F.exec(t[c])||[])[1],C=(o[2]||"").split(".").sort(),w&&(f=m.event.special[w]||{},w=(r?f.delegateType:f.bindType)||w,f=m.event.special[w]||{},v=m.extend({type:w,origType:k,data:data,handler:n,guid:n.guid,selector:r,needsContext:r&&m.expr.match.needsContext.test(r),namespace:C.join(".")},d),(y=l[w])||((y=l[w]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(e,data,C,h)||(e.addEventListener?e.addEventListener(w,h,!1):e.attachEvent&&e.attachEvent("on"+w,h))),f.add&&(f.add.call(e,v),v.handler.guid||(v.handler.guid=n.guid)),r?y.splice(y.delegateCount++,0,v):y.push(v),m.event.global[w]=!0);e=null}},remove:function(e,t,n,r,o){var l,c,d,f,h,v,y,w,C,k,S,E=m.hasData(e)&&m._data(e);if(E&&(v=E.events)){for(h=(t=(t||"").match(T)||[""]).length;h--;)if(C=S=(d=F.exec(t[h])||[])[1],k=(d[2]||"").split(".").sort(),C){for(y=m.event.special[C]||{},w=v[C=(r?y.delegateType:y.bindType)||C]||[],d=d[2]&&new RegExp("(^|\\.)"+k.join("\\.(?:.*\\.|)")+"(\\.|$)"),f=l=w.length;l--;)c=w[l],!o&&S!==c.origType||n&&n.guid!==c.guid||d&&!d.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(w.splice(l,1),c.selector&&w.delegateCount--,y.remove&&y.remove.call(e,c));f&&!w.length&&(y.teardown&&!1!==y.teardown.call(e,k,E.handle)||m.removeEvent(e,C,E.handle),delete v[C])}else for(C in v)m.event.remove(e,C+t[h],n,r,!0);m.isEmptyObject(v)&&(delete E.handle,m._removeData(e,"events"))}},trigger:function(e,data,t,n){var r,o,l,c,f,h,i,v=[t||E],y=d.call(e,"type")?e.type:e,w=d.call(e,"namespace")?e.namespace.split("."):[];if(l=h=t=t||E,3!==t.nodeType&&8!==t.nodeType&&!U.test(y+m.event.triggered)&&(y.indexOf(".")>=0&&(w=y.split("."),y=w.shift(),w.sort()),o=y.indexOf(":")<0&&"on"+y,(e=e[m.expando]?e:new m.Event(y,"object"==typeof e&&e)).isTrigger=n?2:3,e.namespace=w.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+w.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=t),data=null==data?[e]:m.makeArray(data,[e]),f=m.event.special[y]||{},n||!f.trigger||!1!==f.trigger.apply(t,data))){if(!n&&!f.noBubble&&!m.isWindow(t)){for(c=f.delegateType||y,U.test(c+y)||(l=l.parentNode);l;l=l.parentNode)v.push(l),h=l;h===(t.ownerDocument||E)&&v.push(h.defaultView||h.parentWindow||window)}for(i=0;(l=v[i++])&&!e.isPropagationStopped();)e.type=i>1?c:f.bindType||y,(r=(m._data(l,"events")||{})[e.type]&&m._data(l,"handle"))&&r.apply(l,data),(r=o&&l[o])&&r.apply&&m.acceptData(l)&&(e.result=r.apply(l,data),!1===e.result&&e.preventDefault());if(e.type=y,!n&&!e.isDefaultPrevented()&&(!f._default||!1===f._default.apply(v.pop(),data))&&m.acceptData(t)&&o&&t[y]&&!m.isWindow(t)){(h=t[o])&&(t[o]=null),m.event.triggered=y;try{t[y]()}catch(e){}m.event.triggered=void 0,h&&(t[o]=h)}return e.result}},dispatch:function(e){e=m.event.fix(e);var i,n,r,o,l,c=[],d=t.call(arguments),f=(m._data(this,"events")||{})[e.type]||[],h=m.event.special[e.type]||{};if(d[0]=e,e.delegateTarget=this,!h.preDispatch||!1!==h.preDispatch.call(this,e)){for(c=m.event.handlers.call(this,e,f),i=0;(o=c[i++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,l=0;(r=o.handlers[l++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(r.namespace)||(e.handleObj=r,e.data=r.data,void 0!==(n=((m.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,d))&&!1===(e.result=n)&&(e.preventDefault(),e.stopPropagation()));return h.postDispatch&&h.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,o,i,l=[],c=t.delegateCount,d=e.target;if(c&&d.nodeType&&(!e.button||"click"!==e.type))for(;d!=this;d=d.parentNode||this)if(1===d.nodeType&&(!0!==d.disabled||"click"!==e.type)){for(o=[],i=0;i<c;i++)void 0===o[n=(r=t[i]).selector+" "]&&(o[n]=r.needsContext?m(n,this).index(d)>=0:m.find(n,this,null,[d]).length),o[n]&&o.push(r);o.length&&l.push({elem:d,handlers:o})}return c<t.length&&l.push({elem:this,handlers:t.slice(c)}),l},fix:function(e){if(e[m.expando])return e;var i,t,n,r=e.type,o=e,l=this.fixHooks[r];for(l||(this.fixHooks[r]=l=B.test(r)?this.mouseHooks:I.test(r)?this.keyHooks:{}),n=l.props?this.props.concat(l.props):this.props,e=new m.Event(o),i=n.length;i--;)e[t=n[i]]=o[t];return e.target||(e.target=o.srcElement||E),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,l.filter?l.filter(e,o):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var body,n,r,button=t.button,o=t.fromElement;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||E).documentElement,body=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||body&&body.scrollLeft||0)-(r&&r.clientLeft||body&&body.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||body&&body.scrollTop||0)-(r&&r.clientTop||body&&body.clientTop||0)),!e.relatedTarget&&o&&(e.relatedTarget=o===e.target?t.toElement:o),e.which||void 0===button||(e.which=1&button?1:2&button?3:4&button?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(m.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return m.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var o=m.extend(new m.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?m.event.trigger(o,null,t):m.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},m.removeEvent=E.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(void 0===e[r]&&(e[r]=null),e.detachEvent(r,n))},m.Event=function(e,t){if(!(this instanceof m.Event))return new m.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?K:z):this.type=e,t&&m.extend(this,t),this.timeStamp=e&&e.timeStamp||m.now(),this[m.expando]=!0};var P=/^(?:input|select|textarea)$/i,I=/^key/,B=/^(?:mouse|pointer|contextmenu)|click/,U=/^(?:focusinfocus|focusoutblur)$/,F=/^([^.]*)(?:\.(.+)|)$/;function K(){return!0}function z(){return!1}m.Event.prototype={isDefaultPrevented:z,isPropagationStopped:z,isImmediatePropagationStopped:z,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=K,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=K,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=K,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},f.submitBubbles||(m.event.special.submit={setup:function(){if(m.nodeName(this,"form"))return!1;m.event.add(this,"click._submit keypress._submit",(function(e){var t=e.target,form=m.nodeName(t,"input")||m.nodeName(t,"button")?t.form:void 0;form&&!m._data(form,"submitBubbles")&&(m.event.add(form,"submit._submit",(function(e){e._submit_bubble=!0})),m._data(form,"submitBubbles",!0))}))},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&m.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(m.nodeName(this,"form"))return!1;m.event.remove(this,"._submit")}}),f.changeBubbles||(m.event.special.change={setup:function(){if(P.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(m.event.add(this,"propertychange._change",(function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)})),m.event.add(this,"click._change",(function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),m.event.simulate("change",this,e,!0)}))),!1;m.event.add(this,"beforeactivate._change",(function(e){var t=e.target;P.test(t.nodeName)&&!m._data(t,"changeBubbles")&&(m.event.add(t,"change._change",(function(e){!this.parentNode||e.isSimulated||e.isTrigger||m.event.simulate("change",this.parentNode,e,!0)})),m._data(t,"changeBubbles",!0))}))},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return m.event.remove(this,"._change"),!P.test(this.nodeName)}}),f.focusinBubbles||m.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){m.event.simulate(t,e.target,m.event.fix(e),!0)};m.event.special[t]={setup:function(){var r=this.ownerDocument||this,o=m._data(r,t);o||r.addEventListener(e,n,!0),m._data(r,t,(o||0)+1)},teardown:function(){var r=this.ownerDocument||this,o=m._data(r,t)-1;o?m._data(r,t,o):(r.removeEventListener(e,n,!0),m._removeData(r,t))}}})),m.fn.extend({on:function(e,t,data,n,r){var o,l;if("object"==typeof e){for(o in"string"!=typeof t&&(data=data||t,t=void 0),e)this.on(o,t,data,e[o],r);return this}if(null==data&&null==n?(n=t,data=t=void 0):null==n&&("string"==typeof t?(n=data,data=void 0):(n=data,data=t,t=void 0)),!1===n)n=z;else if(!n)return this;return 1===r&&(l=n,(n=function(e){return m().off(e),l.apply(this,arguments)}).guid=l.guid||(l.guid=m.guid++)),this.each((function(){m.event.add(this,e,n,data,t)}))},one:function(e,t,data,n){return this.on(e,t,data,n,1)},off:function(e,t,n){var r,o;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,m(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=z),this.each((function(){m.event.remove(this,e,n,t)}))},trigger:function(e,data){return this.each((function(){m.event.trigger(e,data,this)}))},triggerHandler:function(e,data){var t=this[0];if(t)return m.event.trigger(e,data,t,!0)}}),m.fn.delay=function(time,e){return time=m.fx&&m.fx.speeds[time]||time,e=e||"fx",this.queue(e,(function(e,t){var n=setTimeout(e,time);t.stop=function(){clearTimeout(n)}}))};var $=m.now(),V=/\?/,W=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;m.parseJSON=function(data){if(window.JSON&&window.JSON.parse)return window.JSON.parse(data+"");var e,t=null,n=m.trim(data+"");return n&&!m.trim(n.replace(W,(function(n,r,o,l){return e&&r&&(t=0),0===t?n:(e=o||r,t+=!l-!o,"")})))?Function("return "+n)():m.error("Invalid JSON: "+data)},m.parseXML=function(data){var e;if(!data||"string"!=typeof data)return null;try{window.DOMParser?e=(new DOMParser).parseFromString(data,"text/xml"):((e=new ActiveXObject("Microsoft.XMLDOM")).async="false",e.loadXML(data))}catch(t){e=void 0}return e&&e.documentElement&&!e.getElementsByTagName("parsererror").length||m.error("Invalid XML: "+data),e};var X,G,J=/#.*$/,Z=/([?&])_=[^&]*/,Y=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Q=/^(?:GET|HEAD)$/,ee=/^\/\//,te=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ne={},re={},ie="*/".concat("*");try{G=location.href}catch(e){(G=E.createElement("a")).href="",G=G.href}function oe(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,o=t.toLowerCase().match(T)||[];if(m.isFunction(n))for(;r=o[i++];)"+"===r.charAt(0)?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ae(e,t,n,r){var o={},l=e===re;function c(d){var f;return o[d]=!0,m.each(e[d]||[],(function(e,d){var h=d(t,n,r);return"string"!=typeof h||l||o[h]?l?!(f=h):void 0:(t.dataTypes.unshift(h),c(h),!1)})),f}return c(t.dataTypes[0])||!o["*"]&&c("*")}function se(e,t){var n,r,o=m.ajaxSettings.flatOptions||{};for(r in t)void 0!==t[r]&&((o[r]?e:n||(n={}))[r]=t[r]);return n&&m.extend(!0,e,n),e}X=te.exec(G.toLowerCase())||[],m.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:G,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(X[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":ie,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":m.parseJSON,"text xml":m.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?se(se(e,m.ajaxSettings),t):se(m.ajaxSettings,e)},ajaxPrefilter:oe(ne),ajaxTransport:oe(re),ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,i,r,o,l,c,d,f,s=m.ajaxSetup({},t),h=s.context||s,v=s.context&&(h.nodeType||h.jquery)?m(h):m.event,y=m.Deferred(),w=m.Callbacks("once memory"),C=s.statusCode||{},k={},S={},E=0,_="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===E){if(!f)for(f={};t=Y.exec(o);)f[t[1].toLowerCase()]=t[2];t=f[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===E?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return E||(e=S[n]=S[n]||e,k[e]=t),this},overrideMimeType:function(e){return E||(s.mimeType=e),this},statusCode:function(map){var code;if(map)if(E<2)for(code in map)C[code]=[C[code],map[code]];else x.always(map[x.status]);return this},abort:function(e){var t=e||_;return d&&d.abort(t),O(0,t),this}};if(y.promise(x).complete=w.add,x.success=x.done,x.error=x.fail,s.url=((e||s.url||G)+"").replace(J,"").replace(ee,X[1]+"//"),s.type=t.method||t.type||s.method||s.type,s.dataTypes=m.trim(s.dataType||"*").toLowerCase().match(T)||[""],null==s.crossDomain&&(n=te.exec(s.url.toLowerCase()),s.crossDomain=!(!n||n[1]===X[1]&&n[2]===X[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(X[3]||("http:"===X[1]?"80":"443")))),s.data&&s.processData&&"string"!=typeof s.data&&(s.data=m.param(s.data,s.traditional)),ae(ne,s,t,x),2===E)return x;for(i in(c=s.global)&&0==m.active++&&m.event.trigger("ajaxStart"),s.type=s.type.toUpperCase(),s.hasContent=!Q.test(s.type),r=s.url,s.hasContent||(s.data&&(r=s.url+=(V.test(r)?"&":"?")+s.data,delete s.data),!1===s.cache&&(s.url=Z.test(r)?r.replace(Z,"$1_="+$++):r+(V.test(r)?"&":"?")+"_="+$++)),s.ifModified&&(m.lastModified[r]&&x.setRequestHeader("If-Modified-Since",m.lastModified[r]),m.etag[r]&&x.setRequestHeader("If-None-Match",m.etag[r])),(s.data&&s.hasContent&&!1!==s.contentType||t.contentType)&&x.setRequestHeader("Content-Type",s.contentType),s.headers)x.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(!1===s.beforeSend.call(h,x,s)||2===E))return x.abort();for(i in _="abort",{success:1,error:1,complete:1})x[i](s[i]);if(d=ae(re,s,t,x)){x.readyState=1,c&&v.trigger("ajaxSend",[x,s]),s.async&&s.timeout>0&&(l=setTimeout((function(){x.abort("timeout")}),s.timeout));try{E=1,d.send(k,O)}catch(e){if(!(E<2))throw e;O(-1,e)}}else O(-1,"No Transport");function O(e,t,n,f){var k,S,_,T,O,L=t;2!==E&&(E=2,l&&clearTimeout(l),d=void 0,o=f||"",x.readyState=e>0?4:0,k=e>=200&&e<300||304===e,n&&(T=function(s,e,t){for(var n,r,o,l,c=s.contents,d=s.dataTypes;"*"===d[0];)d.shift(),void 0===r&&(r=s.mimeType||e.getResponseHeader("Content-Type"));if(r)for(l in c)if(c[l]&&c[l].test(r)){d.unshift(l);break}if(d[0]in t)o=d[0];else{for(l in t){if(!d[0]||s.converters[l+" "+d[0]]){o=l;break}n||(n=l)}o=o||n}if(o)return o!==d[0]&&d.unshift(o),t[o]}(s,x,n)),T=function(s,e,t,n){var r,o,l,c,d,f={},h=s.dataTypes.slice();if(h[1])for(l in s.converters)f[l.toLowerCase()]=s.converters[l];for(o=h.shift();o;)if(s.responseFields[o]&&(t[s.responseFields[o]]=e),!d&&n&&s.dataFilter&&(e=s.dataFilter(e,s.dataType)),d=o,o=h.shift())if("*"===o)o=d;else if("*"!==d&&d!==o){if(!(l=f[d+" "+o]||f["* "+o]))for(r in f)if((c=r.split(" "))[1]===o&&(l=f[d+" "+c[0]]||f["* "+c[0]])){!0===l?l=f[r]:!0!==f[r]&&(o=c[0],h.unshift(c[1]));break}if(!0!==l)if(l&&s.throws)e=l(e);else try{e=l(e)}catch(e){return{state:"parsererror",error:l?e:"No conversion from "+d+" to "+o}}}return{state:"success",data:e}}(s,T,x,k),k?(s.ifModified&&((O=x.getResponseHeader("Last-Modified"))&&(m.lastModified[r]=O),(O=x.getResponseHeader("etag"))&&(m.etag[r]=O)),204===e||"HEAD"===s.type?L="nocontent":304===e?L="notmodified":(L=T.state,S=T.data,k=!(_=T.error))):(_=L,!e&&L||(L="error",e<0&&(e=0))),x.status=e,x.statusText=(t||L)+"",k?y.resolveWith(h,[S,L,x]):y.rejectWith(h,[x,L,_]),x.statusCode(C),C=void 0,c&&v.trigger(k?"ajaxSuccess":"ajaxError",[x,s,k?S:_]),w.fireWith(h,[x,L]),c&&(v.trigger("ajaxComplete",[x,s]),--m.active||m.event.trigger("ajaxStop")))}return x},getJSON:function(e,data,t){return m.get(e,data,t,"json")},getScript:function(e,t){return m.get(e,void 0,t,"script")}}),m.each(["get","post"],(function(i,e){m[e]=function(t,data,n,r){return m.isFunction(data)&&(r=r||n,n=data,data=void 0),m.ajax({url:t,type:e,dataType:r,data:data,success:n})}})),m.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(i,e){m.fn[e]=function(t){return this.on(e,t)}})),m._evalUrl=function(e){return m.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})};var le=/%20/g,ce=/\[\]$/,ue=/\r?\n/g,de=/^(?:submit|button|image|reset|file)$/i,pe=/^(?:input|select|textarea|keygen)/i;function fe(e,t,n,r){var o;if(m.isArray(t))m.each(t,(function(i,t){n||ce.test(e)?r(e,t):fe(e+"["+("object"==typeof t?i:"")+"]",t,n,r)}));else if(n||"object"!==m.type(t))r(e,t);else for(o in t)fe(e+"["+o+"]",t[o],n,r)}m.param=function(a,e){var t,s=[],n=function(e,t){t=m.isFunction(t)?t():null==t?"":t,s[s.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===e&&(e=m.ajaxSettings&&m.ajaxSettings.traditional),m.isArray(a)||a.jquery&&!m.isPlainObject(a))m.each(a,(function(){n(this.name,this.value)}));else for(t in a)fe(t,a[t],e,n);return s.join("&").replace(le,"+")},m.fn.extend({serialize:function(){return m.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=m.prop(this,"elements");return e?m.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!m(this).is(":disabled")&&pe.test(this.nodeName)&&!de.test(e)&&(this.checked||!rcheckableType.test(e))})).map((function(i,e){var t=m(this).val();return null==t?null:m.isArray(t)?m.map(t,(function(t){return{name:e.name,value:t.replace(ue,"\r\n")}})):{name:e.name,value:t.replace(ue,"\r\n")}})).get()}}),m.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&ge()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:ge;var he=0,me={},ve=m.ajaxSettings.xhr();function ge(){try{return new window.XMLHttpRequest}catch(e){}}window.ActiveXObject&&m(window).on("unload",(function(){for(var e in me)me[e](void 0,!0)})),f.cors=!!ve&&"withCredentials"in ve,(ve=f.ajax=!!ve)&&m.ajaxTransport((function(e){var t;if(!e.crossDomain||f.cors)return{send:function(n,r){var i,o=e.xhr(),l=++he;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];for(i in e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)void 0!==n[i]&&o.setRequestHeader(i,n[i]+"");o.upload&&e.progress&&(o.upload.onprogress=e.progress),o.send(e.hasContent&&(e.body||e.data)||null),t=function(n,c){var d,f,h;if(t&&(c||4===o.readyState))if(delete me[l],t=void 0,o.onreadystatechange=m.noop,c)4!==o.readyState&&o.abort();else{h={},d=o.status,"string"==typeof o.responseText&&(h.text=o.responseText);try{f=o.statusText}catch(e){f=""}d||!e.isLocal||e.crossDomain?1223===d&&(d=204):d=h.text?200:404}h&&r(d,f,h,o.getAllResponseHeaders())},e.async?4===o.readyState?setTimeout(t):o.onreadystatechange=me[l]=t:t()},abort:function(){t&&t(void 0,!0)}}})),m.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){return m.globalEval(text),text}}}),m.ajaxPrefilter("script",(function(s){void 0===s.cache&&(s.cache=!1),s.crossDomain&&(s.type="GET",s.global=!1)})),m.ajaxTransport("script",(function(s){if(s.crossDomain){var script,head=E.head||m("head")[0]||E.documentElement;return{send:function(e,t){(script=E.createElement("script")).async=!0,s.scriptCharset&&(script.charset=s.scriptCharset),script.src=s.url,script.onload=script.onreadystatechange=function(e,n){(n||!script.readyState||/loaded|complete/.test(script.readyState))&&(script.onload=script.onreadystatechange=null,script.parentNode&&script.parentNode.removeChild(script),script=null,n||t(200,"success"))},head.insertBefore(script,head.firstChild)},abort:function(){script&&script.onload(void 0,!0)}}}}));var ye=[],be=/(=)\?(?=&|$)|\?\?/;return m.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=ye.pop()||m.expando+"_"+$++;return this[e]=!0,e}}),m.ajaxPrefilter("json jsonp",(function(s,e,t){var n,r,o,l=!1!==s.jsonp&&(be.test(s.url)?"url":"string"==typeof s.data&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&be.test(s.data)&&"data");if(l||"jsonp"===s.dataTypes[0])return n=s.jsonpCallback=m.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,l?s[l]=s[l].replace(be,"$1"+n):!1!==s.jsonp&&(s.url+=(V.test(s.url)?"&":"?")+s.jsonp+"="+n),s.converters["script json"]=function(){return o||m.error(n+" was not called"),o[0]},s.dataTypes[0]="json",r=window[n],window[n]=function(){o=arguments},t.always((function(){window[n]=r,s[n]&&(s.jsonpCallback=e.jsonpCallback,ye.push(n)),o&&m.isFunction(r)&&r(o[0]),o=r=void 0})),"script"})),m.parseHTML=function(data,e,t){if(!data||"string"!=typeof data)return null;"boolean"==typeof e&&(t=e,e=!1),e=e||E;var n=rsingleTag.exec(data),r=!t&&[];return n?[e.createElement(n[1])]:(n=m.buildFragment([data],e,r),r&&r.length&&m(r).remove(),m.merge([],n.childNodes))},m}();e.exports=function(e,t){if((e=o.extend(!0,{headers:{},qs:{}},e)).type=e.method,delete e.method,e.onProgress&&(e.progress=e.onProgress,delete e.onProgress),e.qs){var n=r.stringify(e.qs);n&&(e.url+=(-1===e.url.indexOf("?")?"?":"&")+n),delete e.qs}if(e.json&&(e.data=e.body,delete e.json,delete e.body,!e.headers&&(e.headers={}),e.headers["Content-Type"]="application/json"),e.body&&(e.body instanceof Blob||"[object File]"===e.body.toString()||"[object Blob]"===e.body.toString()||(e.data=e.body,delete e.body)),e.headers){var l=e.headers;delete e.headers,e.beforeSend=function(e){for(var t in l)l.hasOwnProperty(t)&&"content-length"!==t.toLowerCase()&&"user-agent"!==t.toLowerCase()&&"origin"!==t.toLowerCase()&&"host"!==t.toLowerCase()&&e.setRequestHeader(t,l[t])}}var c=function(e){var t={};return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){if(e){var n=e.indexOf(":"),r=e.substr(0,n).trim().toLowerCase(),o=e.substr(n+1).trim();t[r]=o}})),{statusCode:e.status,statusMessage:e.statusText,headers:t}};return e.success=function(data,e,n){t(null,c(n),data)},e.error=function(e){e.responseText?t(null,c(e),e.responseText):t(e.statusText,c(e),e.responseText)},e.dataType="text",o.ajax(e)}},838:function(e,t,n){"use strict";t.decode=t.parse=n(839),t.encode=t.stringify=n(840)},839:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,l){t=t||"&",n=n||"=";var c={};if("string"!=typeof e||0===e.length)return c;var d=/\+/g;e=e.split(t);var f=1e3;l&&"number"==typeof l.maxKeys&&(f=l.maxKeys);var h=e.length;f>0&&h>f&&(h=f);for(var i=0;i<h;++i){var m,v,y,w,C=e[i].replace(d,"%20"),k=C.indexOf(n);k>=0?(m=C.substr(0,k),v=C.substr(k+1)):(m=C,v=""),y=decodeURIComponent(m),w=decodeURIComponent(v),r(c,y)?o(c[y])?c[y].push(w):c[y]=[c[y],w]:c[y]=w}return c};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},840:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,c){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?map(l(e),(function(l){var c=encodeURIComponent(r(l))+n;return o(e[l])?map(e[l],(function(e){return c+encodeURIComponent(r(e))})).join(t):c+encodeURIComponent(r(e[l]))})).join(t):c?encodeURIComponent(r(c))+n+encodeURIComponent(r(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function map(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var l=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},841:function(e,t,n){var r,o=n(842),l=n(777).EventProxy,c=n(729);var d={};function f(){var e=this.options.UploadIdCacheLimit;if(!r){if(e)try{r=JSON.parse(localStorage.getItem("cos_sdk_upload_cache"))||[]}catch(e){}r||(r=[])}}function h(e,t,n){f.call(this);for(var i=r.length-1;i>=0;i--)r[i][0]===e&&r[i][1]===t&&r.splice(i,1);r.unshift([e,t]);var o=this.options.UploadIdCacheLimit;r.length>o&&r.splice(o),o&&setTimeout((function(){try{localStorage.setItem("cos_sdk_upload_cache",JSON.stringify(r))}catch(e){}}))}function m(e){f.call(this),delete d[e];for(var i=r.length-1;i>=0;i--)r[i][1]===e&&r.splice(i,1);var t=this.options.UploadIdCacheLimit;r.length>t&&r.splice(t),t&&setTimeout((function(){try{r.length?localStorage.setItem("cos_sdk_upload_cache",JSON.stringify(r)):localStorage.removeItem("cos_sdk_upload_cache")}catch(e){}}))}function v(e){f.call(this);for(var t=[],i=0;i<r.length;i++)r[i][0]===e&&t.push(r[i][1]);return t.length?t:null}function y(e,t){var n=e.TaskId,r=e.Bucket,f=e.Region,h=e.Key,y=e.StorageClass,k=this,S={},E=e.FileSize,_=e.SliceSize,x=Math.ceil(E/_),T=0,O=c.throttleOnProgress.call(k,E,e.onHashProgress),L=function(t,n){var r=t.length;if(0===r)return n(null,!0);if(r>x)return n(null,!1);if(r>1&&Math.max(t[0].Size,t[1].Size)!==_)return n(null,!1);var o=function(l){if(l<r){var d=t[l];!function(t,n){var r=_*(t-1),o=Math.min(r+_,E),l=o-r;S[t]?n(null,{PartNumber:t,ETag:S[t],Size:l}):c.fileSlice(e.Body,r,o,!1,(function(e){c.getFileMd5(e,(function(e,r){if(e)return n(e);var o='"'+r+'"';S[t]=o,1,T+=l,n(e,{PartNumber:t,ETag:o,Size:l}),O({loaded:T,total:E})}))}))}(d.PartNumber,(function(e,t){t&&t.ETag===d.ETag&&t.Size===d.Size?o(l+1):n(null,!1)}))}else n(null,!0)};o(0)},A=new l;A.on("error",(function(e){if(k._isRunningTask(n))return t(e)})),A.on("upload_id_ready",(function(e){var map={},n=[];c.each(e.PartList,(function(e){map[e.PartNumber]=e}));for(var r=1;r<=x;r++){var o=map[r];o?(o.PartNumber=r,o.Uploaded=!0):o={PartNumber:r,ETag:null,Uploaded:!1},n.push(o)}e.PartList=n,t(null,e)})),A.on("no_available_upload_id",(function(){if(k._isRunningTask(n)){var o=c.extend({Bucket:r,Region:f,Key:h,Headers:c.clone(e.Headers),StorageClass:y,Body:e.Body},e),l=e.Headers["Content-Type"]||e.Body&&e.Body.type;l&&(o.Headers["Content-Type"]=l),k.multipartInit(o,(function(e,data){if(k._isRunningTask(n)){if(e)return A.emit("error",e);var r=data.UploadId;if(!r)return t({Message:"no upload id"});A.emit("upload_id_ready",{UploadId:r,PartList:[]})}}))}})),A.on("has_upload_id",(function(e){e=e.reverse(),o.eachLimit(e,1,(function(e,t){k._isRunningTask(n)&&(d[e]?t():C.call(k,{Bucket:r,Region:f,Key:h,UploadId:e},(function(r,o){if(k._isRunningTask(n)){if(r)return m.call(k,e),A.emit("error",r);var l=o.PartList;l.forEach((function(e){e.PartNumber*=1,e.Size*=1,e.ETag=e.ETag||""})),L(l,(function(r,o){if(k._isRunningTask(n))return r?A.emit("error",r):void(o?t({UploadId:e,PartList:l}):t())}))}})))}),(function(e){k._isRunningTask(n)&&(O(null,!0),e&&e.UploadId?A.emit("upload_id_ready",e):A.emit("no_available_upload_id"))}))})),A.on("seek_local_avail_upload_id",(function(t){var o,l=c.getFileUUID(e.Body,e.ChunkSize);if(l&&(o=v.call(k,l))){var y=function(e){if(e>=o.length)A.emit("has_upload_id",t);else{var l=o[e];if(!c.isInArray(t,l))return m.call(k,l),void y(e+1);d[l]?y(e+1):C.call(k,{Bucket:r,Region:f,Key:h,UploadId:l},(function(t,r){k._isRunningTask(n)&&(t?(m.call(k,l),y(e+1)):A.emit("upload_id_ready",{UploadId:l,PartList:r.PartList}))}))}};y(0)}else A.emit("has_upload_id",t)})),A.on("get_remote_upload_id_list",(function(t){w.call(k,{Bucket:r,Region:f,Key:h},(function(t,data){if(k._isRunningTask(n)){if(t)return A.emit("error",t);var r=c.filter(data.UploadList,(function(e){return e.Key===h&&(!y||e.StorageClass.toUpperCase()===y.toUpperCase())})).reverse().map((function(e){return e.UploadId||e.UploadID}));if(r.length)A.emit("seek_local_avail_upload_id",r);else{var o,l=c.getFileUUID(e.Body,e.ChunkSize);l&&(o=v.call(k,l))&&c.each(o,(function(e){m.call(k,e)})),A.emit("no_available_upload_id")}}}))})),A.emit("get_remote_upload_id_list")}function w(e,t){var n=this,r=[],o={Bucket:e.Bucket,Region:e.Region,Prefix:e.Key},l=function(){n.multipartList(o,(function(e,data){if(e)return t(e);r.push.apply(r,data.Upload||[]),"true"===data.IsTruncated?(o.KeyMarker=data.NextKeyMarker,o.UploadIdMarker=data.NextUploadIdMarker,l()):t(null,{UploadList:r})}))};l()}function C(e,t){var n=this,r=[],o={Bucket:e.Bucket,Region:e.Region,Key:e.Key,UploadId:e.UploadId},l=function(){n.multipartListPart(o,(function(e,data){if(e)return t(e);r.push.apply(r,data.Part||[]),"true"===data.IsTruncated?(o.PartNumberMarker=data.NextPartNumberMarker,l()):t(null,{PartList:r})}))};l()}function k(e,t){var n=this,r=e.TaskId,l=e.Bucket,d=e.Region,f=e.Key,h=e.UploadData,m=e.FileSize,v=e.SliceSize,y=Math.min(e.AsyncLimit||n.options.ChunkParallelLimit||1,256),w=e.Body,C=Math.ceil(m/v),k=0,E=e.ServerSideEncryption,_=c.filter(h.PartList,(function(e){return e.Uploaded&&(k+=e.PartNumber>=C&&m%v||v),!e.Uploaded})),x=e.onProgress;o.eachLimit(_,y,(function(e,t){if(n._isRunningTask(r)){var o=e.PartNumber,y=Math.min(m,e.PartNumber*v)-(e.PartNumber-1)*v,C=0;S.call(n,{TaskId:r,Bucket:l,Region:d,Key:f,SliceSize:v,FileSize:m,PartNumber:o,ServerSideEncryption:E,Body:w,UploadData:h,onProgress:function(data){k+=data.loaded-C,C=data.loaded,x({loaded:k,total:m})}},(function(o,data){n._isRunningTask(r)&&(!c.isBrowser||o||data.ETag||(o='get ETag error, please add "ETag" to CORS ExposeHeader setting.'),o?k-=C:(k+=y-C,e.ETag=data.ETag),t(o||null,data))}))}}),(function(e){if(n._isRunningTask(r))return e?t(e):void t(null,{UploadId:h.UploadId,SliceList:h.PartList})}))}function S(e,t){var n=this,r=e.TaskId,l=e.Bucket,d=e.Region,f=e.Key,h=e.FileSize,m=e.Body,v=1*e.PartNumber,y=e.SliceSize,w=e.ServerSideEncryption,C=e.UploadData,k=n.options.ChunkRetryTimes+1,S=y*(v-1),E=y,_=S+y;_>h&&(E=(_=h)-S);var x=C.PartList[v-1];o.retry(k,(function(t){n._isRunningTask(r)&&c.fileSlice(m,S,_,!0,(function(o){n.multipartUpload({TaskId:r,Bucket:l,Region:d,Key:f,ContentLength:E,PartNumber:v,UploadId:C.UploadId,ServerSideEncryption:w,Body:o,onProgress:e.onProgress},(function(e,data){if(n._isRunningTask(r))return e?t(e):(x.Uploaded=!0,t(null,data))}))}))}),(function(e,data){if(n._isRunningTask(r))return t(e,data)}))}function E(e,t){var n=e.Bucket,r=e.Region,l=e.Key,c=e.UploadId,d=e.SliceList,f=this,h=this.options.ChunkRetryTimes+1,m=d.map((function(e){return{PartNumber:e.PartNumber,ETag:e.ETag}}));o.retry(h,(function(e){f.multipartComplete({Bucket:n,Region:r,Key:l,UploadId:c,Parts:m},e)}),(function(e,data){t(e,data)}))}function _(e,t){var n=e.Bucket,r=e.Region,l=e.Key,c=e.AbortArray,d=e.AsyncLimit||1,f=this,h=0,m=new Array(c.length);o.eachLimit(c,d,(function(t,o){var c=h;if(l&&l!==t.Key)return m[c]={error:{KeyNotMatch:!0}},void o(null);var d=t.UploadId||t.UploadID;f.multipartAbort({Bucket:n,Region:r,Key:t.Key,Headers:e.Headers,UploadId:d},(function(e,data){var l={Bucket:n,Region:r,Key:t.Key,UploadId:d};m[c]={error:e,task:l},o(null)})),h++}),(function(e){if(e)return t(e);for(var n=[],r=[],i=0,o=m.length;i<o;i++){var l=m[i];l.task&&(l.error?r.push(l.task):n.push(l.task))}return t(null,{successList:n,errorList:r})}))}function x(e,t){var n=e.TaskId,r=e.Bucket,l=e.Region,c=e.Key,d=e.CopySource,f=e.UploadId,h=1*e.PartNumber,m=e.CopySourceRange,v=this.options.ChunkRetryTimes+1,y=this;o.retry(v,(function(t){y.uploadPartCopy({TaskId:n,Bucket:r,Region:l,Key:c,CopySource:d,UploadId:f,PartNumber:h,CopySourceRange:m,onProgress:e.onProgress},(function(e,data){t(e||null,data)}))}),(function(e,data){return t(e,data)}))}var T={sliceUploadFile:function(e,t){var n,r,o=this,f=new l,v=e.TaskId,w=e.Bucket,C=e.Region,S=e.Key,_=e.Body,x=e.ChunkSize||e.SliceSize||o.options.ChunkSize,T=e.AsyncLimit,O=e.StorageClass||"Standard",L=e.ServerSideEncryption,A=e.onHashProgress;f.on("error",(function(e){if(o._isRunningTask(v))return t(e)})),f.on("upload_complete",(function(e){t(null,e)})),f.on("upload_slice_complete",(function(e){E.call(o,{Bucket:w,Region:C,Key:S,UploadId:e.UploadId,SliceList:e.SliceList},(function(t,data){if(o._isRunningTask(v)){if(delete d[e.UploadId],t)return r(null,!0),f.emit("error",t);r({loaded:n,total:n},!0),m.call(o,e.UploadId),f.emit("upload_complete",data)}}))})),f.on("get_upload_data_finish",(function(t){var l=c.getFileUUID(_,e.ChunkSize);l&&h.call(o,l,t.UploadId),d[t.UploadId]=!0,v&&o.on("inner-kill-task",(function(data){data.TaskId===v&&"canceled"===data.toState&&delete d[t.UploadId]})),k.call(o,{TaskId:v,Bucket:w,Region:C,Key:S,Body:_,FileSize:n,SliceSize:x,AsyncLimit:T,ServerSideEncryption:L,UploadData:t,onProgress:r},(function(e,data){if(o._isRunningTask(v))return e?(r(null,!0),f.emit("error",e)):void f.emit("upload_slice_complete",data)}))})),f.on("get_file_size_finish",(function(){if(r=c.throttleOnProgress.call(o,n,e.onProgress),e.UploadData.UploadId)f.emit("get_upload_data_finish",e.UploadData);else{var t=c.extend({TaskId:v,Bucket:w,Region:C,Key:S,Headers:e.Headers,StorageClass:O,Body:_,FileSize:n,SliceSize:x,onHashProgress:A},e);y.call(o,t,(function(t,n){if(o._isRunningTask(v)){if(t)return f.emit("error",t);e.UploadData.UploadId=n.UploadId,e.UploadData.PartList=n.PartList,f.emit("get_upload_data_finish",e.UploadData)}}))}})),n=e.ContentLength,delete e.ContentLength,!e.Headers&&(e.Headers={}),c.each(e.Headers,(function(t,n){"content-length"===n.toLowerCase()&&delete e.Headers[n]})),function(){for(var t=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],r=1048576,i=0;i<t.length&&!(n/(r=1024*t[i]*1024)<=o.options.MaxPartNumber);i++);e.ChunkSize=e.SliceSize=x=Math.max(x,r)}(),0===n?(e.Body="",e.ContentLength=0,e.SkipTask=!0,o.putObject(e,(function(e,data){if(e)return t(e);t(null,data)}))):f.emit("get_file_size_finish")},abortUploadTask:function(e,t){var n=e.Bucket,r=e.Region,o=e.Key,c=e.UploadId,d=e.Level||"task",f=e.AsyncLimit,h=this,m=new l;if(m.on("error",(function(e){return t(e)})),m.on("get_abort_array",(function(l){_.call(h,{Bucket:n,Region:r,Key:o,Headers:e.Headers,AsyncLimit:f,AbortArray:l},(function(e,data){if(e)return t(e);t(null,data)}))})),"bucket"===d)w.call(h,{Bucket:n,Region:r},(function(e,data){if(e)return t(e);m.emit("get_abort_array",data.UploadList||[])}));else if("file"===d){if(!o)return t({error:"abort_upload_task_no_key"});w.call(h,{Bucket:n,Region:r,Key:o},(function(e,data){if(e)return t(e);m.emit("get_abort_array",data.UploadList||[])}))}else{if("task"!==d)return t({error:"abort_unknown_level"});if(!c)return t({error:"abort_upload_task_no_id"});if(!o)return t({error:"abort_upload_task_no_key"});m.emit("get_abort_array",[{Key:o,UploadId:c}])}},uploadFiles:function(e,t){var n=void 0===e.SliceSize?this.options.SliceSize:e.SliceSize,r=0,o=0,l=c.throttleOnProgress.call(this,o,e.onProgress),d=e.files.length,f=e.onFileFinish,h=Array(d),m=function(e,data,n){l(null,!0),f&&f(e,data,n),h[n.Index]={options:n,error:e,data:data},--d<=0&&t&&t(null,{files:h})},v=[];c.each(e.files,(function(e,t){!function(){var d=e.Body,f=d.size||d.length||0,h={Index:t,TaskId:""};r+=f,c.each(e,(function(e,t){"object"!=typeof e&&"function"!=typeof e&&(h[t]=e)}));var y=e.onTaskReady;e.onTaskReady=function(e){h.TaskId=e,y&&y(e)};var w=0,C=e.onProgress;e.onProgress=function(e){o=o-w+e.loaded,w=e.loaded,C&&C(e),l({loaded:o,total:r})};var k=e.onFileFinish,S=f>=n?"sliceUploadFile":"putObject";v.push({api:S,params:e,callback:function(e,data){k&&k(e,data),m&&m(e,data,h)}})}()})),this._addTasks(v)},sliceCopyFile:function(e,t){var n=new l,r=this,d=e.Bucket,f=e.Region,h=e.Key,m=e.CopySource,v=m.match(/^([^.]+-\d+)\.cos(v6)?\.([^.]+)\.[^/]+\/(.+)$/);if(v){var y=v[1],w=v[3],C=decodeURIComponent(v[4]),k=void 0===e.SliceSize?r.options.CopySliceSize:e.SliceSize;k=Math.max(0,Math.min(k,5368709120));var S,E,_=e.ChunkSize||this.options.CopyChunkSize,T=this.options.CopyChunkParallelLimit,O=0;n.on("copy_slice_complete",(function(e){r.multipartComplete({Bucket:d,Region:f,Key:h,UploadId:e.UploadId,Parts:e.PartList},(function(e,data){if(e)return E(null,!0),t(e);E({loaded:S,total:S},!0),t(null,data)}))})),n.on("get_copy_data_finish",(function(e){o.eachLimit(e.PartList,T,(function(t,n){var o=t.PartNumber,l=t.CopySourceRange,c=t.end-t.start,v=0;x.call(r,{Bucket:d,Region:f,Key:h,CopySource:m,UploadId:e.UploadId,PartNumber:o,CopySourceRange:l,onProgress:function(data){O+=data.loaded-v,v=data.loaded,E({loaded:O,total:S})}},(function(e,data){if(e)return n(e);E({loaded:O,total:S}),O+=c-v,t.ETag=data.ETag,n(e||null,data)}))}),(function(r){if(r)return E(null,!0),t(r);n.emit("copy_slice_complete",e)}))})),n.on("get_file_size_finish",(function(o){var l;!function(){for(var t=[1,2,4,8,16,32,64,128,256,512,1024,2048,4096,5120],n=1048576,i=0;i<t.length&&!(S/(n=1024*t[i]*1024)<=r.options.MaxPartNumber);i++);e.ChunkSize=_=Math.max(_,n);for(var o=Math.ceil(S/_),l=[],c=1;c<=o;c++){var d=(c-1)*_,f=c*_<S?c*_-1:S-1,h={PartNumber:c,start:d,end:f,CopySourceRange:"bytes="+d+"-"+f};l.push(h)}e.PartList=l}(),(l="Replaced"===e.Headers["x-cos-metadata-directive"]?e.Headers:o)["x-cos-storage-class"]=e.Headers["x-cos-storage-class"]||o["x-cos-storage-class"],l=c.clearKey(l),r.multipartInit({Bucket:d,Region:f,Key:h,Headers:l},(function(r,data){if(r)return t(r);e.UploadId=data.UploadId,n.emit("get_copy_data_finish",e)}))})),r.headObject({Bucket:y,Region:w,Key:C},(function(o,data){if(o)o.statusCode&&404===o.statusCode?t({ErrorStatus:C+" Not Exist"}):t(o);else if(void 0!==(S=e.FileSize=data.headers["content-length"])&&S)if(E=c.throttleOnProgress.call(r,S,e.onProgress),S<=k)e.Headers["x-cos-metadata-directive"]||(e.Headers["x-cos-metadata-directive"]="Copy"),r.putObjectCopy(e,(function(e,data){if(e)return E(null,!0),t(e);E({loaded:S,total:S},!0),t(e,data)}));else{var l=data.headers,d={"Cache-Control":l["cache-control"],"Content-Disposition":l["content-disposition"],"Content-Encoding":l["content-encoding"],"Content-Type":l["content-type"],Expires:l.expires,"x-cos-storage-class":l["x-cos-storage-class"]};c.each(l,(function(e,t){0===t.indexOf("x-cos-meta-")&&t.length>"x-cos-meta-".length&&(d[t]=e)})),n.emit("get_file_size_finish",d)}else t({error:'get Content-Length error, please add "Content-Length" to CORS ExposeHeader setting.'})}))}else t({error:"CopySource format error"})}};e.exports.init=function(e,t){t.transferToTaskMethod(T,"sliceUploadFile"),c.each(T,(function(t,n){e.prototype[n]=c.apiWrapper(n,t)}))}},842:function(e,t){var n={eachLimit:function(e,t,n,r){if(r=r||function(){},!e.length||t<=0)return r();var o=0,l=0,c=0;!function d(){if(o>=e.length)return r();for(;c<t&&l<e.length;)c+=1,n(e[(l+=1)-1],(function(t){t?(r(t),r=function(){}):(c-=1,(o+=1)>=e.length?r():d())}))}()},retry:function(e,t,n){var r=function(o){t((function(t,data){t&&o<e?r(o+1):n(t,data)}))};e<1?n():r(1)}};e.exports=n},843:function(e,t,n){"use strict";var r,o="object"==typeof Reflect?Reflect:null,l=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var c=Number.isNaN||function(e){return e!=e};function d(){d.init.call(this)}e.exports=d,e.exports.once=function(e,t){return new Promise((function(n,r){function o(n){e.removeListener(t,l),r(n)}function l(){"function"==typeof e.removeListener&&e.removeListener("error",o),n([].slice.call(arguments))}E(e,t,l,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&E(e,"error",t,n)}(e,o,{once:!0})}))},d.EventEmitter=d,d.prototype._events=void 0,d.prototype._eventsCount=0,d.prototype._maxListeners=void 0;var f=10;function h(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function m(e){return void 0===e._maxListeners?d.defaultMaxListeners:e._maxListeners}function v(e,t,n,r){var o,l,c,d;if(h(n),void 0===(l=e._events)?(l=e._events=Object.create(null),e._eventsCount=0):(void 0!==l.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),l=e._events),c=l[t]),void 0===c)c=l[t]=n,++e._eventsCount;else if("function"==typeof c?c=l[t]=r?[n,c]:[c,n]:r?c.unshift(n):c.push(n),(o=m(e))>0&&c.length>o&&!c.warned){c.warned=!0;var f=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");f.name="MaxListenersExceededWarning",f.emitter=e,f.type=t,f.count=c.length,d=f,console&&console.warn&&console.warn(d)}return e}function y(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},o=y.bind(r);return o.listener=n,r.wrapFn=o,o}function C(e,t,n){var r=e._events;if(void 0===r)return[];var o=r[t];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(o):S(o,o.length)}function k(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function S(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function E(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(l){r.once&&e.removeEventListener(t,o),n(l)}))}}Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e||e<0||c(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),d.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||c(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},d.prototype.getMaxListeners=function(){return m(this)},d.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var c=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw c.context=o,c}var d=r[e];if(void 0===d)return!1;if("function"==typeof d)l(d,this,t);else{var f=d.length,h=S(d,f);for(i=0;i<f;++i)l(h[i],this,t)}return!0},d.prototype.addListener=function(e,t){return v(this,e,t,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(e,t){return v(this,e,t,!0)},d.prototype.once=function(e,t){return h(t),this.on(e,w(this,e,t)),this},d.prototype.prependOnceListener=function(e,t){return h(t),this.prependListener(e,w(this,e,t)),this},d.prototype.removeListener=function(e,t){var n,r,o,i,l;if(h(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){l=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,l||t)}return this},d.prototype.off=d.prototype.removeListener,d.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},d.prototype.listeners=function(e){return C(this,e,!0)},d.prototype.rawListeners=function(e){return C(this,e,!1)},d.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):k.call(e,t)},d.prototype.listenerCount=k,d.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},844:function(e){e.exports=JSON.parse('{"name":"vod-js-sdk-v6","version":"1.4.10","description":"tencent cloud vod js sdk v6","main":"lib/src/tc_vod.js","unpkg":"dist/vod-js-sdk-v6.js","typings":"lib/src/tc_vod.d.ts","scripts":{"test":"cross-env NODE_ENV=test mocha -r espower-typescript/guess -r jsdom-global/register -r test/env test/**/*.test.ts","cover":"cross-env NODE_ENV=test nyc mocha -r espower-typescript/guess -r jsdom-global/register -r test/env test/**/*.test.ts","dev":"webpack --config webpack.dev.config.js --watch","dist":"webpack --config webpack.config.js","build":"npm run test && npm run dist && npm run compile","compile":"tsc -p tsconfig.json","prepublish":"npm run build","lint":"tsc --noEmit && eslint \'src/**/*.{js,ts,tsx}\' --quiet --fix"},"repository":{"type":"git","url":"git+https://github.com/tencentyun/vod-js-sdk-v6.git"},"keywords":["tencentcloud","sdk","vod"],"author":"alsotang <alsotang@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/tencentyun/vod-js-sdk-v6/issues"},"homepage":"https://github.com/tencentyun/vod-js-sdk-v6#readme","dependencies":{"axios":"^0.18.0","cos-js-sdk-v5":"0.5.16","js-sha1":"^0.6.0","uuid":"^3.3.2"},"devDependencies":{"@types/mocha":"^5.2.5","@types/semver":"^6.0.0","@types/sha1":"^1.1.1","@types/uuid":"^3.4.4","@typescript-eslint/eslint-plugin":"^1.9.0","@typescript-eslint/parser":"^1.9.0","cross-env":"^6.0.3","eslint":"^5.16.0","eslint-config-prettier":"^4.3.0","eslint-plugin-prettier":"^3.1.0","espower-typescript":"^9.0.1","jsdom":"^13.1.0","jsdom-global":"^3.0.2","mm":"^2.4.1","mocha":"^5.2.0","nyc":"^13.1.0","power-assert":"^1.6.1","prettier":"^1.17.1","semver":"^6.1.1","ts-loader":"^5.3.3","typescript":"^3.5.3","webpack":"^4.28.1","webpack-cli":"^3.2.1"},"nyc":{"extension":[".ts",".tsx"],"include":["src"],"reporter":["html"],"all":true}}')},845:function(e,t,n){var r=n(846),o=n(847);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var l=(e=e||{}).random||(e.rng||r)();if(l[6]=15&l[6]|64,l[8]=63&l[8]|128,t)for(var c=0;c<16;++c)t[i+c]=l[c];return t||o(l)}},846:function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,i=0;i<16;i++)0==(3&i)&&(e=4294967296*Math.random()),o[i]=e>>>((3&i)<<3)&255;return o}}},847:function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},884:function(e,t,n){"use strict";(function(e){function n(){return(n=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var t in source)Object.prototype.hasOwnProperty.call(source,t)&&(e[t]=source[t])}return e}).apply(this,arguments)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,p){return(o=Object.setPrototypeOf||function(e,p){return e.__proto__=p,e})(e,p)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function c(e,t,n){return(c=l()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var r=new(Function.bind.apply(e,a));return n&&o(r,n.prototype),r}).apply(null,arguments)}function d(e){var t="function"==typeof Map?new Map:void 0;return(d=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,l)}function l(){return c(e,arguments,r(this).constructor)}return l.prototype=Object.create(e.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),o(l,e)})(e)}var f=/%[sdj%]/g,h=function(){};function m(e){if(!e||!e.length)return null;var t={};return e.forEach((function(e){var n=e.field;t[n]=t[n]||[],t[n].push(e)})),t}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=1,r=t[0],o=t.length;if("function"==typeof r)return r.apply(null,t.slice(1));if("string"==typeof r){var l=String(r).replace(f,(function(e){if("%%"===e)return"%";if(i>=o)return e;switch(e){case"%s":return String(t[i++]);case"%d":return Number(t[i++]);case"%j":try{return JSON.stringify(t[i++])}catch(e){return"[Circular]"}break;default:return e}}));return l}return r}function y(e,t){return null==e||(!("array"!==t||!Array.isArray(e)||e.length)||!(!function(e){return"string"===e||"url"===e||"hex"===e||"email"===e||"date"===e||"pattern"===e}(t)||"string"!=typeof e||e))}function w(e,t,n){var r=0,o=e.length;!function l(c){if(c&&c.length)n(c);else{var d=r;r+=1,d<o?t(e[d],l):n([])}}([])}void 0!==e&&e.env;var C=function(e){var t,n;function r(t,n){var r;return(r=e.call(this,"Async Validation Error")||this).errors=t,r.fields=n,r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n,r}(d(Error));function k(e,option,t,n){if(option.first){var r=new Promise((function(r,o){w(function(e){var t=[];return Object.keys(e).forEach((function(n){t.push.apply(t,e[n])})),t}(e),t,(function(e){return n(e),e.length?o(new C(e,m(e))):r()}))}));return r.catch((function(e){return e})),r}var o=option.firstFields||[];!0===o&&(o=Object.keys(e));var l=Object.keys(e),c=l.length,d=0,f=[],h=new Promise((function(r,h){var v=function(e){if(f.push.apply(f,e),++d===c)return n(f),f.length?h(new C(f,m(f))):r()};l.length||(n(f),r()),l.forEach((function(n){var r=e[n];-1!==o.indexOf(n)?w(r,t,v):function(e,t,n){var r=[],o=0,l=e.length;function c(e){r.push.apply(r,e),++o===l&&n(r)}e.forEach((function(a){t(a,c)}))}(r,t,v)}))}));return h.catch((function(e){return e})),h}function S(e){return function(t){return t&&t.message?(t.field=t.field||e.fullField,t):{message:"function"==typeof t?t():t,field:t.field||e.fullField}}}function E(e,source){if(source)for(var s in source)if(source.hasOwnProperty(s)){var t=source[s];"object"==typeof t&&"object"==typeof e[s]?e[s]=n(n({},e[s]),t):e[s]=t}return e}function _(e,t,source,n,r,o){!e.required||source.hasOwnProperty(e.field)&&!y(t,o||e.type)||n.push(v(r.messages.required,e.fullField))}var pattern={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,url:new RegExp("^(?!mailto:)(?:(?:http|https|ftp)://|//)(?:\\S+(?::\\S*)?@)?(?:(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[0-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]+-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))|localhost)(?::\\d{2,5})?(?:(/|\\?|#)[^\\s]*)?$","i"),hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},x={integer:function(e){return x.number(e)&&parseInt(e,10)===e},float:function(e){return x.number(e)&&!x.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return!!new RegExp(e)}catch(e){return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!x.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&!!e.match(pattern.email)&&e.length<255},url:function(e){return"string"==typeof e&&!!e.match(pattern.url)},hex:function(e){return"string"==typeof e&&!!e.match(pattern.hex)}};var T={required:_,whitespace:function(e,t,source,n,r){(/^\s+$/.test(t)||""===t)&&n.push(v(r.messages.whitespace,e.fullField))},type:function(e,t,source,n,r){if(e.required&&void 0===t)_(e,t,source,n,r);else{var o=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(o)>-1?x[o](t)||n.push(v(r.messages.types[o],e.fullField,e.type)):o&&typeof t!==e.type&&n.push(v(r.messages.types[o],e.fullField,e.type))}},range:function(e,t,source,n,r){var o="number"==typeof e.len,l="number"==typeof e.min,c="number"==typeof e.max,d=t,f=null,h="number"==typeof t,m="string"==typeof t,y=Array.isArray(t);if(h?f="number":m?f="string":y&&(f="array"),!f)return!1;y&&(d=t.length),m&&(d=t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),o?d!==e.len&&n.push(v(r.messages[f].len,e.fullField,e.len)):l&&!c&&d<e.min?n.push(v(r.messages[f].min,e.fullField,e.min)):c&&!l&&d>e.max?n.push(v(r.messages[f].max,e.fullField,e.max)):l&&c&&(d<e.min||d>e.max)&&n.push(v(r.messages[f].range,e.fullField,e.min,e.max))},enum:function(e,t,source,n,r){e.enum=Array.isArray(e.enum)?e.enum:[],-1===e.enum.indexOf(t)&&n.push(v(r.messages.enum,e.fullField,e.enum.join(", ")))},pattern:function(e,t,source,n,r){if(e.pattern)if(e.pattern instanceof RegExp)e.pattern.lastIndex=0,e.pattern.test(t)||n.push(v(r.messages.pattern.mismatch,e.fullField,t,e.pattern));else if("string"==typeof e.pattern){new RegExp(e.pattern).test(t)||n.push(v(r.messages.pattern.mismatch,e.fullField,t,e.pattern))}}};function O(e,t,n,source,r){var o=e.type,l=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t,o)&&!e.required)return n();T.required(e,t,source,l,r,o),y(t,o)||T.type(e,t,source,l,r)}n(l)}var L={string:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t,"string")&&!e.required)return n();T.required(e,t,source,o,r,"string"),y(t,"string")||(T.type(e,t,source,o,r),T.range(e,t,source,o,r),T.pattern(e,t,source,o,r),!0===e.whitespace&&T.whitespace(e,t,source,o,r))}n(o)},method:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&T.type(e,t,source,o,r)}n(o)},number:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(""===t&&(t=void 0),y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&(T.type(e,t,source,o,r),T.range(e,t,source,o,r))}n(o)},boolean:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&T.type(e,t,source,o,r)}n(o)},regexp:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),y(t)||T.type(e,t,source,o,r)}n(o)},integer:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&(T.type(e,t,source,o,r),T.range(e,t,source,o,r))}n(o)},float:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&(T.type(e,t,source,o,r),T.range(e,t,source,o,r))}n(o)},array:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(null==t&&!e.required)return n();T.required(e,t,source,o,r,"array"),null!=t&&(T.type(e,t,source,o,r),T.range(e,t,source,o,r))}n(o)},object:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&T.type(e,t,source,o,r)}n(o)},enum:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r),void 0!==t&&T.enum(e,t,source,o,r)}n(o)},pattern:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t,"string")&&!e.required)return n();T.required(e,t,source,o,r),y(t,"string")||T.pattern(e,t,source,o,r)}n(o)},date:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t,"date")&&!e.required)return n();var l;if(T.required(e,t,source,o,r),!y(t,"date"))l=t instanceof Date?t:new Date(t),T.type(e,l,source,o,r),l&&T.range(e,l.getTime(),source,o,r)}n(o)},url:O,hex:O,email:O,required:function(e,t,n,source,r){var o=[],l=Array.isArray(t)?"array":typeof t;T.required(e,t,source,o,r,l),n(o)},any:function(e,t,n,source,r){var o=[];if(e.required||!e.required&&source.hasOwnProperty(e.field)){if(y(t)&&!e.required)return n();T.required(e,t,source,o,r)}n(o)}};function A(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var j=A();function M(e){this.rules=null,this._messages=j,this.define(e)}M.prototype={messages:function(e){return e&&(this._messages=E(A(),e)),this._messages},define:function(e){if(!e)throw new Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw new Error("Rules must be an object");var t,n;for(t in this.rules={},e)e.hasOwnProperty(t)&&(n=e[t],this.rules[t]=Array.isArray(n)?n:[n])},validate:function(e,t,r){var o=this;void 0===t&&(t={}),void 0===r&&(r=function(){});var l,c,source=e,d=t,f=r;if("function"==typeof d&&(f=d,d={}),!this.rules||0===Object.keys(this.rules).length)return f&&f(),Promise.resolve();if(d.messages){var h=this.messages();h===j&&(h=A()),E(h,d.messages),d.messages=h}else d.messages=this.messages();var y={};(d.keys||Object.keys(this.rules)).forEach((function(t){l=o.rules[t],c=source[t],l.forEach((function(r){var l=r;"function"==typeof l.transform&&(source===e&&(source=n({},source)),c=source[t]=l.transform(c)),(l="function"==typeof l?{validator:l}:n({},l)).validator=o.getValidationMethod(l),l.field=t,l.fullField=l.fullField||t,l.type=o.getType(l),l.validator&&(y[t]=y[t]||[],y[t].push({rule:l,value:c,source:source,field:t}))}))}));var w={};return k(y,d,(function(data,e){var t,r=data.rule,o=!("object"!==r.type&&"array"!==r.type||"object"!=typeof r.fields&&"object"!=typeof r.defaultField);function l(e,t){return n(n({},t),{},{fullField:r.fullField+"."+e})}function c(t){void 0===t&&(t=[]);var c=t;if(Array.isArray(c)||(c=[c]),!d.suppressWarning&&c.length&&M.warning("async-validator:",c),c.length&&void 0!==r.message&&(c=[].concat(r.message)),c=c.map(S(r)),d.first&&c.length)return w[r.field]=1,e(c);if(o){if(r.required&&!data.value)return void 0!==r.message?c=[].concat(r.message).map(S(r)):d.error&&(c=[d.error(r,v(d.messages.required,r.field))]),e(c);var f={};if(r.defaultField)for(var h in data.value)data.value.hasOwnProperty(h)&&(f[h]=r.defaultField);for(var m in f=n(n({},f),data.rule.fields))if(f.hasOwnProperty(m)){var y=Array.isArray(f[m])?f[m]:[f[m]];f[m]=y.map(l.bind(null,m))}var C=new M(f);C.messages(d.messages),data.rule.options&&(data.rule.options.messages=d.messages,data.rule.options.error=d.error),C.validate(data.value,data.rule.options||d,(function(t){var n=[];c&&c.length&&n.push.apply(n,c),t&&t.length&&n.push.apply(n,t),e(n.length?n:null)}))}else e(c)}o=o&&(r.required||!r.required&&data.value),r.field=data.field,r.asyncValidator?t=r.asyncValidator(r,data.value,c,data.source,d):r.validator&&(!0===(t=r.validator(r,data.value,c,data.source,d))?c():!1===t?c(r.message||r.field+" fails"):t instanceof Array?c(t):t instanceof Error&&c(t.message)),t&&t.then&&t.then((function(){return c()}),(function(e){return c(e)}))}),(function(e){!function(e){var i,t,n,r=[],o={};for(i=0;i<e.length;i++)t=e[i],n=void 0,Array.isArray(t)?r=(n=r).concat.apply(n,t):r.push(t);r.length?o=m(r):(r=null,o=null),f(r,o)}(e)}))},getType:function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!L.hasOwnProperty(e.type))throw new Error(v("Unknown rule type %s",e.type));return e.type||"string"},getValidationMethod:function(e){if("function"==typeof e.validator)return e.validator;var t=Object.keys(e),n=t.indexOf("message");return-1!==n&&t.splice(n,1),1===t.length&&"required"===t[0]?L.required:L[this.getType(e)]||!1}},M.register=function(e,t){if("function"!=typeof t)throw new Error("Cannot register a validator by type, validator is not a function");L[e]=t},M.warning=h,M.messages=j,M.validators=L,t.a=M}).call(this,n(161))},904:function(e,t,n){"use strict";n(52),n(878);t.a=function(e){var t=e,n=0,r=[];return t=t.replace(/<a href="([^"\s]+)"(\stitle="(\S*)")?>([^<>]+)<\/a>/g,(function(){return n++,r.push({type:"a",mark:"{{a".concat(n,"}}"),link:arguments.length<=1?void 0:arguments[1],title:(arguments.length<=3?void 0:arguments[3])||"链接",con:arguments.length<=4?void 0:arguments[4]}),"{{a".concat(n,"}}")})).replace(/<img[^<>]+src="[^"\s<>]*"[^<>]+>/g,(function(){return n++,r.push({type:"img",mark:"{{img".concat(n,"}}"),con:arguments.length<=0?void 0:arguments[0]}),"{{img".concat(n,"}}")})).replace(/https?:\/\/(?:[\w-]+\.)+[a-z0-9]+((?:\/[\w-]*)+(\.[\w-]*)?)?(\?[^#\s{}]+)?(#\S+)?/gi,(function(){return n++,r.push({type:"a",mark:"{{a".concat(n,"}}"),link:arguments.length<=0?void 0:arguments[0],title:"链接",con:arguments.length<=0?void 0:arguments[0]}),"{{a".concat(n,"}}")})),r.forEach((function(e){t=t.replace(e.mark,(function(){return"img"===e.type?e.con:/^(https?)/.test(e.link)?'\n          <a href="'.concat(e.link,'" target="_blank" title="').concat(e.title,'" rel="noopener noreferrer">\n            ').concat(e.con,"\n          </a>\n        "):'\n          <a href="https://'.concat(e.link,'" target="_blank" title="').concat(e.title,'" rel="noopener noreferrer">\n            ').concat(e.con,"\n          </a>\n        ")}))})),t}},962:function(e,t,n){"use strict";var r=n(262),o=n.n(r),l={props:{images:{type:Array},rebuild:{type:Boolean,default:!1},trigger:{},options:{type:Object}},data:function(){return{}},computed:{},methods:{onChange:function(){this.rebuild?this.rebuildViewer():this.updateViewer()},rebuildViewer:function(){this.destroyViewer(),this.createViewer()},updateViewer:function(){this.$viewer?(this.$viewer.update(),this.$emit("inited",this.$viewer)):this.createViewer()},destroyViewer:function(){this.$viewer&&this.$viewer.destroy()},createViewer:function(){this.$viewer=new o.a(this.$el,this.options),this.$emit("inited",this.$viewer)}},watch:{images:function(){var e=this;this.$nextTick((function(){e.onChange()}))},trigger:{handler:function(){var e=this;this.$nextTick((function(){e.onChange()}))},deep:!0},options:{handler:function(){var e=this;this.$nextTick((function(){e.rebuildViewer()}))},deep:!0}},mounted:function(){this.createViewer()},destroyed:function(){this.destroyViewer()}},c=n(11),component=Object(c.a)(l,(function(){var e=this.$createElement;return(this._self._c||e)("div",[this._t("default",null,{images:this.images,options:this.options})],2)}),[],!1,null,null,null);t.a=component.exports}}]);