(window.webpackJsonp=window.webpackJsonp||[]).push([[39,4,5],{518:function(t,e,n){n(32);var o=n(501);n(51),t.exports={data:function(){var t=this;return{errorCodeHandler:{default:{model_not_found:function(){return t.$router.replace("/error")},not_authenticated:function(){return t.$router.push("/user/login")}},thread:{permission_denied:function(){return t.$router.replace("/error")}}}}},methods:{handleError:function(t){var e=arguments,n=this;return o(regeneratorRuntime.mark((function o(){var r,c,l,d,h;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(r=e.length>1&&void 0!==e[1]?e[1]:"",c=t.response.data.errors,!(Array.isArray(c)&&c.length>0)){o.next=13;break}if(l=c[0].code,d=c[0].detail&&c[0].detail.length>0?c[0].detail[0]:c[0].code,h=c[0].detail&&c[0].detail.length>0?c[0].detail[0]:n.$t("core.".concat(d)),"site_closed"!==c[0].code){o.next=10;break}return o.next=9,n.siteClose(c);case 9:return o.abrupt("return",o.sent);case 10:n.$message.error(h),n.errorCodeHandler.default[l]&&n.errorCodeHandler.default[l](),r&&n.errorCodeHandler[r][l]&&n.errorCodeHandler[r][l]();case 13:case"end":return o.stop()}}),o)})))()},siteClose:function(t){var e=this;return o(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("forum/setError",{code:t[0].code,detail:t[0].detail&&t[0].detail.length>0&&t[0].detail[0]});case 3:return n.next=5,e.$router.push("/site/close");case 5:n.next=9;break;case 7:n.prev=7,n.t0=n.catch(0);case 9:case"end":return n.stop()}}),n,null,[[0,7]])})))()}}}},520:function(t,e,n){},521:function(t,e,n){},522:function(t,e,n){},523:function(t,e,n){"use strict";n.r(e);var o={name:"Cover",mounted:function(){var t=document.createElement("div");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="100%",t.style.height="100%",t.style.background="rgba(0, 0, 0, .4)",t.style.zIndex="10",t.id="cover",document.querySelector("body").appendChild(t)},destroyed:function(){var t=document.querySelector("#cover");t.parentNode.removeChild(t)},render:function(){return""}},r=n(13),component=Object(r.a)(o,void 0,void 0,!1,null,null,null);e.default=component.exports},524:function(t,e,n){},525:function(t,e,n){},526:function(t,e,n){},527:function(t,e,n){},531:function(t,e,n){"use strict";n.r(e);var o={name:"MessageBox",props:{width:{type:String,default:"820px"},title:{type:String,default:""},overflow:{type:String,default:"auto"}}},r=(n(590),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Cover"),t._v(" "),n("div",{staticClass:"message-box",style:{overflow:t.overflow,width:t.width}},[n("div",{staticClass:"container-title"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),t._t("default")],2)],1)}),[],!1,null,"7539ed90",null);e.default=component.exports;installComponents(component,{Cover:n(523).default,SvgIcon:n(67).default})},532:function(t,e){e.extensionList=["7Z","AI","APK","CAD","CDR","DOC","DOCX","EPS","EXE","IPA","MP3","MP4","PDF","PPT","PSD","RAR","TXT","XLS","XLSX","ZIP","JPG","WAV"]},533:function(t,e,n){"use strict";n.r(e);var o=n(587),r={name:"VideoPop",props:{url:{type:String,default:""},coverUrl:{type:String,default:""}},data:function(){return{options:{autoplay:!0,controls:!0},player:null}},mounted:function(){document.addEventListener("click",this.removeVideoPop),this.initVideoJs()},methods:{initVideoJs:function(){var t=this;this.player=Object(o.a)("videoPlayer",this.options,(function(){var e=this;o.a.log("Your player is ready!"),this.play(),this.on("error",(function(){e.errorDisplay.close(),e.createModal(t.$t("core.videoError"))}))}))},removeVideoPop:function(t){var e=!0;(t.path||t.composedPath&&t.composedPath()).forEach((function(t){"video-pop"===t.id&&(e=!1),t.classList&&t.classList.contains("svg-icon-video-play")&&(e=!1)})),e&&(this.$emit("remove"),this.player.dispose(),document.removeEventListener("click",this.removeVideoPop))}}},c=(n(535),n(13)),component=Object(c.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"video-pop",attrs:{id:"video-pop"}},[e("Cover"),this._v(" "),e("video",{staticClass:"video-js",attrs:{id:"videoPlayer",controls:"",width:"800px",height:"600px",preload:"auto","data-setup":"{}"}},[e("source",{attrs:{src:this.url}}),this._v(" "),e("source",{attrs:{src:this.url,type:"video/webm"}})])],1)}),[],!1,null,"5d02c715",null);e.default=component.exports;installComponents(component,{Cover:n(523).default})},534:function(t,e,n){"use strict";n(39);var o=n(22),r=(n(37),n(29),n(19),n(11),n(36),n(502),n(170),n(51),n(503)),c=(n(505),n(172),n(504));function l(t,e){l=function(t,e){return new f(t,void 0,e)};var n=Object(c.a)(RegExp),d=RegExp.prototype,h=new WeakMap;function f(t,e,o){var r=n.call(this,t,e);return h.set(r,o||h.get(t)),r}function m(t,e){var g=h.get(e);return Object.keys(g).reduce((function(e,n){return e[n]=t[g[n]],e}),Object.create(null))}return Object(r.a)(f,n),f.prototype.exec=function(t){var e=d.exec.call(this,t);return e&&(e.groups=m(e,this)),e},f.prototype[Symbol.replace]=function(t,e){if("string"==typeof e){var n=h.get(this);return d[Symbol.replace].call(this,t,e.replace(/\$<([^>]+)>/g,(function(t,e){return"$"+n[e]})))}if("function"==typeof e){var r=this;return d[Symbol.replace].call(this,t,(function(){var t=[];return t.push.apply(t,arguments),"object"!==Object(o.a)(t[t.length-1])&&t.push(m(t,r)),e.apply(this,t)}))}return d[Symbol.replace].call(this,t,e)},l.apply(this,arguments)}var d={topic:function(text){if(text){var t=l(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="topic"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/topic/".concat(t);return'<a href="'.concat(e,'" class="content-topic a-blue">').concat(text,"</a> ")}))}))}},usermention:function(text){if(text){var t=l(/<[s\u017F]pan[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*id="member"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*value="([0-9A-Z_a-z\u017F\u212A]+)"[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*>((?:(?!<)[\s\S])+)<\/[s\u017F]pan>/gim,{value:1,string:2});return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){var e="/user/".concat(t);return'<a href="'.concat(e,'" class="content-member a-blue">').concat(text,"</a> ")}))}))}},parseHtml1:function(text){if(text){var t=/&lt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return"<"}))}))}},parseHtml2:function(text){if(text){var t=/&gt;/gim;return text.replace(t,(function(e){return e.replace(t,(function(content,t,text){return">"}))}))}}};e.a={parse:function(text){for(var t in d)text=d[t](text);return text}}},535:function(t,e,n){"use strict";var o=n(520);n.n(o).a},536:function(t,e,n){t.exports={data:function(){return{diffModulus:[[1e3,60,this.$t("discuzq.date.sec")],[6e4,60,this.$t("discuzq.date.min")],[36e5,24,this.$t("discuzq.date.hour")],[864e5,30,this.$t("discuzq.date.day")],[2592e6,12,this.$t("discuzq.date.mon")],[31104e6,1e6,this.$t("discuzq.date.year")]]}},methods:{timerDiff:function(t,e){t instanceof Date||(t=new Date(t)),e instanceof Date||(e=window.currentTime||new Date),e||(e=window.currentTime||new Date);for(var n,o=e-t,i=0;i<this.diffModulus.length;i++){var r=this.diffModulus[i];if(o/r[0]<r[1]){n=Math.ceil(o/r[0])+" "+r[2];break}}return n||""}}}},537:function(t,e,n){},540:function(t,e,n){"use strict";var o=n(521);n.n(o).a},541:function(t,e,n){"use strict";var o=n(522);n.n(o).a},542:function(t,e,n){},543:function(t,e,n){},544:function(t,e,n){},545:function(t,e,n){},546:function(t,e,n){},547:function(t,e,n){},548:function(t,e,n){},549:function(t,e,n){},550:function(t,e,n){},551:function(t,e,n){},552:function(t,e,n){},553:function(t,e,n){},554:function(t,e,n){},555:function(t,e,n){},556:function(t,e,n){},557:function(t,e,n){},558:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"ListLoadMore",mixins:[{data:function(){return{scrollTop:0}},mounted:function(){this.addEventListener(window,"scroll",this.handleScroll)},destroyed:function(){this.removeEventListener(window,"scroll",this.handleScroll)},methods:{handleScroll:function(){var t=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.clientHeight||document.body.clientHeight,n=document.documentElement.scrollHeight||document.body.scrollHeight;Math.ceil(t+e+10)>=n&&this.scrollLoadMore(),this.scrollTop=t},addEventListener:function(t,e,n,o){t.addEventListener?t.addEventListener(e,n,o):t.attachEvent&&t.attachEvent("on"+e,n)},removeEventListener:function(t,e,n,o){t.removeEventListener?t.removeEventListener(e,n,o):t.detachEvent&&t.detachEvent("on"+e,n)}}}],props:{loading:{type:Boolean,default:!1},hasMore:{type:Boolean,default:!1},pageNum:{type:[Number,String],default:1},length:{type:[Number,String],default:0},surplus:{type:[Number,String],default:0},loadMoreText:{type:String,default:function(){return this.$t("topic.showMore")}}},methods:{scrollLoadMore:function(){(this.pageNum-1)%5>0&&!this.loading&&this.hasMore&&this.loadMore()},loadMore:function(){this.$emit("loadMore")}}},r=n(13),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"load-more-container"},[t.loading?n("loading"):[t.hasMore&&(t.pageNum-1)%5==0?n("div",{staticClass:"load-more",on:{click:t.loadMore}},[t._v("\n      "+t._s(t.surplus>0?t.$t("notice.checkMore",{surplus:t.surplus}):t.loadMoreText)+"\n    ")]):t.hasMore&&(t.pageNum-1)%5>0?n("loading"):n("div",{staticClass:"no-more"},[0===t.length?n("svg-icon",{staticClass:"empty-icon",attrs:{type:"empty"}}):t._e(),t._v("\n      "+t._s(t.length>0?t.$t("discuzq.list.noMoreData"):t.$t("discuzq.list.noData"))+"\n    ")],1)]],2)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Loading:n(628).default,SvgIcon:n(67).default})},559:function(t,e,n){"use strict";n.r(e);var o={name:"ProductItem",props:{item:{type:Object,default:function(){}}},data:function(){return{}}},r=(n(540),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.item?n("a",{staticClass:"product-container",attrs:{href:t.item.detail_content,target:"_blank",el:"nofollow"}},[n("el-image",{staticClass:"image",attrs:{src:t.item.image_path,alt:t.item.title,fit:"cover",lazy:""}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])]),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"info-header"},[n("div",{staticClass:"title"},[t._v(t._s(t.item.title))]),t._v(" "),t.item.price>0?n("div",{staticClass:"price"},[t._v(t._s(t.$t("post.yuanItem")+t.item.price+t.$t("post.yuan")))]):t._e()]),t._v(" "),n("div",{staticClass:"btn"},[n("svg-icon",{staticClass:"icon",attrs:{type:"product-icon"}}),t._v(t._s(t.$t("post.buyProudct")))],1)])],1):t._e()}),[],!1,null,"4589e254",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},560:function(t,e,n){"use strict";n.r(e);n(30),n(11);var o={name:"AudioPlayer",props:{file:{type:Object,default:function(){}},currentAudio:{type:Object,default:function(){}}},data:function(){return{onDragging:!1,delta:0}},computed:{currentFile:function(){return this.currentAudio.id===this.file._jv.id},playing:function(){return this.currentAudio.currentTime&&this.currentAudio.duration}},methods:{formatDuration:function(t){var e=Math.floor(t/60),n=(t-60*e).toString().substr(0,2);return"."===n[1]&&(n="0"+n[0]),e+":"+n},formatCurrentTime:function(t){var e=parseInt(t/60)%60,n=(t%60).toFixed();return(e<10?"0"+e:e)+":"+(n<10?"0"+n:n)},convertToPercentage:function(){return this.currentAudio.currentTime/this.currentAudio.duration*100},onmousedown:function(){window.document.addEventListener("mousemove",this.dragging),window.document.addEventListener("mouseup",this.onMouseUp)},dragging:function(t){this.delta=t.clientX-this.$refs.progress.getBoundingClientRect().x,this.delta<0&&(this.delta=0),this.delta>290&&(this.delta=290);var time=this.delta/290*this.currentAudio.duration;this.$emit("seeking",time)},onMouseUp:function(){var time=this.delta/290*this.currentAudio.duration;this.$emit("seek",time),window.document.removeEventListener("mousemove",this.dragging),window.document.removeEventListener("mouseup",this.onMouseUp)}}},r=(n(541),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"audio"},[t.currentFile&&t.currentAudio.isLoading?n("div",{staticClass:"control"},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"loading",rotate:""}})],1):t.currentFile&&t.currentAudio.isPlay?n("div",{staticClass:"control",on:{click:function(e){return t.$emit("pause")}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-pause"}})],1):n("div",{staticClass:"control",on:{click:function(e){return t.$emit("play",t.file)}}},[n("svg-icon",{staticStyle:{"font-size":"32px"},attrs:{type:"audio-play"}})],1),t._v(" "),n("div",{staticClass:"info"},[n("div",{staticClass:"title"},[n("span",{staticClass:"title-audio"},[t._v(t._s(t.file.fileName||t.file.file_name))]),t._v(" "),t.currentFile&&t.playing?n("span",{staticClass:"duration-audio"},[t._v("\n        "+t._s(t.formatCurrentTime(t.currentAudio.currentTime))+" / "+t._s(t.formatDuration(t.currentAudio.duration))+"\n      ")]):n("span",{staticClass:"duration-audio"},[t._v("--:--")])]),t._v(" "),t.currentFile&&t.playing?n("div",{ref:"progress",staticClass:"progress",attrs:{id:"progress"}},[n("div",{staticClass:"progress-item",style:{width:t.convertToPercentage()+"%"}}),t._v(" "),n("div",{staticClass:"control-ball",style:{left:t.convertToPercentage()+"%"},attrs:{id:"control-ball"},on:{mousedown:t.onmousedown}})]):t._e()])])}),[],!1,null,"5944d781",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},563:function(t,e,n){"use strict";n.r(e);n(251);var o=n(561),r={name:"SharePopover",props:{threadsId:{type:[String,Number],default:""},type:{type:String,default:""}},data:function(){return{qrcode:null,currentType:""}},methods:{copyLink:function(){var t=document.createElement("input");"topic"===this.type?t.value=window.location.href:t.value="".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)},onShowPopover:function(){this.currentType=this.type;var path=window.location.href;path="topic"===this.type?window.location.href:"".concat(window.location.protocol,"//").concat(window.location.host,"/thread/").concat(this.threadsId),this.createQrcode(path)},createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new o(t.$refs.qrcode,{width:88,height:88,text:link})}))},closeCode:function(){this.$refs.qrcode.innerHTML=""}}},c=(n(566),n(567),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"share-container"},[n("el-popover",{attrs:{placement:"bottom",width:"120","min-width":"120",trigger:"click","popper-class":"custom-popover-width"},on:{show:t.onShowPopover,hide:t.closeCode}},[n("div",{staticClass:"share-cont"},[n("div",{staticClass:"copy",on:{click:t.copyLink}},[n("svg-icon",{staticClass:"copy-icon",attrs:{type:"copy-link"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.copyLink")))])],1),t._v(" "),n("div",{staticClass:"qrcode"},[n("div",{staticClass:"qrcode-text"},[n("svg-icon",{staticClass:"wechat-logo",attrs:{type:"wechat-logo"}}),t._v(" "),n("span",[t._v(t._s(t.$t("core.wxShare")))])],1),t._v(" "),n("div",{ref:"qrcode",staticClass:"qrcode-cont"})])]),t._v(" "),n("template",{slot:"reference"},[t._t("default")],2)],2)],1)}),[],!1,null,"034fa0b9",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},564:function(t,e,n){"use strict";n.r(e);var o=n(561),r={name:"Advertising",data:function(){return{qrcode:null,site_name:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{forums:{handler:function(t){t&&t.set_site&&(this.site_name=t.set_site.site_name?t.set_site.site_name:"Discuz! Q")},deep:!0}},mounted:function(){this.site_name=this.forums&&this.forums.set_site&&this.forums.set_site.site_name?this.forums.set_site.site_name:"Discuz! Q",this.createQrcode(window.location.href)},destroyed:function(){this.qrcode=null},methods:{createQrcode:function(link){var t=this;this.qrcode=null,this.$nextTick((function(){t.qrcode=new o(t.$refs.qrcode,{width:70,height:70,text:link})}))}}},c=(n(568),n(13)),component=Object(c.a)(r,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"adv-container"},[e("div",{ref:"qrcode",staticClass:"qrcode"}),this._v(" "),e("div",{staticClass:"adv-info"},[e("div",{staticClass:"adv-title"},[this._v(" 扫一扫，访问移动端")]),this._v("\n    "+this._s(this.site_name)+"\n  ")])])}),[],!1,null,"038d2a1a",null);e.default=component.exports},565:function(t,e,n){"use strict";n.r(e);var o={name:"Copyright",data:function(){return{year:"2019",site_record_code:""}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},mounted:function(){var t=window.currentTime||new Date;this.year=t.getFullYear()}},r=(n(569),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"copyright"},[n("div",{staticClass:"info"},[n("span",[t._v("Powered By")]),t._v(" "),n("a",{staticClass:"site",attrs:{href:"https://discuz.com",target:"_blank"}},[t._v("Discuz! Q")]),t._v(" "),n("span",{staticClass:"block"},[t._v("© "+t._s(t.year))])]),t._v(" "),t.forums&&t.forums.set_site&&(t.forums.set_site.site_record||t.forums.set_site.site_record_code)?n("div",{staticClass:"id"},[n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"https://beian.miit.gov.cn/",target:"_blank"}},[t._v(t._s(t.forums.set_site?t.forums.set_site.site_record:""))])]),t._v(" "),t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code?n("div",{staticClass:"site-record-code"},[n("a",{attrs:{href:"http://www.beian.gov.cn/portal/registerSystemInfo?recordcode="+(t.forums&&t.forums.set_site&&t.forums.set_site.site_record_code.replace(/[^0-9]/gi,"")),target:"_blank"}},[t._v(t._s(t.forums.set_site.site_record_code))])]):t._e()]):t._e()])}),[],!1,null,"68b79e04",null);e.default=component.exports},566:function(t,e,n){"use strict";var o=n(524);n.n(o).a},567:function(t,e,n){"use strict";var o=n(525);n.n(o).a},568:function(t,e,n){"use strict";var o=n(526);n.n(o).a},569:function(t,e,n){"use strict";var o=n(527);n.n(o).a},570:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"AvatarComponent",props:{author:{type:Object,default:function(){}},size:{type:Number,default:50},round:{type:Boolean,default:!1}},computed:{isAnonymous:function(){return this.author&&this.author.id&&parseInt(this.author.id)<0}}},r=(n(602),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("Avatar",{attrs:{user:t.author,size:t.size,round:t.round}}),t._v(" "),n("div",{staticClass:"title-info"},[n("div",{staticClass:"author-name"},[n("a",{staticClass:"username",attrs:{href:t.isAnonymous?"javascript:void(0)":"/user/"+t.author.id}},[t._v(t._s(t.author.username))]),t._v(" "),t.author.groups&&t.author.groups[0]&&t.author.groups[0].isDisplay?n("span",{staticClass:"group"},[t._v("（"+t._s(t.author.groups[0].name)+"）")]):t._e()]),t._v(" "),n("div",{staticClass:"timer"},[t._t("default")],2)])],1)}),[],!1,null,"a700310a",null);e.default=component.exports;installComponents(component,{Avatar:n(252).default})},571:function(t,e,n){"use strict";n.r(e);var o={name:"Message",props:{title:{type:String,default:""}}},r=(n(651),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Cover"),t._v(" "),n("div",{staticClass:"checkout-counter"},[n("div",{staticClass:"container-title"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),t._t("default")],2)],1)}),[],!1,null,"307d337d",null);e.default=component.exports;installComponents(component,{Cover:n(523).default,SvgIcon:n(67).default})},573:function(t,e,n){},574:function(t,e,n){},577:function(t,e,n){n(11);var o=n(583);t.exports={mixins:[o],computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},methods:{checkCaptcha:function(t){var e=this;return new Promise((function(n,o){if(e.forums&&e.forums.qcloud&&e.forums.qcloud.qcloud_captcha)return new TencentCaptcha(e.forums.qcloud.qcloud_captcha_app_id,(function(e){0===e.ret?(t.captcha_rand_str=e.randstr,t.captcha_ticket=e.ticket,n(t)):o(e)})).show();n(t)}))}}}},578:function(t,e,n){t.exports={methods:{handleAttachmentError:function(t){if(t&&t.message){var e=t.message.errors,n=e[0].detail?e[0].detail[0]:e[0].code,o=e[0].detail?e[0].detail[0]:this.$t("core.".concat(n));this.$message.error(o)}else this.$message.error(this.$t("post.imageUploadFail"))}}}},579:function(t,e,n){n(19),n(36),n(30),n(11),n(26);var o=n(506);t.exports={watch:{fileList:{handler:function(){var t;this.fileList.length>this.previewFiles.length&&0===this.previewFiles.length&&((t=this.previewFiles).push.apply(t,o(this.fileList)),this.previewFiles.map((function(t){t.progress=100})))},deep:!0,immediate:!0}},methods:{onClick:function(){this.input.dispatchEvent(new MouseEvent("click"))},onInput:function(t){var e=this,n=t.target.files,o=[];if(this.onUpload)return this.$message.warning(0===this.type?"请等待上传中的文件完成上传":"请等待上传中的图片完成上传");if(this.checkSizeLimit(n)&&this.checkLengthLimit(n)){for(var i=0;i<n.length;i++){var r=this.getObjectURL(n[i]);this.previewFiles.push({name:n[i].name,url:r,progress:0,deleted:!1,size:n[i].size}),o.push(n[i])}var c=o.reduce((function(t,n,o,r){return t.push(e.uploadFile(n,o,r.length)),t}),[]);this.uploadFiles(c)}},uploadFile:function(t,e,n){var o=this,r={onUploadProgress:function(t){t.lengthComputable?o.previewFiles[o.previewFiles.length-n+e].progress=.9*parseInt(Math.round(t.loaded/t.total*100).toString()):o.previewFiles[o.previewFiles.length-n+e].progress=100}},c=new FormData;return c.append("type",this.type),c.append("file",t),this.service.post(this.action,c,r)},uploadFiles:function(t){var e=this;this.$emit("update:onUpload",!0),Promise.all(t).then((function(t){e.previewFiles.map((function(t){t.progress=100}));var n=t.map((function(t){return t.data.data})),r=o(e.fileList);n.forEach((function(t){return r.push({id:t.id,name:t.attributes.fileName,url:t.attributes.url})})),e.input.value="",e.$emit("success",r),e.$emit("update:onUpload",!1)}),(function(n){e.input.value="";var o=t.length;e.$emit("update:onUpload",!1),e.previewFiles.splice(e.previewFiles.length-o,o),e.handleError(n).then((function(){}))}))},removeItem:function(t){var e=this;this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){e.previewFiles[t].deleted=!0;var n=o(e.fileList);n.splice(t,1),e.$emit("remove",n),setTimeout((function(){e.previewFiles.splice(t,1),e.$message.success("删除成功")}),900)}),(function(){}))},checkSizeLimit:function(t){for(var e=!0,i=0;i<t.length;i++)t[i].size>this.sizeLimit&&(e=!1);return e||this.$message.error(0===this.type?"文件大小不可超过 ".concat(this.sizeLimit/1024/1024," MB"):"图片大小不可超过 ".concat(this.sizeLimit/1024/1024," MB")),e},checkLengthLimit:function(t){return!(this.previewFiles.length+t.length>this.limit)||(this.$message.warning(0===this.type?"文件最多上传".concat(this.limit,"张"):"图片最多上传".concat(this.limit,"张")),this.$emit("exceed",t),!1)},getObjectURL:function(t){var e=null;return window.createObjectURL?e=window.createObjectURL(t):window.URL?e=window.URL.createObjectURL(t):window.webkitURL&&(e=window.webkitURL.createObjectURL(t)),e}}}},580:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(518),c={name:"TopicList",mixins:[n.n(r).a],data:function(){return{searchValue:"",searchList:[],searchTotal:0,pageNumber:1,pageLimit:5,setTimeoutId:null,loading:!1}},computed:{noMore:function(){return!this.loading&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getTopics()},methods:{searchTopics:function(t){var e=this;this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getTopics(),e.setTimeoutId=null}),300)},getTopics:function(){var t=this,e={"page[limit]":this.pageLimit,"page[number]":this.pageNumber,sort:"recommended"};return this.searchValue&&(e["filter[content]"]=this.searchValue),this.searchValue||(e["filter[recommended]"]=1),this.$store.dispatch("jv/get",["topics",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getTopics())},emitValue:function(t){this.$emit("selectedTopic"," #"+t+"# "),this.searchValue="",this.searchList=[],this.getTopics()}}},l=(n(609),n(13)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container-search-list",on:{click:function(t){t.stopPropagation()}}},[n("label",{on:{click:function(t){if(t.target!==t.currentTarget)return null}}},[n("input",{staticClass:"input-topic",attrs:{type:"text",placeholder:t.$t("post.topicInputTip")},domProps:{value:t.searchValue},on:{input:t.searchTopics,click:function(t){if(t.target!==t.currentTarget)return null}}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},[t.searchValue&&t.searchList.map((function(t){return t.content})).indexOf(t.searchValue)<0&&!t.loading?n("li",{on:{click:function(e){return t.emitValue(t.searchValue)}}},[n("span",[t._v("#"+t._s(t.searchValue)+"#")]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.newTopic")))])]):t._e(),t._v(" "),t._l(t.searchList,(function(e,o){return n("li",{key:o,staticClass:"infinite-list-item",on:{click:function(n){return t.emitValue(e.content)}}},[n("span",[t._v("#"+t._s(e.content)+"#")]),t._v(" "),n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:1===e.recommended,expression:"topic.recommended === 1"}],staticStyle:{"font-size":"16px"},attrs:{type:"recommend"}}),t._v(" "),n("span",[t._v(t._s(e.view_count+t.$t("topic.hot")))])],1)}))],2),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e()])])}),[],!1,null,"5d9c9c32",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},581:function(t,e,n){"use strict";n.r(e);var o={name:"EmojiList",data:function(){return{emojiList:[]}},mounted:function(){this.getEmojiList()},methods:{getEmojiList:function(){var t=this;this.$store.dispatch("jv/get",["emoji",{}]).then((function(data){t.emojiList=data}))}}},r=(n(610),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"emoji-list"},t._l(t.emojiList,(function(e,o){return n("span",{key:o,on:{click:function(n){return t.$emit("selectEmoji",e.code)}}},[n("img",{attrs:{src:e.url,alt:e.code}})])})),0)}),[],!1,null,"35a46638",null);e.default=component.exports},582:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(518),c={name:"Caller",mixins:[n.n(r).a],data:function(){return{friends:[],friendsLoading:!0,selectedFriends:[],searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.getFriends()},methods:{getFriends:function(){var t=this,e={"filter[type]":2,include:"fromUser,toUser.groups"};return this.$store.dispatch("jv/get",["follow",{params:e}]).then((function(data){t.friendsLoading=!1,t.friends=data.filter((function(t){return 1===t.is_mutual})),t.friends=t.friends.map((function(t){return t.fromUser}))}),(function(e){return t.handleError(e)}))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*"+this.searchValue+"*","filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},formatValue:function(){var t=Object(o.a)(this.selectedFriends);return" @"+(t=t.map((function(t){return t+" "}))).join("@")},selectFriendFromUl:function(t){this.selectedFriends.indexOf(t.username)<0&&this.selectedFriends.push(t.username),this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},l=(n(611),n(13)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callFriends"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},t._l(t.selectedFriends,(function(e,o){return n("div",{key:o,staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(e))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(n){t.selectedFriends.splice(t.selectedFriends.indexOf(e),1)}}})],1)})),0),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriends")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,o){return n("li",{key:o,class:{"infinite-list-item":!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v(t._s(e.username))])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.myFriends")))]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.friendsLoading,expression:"friendsLoading"}],staticClass:"container-caller"},t._l(t.friends,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriends.indexOf(e.username)>=0},on:{click:function(n){t.selectedFriends.indexOf(e.username)>=0?t.selectedFriends.splice(t.selectedFriends.indexOf(e.username),1):t.selectedFriends.push(e.username)}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("span",{staticClass:"text"},[t._v(t._s(t.$t("post.chosen")+" "+t.selectedFriends.length+" "+t.$t("topic.personUnit")))]),t._v(" "),n("el-button",{attrs:{disabled:0===t.selectedFriends.length,size:"medium",type:"primary"},on:{click:function(e){t.$emit("selectedCaller",t.formatValue())}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"b2de57ee",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,Avatar:n(252).default,MessageBox:n(531).default})},583:function(module,exports,__webpack_require__){__webpack_require__(60),__webpack_require__(19),__webpack_require__(39),__webpack_require__(174);var _defineProperty=__webpack_require__(509);__webpack_require__(251),__webpack_require__(26),__webpack_require__(30),__webpack_require__(11),__webpack_require__(51),__webpack_require__(59),__webpack_require__(253);var _typeof2=__webpack_require__(256);function ownKeys(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function _objectSpread(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(e){_defineProperty(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}__webpack_require__(37),__webpack_require__(29),function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===_typeof2(t)&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=16)}([function(t,e,n){function o(){return Math.floor(1e8*Math.random())}var r=function(t){t=t?1:0;try{return location.search.substr(t)}catch(o){try{var e=document.URL,n=e.indexOf("?");if(n>=0)return e.substr(n+t)}catch(t){}}return""},a={};!function(){for(var t=r(!0).split("&"),e=0;e<t.length;e++){var n=/(.*?)=(.*)/.exec(t[e]);n&&(a[n[1]]=n[2])}}(),t.exports={href:function(){try{return location.href}catch(t){try{return document.URL}catch(t){}}return""},getQuery:function(t){var e=r();return t=t?1:0,(e=e?"".concat(e.replace(/&rand=[^&]+/,""),"&rand=").concat(o()):"?rand=".concat(o())).substr(t)},queryParam:function(t){return a[t]},queryMap:function(){return $.extend({},a)},parse2rgb:function(t){if(!t||"string"!=typeof t)return null;t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,n,o){return e+e+n+n+o+o}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16),s:"#".concat(e[1]).concat(e[2]).concat(e[3])}:null},arrIndexOf:function(t,e){if("function"==typeof t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}}},function(t,e,n){var o=function(){var t=1,e=/subsid=(\d+)/.exec(location.href);e&&(t=parseInt(e[1],10)+1);var n=function(e,n){var o=n||t;return e=/subsid=\d+/.test(e)?e.replace(/subsid=\d+/g,"subsid=".concat(o)):"".concat(e,"&subsid=").concat(o),n||t++,e};return n.get=function(){return t},n.bind=function(){var e=t++;return function(t){return n(t,e)}},n}();t.exports=o},function(t,e,n){var o=Object.prototype.hasOwnProperty,r=Object.prototype.toString,a=Object.defineProperty,i=Object.getOwnPropertyDescriptor,c=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===r.call(t)},s=function(t){if(!t||"[object Object]"!==r.call(t))return!1;var e,n=o.call(t,"constructor"),a=t.constructor&&t.constructor.prototype&&o.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!a)return!1;for(e in t);return void 0===e||o.call(t,e)},u=function(t,e){a&&"__proto__"===e.name?a(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},p=function(t,e){if("__proto__"===e){if(!o.call(t,e))return;if(i)return i(t,e).value}return t[e]};t.exports=function t(){var e,n,o,r,l,a,i=arguments[0],d=1,h=arguments.length,f=!1;for("boolean"==typeof i&&(f=i,i=arguments[1]||{},d=2),(null==i||"object"!==_typeof2(i)&&"function"!=typeof i)&&(i={});d<h;++d)if(null!=(e=arguments[d]))for(n in e)o=p(i,n),i!==(r=p(e,n))&&(f&&r&&(s(r)||(l=c(r)))?(l?(l=!1,a=o&&c(o)?o:[]):a=o&&s(o)?o:{},u(i,{name:n,newValue:t(f,a,r)})):void 0!==r&&u(i,{name:n,newValue:r}));return i}},function(t,e,n){var o,r,a=n(1),i={ERROR_TYPE_FRAMEJS_DOWNLOAD_FAIL:16,ERROR_TYPE_JSONP_PREHANDLE:17,ERROR_TYPE_FRAMEJS_CODE_ERROR:18,CALLBACK_NAME:19},c={ERROR_TYPE_FRAMEJS_DOWNLOAD_FAIL:"ERROR_TYPE_FRAMEJS_DOWNLOAD_FAIL",ERROR_TYPE_JSONP_PREHANDLE:"ERROR_TYPE_JSONP_PREHANDLE",ERROR_TYPE_FRAMEJS_CODE_ERROR:"ERROR_TYPE_FRAMEJS_CODE_ERROR",CALLBACK_NAME:"CALLBACK_NAME"},s=(o=document.referrer,r=location.href||document.URL,o=o.length>512?o.substr(0,512):o,r=r.length>1024?r.substr(0,1024):r,["referer=".concat(encodeURIComponent(o)),"href=".concat(encodeURIComponent(r))].join("&"));t.exports={type:i,send:function(t,e,n){try{(n=n||c[t]).length>1024&&n.substr(0,1024);var o=["type=".concat(t=i[t]),"appid=".concat(e),"reason=".concat(encodeURIComponent(n))],r="https://aq.qq.com/cn2/manage/mbtoken/cap_monitor?".concat(s,"&").concat(o.join("&"));(new Image).src=a(r)}catch(t){}},perfectStack:function(t){var e="";t&&t.stack&&(e=t.stack.replace(/\n/gi,"").split(/\bat\b/).join("\n").replace(/\?[^:]+/gi,""));try{var n=t.toString();e.indexOf(n)<0&&(e="".concat(n,"@").concat(e))}catch(t){}return e}}},,function(t,e,n){t.exports={add:function(t,e,n){t&&(t.addEventListener?t.addEventListener(e,n,!1):t.attachEvent?t.attachEvent("on".concat(e),n):t["on".concat(e)]=n)},remove:function(t,e,n){t&&(t.removeEventListener?t.removeEventListener(e,n,!1):t.detachEvent?t.detachEvent("on".concat(e),n):t["on".concat(e)]=null)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var i,n=t[1]||"",o=t[3];if(!o)return n;if(e&&"function"==typeof btoa){var r=(i=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),a=o.sources.map((function(t){return"/*# sourceURL=".concat(o.sourceRoot).concat(t," */")}));return[n].concat(a).concat([r]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2],"{").concat(n,"}"):n})).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var o={},r=0;r<this.length;r++){var a=this[r][0];"number"==typeof a&&(o[a]=!0)}for(r=0;r<t.length;r++){var i=t[r];"number"==typeof i[0]&&o[i[0]]||(n&&!i[2]?i[2]=n:n&&(i[2]="(".concat(i[2],") and (").concat(n,")")),e.push(i))}},e}},function(t,e){var n,o={},r=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}},c=r((function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())})),a=r((function(){return document.head||document.getElementsByTagName("head")[0]})),i=null,l=0;function s(t,e){for(var n=0;n<t.length;n++){var r=t[n],c=o[r.id];if(c){c.refs++;for(var i=0;i<c.parts.length;i++)c.parts[i](r.parts[i]);for(;i<r.parts.length;i++)c.parts.push(h(r.parts[i],e))}else{var l=[];for(i=0;i<r.parts.length;i++)l.push(h(r.parts[i],e));o[r.id]={id:r.id,refs:1,parts:l}}}}function u(t){for(var e=[],n={},o=0;o<t.length;o++){var r=t[o],c=r[0],l={css:r[1],media:r[2],sourceMap:r[3]};n[c]?n[c].parts.push(l):e.push(n[c]={id:c,parts:[l]})}return e}function p(t,e){var n=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);t.apply(e,n.concat(o))}}function d(){var t=document.createElement("style"),e=a();return t.type="text/css",e.appendChild(t),t}function h(t,e){var n,o,r,s,u;if(e.singleton){var c=l++;n=i||(i=d()),o=p(m,null,n,c,!1),r=p(m,null,n,c,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(s=document.createElement("link"),u=a(),s.rel="stylesheet",u.appendChild(s),o=p(v,null,n=s),r=function(){n.parentNode.removeChild(n),n.href&&URL.revokeObjectURL(n.href)}):(n=d(),o=p(b,null,n),r=function(){n.parentNode.removeChild(n)});return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else r()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!==("undefined"==typeof document?"undefined":_typeof2(document)))throw new Error("The style-loader cannot be used in a non-browser environment");void 0===(e=e||{}).singleton&&(e.singleton=c());var n=u(t);return s(n,e),function(t){for(var r=[],a=0;a<n.length;a++){var c=n[a];(l=o[c.id]).refs--,r.push(l)}for(t&&s(u(t),e),a=0;a<r.length;a++){var l;if(0===(l=r[a]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete o[l.id]}}}};var f=(n=[],function(t,e){var o=[];n[t]=e;for(var r=0;r<n.length;r++)n[r]&&o.push(n[r]);return o.join("\n")});function m(t,e,n,o){var r=n?"":o.css;if(t.styleSheet)t.styleSheet.cssText=f(e,r);else{var c=document.createTextNode(r),l=t.childNodes;l[e]&&t.removeChild(l[e]),l.length?t.insertBefore(c,l[e]):t.appendChild(c)}}function b(t,e){var n=e.css,o=e.media;if(e.sourceMap,o&&t.setAttribute("media",o),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function v(t,e){var n=e.css,o=(e.media,e.sourceMap);o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */"));var r=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}},function(module,exports,__webpack_require__){var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)};"object"!==("undefined"==typeof JSON?"undefined":_typeof(JSON))&&(JSON={}),function(){var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;function f(t){return t<10?"0".concat(t):t}function this_value(){return this.valueOf()}function quote(t){return rx_escapable.lastIndex=0,rx_escapable.test(t)?'"'.concat(t.replace(rx_escapable,(function(t){var e=meta[t];return"string"==typeof e?e:"\\u".concat("0000".concat(t.charCodeAt(0).toString(16)).slice(-4))})),'"'):'"'.concat(t,'"')}function str(t,e){var n,o,r,a,i,c=gap,s=e[t];switch(s&&"object"===(void 0===s?"undefined":_typeof(s))&&"function"==typeof s.toJSON&&(s=s.toJSON(t)),"function"==typeof rep&&(s=rep.call(e,t,s)),void 0===s?"undefined":_typeof(s)){case"string":return quote(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(gap+=indent,i=[],"[object Array]"===Object.prototype.toString.apply(s)){for(a=s.length,n=0;n<a;n+=1)i[n]=str(n,s)||"null";return r=0===i.length?"[]":gap?"[\n".concat(gap).concat(i.join(",\n".concat(gap)),"\n").concat(c,"]"):"[".concat(i.join(","),"]"),gap=c,r}if(rep&&"object"===(void 0===rep?"undefined":_typeof(rep)))for(a=rep.length,n=0;n<a;n+=1)"string"==typeof rep[n]&&(r=str(o=rep[n],s))&&i.push(quote(o)+(gap?": ":":")+r);else for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r=str(o,s))&&i.push(quote(o)+(gap?": ":":")+r);return r=0===i.length?"{}":gap?"{\n".concat(gap).concat(i.join(",\n".concat(gap)),"\n").concat(c,"}"):"{".concat(i.join(","),"}"),gap=c,r}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?"".concat(this.getUTCFullYear(),"-").concat(f(this.getUTCMonth()+1),"-").concat(f(this.getUTCDate()),"T").concat(f(this.getUTCHours()),":").concat(f(this.getUTCMinutes()),":").concat(f(this.getUTCSeconds()),"Z"):null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(t,e,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;o<n;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=e,e&&"function"!=typeof e&&("object"!==(void 0===e?"undefined":_typeof(e))||"number"!=typeof e.length))throw new Error("JSON.stringify");return str("",{"":t})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){var j;function walk(t,e){var n,o,r=t[e];if(r&&"object"===(void 0===r?"undefined":_typeof(r)))for(n in r)Object.prototype.hasOwnProperty.call(r,n)&&(void 0!==(o=walk(r,n))?r[n]=o:delete r[n]);return reviver.call(t,e,r)}if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,(function(t){return"\\u".concat("0000".concat(t.charCodeAt(0).toString(16)).slice(-4))}))),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("(".concat(text,")")),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(t,e,n){var o="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)},r="[CODE_VERIFY]",a="postMessage"in window;function i(t,e,n){var r="";if(arguments.length<2?r="[Msger] error 1":"object"!=(void 0===t?"undefined":o(t))?r="[Msger] error 2":"string"!=typeof e&&(r="[Msger] error 3"),r)throw new Error(r);this.target=t,this.name=e,this.domain=n||"*"}function c(t,e){this.targets={},this.name=t,this.listenFunc=[],"string"!=typeof(r=e||r)&&(r=r.toString()),this.initListen()}i.prototype.send=a?function(t){this.target.postMessage(t,this.domain)}:function(t){var e=window.navigator[r+this.name];if("function"!=typeof e)throw new Error("target callback function is not defined");e(t,window)},c.prototype.addTarget=function(t,e,n){var o=new i(t,e,n);this.targets[e]=o},c.prototype.initListen=function(){var t=this,e=function(e){"object"==(void 0===e?"undefined":o(e))&&e.data&&(e=e.data);for(var n=0;n<t.listenFunc.length;n++)t.listenFunc[n](e)};a?"addEventListener"in document?window.addEventListener("message",e,!1):"attachEvent"in document&&window.attachEvent("onmessage",e):window.navigator[r+this.name]=e},c.prototype.listen=function(t){this.listenFunc.push(t)},c.prototype.clear=function(){this.listenFunc=[]},c.prototype.send=function(t){var e,n=this.targets;for(e in n)n.hasOwnProperty(e)&&n[e].send(t)},window.TCapMsg=c,t.exports=c},,,,,,,function(module,exports,__webpack_require__){var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)};if(!0===window.__TencentCaptchaExists__)throw new Error("请勿多次引用腾讯验证码的接入js");window.__TencentCaptchaExists__=!0,__webpack_require__(17),__webpack_require__(8);var Messenger=__webpack_require__(9),domReady=__webpack_require__(19),btoa=window.btoa||__webpack_require__(20),extend=Object.assign||__webpack_require__(2),loadScript=__webpack_require__(21),eventListener=__webpack_require__(5),Executor=__webpack_require__(22),isIEVar=__webpack_require__(23),isElement=__webpack_require__(24),invisibleIframe=__webpack_require__(25),getScriptDomain=__webpack_require__(26),scriptDomain=getScriptDomain()||"",isWechatDevtools=navigator.userAgent&&/wechatdevtools/.test(navigator.userAgent),isWindows=/windows/i.test(navigator.userAgent),isMobile=!isWindows&&("ontouchstart"in window||"ontouchstart"in document.createElement("div")||isWechatDevtools),capDomain="https://ssl.captcha.qq.com";capDomain||(capDomain=scriptDomain);var grayscaleFrameJs="/tcaptcha-frame.2de3157b.js",grayscaleThreshold=1,grayscaleAppId=["123","2100049389","2100049390","2046103261","2070173641","2060075756"],grayscaleProb=Math.random(),needGrayscaleJs=void 0,jsLoadStatus="none",capError=__webpack_require__(3),preVerifyData={},capObj=void 0,initQueue=[],defaultOpt={type:"popup",pos:isIEVar(6)?"absolute":"fixed",lang:2052,showHeader:isMobile,needFeedBack:!0,themeColor:"",tcaptchaFlag:!0,gettype:"cap_union_prehandle",domain:capDomain,htdoc_path:capDomain},noop=function(){},isGrayscaleAppId=function(t){if(void 0!==needGrayscaleJs)return needGrayscaleJs;for(var e=0,n=grayscaleAppId.length;e<n;e++)if(t==grayscaleAppId[e])return needGrayscaleJs=!0;return needGrayscaleJs=!1},callbackWrap=function(t,e){return function(n){"object"===(void 0===n?"undefined":_typeof(n))&&(n=_objectSpread({bizState:t.options.bizState,appid:t.options.appid},n)),e&&e(n)}},executor=new Executor((function(){if(initQueue.length>0){for(var t=0;t<initQueue.length;t++)initQueue[t].show();initQueue.length=0}}),0),Captcha=function Captcha($btn,appid,_tcallback_,opts){var bizState=void 0;if(isElement($btn))if(appid&&"object"===(void 0===appid?"undefined":_typeof(appid)))opts=appid,appid=null,_tcallback_=null;else{if(appid=appid||$btn.getAttribute("data-appid"),!_tcallback_){var callbackName=$btn.getAttribute("data-cbfn");try{_tcallback_=eval("window.".concat(callbackName))}catch(t){throw new Error("Lost `callback`")}}bizState=$btn.getAttribute("data-biz-state")}else{if("string"!=typeof $btn||"function"!=typeof appid)throw new Error("Arguments error.");opts=_tcallback_,_tcallback_=appid,appid=$btn,$btn=null}opts=opts||{},opts.callback=_tcallback_||opts.callback,opts.start=opts.start||noop,opts.end=opts.end||noop;var readyCallback="function"==typeof opts.ready?opts.ready:noop;if(opts.ready=function(t){readyCallback.call(this,t)},opts.appid=appid||opts.appid,opts.bizState=bizState||opts.bizState,opts.fwidth=parseFloat(opts.fwidth)||0,opts.sdkOpts=opts.sdkOpts||null,opts.ele=$btn,this.options=opts,"function"!=typeof opts.callback)throw new Error("Lost `callback`");if(this.initOpts=_objectSpread(_objectSpread({},defaultOpt),opts),this.langFun(),$btn){var that=this;eventListener.add($btn,"click",(function(){that.show()}))}};Captcha.prototype={show:function(){if(executor.isDone)this.__show__();else{for(var t=0;t<initQueue.length;t++)if(initQueue[t]===this)return;initQueue.push(this)}},__show__:function(){var t=this.initOpts;if(void 0===window.AqSCode)return capError.send("ERROR_TYPE_FRAMEJS_CODE_ERROR",t.appid),alert("页面加载异常，请刷新页面重试");this.destroy();var e=[];for(var n in e.push("aid=".concat(t.appid)),e.push("accver=1"),e.push("showtype=".concat(t.type)),e.push("ua=".concat(encodeURIComponent(btoa((navigator.userAgent||"").replace(/[\u00ff-\uffff]+/g,""))))),e.push("noheader=".concat("false"=="".concat(t.showHeader)?"1":"0")),e.push("fb=".concat("false"=="".concat(t.needFeedBack)?"0":"1")),e.push("enableDarkMode=".concat(t.enableDarkMode?"1":"0")),t.sid&&e.push("sid=".concat(t.sid)),preVerifyData)preVerifyData[n]&&e.push("".concat(n,"=").concat(encodeURIComponent(preVerifyData[n])));t.uid="".concat(t.uin||""),needGrayscaleJs&&(e.push("grayscale=1"),t.grayscale=1),isMobile?(e.push("clientype=1"),t.clientype=1,t.forceLang&&e.push("lang=".concat(t.forceLang)),t.params="?".concat(e.join("&"))):(e.push("clientype=2"),t.clientype=2,needGrayscaleJs&&t.forceLang&&e.push("lang=".concat(t.forceLang)),t.params="?".concat(e.join("&")),t.s_type_suffix="?".concat(e.join("&")),t.src="".concat(capDomain,"/template/new_placeholder.html").concat(t.s_type_suffix),t.s_type="".concat(capDomain,"/cap_union_prehandle").concat(t.s_type_suffix),t.slide_src="".concat(capDomain,"/template/new_slide_placeholder.html").concat(t.s_type_suffix),t.fb="false"=="".concat(t.needFeedBack)?"0":"1"),(capObj=new AqSCode(t)).listen(callbackWrap(this,t.callback),callbackWrap(this,t.ready)),capObj.start(callbackWrap(t.start)),capObj.end(callbackWrap(t.end)),(needGrayscaleJs||isMobile)&&((t.top||t.left)&&capObj.initPos({top:t.top||void 0,left:t.left||void 0}),capObj.create())},langFun:function(){if(this.initOpts.forceLang){var t={"zh-cn":"2052","zh-hk":"1028",en:"1033"},e=this.initOpts.forceLang;t[e]?(this.initOpts.lang=t[e],this.initOpts.forceLang=t[e],this.initOpts.forcestyle=1):this.initOpts.forceLang=""}},destroy:function(){capObj&&capObj.destroy&&capObj.destroy()},refresh:function(){capObj&&capObj.refresh&&capObj.refresh()},getTicket:function(){if(capObj&&capObj.getTicket){var t=null;return callbackWrap(this,(function(e){t=e}))(capObj.getTicket()),t}return null}};var autoBindBtn=function(){var t=document.getElementById("TencentCaptcha");t&&new Captcha(t)};executor.exec((function(t){domReady((function(){try{autoBindBtn()}catch(t){}new Messenger("TCaptchaVerifyDetect").listen((function(t){if(t&&"object"===(void 0===t?"undefined":_typeof(t)))switch(t.type){case"preVerify":extend(preVerifyData,t.data)}}));try{invisibleIframe("".concat(capDomain,"/template/captcha-pre-verify.html"))}catch(t){}t()}))})),executor.exec((function(t){jsLoadStatus="loading",needGrayscaleJs=!0,loadScript(grayscaleFrameJs,capDomain,capDomain,(function(){return!!window.AqSCode}),(function(){jsLoadStatus="loaded",t()}),(function(){jsLoadStatus="none",capError.send("ERROR_TYPE_FRAMEJS_DOWNLOAD_FAIL"),t()}))})),window.TencentCaptcha=Captcha},function(t,e,n){var o=n(18);"string"==typeof o&&(o=[[t.i,o,""]]),n(7)(o,{}),o.locals&&(t.exports=o.locals)},function(t,e,n){(t.exports=n(6)(!1)).push([t.i,"@keyframes animate_dots{0%{opacity:1}to{opacity:0}}@-webkit-keyframes animate_dots{0%{opacity:1}to{opacity:0}}.dot0,.dot1{animation:animate_dots .9s infinite;-moz-animation:animate_dots .9s infinite;-webkit-animation:animate_dots .9s infinite;-o-animation:animate_dots .9s infinite}.dot1{animation-delay:.2s;-webkit-animation-delay:.2s}.dot2{animation:animate_dots .9s infinite;-moz-animation:animate_dots .9s infinite;-webkit-animation:animate_dots .9s infinite;-o-animation:animate_dots .9s infinite;animation-delay:.4s;-webkit-animation-delay:.4s}.dots_item{display:inline-block;margin-right:5px;width:10px;height:10px;border-radius:50%;background:#4886ff}.verify-icon{position:absolute;width:100%;margin-top:70px;text-align:center}.t-mask{width:100%;height:100%;position:fixed;_position:absolute;left:0;top:0;background:#000;opacity:.5;filter:progid:DXImageTransform.Microsoft.Alpha(opacity=50);z-index:2000000000}",""])},function(t,e,n){t.exports=function(t){var e,n=[],o=document,r=o.documentElement,a=r.doScroll,i=(a?/^loaded|^c/:/^loaded|c/).test(o.readyState);function c(t){for(i=1;t=n.shift();)t()}return o.addEventListener&&o.addEventListener("DOMContentLoaded",e=function(){o.removeEventListener("DOMContentLoaded",e,!1),c()},!1),a&&o.attachEvent("onreadystatechange",e=function(){/^c/.test(o.readyState)&&(o.detachEvent("onreadystatechange",e),c())}),t=a?function(e){self!=top?i?e():n.push(e):function(){try{r.doScroll("left")}catch(n){return setTimeout((function(){t(e)}),50)}e()}()}:function(t){i?t():n.push(t)}}()},function(t,e,n){var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=function(t){var e=[0,2,1][t.length%3],n=t.charCodeAt(0)<<16|(t.length>1?t.charCodeAt(1):0)<<8|(t.length>2?t.charCodeAt(2):0);return[o.charAt(n>>>18),o.charAt(n>>>12&63),e>=2?"=":o.charAt(n>>>6&63),e>=1?"=":o.charAt(63&n)].join("")};t.exports=function(t){return t.replace(/[\s\S]{1,3}/g,r)}},function(t,e,n){t.exports=function t(e,n,o,a,i,r,s){s=s||1;var u=!1,p=document.createElement("script");function c(t){u||(t&&"load"===t.type||/^(loaded|complete)$/.test(this.readyState))&&(a()?(u=!0,i&&i()):l())}p.type="text/javascript",p.async=!0,p.src=(s>1?o:n)+e,"onload"in p?p.onload=c:p.onreadystatechange=c;var l=function(){u||(u=!0,s>=2?r&&r():t(e,n,o,a,i,r,s+1))};p.onerror=l,document.getElementsByTagName("head").item(0).appendChild(p)}},function(t,e,n){var o=function(t,e){this.i=0,this.doneCallback=t,this.isDone=!1,this.timeout=e||0;var n=this;this.immediateExec=setTimeout((function(){n.doneCheck()}),0)};o.prototype={doneCheck:function(t,e){try{t&&t(e)}catch(t){}if(this.i--,this.i<=0)try{this.isDone=!0,this.doneCallback()}catch(t){}},exec:function(t,e,n){clearTimeout(this.immediateExec);var o=!1,r="",a=this;this.i++,this.i>0&&(this.isDone=!1);try{(r=t((function(t){o||(o=!0,setTimeout((function(){a.doneCheck(e,t)}),0))})))&&(o=!0,setTimeout((function(){a.doneCheck(e,r)}),0))}catch(t){}(n=n||this.timeout||0)>0&&setTimeout((function(){o||(o=!0,a.doneCheck(e,""))}),n)}},t.exports=o},function(t,e,n){t.exports=function(t){var e=document.createElement("b");return e.innerHTML="\x3c!--[if IE ".concat(t,"]><i></i><![endif]--\x3e"),e.getElementsByTagName("i")&&1===e.getElementsByTagName("i").length}},function(t,e,n){var o="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)};t.exports=function(t){try{return t instanceof HTMLElement}catch(e){return"object"===(void 0===t?"undefined":o(t))&&1===t.nodeType&&"object"===o(t.style)&&"object"===o(t.ownerDocument)}}},function(t,e,n){t.exports=function(t){var e=document.createElement("iframe");return e.src=t,e.style.cssText="width: 0px; height: 0px; display: none;",(document.body||document.getElementsByTagName("body").item("0")).appendChild(e),e}},function(t,e,n){var o=n(0).href;t.exports=function(){try{var t=document.getElementById("CaptchaScript")||function(){for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var n=t[e];if(n.src.match(/captcha\.js/i))return n}}()||"";if(!t)return"";var e=t.src,n=function(t){var e=t.split("?");if(2!==e.length)return{};for(var n=e[1]&&e[1].split("&"),o={},r=0;r<n.length;r++){var c=n[r].split("=");c[1]&&(o[c[0]]=decodeURIComponent(c[1]))}return o}(e).domain;if(n)return n;var i=/(https?\:\/\/[0-9a-zA-Z-:\.]+)\//i,r=e.match(i)||o().match(i);return r?r[1]:""}catch(t){return""}}}])},585:function(t,e,n){"use strict";n.r(e);n(59);var o=n(518),r={name:"Editor",mixins:[n.n(o).a],props:{post:{type:Object,default:function(){}},payment:{type:Object,default:function(){}},question:{type:Object,default:function(){}},product:{type:Object,default:function(){}},typeInformation:{type:Object,default:function(){}},editResourceShow:{type:Object,default:function(){}},isEdit:{type:Boolean,default:!1},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"},selector:{type:String,default:"editor"}},data:function(){return{input:{},vditor:{},selectionStart:0,selectionEnd:0,showEmoji:!1,showCaller:!1,showTopic:!1,showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1,onUploadImage:!1,onUploadVideo:!1,onUploadAttached:!1,listenerList:["emoji-list","topic-list"],actions:[{icon:"emoji",toggle:"showEmoji",show:!1},{icon:"call",toggle:"showCaller",show:!1},{icon:"topic",toggle:"showTopic",show:!1}],resources:[{icon:"picture",toggle:"showUploadImg",show:!1},{icon:"video",toggle:"showUploadVideo",show:!1}]}},computed:{userId:function(){return this.$store.state.session.userId},url:function(){return"/api"},header:function(){var t=window.localStorage.getItem("access_token");return{authorization:"Bearer ".concat(t)}},textarea:function(){return document.querySelector(".".concat(this.selector," #textarea"))},forums:function(){return this.$store.state.site.info.attributes||{}},canCreateThreadPaid:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_create_thread_paid},canUploadAttachments:function(){return!(!this.forums||!this.forums.other)&&this.forums.other.can_upload_attachments},attachedSizeLimit:function(){return this.forums.set_attach?1024*this.forums.set_attach.support_max_size*1024:10485760},imageTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_img_ext.split(",").map((function(t){return"."+t})).join(","):""},attachedTypeLimit:function(){return this.forums.set_attach?this.forums.set_attach.support_file_ext.split(",").map((function(t){return"."+t})).join(","):""},isPost:function(){return this.typeInformation&&1===this.typeInformation.type||!1}},watch:{editResourceShow:{handler:function(t){if(t)for(var e in t)this[e]=t[e]},deep:!0,immediate:!0},typeInformation:{handler:function(t){t&&(this.actions[0].show=t.showEmoji,this.actions[1].show=t.showCaller,this.actions[2].show=t.showTopic,this.resources[0].show=t.showImage,this.resources[1].show=t.showVideo)},deep:!0,immediate:!0}},mounted:function(){this.textarea&&this.autoHeight(),this.emojiListener()},methods:{onPostContentChange:function(t,e){var n=Object.assign({},this.post);n[t]=e,this.$emit("update:post",n)},onPaymentChange:function(t,e){var n=Object.assign({},this.payment);n[t]=e,this.$emit("update:payment",n)},onQuestionChange:function(t,e){var n=Object.assign({},this.question);n[t]=e,this.$emit("update:question",n)},onProductChange:function(t){var e=Object.assign({},t);this.$emit("update:product",e)},autoHeight:function(){"chat"!==this.editorStyle&&(this.post.text.length>310&&(this.textarea.style.height="180px"),this.textarea.onkeyup=function(){var t=document.scrollingElement.scrollTop;this.style.height="auto",this.style.height=this.scrollHeight+"px",document.scrollingElement.scrollTop=t})},getSelection:function(){this.selectionStart=this.textarea.selectionStart,this.selectionEnd=this.textarea.selectionEnd},emojiListener:function(){var t=this;document.addEventListener("click",(function(e){var n=!0;(e.path||e.composedPath&&e.composedPath()).forEach((function(t){t.classList&&(t.classList.contains("emoji-list")||t.classList.contains("topic-list")||t.classList.contains("editor-bar"))&&(n=!1)})),n&&(t.showTopic=!1,t.showEmoji=!1)}))},onActions:function(t){var e=this;this.hideActions(),setTimeout((function(){e[t]=!e[t]}))},addResource:function(t){this[t]=!0},selectActions:function(code){this.getSelection();var t=this.post.text.slice(0,this.selectionStart)+code+this.post.text.slice(this.selectionStart,this.post.text.length);this.onPostContentChange("text",t),this.hideActions()},hideActions:function(){this.showEmoji=!1,this.showTopic=!1,this.showCaller=!1},publish:function(){return this.onUploadAttached?this.$message.warning(this.$t("post.pleaseWaitForTheAttachedUploadToComplete")):this.onUploadImage?this.$message.warning(this.$t("post.pleaseWaitForTheImageUploadToComplete")):this.onUploadVideo?this.$message.warning(this.$t("post.pleaseWaitForTheVideoUploadToComplete")):(this.$emit("update:onPublish",!0),void this.$emit("publish"))}}},c=(n(600),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"editor"},[t.userId&&0===t.userId?n("div",{staticClass:"not-logged"},[n("span",[t._v(t._s(t.$t("post.publishAfterLogin")))])]):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showTitle?n("label",[n("input",{staticClass:"input-title",attrs:{placeholder:t.$t("post.pleaseInputPostTitle"),type:"text"},domProps:{value:t.post&&t.post.title},on:{input:function(e){return t.onPostContentChange("title",e.target.value)}}})]):t._e(),t._v(" "),t.typeInformation&&5===t.typeInformation.type?n("editor-qa",{attrs:{question:t.question},on:{paymentTypeChange:function(e){return t.onQuestionChange("paymentType",e)},isAnonymousChange:function(e){return t.onQuestionChange("isAnonymous",e)},isOnlookerChange:function(e){return t.onQuestionChange("isOnlooker",e)},beUserChange:function(e){return t.onQuestionChange("beUser",e)}}}):t._e(),t._v(" "),t.typeInformation&&6===t.typeInformation.type?n("editor-product",{attrs:{product:t.product},on:{productChange:t.onProductChange}}):t._e(),t._v(" "),t.typeInformation&&t.typeInformation.showPayment&&t.canCreateThreadPaid?n("editor-payment",{attrs:{payment:t.payment||{},type:t.typeInformation&&t.typeInformation.type,"can-upload-attachments":t.canUploadAttachments},on:{paymentChange:function(e){return t.onPaymentChange(e.key,e.value)}}}):t._e(),t._v(" "),t.isPost&&t.canUploadAttachments?n("attachment-upload",{attrs:{"file-list":t.post&&t.post.attachedList,"on-upload":t.onUploadAttached,action:"/attachments",accept:t.attachedTypeLimit,limit:99999,type:0,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadAttached=e},"update:on-upload":function(e){t.onUploadAttached=e},success:function(e){return t.onPostContentChange("attachedList",e)},remove:function(e){return t.onPostContentChange("attachedList",e)}}}):t._e(),t._v(" "),t.isPost?n("Vditor",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,placeholder:t.typeInformation&&t.typeInformation.placeholder,"image-accept":t.imageTypeLimit,text:t.post&&t.post.text,"show-caller":t.showCaller,"show-topic":t.showTopic,"show-emoji":t.showEmoji,"is-edit":t.isEdit,"on-publish":t.onPublish,"attachment-size-limit":t.attachedSizeLimit,"on-upload-image":t.onUploadImage},on:{"update:onUploadImage":function(e){t.onUploadImage=e},"update:on-upload-image":function(e){t.onUploadImage=e},textChange:function(e){return t.onPostContentChange("text",e)},close:function(e){t.showCaller=!1},hideActions:t.hideActions,onActions:t.onActions,publish:t.publish}}):t._e(),t._v(" "),t.isPost?t._e():n("div",{class:["container-textarea",t.editorStyle]},["post"===t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit,"text-length":t.post&&t.post.text&&t.post.text.length,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e(),t._v(" "),n("label",[n("textarea",{class:["input-text",t.editorStyle],attrs:{id:"textarea",placeholder:t.typeInformation?t.typeInformation.placeholder:"",maxlength:t.post&&t.post.textLimit},domProps:{value:t.post&&t.post.text},on:{input:function(e){return t.onPostContentChange("text",e.target.value)}}})]),t._v(" "),n("div",[t.showUploadImg||t.showUploadVideo?n("div",{staticClass:"resources-list"},[t.showUploadImg?n("image-upload",{attrs:{type:t.typeInformation.type&&15===t.typeInformation.type?5:1,"file-list":t.post&&t.post.imageList,"on-upload":t.onUploadImage,action:"/attachments",accept:t.imageTypeLimit,limit:9,"size-limit":t.attachedSizeLimit},on:{"update:onUpload":function(e){t.onUploadImage=e},"update:on-upload":function(e){t.onUploadImage=e},success:function(e){return t.onPostContentChange("imageList",e)},remove:function(e){return t.onPostContentChange("imageList",e)}}}):t._e(),t._v(" "),t.showUploadVideo?n("video-upload",{attrs:{"on-upload-video":t.onUploadVideo,"video-list":t.post&&t.post.videoList},on:{"update:onUploadVideo":function(e){t.onUploadVideo=e},"update:on-upload-video":function(e){t.onUploadVideo=e},videoChange:function(e){return t.onPostContentChange(e.key,e.value)}}}):t._e()],1):t._e(),t._v(" "),"post"!==t.editorStyle?n("editor-tool-bar",{attrs:{"text-limit":t.typeInformation&&t.typeInformation.textLimit||450,"text-length":t.post&&t.post.text&&t.post.text.length||0,actions:t.actions,"show-emoji":t.showEmoji,"show-topic":t.showTopic,"show-caller":t.showCaller,resources:t.resources,"on-publish":t.onPublish,"editor-style":t.editorStyle},on:{publish:t.publish,selectActions:t.selectActions,addResource:t.addResource,hidePop:t.hideActions,onActions:t.onActions}}):t._e()],1)],1),t._v(" "),t.showCaller&&!t.isPost?n("caller",{on:{close:function(e){t.showCaller=!1},selectedCaller:t.selectActions}}):t._e()],1)}),[],!1,null,"11aa4f42",null);e.default=component.exports;installComponents(component,{EditorQa:n(626).default,EditorProduct:n(619).default,EditorPayment:n(620).default,AttachmentUpload:n(621).default,Vditor:n(616).default,EditorToolBar:n(623).default,ImageUpload:n(624).default,VideoUpload:n(625).default,Caller:n(582).default})},588:function(t,e){},590:function(t,e,n){"use strict";var o=n(537);n.n(o).a},591:function(t,e,n){"use strict";n(51);e.a=function(t){return t[0]===t[1]&&"0"===t[0]&&(t=t.substr(0,1)),t.replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,"")}},592:function(t,e,n){},593:function(t,e,n){},594:function(t,e,n){},595:function(t,e,n){},597:function(t,e){t.exports={name:"isLogin",methods:{isLogin:function(){if(!this.$store.state.user.info.id){this.$message.error(this.$t("user.pleaseLogin"));var t=this.$route.fullPath;return this.forums&&this.forums.set_reg&&0===this.forums.set_reg.register_type?this.$router.push("/user/login?preurl=".concat(t)):this.forums&&this.forums.set_reg&&1===this.forums.set_reg.register_type?this.$router.push("/user/phone-login-register?preurl=".concat(t)):this.forums&&this.forums.set_reg&&2===this.forums.set_reg.register_type?this.forums&&this.forums.passport&&this.forums.passport.oplatform_close&&this.forums.passport.offiaccount_close?this.$router.push("/user/wechat?preurl=".concat(t)):this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_sms?this.$router.push("/user/phone-login-register?preurl=".concat(t)):this.$router.push("/user/login?preurl=".concat(t)):this.$router.push("/user/login?preurl=".concat(t)),!1}return!0}}}},600:function(t,e,n){"use strict";var o=n(542);n.n(o).a},601:function(t,e,n){"use strict";var o=n(543);n.n(o).a},602:function(t,e,n){"use strict";var o=n(544);n.n(o).a},603:function(t,e,n){"use strict";var o=n(545);n.n(o).a},604:function(t,e,n){"use strict";var o=n(546);n.n(o).a},605:function(t,e,n){"use strict";var o=n(547);n.n(o).a},606:function(t,e,n){"use strict";var o=n(548);n.n(o).a},607:function(t,e,n){"use strict";var o=n(549);n.n(o).a},608:function(t,e,n){"use strict";var o=n(550);n.n(o).a},609:function(t,e,n){"use strict";var o=n(551);n.n(o).a},610:function(t,e,n){"use strict";var o=n(552);n.n(o).a},611:function(t,e,n){"use strict";var o=n(553);n.n(o).a},612:function(t,e,n){"use strict";var o=n(554);n.n(o).a},613:function(t,e,n){"use strict";var o=n(555);n.n(o).a},614:function(t,e,n){"use strict";var o=n(556);n.n(o).a},615:function(t,e,n){"use strict";var o=n(557);n.n(o).a},616:function(t,e,n){"use strict";n.r(e);n(19),n(36),n(11),n(251);var o=n(33),r=n(518),c=n.n(r),l=n(649),d={name:"Vditor",mixins:[c.a],props:{showCaller:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},showEmoji:{type:Boolean,default:!1},text:{type:String,default:""},textLimit:{type:[Number,String],default:49999},textLength:{type:[Number,String],default:0},isEdit:{type:Boolean,default:!1},attachmentSizeLimit:{type:Number,default:1e21},imageAccept:{type:String,default:""},onUploadImage:{type:Boolean,default:!1},placeholder:{type:String,default:""},onPublish:{type:Boolean,default:!1}},data:function(){return{vditor:{},input:{},range:[]}},watch:{isEdit:{handler:function(t){t&&this.text&&this.vditor&&this.vditor.setValue(this.text,!1)},immediate:!0}},mounted:function(){l&&this.initVditor()},methods:{initVditor:function(){var t=this;this.vditor=new l("vditor",{minHeight:450,placeholder:this.placeholder,mode:"wysiwyg",tab:"    ",input:function(e){t.$emit("textChange",e)},toolbar:[{hotkey:"",name:"@",tipPosition:"ne",tip:"@ 好友",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.816" height="19.816" viewBox="0 0 19.816 19.816">\n   <path id="路径_965" data-name="路径 965" d="M67.565,65.963c0,6.137,4.261,9.862,10.128,9.862a14.524,14.524,0,0,0,4.032-.512c.66-.2.87-.54.87-.884a.611.611,0,0,0-.64-.606,1.994,1.994,0,0,0-.449.065A13.894,13.894,0,0,1,78,74.353c-5.236,0-8.79-3.073-8.79-8.334,0-5.038,3.363-8.549,8.427-8.549,4.481,0,8.227,2.691,8.227,7.525,0,2.821-.984,4.721-2.551,4.721a1.489,1.489,0,0,1-1.653-1.611V61.792a.727.727,0,0,0-.764-.811.741.741,0,0,0-.784.811v1.061h-.086a3.258,3.258,0,0,0-3.1-1.871c-2.474,0-4.214,2.058-4.214,5.009,0,2.98,1.729,5.057,4.252,5.057a3.3,3.3,0,0,0,3.172-2.1h.086a2.6,2.6,0,0,0,2.838,2.114c2.666,0,4.319-2.551,4.319-6.127,0-5.411-4.09-8.921-9.727-8.921-5.933,0-10.089,3.957-10.089,9.955Zm9.66,3.613c-1.72,0-2.8-1.387-2.8-3.595,0-2.169,1.089-3.557,2.809-3.557,1.748,0,2.857,1.36,2.857,3.52,0,2.207-1.128,3.632-2.866,3.632Z" transform="translate(-67.565 -56.008)" fill="#777"/>\n</svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showCaller")}},{hotkey:"",name:"#",tipPosition:"ne",tip:"新增话题",className:"right",icon:'<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1598001954510" class="icon" viewBox="0 0 1040 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5506" xmlns:xlink="http://www.w3.org/1999/xlink" width="203.125" height="200"><defs><style type="text/css"></style></defs><path d="M947.393251 679.125345 674.853042 679.125345l143.716192-556.918026c3.51915-13.677511-4.727675-27.656897-18.411325-31.184233-13.644765-3.545756-27.646664 4.678556-31.214932 18.386766L721.04713 295.052946 364.271424 295.052946l44.60694-172.84051c3.527336-13.675464-4.727675-27.646664-18.402115-31.174-13.661138-3.553942-27.65485 4.678556-31.208792 18.378579l-47.900963 185.645141L76.8022 295.062156c-14.114462 0-25.594935 11.480472-25.594935 25.603121 0 14.155395 11.488659 25.596981 25.594935 25.596981L298.143331 346.262258l-85.904509 332.872297L25.611308 679.134555c-14.130835 0-25.611308 11.480472-25.611308 25.603121 0 14.155395 11.488659 25.596981 25.611308 25.596981l173.439144 0-44.60694 172.830277c-3.527336 13.691837 4.694929 27.65485 18.394952 31.214932 2.156106 0.551562 4.304026 0.791016 6.402827 0.791016 11.408841 0 21.828145-7.656377 24.805966-19.199271l147.026588-569.732889 356.768543 0L621.937878 679.117159 384.087749 679.117159c-14.155395 0-25.596981 11.480472-25.596981 25.594935 0 14.163581 11.441587 25.605168 25.596981 25.605168l224.645386 0-44.604894 172.830277c-3.521197 13.691837 4.733814 27.65485 18.409279 31.216979 2.156106 0.541329 4.312212 0.788969 6.427386 0.788969 11.376095 0 21.779026-7.656377 24.781406-19.199271l47.900963-185.645141 285.769512 0c14.155395 0 25.594935-11.449773 25.594935-25.596981 0-14.130835-11.455913-25.611308-25.611308-25.611308L947.393251 679.125345zM998.617913 295.052946 896.193149 295.052946c-14.155395 0-25.594935 11.480472-25.594935 25.594935 0 14.155395 11.43954 25.596981 25.594935 25.596981l102.424764 0c14.153348 0 25.594935-11.441587 25.594935-25.596981C1024.212848 306.517045 1012.771261 295.052946 998.617913 295.052946L998.617913 295.052946zM998.617913 295.052946" p-id="5507" fill="#333" ></path></svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showTopic")}},{hotkey:"",name:"my-emoji",tipPosition:"ne",tip:"插入表情",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.819" height="19.816" viewBox="0 0 19.819 19.816">\n  <path id="路径_964" data-name="路径 964" d="M9.909,19.816A9.908,9.908,0,0,1,2.9,2.9,9.91,9.91,0,0,1,16.92,16.914a9.855,9.855,0,0,1-7.011,2.9Zm0-18.525A8.618,8.618,0,0,0,3.815,16,8.62,8.62,0,0,0,16.007,3.814a8.566,8.566,0,0,0-6.1-2.523ZM6.389,12.612a4.334,4.334,0,0,0,3.52,1.856,5.563,5.563,0,0,0,3.906-1.856.873.873,0,0,1,.876.928,5.954,5.954,0,0,1-4.782,2.165A4.649,4.649,0,0,1,5.586,13.54s-.032-.928.8-.928Zm.64-5.89A1.213,1.213,0,1,0,8.243,7.936,1.215,1.215,0,0,0,7.029,6.722Zm6.219,0a1.213,1.213,0,1,0,1.214,1.214,1.214,1.214,0,0,0-1.214-1.214Z" transform="translate(0)" fill="#777"/>\n</svg>',click:function(){t.range=getSelection().getRangeAt(0),t.$emit("onActions","showEmoji")}},"headings","bold","italic","strike","link","list","ordered-list","check","outdent","indent","quote",{hotkey:"",name:"picture",tipPosition:"ne",tip:"插入图片",className:"right",icon:'<svg xmlns="http://www.w3.org/2000/svg" width="19.816" height="19.816" viewBox="0 0 19.816 19.816">\n  <path id="路径_1180" data-name="路径 1180" d="M120.154,104.877a2.477,2.477,0,1,0,2.477,2.477,2.484,2.484,0,0,0-2.477-2.477Zm0,3.716a1.239,1.239,0,1,1,1.239-1.239A1.242,1.242,0,0,1,120.154,108.593Zm12.385-6.193H117.677a2.484,2.484,0,0,0-2.477,2.477v14.862a2.484,2.484,0,0,0,2.477,2.477h14.862a2.484,2.484,0,0,0,2.477-2.477V104.877A2.484,2.484,0,0,0,132.539,102.4Zm-14.862,18.578a1.242,1.242,0,0,1-1.238-1.238v-.557l4.892-4.4,6.254,6.193Zm16.1-1.238a1.242,1.242,0,0,1-1.239,1.238h-3.22l-4.521-4.644,5.264-5.264,3.716,3.716Zm0-6.75-3.716-3.777-6.131,6.254-2.539-2.539-4.954,4.521V104.877a1.242,1.242,0,0,1,1.238-1.238h14.862a1.242,1.242,0,0,1,1.239,1.238Z" transform="translate(-115.2 -102.4)" fill="#777"/>\n</svg>\n',click:function(){t.uploader()}},"line","code","inline-code","table","both","br","undo","redo"],toolbarConfig:{pin:!0},cache:{enable:!1}})},uploader:function(){var t=this;if(this.onUploadImage)return this.$message.warning("请等待上传中的图片完成上传");this.input=document.createElement("input"),this.input.type="file",this.input.multiple=!0,this.input.accept=this.imageAccept,this.input.dispatchEvent(new MouseEvent("click")),this.input.oninput=function(e){var n=e.target.files,o=[];if(t.checkSizeLimit(n)){for(var i=0;i<n.length;i++)o.push(n[i]);var r=o.reduce((function(e,n){return e.push(t.uploadFile(n)),e}),[]);t.uploadFiles(r)}}},uploadFile:function(t){var e=new FormData;return e.append("type",1),e.append("file",t),o.a.post("/attachments",e)},uploadFiles:function(t){var e=this;this.$emit("update:onUploadImage",!0),Promise.all(t).then((function(t){t.map((function(t){return t.data.data})).forEach((function(t){var html='<img src="'.concat(t.attributes.url,'" alt="').concat(t.attributes.fileName,'" title="').concat(t.id,'">'),n=e.vditor.html2md(html);e.vditor.insertValue(n.substr(0,n.length-1))})),e.input.value=""}),(function(t){e.input.value="",e.handleError(t).then((function(){}))})).finally((function(){e.$emit("update:onUploadImage",!1)}))},selectActions:function(code){var t=window.getSelection();t.removeAllRanges(),t.addRange(this.range),this.vditor.insertValue(code),this.$emit("hideActions")},checkSizeLimit:function(t){for(var e=!0,i=0;i<t.length;i++)t[i].size>this.attachmentSizeLimit&&(e=!1);return e||this.$message.error("图片大小不可超过 ".concat(this.attachmentSizeLimit/1024/1024," MB")),e},publish:function(){var t=this.vditor.getValue();this.$emit("textChange",t),this.$emit("publish")}}},h=(n(608),n(13)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.onUploadImage,expression:"onUploadImage"}],staticClass:"vditor-container",attrs:{"element-loading-background":"hsla(0,0%,100%,0.6)"}},[n("div",{staticClass:"sticky-box"},[n("topic-list",{directives:[{name:"show",rawName:"v-show",value:t.showTopic,expression:"showTopic"}],staticClass:"action-vditor",on:{selectedTopic:t.selectActions}}),t._v(" "),n("emoji-list",{directives:[{name:"show",rawName:"v-show",value:t.showEmoji,expression:"showEmoji"}],staticClass:"action-vditor",on:{selectEmoji:t.selectActions}})],1),t._v(" "),n("div",{attrs:{id:"vditor"}}),t._v(" "),t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.typeInformation.textLimit})))]):t._e(),t._v(" "),t.showCaller?n("caller",{on:{close:function(e){return t.$emit("close")},selectedCaller:t.selectActions}}):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:t.publish}},[t._v(t._s(t.$t("post.post")))])],1)}),[],!1,null,"1ca883d4",null);e.default=component.exports;installComponents(component,{TopicList:n(580).default,EmojiList:n(581).default,Caller:n(582).default})},617:function(t,e,n){"use strict";n.r(e);var o={name:"Popover",props:{visible:{type:Boolean,default:!1}}},r=(n(613),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-popover",{attrs:{placement:"bottom","min-width":"150",value:t.visible,trigger:"manual","popper-class":"popover"},on:{hide:function(e){return t.$emit("hide-pop")}}},[t._t("pop"),t._v(" "),n("template",{slot:"reference"},[t._t("activeNode")],2)],2)],1)}),[],!1,null,null,null);e.default=component.exports},618:function(t,e,n){"use strict";n.r(e);var o=n(85),r=n(518),c={name:"QaCaller",mixins:[n.n(r).a],data:function(){return{preQaUsers:{loading:!0,list:[]},currentQaUsers:{loading:!0,list:[]},nextQaUsers:{loading:!0,list:[]},preTimerId:null,nextTimerId:null,qaFriendsLoading:!1,selectedFriend:{},searchList:[],searchValue:"",searchTotal:10,loading:!1,setTimeoutId:null,pageLimit:10,pageNumber:1,pageLimitPagination:10,pageNumberPagination:1,totalPage:""}},computed:{noMore:function(){return!(!this.searchValue||this.loading)&&this.searchList.length>=this.searchTotal},disabled:function(){return this.loading||this.noMore}},mounted:function(){this.initUserList()},methods:{initUserList:function(){1===this.pageNumberPagination?(this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers)):this.pageNumberPagination===(this.totalPage||10)?(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination+1,this.currentQaUsers)):(this.getUserList(this.pageNumberPagination-1,this.preQaUsers),this.getUserList(this.pageNumberPagination,this.currentQaUsers),this.getUserList(this.pageNumberPagination+1,this.nextQaUsers))},getUserList:function(t,e){var n=this;if(!(e.list.length>0)){e.loading=!0;var r={"filter[canBeAsked]":"yes","page[limit]":this.pageLimitPagination,"page[number]":t};return this.$store.dispatch("jv/get",["/users",{params:r}]).then((function(data){var meta=data._jv.json.meta;n.totalPage=meta.pageCount,e.loading=!1,e.list=Object(o.a)(data)}),(function(t){return n.handleError(t)}))}},prePage:function(){var t=this;this.pageNumberPagination<=1||(this.$refs.currentQaUser.classList.add("transfer-right"),this.$refs.preQaUser.classList.add("transfer-right"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-right"),t.$refs.preQaUser.classList.remove("transfer-right"),t.nextQaUsers=t.currentQaUsers,t.currentQaUsers=t.preQaUsers,t.preQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination-=1,this.preTimerId&&window.clearTimeout(this.preTimerId),this.preTimerId=setTimeout((function(){t.preTimerId=null,t.initUserList()}),310))},nextPage:function(){var t=this;this.pageNumberPagination>=this.totalPage||(this.$refs.currentQaUser.classList.add("transfer-left"),this.$refs.nextQaUser.classList.add("transfer-left"),setTimeout((function(){t.$refs.currentQaUser.classList.remove("transfer-left"),t.$refs.nextQaUser.classList.remove("transfer-left"),t.preQaUsers=t.currentQaUsers,t.currentQaUsers=t.nextQaUsers,t.nextQaUsers={loading:!0,list:[]}}),300),this.pageNumberPagination+=1,this.nextTimerId&&window.clearTimeout(this.nextTimerId),this.nextTimerId=setTimeout((function(){t.initUserList(),t.nextTimerId=null}),310))},searchUser:function(t){var e=this;this.searchValue=t.target.value,this.pageNumber=1,this.searchList=[],this.setTimeoutId&&window.clearTimeout(this.setTimeoutId),this.searchValue&&(this.setTimeoutId=setTimeout((function(){e.loading=!0,e.getSearchList(),e.setTimeoutId=null}),300))},getSearchList:function(){var t=this,e={"filter[username]":"*"+this.searchValue+"*","filter[status]":"normal","page[limit]":this.pageLimit,"page[number]":this.pageNumber,"filter[canBeAsked]":"yes"};this.$store.dispatch("jv/get",["users",{params:e}]).then((function(data){var e,meta=data._jv.json.meta;t.loading=!1,t.searchTotal=meta.total,data.length>0&&(e=t.searchList).push.apply(e,Object(o.a)(data))}),(function(e){return t.handleError(e)}))},load:function(){this.searchValue&&this.searchList.length>0&&(this.loading=!0,this.pageNumber+=1,this.getSearchList())},selectFriendFromUl:function(t){this.selectedFriend=t,this.clear()},clear:function(){this.$refs.inputCaller.value="",this.searchValue="",this.searchList=[]}}},l=(n(603),n(13)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("post.callAnswer"),overflow:"visible"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"container-selectedCaller"},[n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.selectedFriend).length>0,expression:"Object.keys(selectedFriend).length > 0"}],staticClass:"selectedCaller"},[n("span",[t._v("@ "+t._s(t.selectedFriend.username))]),t._v(" "),n("svg-icon",{staticStyle:{"font-size":"14px",cursor:"pointer",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){t.selectedFriend={}}}})],1)]),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("post.searchFriendsCanBeAsd")))]),t._v(" "),n("div",{staticClass:"container-search-list"},[n("label",[n("input",{ref:"inputCaller",staticClass:"input-caller",attrs:{placeholder:t.$t("post.pleaseInput"),type:"text"},on:{input:t.searchUser}})]),t._v(" "),n("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[n("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.load,expression:"load"}],attrs:{"infinite-scroll-disabled":"disabled"}},t._l(t.searchList,(function(e,o){return n("li",{key:o,class:{"infinite-list-item":!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){return t.selectFriendFromUl(e)}}},[t._v(t._s(e.username))])})),0),t._v(" "),t.loading?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.loading")))]):t._e(),t._v(" "),t.noMore?n("p",{staticClass:"loading-tip"},[t._v(t._s(t.$t("core.noMoreData")))]):t._e()])]),t._v(" "),n("div",{staticClass:"friends"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.recommendAnswer")))]),t._v(" "),n("div",{staticClass:"container-user-list"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.preQaUsers.loading,expression:"preQaUsers.loading"}],ref:"preQaUser",staticClass:"container-caller prePage"},t._l(t.preQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.currentQaUsers.loading,expression:"currentQaUsers.loading"}],ref:"currentQaUser",staticClass:"container-caller currentPage"},t._l(t.currentQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.nextQaUsers.loading,expression:"nextQaUsers.loading"}],ref:"nextQaUser",staticClass:"container-caller nextPage"},t._l(t.nextQaUsers.list,(function(e,o){return n("div",{key:o,class:{caller:!0,selected:t.selectedFriend.username===e.username},on:{click:function(n){t.selectedFriend=e}}},[n("avatar",{attrs:{user:e,size:"30",round:"","prevent-jump":""}}),t._v(" "),n("span",[t._v(t._s(e.username))])],1)})),0)]),t._v(" "),t.totalPage?n("div",{staticClass:"container-pagination"},[n("div",{staticClass:"pagination"},[n("svg-icon",{class:{"page-button":!0,"pre-button":!0,disabled:t.pageNumberPagination<=1},attrs:{type:"drop-down"},on:{click:t.prePage}}),t._v(" "),n("span",[t._v(t._s(t.pageNumberPagination))]),t._v(" "),n("svg-icon",{class:{"page-button":!0,"next-button":!0,disabled:t.pageNumberPagination>=t.totalPage},attrs:{type:"drop-down"},on:{click:t.nextPage}})],1)]):t._e()])]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{disabled:0===Object.keys(t.selectedFriend).length,size:"medium",type:"primary"},on:{click:function(e){return t.$emit("selectedQaCaller",t.selectedFriend)}}},[t._v(t._s(t.$t("post.confirmChoice")))])],1)])])}),[],!1,null,"913aa11c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,Avatar:n(252).default,MessageBox:n(531).default})},619:function(t,e,n){"use strict";n.r(e);n(60),n(29),n(19),n(11),n(39);var o=n(9),r=n(536);function c(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}var l={name:"EditorProduct",mixins:[n.n(r).a],props:{product:{type:Object,default:function(){}}},data:function(){return{addedProduct:{},showProductDialog:!1,typeList:{1:"product-tmall",2:"product-jd",3:"product-pinduoduo",5:"product-taobao",7:"product-youzan"}}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}}},watch:{product:{handler:function(t){this.addedProduct=t},deep:!0}},mounted:function(){this.addedProduct=function(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?c(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):c(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}({},this.product)},methods:{inputedLink:function(t){this.addedProduct=t,this.showProductDialog=!1,this.$emit("productChange",t)},remove:function(){this.addedProduct={},this.$emit("productChange",this.addedProduct)}}},d=(n(604),n(13)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"product-container"},[n("div",{staticClass:"block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("permission.createThreadGoods"))+":")]),t._v(" "),n("span",{staticClass:"select-product",on:{click:function(e){t.showProductDialog=!0}}},[t._v("\n        "+t._s(Object.keys(t.addedProduct).length>0?"":"+"+t.$t("post.addProduct"))+"\n      ")])]),t._v(" "),Object.keys(t.addedProduct).length>0?n("div",{staticClass:"product-info"},[n("el-image",{staticClass:"image",attrs:{src:t.addedProduct.image_path}}),t._v(" "),n("div",{staticClass:"right"},[n("div",{staticClass:"title"},[t.typeList[t.addedProduct.type]&&t.addedProduct.title?n("svg-icon",{staticClass:"icon",attrs:{type:t.typeList[t.addedProduct.type]}}):t._e(),t._v("\n          "+t._s(t.addedProduct.title)+"\n        ")],1),t._v(" "),n("div",{staticClass:"bottom"},[n("span",{staticClass:"price"},[t._v(t._s(t.addedProduct.price>0?t.$t("post.yuanItem")+t.addedProduct.price+t.$t("post.yuan"):""))]),t._v(" "),n("svg-icon",{staticClass:"icon",attrs:{type:"delete"},on:{click:t.remove}})],1)])],1):t._e()]),t._v(" "),t.showProductDialog?n("product-dialog",{on:{close:function(e){t.showProductDialog=!1},inputedLink:t.inputedLink}}):t._e()],1)}),[],!1,null,"c13597fe",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,ProductDialog:n(622).default})},620:function(t,e,n){"use strict";n.r(e);n(251);var o=n(591),r={name:"EditorPayment",props:{payment:{type:Object,default:function(){}},type:{type:Number,default:0},canUploadAttachments:{type:Boolean,default:!1}},data:function(){return{freeWords:0,price:0,attachmentPrice:0,options:[{value:"free",label:this.$t("post.freeWatch")},{value:"paid",label:this.$t("post.paidWatch")}],freeWordsOptions:[{value:0,label:"0%"},{value:.1,label:"10%"},{value:.3,label:"30%"},{value:.5,label:"50%"},{value:.7,label:"70%"},{value:1,label:"100%"}]}},watch:{payment:{handler:function(t){this.freeWords=t.freeWords||0,this.price=t.price||0,this.attachmentPrice=t.attachmentPrice||0},immediate:!0,deep:!0},type:{handler:function(t){1===t&&this.canUploadAttachments&&this.options.push({value:"attachmentPaid",label:this.$t("post.postFreeAttachmentPaid")})},immediate:!0}},methods:{onPriceInput:function(t){this.price=Object(o.a)(t)},onAttachmentPriceInput:function(t){this.attachmentPrice=Object(o.a)(t)}}},c=(n(606),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("div",{staticClass:"block"},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.isPay"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.payment.paidType,placeholder:"请选择"},on:{change:function(e){return t.$emit("paymentChange",{key:"paidType",value:e})}}},t._l(t.options,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType,expression:"payment.paidType === 'paid'"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"price",value:parseFloat(t.price)})},input:t.onPriceInput},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"attachmentPaid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'attachmentPaid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.paymentAmount"))+":")]),t._v(" "),n("el-input",{attrs:{size:"medium",placeholder:"0",maxlength:"7"},on:{change:function(e){t.$emit("paymentChange",{key:"attachmentPrice",value:parseFloat(t.attachmentPrice)})},input:t.onAttachmentPriceInput},model:{value:t.attachmentPrice,callback:function(e){t.attachmentPrice=e},expression:"attachmentPrice"}},[n("span",{staticClass:"prefix",attrs:{slot:"prefix"},slot:"prefix"},[t._v("￥")])])],1)]),t._v(" "),n("div",{staticClass:"block"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"paid"===t.payment.paidType&&1===t.type,expression:"payment.paidType === 'paid' && type === 1"}]},[n("div",{staticClass:"text"},[t._v(t._s(t.$t("post.freeWord"))+":")]),t._v(" "),n("el-select",{attrs:{size:"medium",value:t.freeWords},on:{change:function(e){return t.$emit("paymentChange",{key:"freeWords",value:e})}}},t._l(t.freeWordsOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)])])}),[],!1,null,"68ed2d49",null);e.default=component.exports},621:function(t,e,n){"use strict";n.r(e);n(59),n(251);var o=n(518),r=n.n(o),c=n(578),l=n.n(c),d=n(532),h=n(579),f=n.n(h),m=n(33),v={name:"AttachmentUpload",mixins:[r.a,l.a,f.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},type:{type:Number,default:0}},data:function(){return{previewFiles:[]}},computed:{input:function(){return document.getElementById("upload")},service:function(){return m.a}},methods:{extensionValidate:function(t){var e=t.split(".")[t.split(".").length-1];return d.extensionList.indexOf(e.toUpperCase())>0?e.toUpperCase():"UNKNOWN"}}},_=(n(607),n(13)),component=Object(_.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[n("div",{staticClass:"upload"},[n("span",{staticClass:"attachment-list"},[t._v(t._s(t.$t("post.attachmentList")))]),t._v(" "),n("span",{staticClass:"add-attachment",on:{click:t.onClick}},[t._v(t._s(t.$t("post.addAttachment")))]),t._v(" "),n("input",{attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}})]),t._v(" "),t._l(t.previewFiles,(function(e,o){return n("div",{key:o,class:{"preview-item":!0,deleted:e.deleted}},[n("div",{staticClass:"container-item"},[n("div",{staticClass:"info"},[n("svg-icon",{staticStyle:{"font-size":"18px","vertical-align":"middle"},attrs:{type:t.extensionValidate(e.name)}}),t._v(" "),n("span",{class:{"file-name":!0,uploading:e.progress<100}},[t._v(t._s(e.name))])],1),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(parseInt((e.size/1024).toString()).toLocaleString())+" KB")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.progress<100,expression:"file.progress < 100"}],staticClass:"progress",style:{width:e.progress+"%"}})]),t._v(" "),n("div",{staticClass:"remove"},[n("svg-icon",{directives:[{name:"show",rawName:"v-show",value:e.progress&&100===e.progress,expression:"file.progress && file.progress === 100"}],staticClass:"remove-icon",attrs:{type:"delete"},on:{click:function(e){return t.removeItem(o)}}})],1)])}))],2)}),[],!1,null,"10e67521",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},622:function(t,e,n){"use strict";n.r(e);n(11),n(507);var o=n(518),r={name:"ProductDialog",mixins:[n.n(o).a],data:function(){return{supportedType:[{icon:"product-jd",text:this.$t("post.jd")},{icon:"product-taobao",text:this.$t("post.taobao")},{icon:"product-tmall",text:this.$t("post.tmall")},{icon:"product-pinduoduo",text:this.$t("post.pinduoduo")},{icon:"product-youzan",text:this.$t("post.youzan")}],link:"",loading:!1}},computed:{},mounted:function(){},methods:{handleLink:function(){var t=this;if(this.link){this.loading=!0;var e={_jv:{type:"goods/analysis"},type:"analysis",address:this.link};this.$store.dispatch("jv/post",e).then((function(e){e&&e._jv&&(t.link="",t.$emit("inputedLink",e))}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))}else this.$message.error(this.$t("post.goodsLinkEmpty"))}}},c=(n(605),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"message-box-product",attrs:{title:t.$t("post.addProduct"),overflow:"visible",width:"620px"},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"tips"},[t._v(t._s(t.$t("post.supportedLink")))]),t._v(" "),n("div",{staticClass:"supported-type"},t._l(t.supportedType,(function(e,o){return n("div",{key:o,staticClass:"item"},[n("svg-icon",{staticClass:"icon",attrs:{type:e.icon}}),t._v(t._s(e.text)+"\n      ")],1)})),0),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.link,expression:"link"}],staticClass:"input-link",attrs:{placeholder:t.$t("post.goodsLink")},domProps:{value:t.link},on:{input:function(e){e.target.composing||(t.link=e.target.value)}}})]),t._v(" "),n("div",{staticClass:"bottom"},[n("div",{staticClass:"container"},[n("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.handleLink}},[t._v(t._s(t.$t("discuzq.ok")))]),t._v(" "),n("el-button",{attrs:{size:"medium"},on:{click:function(e){return t.$emit("close")}}},[t._v(t._s(t.$t("post.cancel")))])],1)])])}),[],!1,null,"33d30d80",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,MessageBox:n(531).default})},623:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"EditorToolBar",props:{actions:{type:Array,default:function(){return[]}},showEmoji:{type:Boolean,default:!1},showTopic:{type:Boolean,default:!1},resources:{type:Array,default:function(){return[]}},textLimit:{type:[Number,String],default:450},textLength:{type:[Number,String],default:0},onPublish:{type:Boolean,default:!1},editorStyle:{type:String,default:"post"}}},r=(n(612),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:["editor-bar",t.editorStyle]},[n("div",{staticClass:"block"},[t._l(t.actions,(function(e,o){return[e.show&&"emoji"===e.icon?n("popover",{key:o,staticClass:"svg",attrs:{visible:t.showEmoji},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("emoji-list",{on:{selectEmoji:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):t._e(),t._v(" "),e.show&&"topic"===e.icon?n("popover",{key:o,staticClass:"svg",attrs:{visible:t.showTopic},on:{hidePop:function(e){return t.$emit("hidePop",e)}},scopedSlots:t._u([{key:"pop",fn:function(){return[n("topic-list",{on:{selectedTopic:function(e){return t.$emit("selectActions",e)}}})]},proxy:!0},{key:"activeNode",fn:function(){return[n("svg-icon",{staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}})]},proxy:!0}],null,!0)}):e.show&&"call"===e.icon?n("svg-icon",{key:o,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("onActions",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"block"},[t._l(t.resources,(function(e,o){return[e.show?n("svg-icon",{key:o,staticClass:"svg",staticStyle:{"font-size":"20px"},attrs:{type:e.icon},on:{click:function(n){return t.$emit("addResource",e.toggle)}}}):t._e()]}))],2),t._v(" "),n("div",{staticClass:"publish-container"},[t.textLimit?n("span",{staticClass:"tip"},[t._v(t._s(t.textLimit>=t.textLength?t.$t("post.note",{num:t.textLimit-t.textLength}):t.$t("post.exceed",{num:t.textLength-t.textLimit})))]):t._e(),t._v(" "),n("el-button",{staticClass:"button-publish",attrs:{loading:t.onPublish,type:"primary",size:"small"},on:{click:function(e){return t.$emit("publish")}}},[t._v(t._s(t.$t("post.post")))])],1)])}),[],!1,null,"7783e7e6",null);e.default=component.exports;installComponents(component,{EmojiList:n(581).default,SvgIcon:n(67).default,Popover:n(617).default,TopicList:n(580).default})},624:function(t,e,n){"use strict";n.r(e);n(251);var o=n(518),r=n.n(o),c=n(578),l=n.n(c),d=n(579),h=n.n(d),f=n(33),m={name:"ImageUpload",mixins:[r.a,l.a,h.a],props:{action:{type:String,default:"",required:!0},fileList:{type:Array,default:function(){return[]},required:!0},accept:{type:String,default:""},limit:{type:Number,default:9999},sizeLimit:{type:Number,default:1e17},onUpload:{type:Boolean,default:!1},type:{type:Number,default:0}},data:function(){return{previewFiles:[]}},computed:{input:function(){return document.getElementById("upload")},service:function(){return f.a}}},v=(n(614),n(13)),component=Object(v.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"container-upload"},[t._l(t.previewFiles,(function(image,e){return n("div",{key:e,class:{"preview-item":!0,deleted:image.deleted}},[n("img",{attrs:{src:image.url,alt:""}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"progress",attrs:{percentage:image.progress,color:"#25A9F6","show-text":!1}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:image.progress<100,expression:"image.progress < 100"}],staticClass:"cover"},[t._v("图片上传中...")]),t._v(" "),n("div",{class:{"upload-delete":!0,"show-delete":100===image.progress},on:{click:function(n){return t.removeItem(e)}}},[n("svg-icon",{staticStyle:{"font-size":"14px",fill:"white"},attrs:{type:"delete"}})],1)],1)})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.previewFiles.length<t.limit,expression:"previewFiles.length < limit"}],staticClass:"upload",on:{click:t.onClick}},[n("input",{attrs:{id:"upload",accept:t.accept,type:"file",multiple:""},on:{input:t.onInput}}),t._v(" "),n("svg-icon",{staticClass:"upload-icon",staticStyle:{fill:"#1878F3"},attrs:{type:"add"}})],1)],2)}),[],!1,null,"1dc1de81",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},625:function(t,e,n){"use strict";n.r(e);n(11),n(26);var o=n(85),r=(n(59),n(650)),c={name:"VideoUpload",props:{videoList:{type:Array,default:function(){return[]}},onUploadVideo:{type:Boolean,default:!1}},data:function(){return{showVideoPop:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},sizeLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_size:""},typesLimit:function(){return this.forums&&this.forums.qcloud?this.forums.qcloud.qcloud_vod_ext.split(",").map((function(t){return"."+t})).join(","):""}},methods:{handleVideoRemove:function(){var t=this;return this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),type:this.$t("discuzq.msgBox.cancel"),typeInformation:"warning"}).then((function(){t.$refs.upload.clearFiles(),setTimeout((function(){t.$emit("videoChange",{key:"videoList",value:[]})}),1e3)}),(function(){}))},addVideo:function(t){var e=this;if(!this.onUploadVideo){if(this.sizeLimit&&t.raw.size>1024*this.sizeLimit*1024)return this.$message.error(this.$t("profile.filesizecannotexceed")+this.sizeLimit+"MB"),void this.$refs.upload.clearFiles();if(!this.videoTypeCheck(t))return this.$message.error("暂不支持此类型的视频"),void this.$refs.upload.clearFiles();this.$emit("update:onUploadVideo",!0);var n=Object(o.a)(this.videoList);n.push({name:t.name,url:t.url,videoPercent:0}),this.$emit("videoChange",{key:"videoList",value:n}),this.getSignature((function(o){new r.default({getSignature:o}).upload({mediaFile:t.raw}).on("media_progress",(function(t){n[0].videoPercent=t.percent,e.$emit("videoChange",{key:"videoList",value:n})})).done().then((function(t){e.postVideo(t.fileId)}))}))}},videoTypeCheck:function(t){var e=t.name.split(".")[t.name.split(".").length-1].toLowerCase();return!("m3u8"===e||this.typesLimit.indexOf(e.toLowerCase())<0)},getSignature:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.$store.dispatch("jv/get",["signature",{}]).then((function(e){t((function(){return e.signature}))}))},postVideo:function(t){var e=this,n={_jv:{type:"thread/video"},file_id:t};this.$store.dispatch("jv/post",n).then((function(data){var t=Object(o.a)(e.videoList);t[0].id=data.file_id,e.$emit("videoChange",{key:"videoList",value:t})}),(function(t){return e.handleError(t)})).finally((function(){e.$emit("update:onUploadVideo",!1)}))},handleError:function(){this.$emit("update:onUploadVideo",!1),this.$message.error(this.$t("post.videoUploadFail"))}}},l=(n(615),n(13)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.videoList[0]?n("div",{staticClass:"video-upload"},[n("video",{ref:"video",staticClass:"video",attrs:{src:t.videoList[0].url,controls:!1}}),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{url:t.videoList[0].url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),n("svg-icon",{staticClass:"icon-play",staticStyle:{"font-size":"30px"},attrs:{type:"video-play"},on:{click:function(e){t.showVideoPop=!0}}}),t._v(" "),n("svg-icon",{staticClass:"icon-delete",staticStyle:{"font-size":"22px"},attrs:{type:"delete-red"},on:{click:t.handleVideoRemove}}),t._v(" "),n("el-progress",{directives:[{name:"show",rawName:"v-show",value:t.videoList[0].videoPercent<1,expression:"videoList[0].videoPercent < 1"}],staticClass:"progress",attrs:{percentage:100*t.videoList[0].videoPercent,color:"#25A9F6","show-text":!1}})],1):t._e(),t._v(" "),n("el-upload",{directives:[{name:"show",rawName:"v-show",value:!t.videoList[0],expression:"!videoList[0]"}],ref:"upload",staticClass:"image-upload",attrs:{"list-type":"picture-card",accept:t.typesLimit,action:"","auto-upload":!1,limit:1,disabled:t.videoList.length>0,"on-change":t.addVideo,"on-error":t.handleError}},[n("i",{staticClass:"el-icon-plus"})])],1)}),[],!1,null,"3be5bd55",null);e.default=component.exports;installComponents(component,{VideoPop:n(533).default,SvgIcon:n(67).default})},626:function(t,e,n){"use strict";n.r(e);var o=n(536),r={name:"EditorQa",mixins:[n.n(o).a],props:{question:{type:Object,default:function(){}}},data:function(){return{beAskedUser:{},showQACaller:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},canSetOnlooker:function(){return!!(this.forums&&this.forums.other&&this.forums.other.can_be_onlooker)&&this.forums.other.can_be_onlooker},siteOnlookerPrice:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_onlooker_price:""},siteMasterScale:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_master_scale/10:""},siteUserScale:function(){return this.siteMasterScale?1-this.siteMasterScale:""}},watch:{question:{handler:function(t){t.beUser&&(this.beAskedUser=t.beUser)},deep:!0,immediate:!0}},mounted:function(){this.question.beUser&&(this.beAskedUser=this.question.beUser)},methods:{selectedQaCaller:function(t){this.beAskedUser=t,this.showQACaller=!1,this.$emit("beUserChange",t)}}},c=(n(601),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qa"},[n("div",{staticClass:"qa-payment block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.questionMode"))+":")]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"free"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.freeWatch")))]),t._v(" "),n("el-radio",{attrs:{value:t.question.paymentType,label:"paid"},on:{input:function(e){return t.$emit("paymentTypeChange",e)}}},[t._v(t._s(t.$t("post.paidWatch")))])],1),t._v(" "),n("div",{staticClass:"qa-anonymous block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.anonymous"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isAnonymous,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isAnonymousChange",e)}}})],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.canSetOnlooker,expression:"canSetOnlooker"}],staticClass:"qa-onlooker block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("post.onLooker"))+":")]),t._v(" "),n("el-switch",{attrs:{value:t.question.isOnlooker,"active-color":"#1878F3"},on:{input:function(e){return t.$emit("isOnlookerChange",e)}}}),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.siteOnlookerPrice&&t.siteMasterScale&&t.siteUserScale,expression:"siteOnlookerPrice && siteMasterScale && siteUserScale"}],staticClass:"tip"},[n("span",[t._v(t._s("他人围观需付费 "+t.siteOnlookerPrice+" 元"))]),t._v(" "),n("span",[t._v(t._s("（你得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元，回答者得 "+(t.siteOnlookerPrice*t.siteUserScale/2).toFixed(2)+" 元，平台得 "+(t.siteOnlookerPrice*t.siteMasterScale).toFixed(2)+" 元）"))])])],1),t._v(" "),n("div",{staticClass:"qa-answerer block"},[n("div",{staticClass:"title"},[n("span",[t._v(t._s(t.$t("post.questionHim"))+":")]),t._v(" "),n("span",{staticClass:"select-answerer",on:{click:function(e){t.showQACaller=!0}}},[t._v("\n        "+t._s(Object.keys(t.beAskedUser).length>0?t.$t("post.changeBeAskedUser"):t.$t("post.addBeAskedUser"))+"\n      ")])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:Object.keys(t.beAskedUser).length>0,expression:"Object.keys(beAskedUser).length > 0"}],staticClass:"be-asked-user"},[n("avatar-component",{attrs:{author:t.beAskedUser,size:50,round:""}},[t._v("\n        "+t._s(t.$t("topic.activeAt"))+" "+t._s(t.timerDiff(t.beAskedUser.updatedAt))+t._s(t.$t("topic.before"))+"\n      ")])],1)]),t._v(" "),t.showQACaller?n("qa-caller",{on:{close:function(e){t.showQACaller=!1},selectedQaCaller:t.selectedQaCaller}}):t._e()],1)}),[],!1,null,"1935ce69",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(570).default,QaCaller:n(618).default})},627:function(t,e,n){t.exports=function(){"use strict";var t="millisecond",e="second",n="minute",o="hour",i="day",s="week",u="month",a="quarter",r="year",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[^0-9]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?.?(\d{1,3})?$/,l=/\[([^\]]+)]|Y{2,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(t,e,n){var o=String(t);return!o||o.length>=e?t:""+Array(e+1-o.length).join(n)+t},h={s:d,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),o=Math.floor(n/60),i=n%60;return(e<=0?"+":"-")+d(o,2,"0")+":"+d(i,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var o=12*(n.year()-e.year())+(n.month()-e.month()),i=e.add(o,u),s=n-i<0,a=e.add(o+(s?-1:1),u);return+(-(o+(n-i)/(s?i-a:a-i))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(c){return{M:u,y:r,w:s,d:i,D:"date",h:o,m:n,s:e,ms:t,Q:a}[c]||String(c||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},m="en",v={};v[m]=f;var _=function(t){return t instanceof C},y=function(t,e,n){var o;if(!t)return m;if("string"==typeof t)v[t]&&(o=t),e&&(v[t]=e,o=t);else{var i=t.name;v[i]=t,o=i}return!n&&o&&(m=o),o||!n&&m},g=function(t,e){if(_(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new C(n)},w=h;w.l=y,w.i=_,w.w=function(t,e){return g(t,{locale:e.$L,utc:e.$u,$offset:e.$offset})};var C=function(){function d(t){this.$L=this.$L||y(t.locale,null,!0),this.parse(t)}var h=d.prototype;return h.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(w.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var o=e.match(c);if(o){var i=o[2]-1||0;return n?new Date(Date.UTC(o[1],i,o[3]||1,o[4]||0,o[5]||0,o[6]||0,o[7]||0)):new Date(o[1],i,o[3]||1,o[4]||0,o[5]||0,o[6]||0,o[7]||0)}}return new Date(e)}(t),this.init()},h.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},h.$utils=function(){return w},h.isValid=function(){return!("Invalid Date"===this.$d.toString())},h.isSame=function(t,e){var n=g(t);return this.startOf(e)<=n&&n<=this.endOf(e)},h.isAfter=function(t,e){return g(t)<this.startOf(e)},h.isBefore=function(t,e){return this.endOf(e)<g(t)},h.$g=function(t,e,n){return w.u(t)?this[e]:this.set(n,t)},h.year=function(t){return this.$g(t,"$y",r)},h.month=function(t){return this.$g(t,"$M",u)},h.day=function(t){return this.$g(t,"$W",i)},h.date=function(t){return this.$g(t,"$D","date")},h.hour=function(t){return this.$g(t,"$H",o)},h.minute=function(t){return this.$g(t,"$m",n)},h.second=function(t){return this.$g(t,"$s",e)},h.millisecond=function(e){return this.$g(e,"$ms",t)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(t,a){var c=this,l=!!w.u(a)||a,d=w.p(t),h=function(t,e){var n=w.w(c.$u?Date.UTC(c.$y,e,t):new Date(c.$y,e,t),c);return l?n:n.endOf(i)},f=function(t,e){return w.w(c.toDate()[t].apply(c.toDate("s"),(l?[0,0,0,0]:[23,59,59,999]).slice(e)),c)},m=this.$W,v=this.$M,_=this.$D,y="set"+(this.$u?"UTC":"");switch(d){case r:return l?h(1,0):h(31,11);case u:return l?h(1,v):h(0,v+1);case s:var g=this.$locale().weekStart||0,C=(m<g?m+7:m)-g;return h(l?_-C:_+(6-C),v);case i:case"date":return f(y+"Hours",0);case o:return f(y+"Minutes",1);case n:return f(y+"Seconds",2);case e:return f(y+"Milliseconds",3);default:return this.clone()}},h.endOf=function(t){return this.startOf(t,!1)},h.$set=function(s,a){var c,l=w.p(s),d="set"+(this.$u?"UTC":""),h=(c={},c.day=d+"Date",c.date=d+"Date",c[u]=d+"Month",c[r]=d+"FullYear",c[o]=d+"Hours",c[n]=d+"Minutes",c[e]=d+"Seconds",c[t]=d+"Milliseconds",c)[l],f=l===i?this.$D+(a-this.$W):a;if(l===u||l===r){var m=this.clone().set("date",1);m.$d[h](f),m.init(),this.$d=m.set("date",Math.min(this.$D,m.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},h.set=function(t,e){return this.clone().$set(t,e)},h.get=function(t){return this[w.p(t)]()},h.add=function(t,a){var c,l=this;t=Number(t);var d=w.p(a),h=function(e){var n=g(l);return w.w(n.date(n.date()+Math.round(e*t)),l)};if(d===u)return this.set(u,this.$M+t);if(d===r)return this.set(r,this.$y+t);if(d===i)return h(1);if(d===s)return h(7);var f=(c={},c[n]=6e4,c[o]=36e5,c[e]=1e3,c)[d]||1,m=this.$d.getTime()+t*f;return w.w(m,this)},h.subtract=function(t,e){return this.add(-1*t,e)},h.format=function(t){var e=this;if(!this.isValid())return"Invalid Date";var n=t||"YYYY-MM-DDTHH:mm:ssZ",o=w.z(this),i=this.$locale(),s=this.$H,u=this.$m,a=this.$M,r=i.weekdays,c=i.months,d=function(t,o,i,s){return t&&(t[o]||t(e,n))||i[o].substr(0,s)},h=function(t){return w.s(s%12||12,t,"0")},f=i.meridiem||function(t,e,n){var o=t<12?"AM":"PM";return n?o.toLowerCase():o},m={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:w.s(a+1,2,"0"),MMM:d(i.monthsShort,a,c,3),MMMM:d(c,a),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:d(i.weekdaysMin,this.$W,r,2),ddd:d(i.weekdaysShort,this.$W,r,3),dddd:r[this.$W],H:String(s),HH:w.s(s,2,"0"),h:h(1),hh:h(2),a:f(s,u,!0),A:f(s,u,!1),m:String(u),mm:w.s(u,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:o};return n.replace(l,(function(t,e){return e||m[t]||o.replace(":","")}))},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(t,c,l){var d,h=w.p(c),f=g(t),m=6e4*(f.utcOffset()-this.utcOffset()),v=this-f,_=w.m(this,f);return _=(d={},d[r]=_/12,d[u]=_,d[a]=_/3,d[s]=(v-m)/6048e5,d.day=(v-m)/864e5,d[o]=v/36e5,d[n]=v/6e4,d[e]=v/1e3,d)[h]||v,l?_:w.a(_)},h.daysInMonth=function(){return this.endOf(u).$D},h.$locale=function(){return v[this.$L]},h.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),o=y(t,e,!0);return o&&(n.$L=o),n},h.clone=function(){return w.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},d}();return g.prototype=C.prototype,g.extend=function(t,e){return t(e,C,g),g},g.locale=y,g.isDayjs=_,g.unix=function(t){return g(1e3*t)},g.en=v[m],g.Ls=v,g}()},628:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"Loading",props:{loading:{type:Boolean,default:!1},fontSize:{type:Number,default:32}}},r=(n(629),n(13)),component=Object(r.a)(o,(function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"loading-container"},[this._v("\n  "+this._s(this.$t("discuzq.list.loading"))+"...\n")])}),[],!1,null,"10c555d3",null);e.default=component.exports},629:function(t,e,n){"use strict";var o=n(573);n.n(o).a},630:function(t,e,n){"use strict";var o=n(574);n.n(o).a},634:function(t,e,n){n(26);var o=n(506);t.exports={methods:{createAttachmentsData:function(t){return t.map((function(t){var e={};return e.id=t.id,e.type="attachments",e}))},publishPostResource:function(t,e){var n,r,c=this.createAttachmentsData(e.imageList),l=this.createAttachmentsData(e.attachedList);(c.length>0||l.length>0)&&(t._jv.relationships.attachments={},t._jv.relationships.attachments.data=[],(n=t._jv.relationships.attachments.data).push.apply(n,o(c)),(r=t._jv.relationships.attachments.data).push.apply(r,o(l)));return t},publishAnswerResource:function(t,e){var n,r,c=this.createAttachmentsData(e.imageList),l=this.createAttachmentsData(e.attachedList);(c.length>0||l.length>0)&&(t.relationships.attachments={},t.relationships.attachments.data=[],(n=t.relationships.attachments.data).push.apply(n,o(c)),(r=t.relationships.attachments.data).push.apply(r,o(l)));return t},publishThreadResource:function(t,e){return e.videoList.length>0&&(t.file_id=this.post.videoList[0].id,t.file_name=this.post.videoList[0].name),t},publishPayment:function(t,e){return t.price=0,t.free_words=0,t.attachment_price=0,"attachmentPaid"===e.paidType?t.attachment_price=e.attachmentPrice:"paid"===e.paidType&&(t.price=e.price,t.free_words=e.freeWords),t},publishLocation:function(t,e){return t.location=e.location?e.location:"",t.latitude=e.latitude?e.latitude:"",t.longitude=e.longitude?e.longitude:"",t},publishQuestion:function(t,e){t.is_anonymous=e.isAnonymous,t._jv.relationships.question={},t._jv.relationships.question.data={};var data=t._jv.relationships.question.data;return data.be_user_id=e.beUser._jv.id,data.order_id=e.orderId||"",data.price=e.price||0,data.is_onlooker=e.isOnlooker,t},publishProduct:function(t,e){return t.post_goods_id=e&&e._jv&&e._jv.id||"",t},deleteAttachmentsAfterEdit:function(t,e){var n=this,o=e.map((function(t){return t.id}));t.map((function(t){return t._jv.id})).filter((function(t){return o.indexOf(t)<0})).forEach((function(t){n.$store.dispatch("jv/delete",["/attachments/".concat(t),{}]).catch((function(){return""}))}))}}}},635:function(t,e,n){},636:function(t,e,n){},637:function(t,e,n){},638:function(t,e,n){},639:function(t,e,n){},640:function(t,e,n){},641:function(t,e,n){},642:function(t,e,n){},644:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(26),n(627)),c=n.n(r),l=n(518),d={name:"ChatBox",mixins:[n.n(l).a],props:{dialog:{type:Object,default:function(){}}},data:function(){return{recordList:[],recordTotal:0,pageLimit:10,pollId:"",loading:!1,onChatPublish:!1,chatContent:{text:"",imageList:[],attachedList:[]},chatType:{type:10,textLimit:450,showPayment:!1,showTitle:!1,showImage:!1,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!1,placeholder:"请输入 ..."},loadMoreMessage:!1}},computed:{userId:function(){return this.$store.getters["session/get"]("userId")},noMore:function(){return this.recordList.length===this.recordTotal}},watch:{dialog:{handler:function(t){var e=this;this.loading=!0,t.id&&t.name?this.getChatRecord(t.id).then((function(){e.loading=!1,e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight}))})):this.loading=!1},deep:!0,immediate:!0}},mounted:function(){this.activePolling(),this.scrollListener()},beforeDestroy:function(){window.clearInterval(this.pollId)},methods:{scrollListener:function(){var t=this;this.$refs.chatContent.addEventListener("scroll",(function(e){if(0===e.target.scrollTop){if(t.loadMoreMessage)return;t.loadMoreMessage=!0,t.pageLimit+=10,t.getChatRecord(t.dialog.id)}}))},activePolling:function(){var t=this;this.pollId=window.setInterval((function(){t.dialog.id&&t.getChatRecord(t.dialog.id)}),1500)},getChatRecord:function(t){var e=this,n={"filter[dialog_id]":t,include:"user,user.groups","page[number]":1,"page[limit]":this.pageLimit,sort:"-createdAt"};return this.$store.dispatch("jv/get",["dialog/message",{params:n}]).then((function(t){var n=t._jv.json.meta.total;e.recordList=Object(o.a)(t).reverse(),e.onChatPublish=!1,e.recordTotal===n||e.loadMoreMessage||e.$nextTick((function(){e.$refs.chatContent.scrollTop=e.$refs.chatContent.scrollHeight})),e.loadMoreMessage=!1,e.recordTotal=n}),(function(t){return e.handleError(t)}))},formatDate:function(t){return c()(new Date(t)).format("YYYY-MM-DD HH:mm")},postMessage:function(){var t=this,e={_jv:{type:"dialog/message"},dialog_id:this.dialog.id,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(){t.getChatRecord(t.dialog.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},createDialogAndPost:function(){var t=this,e={_jv:{type:"dialog"},recipient_username:this.dialog.name,message_text:this.chatContent.text};this.$store.dispatch("jv/post",e).then((function(e){t.getChatRecord(e._jv.id),t.chatContent.text=""}),(function(e){t.onChatPublish=!1,t.handleError(e)}))},chatPublish:function(){return this.chatContent.text?this.chatContent.text.length>450?this.$message.warning(this.$t("chat.messageLengthCannotOver")):void(this.onChatPublish||(this.onChatPublish=!0,this.dialog.id?this.postMessage():this.createDialogAndPost())):this.$message.warning(this.$t("chat.messageCannotBeBlack"))}}},h=(n(630),n(13)),component=Object(h.a)(d,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"chat-box"},[n("div",{staticClass:"header"},[n("span",{staticClass:"name"},[t._v(t._s(t.dialog.name))]),t._v(" "),n("span",[t._v(t._s(t.$t("chat.chatWithYou")))]),t._v(" "),n("svg-icon",{staticClass:"icon-close",staticStyle:{"font-size":"16px",fill:"#6d6d6d"},attrs:{type:"close"},on:{click:function(e){return t.$emit("close")}}})],1),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"chatContent",staticClass:"chat-content",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[t.loadMoreMessage?n("div",{staticClass:"load-tip"},[t._v(t._s(t.noMore?t.$t("chat.noMore"):t.$t("chat.loadRecord")))]):t._e(),t._v(" "),t._l(t.recordList,(function(e,o){return n("div",{key:o,staticClass:"record"},[e.user_id===parseInt(t.userId)?n("div",{staticClass:"record-item mine"},[n("div",{staticClass:"message"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}}),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])]),t._v(" "),n("Avatar",{attrs:{user:e.user,size:50}})],1):n("div",{staticClass:"record-item his"},[n("Avatar",{attrs:{user:e.user,size:50}}),t._v(" "),n("div",{staticClass:"message"},[n("div",{staticClass:"message-box"},[n("div",{staticClass:"message-box",domProps:{innerHTML:t._s(t.$xss(e.message_text_html))}})]),t._v(" "),n("div",{staticClass:"created-at"},[t._v(t._s(t.formatDate(e.updated_at)))])])],1)])}))],2),t._v(" "),n("editor",{staticClass:"chat-editor",attrs:{"editor-style":"chat",selector:"chat-editor","type-information":t.chatType,post:t.chatContent,"on-publish":t.onChatPublish},on:{"update:post":function(e){t.chatContent=e},publish:t.chatPublish}}),t._v(" "),n("Cover")],1)}),[],!1,null,"51058ffb",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,Avatar:n(252).default,Editor:n(585).default,Cover:n(523).default})},651:function(t,e,n){"use strict";var o=n(592);n.n(o).a},652:function(t,e,n){"use strict";var o=n(593);n.n(o).a},653:function(t,e,n){"use strict";var o=n(594);n.n(o).a},654:function(t,e,n){"use strict";var o=n(595);n.n(o).a},655:function(t,e){t.exports={methods:{postLegalityCheck:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.$t("topic.publishExamineTip");0===t.isApproved?this.$message.warning(n):this.$message.success(e)}}}},656:function(t,e,n){"use strict";n.r(e);n(32);var o=n(7),r=(n(51),n(5)),c=n(518),l=n.n(c),d=n(577),h={name:"FindPaypwd",mixins:[n.n(d).a,l.a],props:{mobile:{type:String,default:""},phonenum:{type:String,default:""}},data:function(){return{phoneNumber:"",isVerifyDisabled:!0,canCountDown:!1,countDownSecond:60,loading:!1,verifyCode:"",newPassword:"",newPasswordRepeat:"",username:"",realphoneNumber:"",userId:this.$store.getters["session/get"]("userId")}},mounted:function(){this.phoneNumber=this.mobile,this.realphoneNumber=this.phonenum},methods:{onInput:function(t){this.phoneNumber=t.target.value.replace(/[^\d]/g,""),this.isVerifyDisabled=11!==this.phoneNumber.length},countDown:function(t){var e=this;this.canCountDown=!0,this.countDownSecond=t;var n=setInterval((function(){e.countDownSecond-=1,0===e.countDownSecond&&(e.canCountDown=!1,clearInterval(n))}),1e3)},sendVerifyCode:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={_jv:{type:"sms/send"},mobile:t.realphoneNumber,type:"reset_pay_pwd"},e.next=3,t.checkCaptcha(n);case 3:n=e.sent,r.status.run((function(){return t.$store.dispatch("jv/post",n)})).then((function(e){e.interval&&t.countDown(e.interval)}),(function(e){var n=e.response.data.errors;if(n[0])return t.$message.error(n[0].detail[0])}));case 5:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;if(""===this.verifyCode)this.$message.error("验证码不能为空");else if(""===this.newPassword)this.$message.error("新密码不能为空");else if(""===this.newPasswordRepeat)this.$message.error("重复密码不能为空");else if(this.newPassword!==this.newPasswordRepeat)this.$message.error("二次密码输入不一致");else{var e={_jv:{type:"sms/verify"},mobile:this.realphoneNumber,code:this.verifyCode,pay_password:this.newPassword,pay_password_confirmation:this.newPasswordRepeat,type:"reset_pay_pwd"};r.status.run((function(){return t.$store.dispatch("jv/post",e)})).then((function(){t.$message.success(t.$t("modify.paymentsucceed")),t.$emit("close")}),(function(e){return t.handleError(e)}))}}}},f=(n(652),n(13)),component=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+" "},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"retrieve-inputs"},[n("label",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.phoneNumber,expression:"phoneNumber"}],attrs:{maxlength:"11",type:"text",placeholder:t.$t("modify.placeEnterRegisteredPhone")},domProps:{value:t.phoneNumber},on:{input:function(e){e.target.composing||(t.phoneNumber=e.target.value)}}}),t._v(" "),t.canCountDown?n("button",{class:{disabled:t.canCountDown},attrs:{disabled:t.canCountDown}},[t._v(t._s(t.countDownSecond+t.$t("modify.retransmission")))]):n("button",{staticClass:"sendbtn",on:{click:t.sendVerifyCode}},[t._v("\n          "+t._s(t.$t("modify.sendVerifyCode"))+"\n        ")])]),t._v(" "),n("el-input",{attrs:{maxlength:"6",placeholder:t.$t("modify.placeEnterCode")},model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}}),t._v(" "),n("el-input",{attrs:{placeholder:"请输入新支付密码","show-password":""},model:{value:t.newPassword,callback:function(e){t.newPassword=e},expression:"newPassword"}}),t._v(" "),n("el-input",{attrs:{placeholder:"请重新输入新支付密码","show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submit(e)}},model:{value:t.newPasswordRepeat,callback:function(e){t.newPasswordRepeat=e},expression:"newPasswordRepeat"}})],1),t._v(" "),n("button",{staticClass:"submit",on:{click:t.submit}},[t._v(t._s(t.$t("modify.newPayPwdTitle")))])])])}),[],!1,null,"7d5bc971",null);e.default=component.exports;installComponents(component,{Message:n(571).default})},657:function(t,e,n){"use strict";n.r(e);var o={name:"WalletPassword",data:function(){return{}},methods:{tobind:function(){this.$router.push("/my/profile?phonebind=true")}}},r=(n(653),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+" "},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("modify.nohasphon")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",[t._v(t._s(t.$t("modify.forgetPassword")+"/"+t.$t("modify.retrievePassword")+",需要您先绑定常用手机号码"))])]),t._v(" "),n("el-button",{staticClass:"btn",attrs:{type:"primary"},on:{click:t.tobind}},[t._v("前去绑定")])],1)])])}),[],!1,null,"0d299855",null);e.default=component.exports;installComponents(component,{Message:n(571).default})},658:function(t,e,n){"use strict";n.r(e);var o={name:"TopicWxPay",props:{qrCode:{type:String,default:""}}},r=(n(654),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.pay")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"title"},[n("svg-icon",{staticStyle:{fill:"#09BB07","font-size":"30px"},attrs:{type:"wechat"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPay")))])],1),t._v(" "),n("div",{staticClass:"tip"},[t._v(t._s(t.$t("pay.wechatTimeLimit")))]),t._v(" "),n("div",{staticClass:"container-qr-code"},[n("img",{staticStyle:{width:"138px",height:"138px"},attrs:{src:t.qrCode,alt:"qr-code"}})]),t._v(" "),n("div",{staticClass:"scan-tip"},[n("svg-icon",{staticStyle:{display:"block","font-size":"32px"},attrs:{type:"wx-scan"}}),t._v(" "),n("div",{staticClass:"tip"},[n("span",[t._v(t._s(t.$t("pay.wechatScan")))]),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wechatScanPay")))])])],1)])])}),[],!1,null,"6b0f2990",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,MessageBox:n(531).default})},696:function(t,e,n){"use strict";var o=n(635);n.n(o).a},697:function(t,e,n){"use strict";var o=n(636);n.n(o).a},698:function(t,e,n){"use strict";var o=n(637);n.n(o).a},700:function(t,e,n){"use strict";var o=n(638);n.n(o).a},701:function(t,e,n){"use strict";var o=n(639);n.n(o).a},702:function(t,e,n){n(11),t.exports={data:function(){return{orderNo:"",paymentType:0,paymentStatus:0}},methods:{createOrder:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(!this.defaultLoading){this.defaultLoading=!0;var l={_jv:{type:"/orders"},is_anonymous:t,type:o,amount:n};return c&&(l.payee_id=c),this.threadId&&(l.thread_id=this.threadId),this.$store.dispatch("jv/post",l).then((function(data){e.orderNo=data.order_sn,e.paymentType=r}),(function(t){return e.handleError(t)}))}},payOrder:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n={_jv:{type:"/trade/pay/order/".concat(this.orderNo)},order_sn:this.orderNo,payment_type:this.paymentType,pay_password:e};return this.$store.dispatch("jv/post",n).then((function(data){return 10===t.paymentType?data.wechat_qrcode:(t.$message.success(t.$t("pay.paySuccess")),t.passwordError=!1,t.showPasswordInput=!1,t.orderNo)}),(function(e){var n=e.response.data.errors;return"pay_password_failures_times_toplimit"===n[0].code?(t.passwordError=!0,t.passwordErrorTip=t.$t("core.pay_password_failures_times_toplimit"),Promise.reject()):"validation_error"===n[0].code?(t.passwordError=!0,t.passwordErrorTip=n[0].detail[0],Promise.reject()):void t.handleError(e)}))},wxPayActive:function(){var t=this;return this.showWxPay=!0,new Promise((function(e,n){var o=setInterval((function(){1===t.paymentStatus&&(clearInterval(o),t.showWxPay=!1,t.$message.success(t.$t("pay.paySuccess")),e(t.orderNo)),t.showWxPay||(clearInterval(o),n()),t.getOrderStatus()}),1e3)}))},getOrderStatus:function(){var t=this,e={_jv:{type:"/orders/".concat(this.orderNo)},orderNo:this.orderNo};return this.$store.dispatch("jv/get",e).then((function(data){t.paymentStatus=data.status}),(function(e){return t.handleError(e)}))},onFindPassword:function(){this.showPasswordInput=this.passwordError=!1,this.passwordErrorTip="",this.findPassword=!0}}}},704:function(t,e,n){"use strict";var o=n(640);n.n(o).a},705:function(t,e,n){"use strict";var o=n(641);n.n(o).a},706:function(t,e,n){"use strict";var o=n(642);n.n(o).a},724:function(t,e,n){},725:function(t,e,n){},726:function(t,e,n){},727:function(t,e,n){},728:function(t,e,n){},729:function(t,e,n){},730:function(t,e,n){},731:function(t,e,n){},732:function(t,e,n){},733:function(t,e,n){},743:function(t,e,n){"use strict";n.r(e);n(59),n(51);var o=n(85),r=(n(251),n(534)),c=n(597),l=n.n(c),d=(n(254),n(255)),h=n.n(d),f={props:{images:{type:Array},rebuild:{type:Boolean,default:!1},trigger:{},options:{type:Object}},data:function(){return{}},computed:{},methods:{onChange:function(){this.rebuild?this.rebuildViewer():this.updateViewer()},rebuildViewer:function(){this.destroyViewer(),this.createViewer()},updateViewer:function(){this.$viewer?(this.$viewer.update(),this.$emit("inited",this.$viewer)):this.createViewer()},destroyViewer:function(){this.$viewer&&this.$viewer.destroy()},createViewer:function(){this.$viewer=new h.a(this.$el,this.options),this.$emit("inited",this.$viewer)}},watch:{images:function(){var t=this;this.$nextTick((function(){t.onChange()}))},trigger:{handler:function(){var t=this;this.$nextTick((function(){t.onChange()}))},deep:!0},options:{handler:function(){var t=this;this.$nextTick((function(){t.rebuildViewer()}))},deep:!0}},mounted:function(){this.createViewer()},destroyed:function(){this.destroyViewer()}},m=n(13),v={name:"TopicContent",components:{Viewer:Object(m.a)(f,(function(){var t=this.$createElement;return(this._self._c||t)("div",[this._t("default",null,{images:this.images,options:this.options})],2)}),[],!1,null,null,null).exports},mixins:[l.a],props:{article:{type:Object,default:function(){}},title:{type:String,default:function(){return""}},video:{type:Object,default:function(){}},audio:{type:Object,default:function(){}},paidInformation:{type:Object,default:function(){}},threadType:{type:Number,default:0},category:{type:Object,default:function(){}},location:{type:Object,default:function(){}}},data:function(){return{showVideoPop:!1,options:{filter:function(image){return Object(o.a)(image.classList).indexOf("qq-emotion")<0},url:function(image){return image&&image.src&&image.src.split("imageMogr2")[0].replace(/[&?]$/,"")}},currentAudio:{id:"",url:"",currentTime:"",duration:"",audio:"",seeking:!1,isPlay:!1,isLoading:!1}}},computed:{unpaid:function(){return this.paidInformation.paid&&this.removeTextHideCover(),!(this.paidInformation.paid||0===parseFloat(this.paidInformation.price))}},watch:{article:{handler:function(){this.addTextHideCover()},deep:!0}},mounted:function(){this.currentAudio.audio=document.getElementById("audio-player")},methods:{formatTopicHTML:function(html){return r.a.parse(html)},addTextHideCover:function(){if(1===this.threadType&&this.unpaid){var t=document.querySelector(".content-html");parseInt(t.offsetHeight)>100&&t.classList.add("hide-cover")}},removeTextHideCover:function(){var t=document.querySelector(".content-html");t&&t.classList.remove("hide-cover")},openVideo:function(){if(this.isLogin())return this.unpaid?this.$emit("payForThread"):void(this.showVideoPop=!0)},play:function(t){var e=this;if(this.isLogin()){if(this.unpaid)return this.$emit("payForThread");this.currentAudio.id!==t._jv.id&&(this.resetAudio(this.currentAudio.audio),this.currentAudio.url=t.media_url,this.currentAudio.id=t._jv.id,this.currentAudio.audio.src=this.currentAudio.url,this.currentAudio.isLoading=!0,this.currentAudio.audio.load()),window.setTimeout((function(){e.currentAudio.audio.play(),e.currentAudio.isPlay=!0,e.currentAudio.audio.addEventListener("timeupdate",e.onProgressing),e.currentAudio.audio.addEventListener("ended",e.onEnded)}),0)}},onProgressing:function(){this.currentAudio.seeking||(this.currentAudio.isLoading=!1,this.currentAudio.duration=this.currentAudio.audio.duration,this.currentAudio.currentTime=this.currentAudio.audio.currentTime)},onEnded:function(){this.resetAudio(this.currentAudio.audio)},resetAudio:function(audio){audio.removeEventListener("timeupdate",this.onProgressing),audio.removeEventListener("ended",this.onEnded),this.currentAudio.isPlay=!1,this.currentAudio.duration="",this.currentAudio.currentTime=""},pause:function(){this.currentAudio.isLoading=!1,this.currentAudio.isPlay=!1,this.currentAudio.audio.pause()},seek:function(time){this.currentAudio.seeking=!1,this.currentAudio.currentTime=time,this.currentAudio.audio.currentTime=time},seeking:function(time){this.currentAudio.seeking=!0,this.currentAudio.currentTime=time}}},_=(n(696),Object(m.a)(v,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("article",{staticClass:"global"},[n("div",{staticClass:"title"},[t._v(t._s(t.title))]),t._v(" "),n("viewer",{attrs:{trigger:t.$xss(t.formatTopicHTML(t.article.contentHtml||"")),options:t.options}},[n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(t.formatTopicHTML(t.article.contentHtml||"")))}})]),t._v(" "),t.video.cover_url?n("div",{staticClass:"container-video-img-cover"},[n("div",{staticClass:"warp-video-img-cover"},[n("img",{staticClass:"video-img-cover",attrs:{src:t.video.cover_url,alt:t.video.file_name},on:{click:function(e){return e.stopPropagation(),t.openVideo(e)}}}),t._v(" "),n("svg-icon",{staticClass:"icon-play",staticStyle:{"font-size":"50px"},attrs:{type:"video-play"},on:{click:t.openVideo}})],1)]):t._e(),t._v(" "),t.article.images&&t.article.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images",on:{click:function(e){t.unpaid&&t.openVideo()}}},t._l(t.article.images,(function(image,e){return n("el-image",{key:e,staticClass:"image",attrs:{"data-source":t.unpaid?"":image.url,src:image.thumbUrl,alt:image.filename,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e(),t._v(" "),(t.article.attachments||[]).length>0?n("div",{staticClass:"container-attachment"},[n("h3",{staticClass:"name"},[t._v(t._s(t.$t("topic.attachment")))]),t._v(" "),n("div",[t._l(t.article.attachments,(function(e,o){return[n("attachment-list",{key:o,attrs:{file:e,price:t.paidInformation.price,"is-paid":t.paidInformation.paid,"is-paid-attachment":t.paidInformation.isPaidAttachment,"attachment-price":t.paidInformation.attachmentPrice}})]}))],2)]):t._e(),t._v(" "),t.unpaid&&1===t.threadType?n("div",{staticClass:"hide-content-tip"},[t._v(t._s(t.$t("pay.contentHide")))]):t._e(),t._v(" "),t.category.name?n("nuxt-link",{staticClass:"tag",attrs:{to:{path:"/category/"+t.category._jv.id}}},[t._v(t._s(t.category.name))]):t._e(),t._v(" "),t.location&&t.location.location?n("div",[n("nuxt-link",{staticClass:"location",attrs:{to:"/topic/position?longitude="+t.location.longitude+"&latitude="+t.location.latitude}},[n("span",{staticClass:"flex"},[n("svg-icon",{staticClass:"icon",attrs:{type:"location"}}),t._v(" "),n("span",[t._v(" "+t._s(t.location.location)+" ")])],1)])],1):t._e(),t._v(" "),6===t.threadType?n("div",{staticClass:"product"},[n("product-item",{attrs:{item:t.article&&t.article.postGoods}})],1):t._e(),t._v(" "),4===t.threadType?n("div",{staticClass:"audio"},[t._l([].concat(t.audio),(function(e,o){return[n("audio-player",{key:o,attrs:{file:e,"current-audio":t.currentAudio},on:{play:t.play,pause:t.pause,seek:t.seek,seeking:t.seeking}})]}))],2):t._e(),t._v(" "),t.showVideoPop?n("video-pop",{attrs:{"cover-url":t.video.cover_url,url:t.video.media_url},on:{remove:function(e){t.showVideoPop=!1}}}):t._e(),t._v(" "),n("audio",{staticStyle:{display:"none"},attrs:{id:"audio-player",src:t.currentAudio.url}})],1)}),[],!1,null,"6231a462",null));e.default=_.exports;installComponents(_,{SvgIcon:n(67).default,AttachmentList:n(751).default,ProductItem:n(559).default,AudioPlayer:n(560).default,VideoPop:n(533).default})},745:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"TopicPassword",props:{price:{type:[Number,String],default:""},passwordError:{type:Boolean,default:!1},passwordErrorTip:{type:String,default:""}}},r=(n(705),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.checkoutCounter")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"container"},[n("div",{staticClass:"block show-amount"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("pay.pay")+t.$t("pay.sumOfMoney")))]),t._v(" "),n("div",{staticClass:"amount"},[n("span",{staticClass:"icon"},[t._v("￥")]),t._v(" "),n("span",[t._v(t._s(t.price))])])]),t._v(" "),n("div",{staticClass:"block input-password"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("pay.payPassword")))]),t._v(" "),n("password-input",{attrs:{error:t.passwordError},on:{password:function(e){return t.$emit("password",e)},type:function(e){return t.$emit("update:passwordError",!1)}}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.passwordError,expression:"passwordError"}],staticClass:"error-tip"},[t._v(t._s(t.passwordErrorTip?t.passwordErrorTip:t.$t("pay.passwordError")))])],1),t._v(" "),n("span",{staticClass:"forget-password",on:{click:function(e){return t.$emit("findPassword")}}},[t._v(t._s(t.$t("topic.forgetPasswordFindIt")))])])])}),[],!1,null,"7e5a73cb",null);e.default=component.exports;installComponents(component,{PasswordInput:n(749).default,MessageBox:n(531).default})},746:function(t,e,n){"use strict";n.r(e);n(251);var o=n(591),r={name:"TopicCheckoutCounter",props:{threadType:{type:Number,default:0},user:{type:Object,default:function(){}},amount:{type:[String,Number],default:""},content:{type:String,default:""},rewardOrPay:{type:String,default:""},beAskedUser:{type:Object,default:function(){}},showAnonymous:{type:Boolean,default:!0},askOrWatchAnswer:{type:String,default:"ask"},showWechatPay:{type:Boolean,default:!0}},data:function(){return{hideAvatar:!1,text:["getRemainingContent","getRemainingContent","getVideo","getPicture","getAudio"],payWay:"wxPay",rewardAmount:"",defaultAmounts:["1","2","5","10","20","50","88","128"],loading:!1}},computed:{showAmount:function(){return"reward"===this.rewardOrPay?this.formatToFixed(this.rewardAmount):this.amount},userWallet:function(){var t=this.$store.state.user.info.attributes;return{walletBalance:t.walletBalance,canWalletPay:t.canWalletPay}},enoughBalance:function(){return"reward"===this.rewardOrPay?parseFloat(this.rewardAmount||"0")<=parseFloat(this.userWallet.walletBalance):parseFloat(this.amount)<=parseFloat(this.userWallet.walletBalance)}},created:function(){var t=this;this.loading=!0;var e=this.$store.state.user.info.id;e?this.$store.dispatch("user/getUserInfo",e).then((function(){t.$store.commit("session/SET_USER_ID",e),t.loading=!1}),(function(e){return t.$store.commit("user/SET_USER_INFO",{})})):this.loading=!1},methods:{formatAmount:function(t){t.target.value=Object(o.a)(t.target.value),this.rewardAmount=t.target.value},formatToFixed:function(t){return(parseFloat(t||"0")+1e-6).toFixed(2)}}},c=(n(704),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message-box",{attrs:{title:t.$t("pay.checkoutCounter")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"top"},[n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.payProduct")))]),t._v(" "),5===t.threadType?n("div",{staticClass:"body product-information"},[n("span",{staticClass:"title"},[t._v(t._s("ask"===t.askOrWatchAnswer?t.$t("post.askHim"):t.$t("topic.watchAnswer")))]),t._v(" "),n("span",[t._v(t._s(t.$t("post.answerer")+t.beAskedUser.username))])]):n("div",{staticClass:"body product-information"},["reward"===t.rewardOrPay?n("span",{staticClass:"title"},[t._v(t._s(t.$t("pay.supportAuthor")+t.$t("pay.keepWriting")))]):n("span",{staticClass:"title"},[t._v(t._s(t.$t("pay.supportAuthor")+t.$t("pay."+t.text[t.threadType])+t.$t("pay.getRight")))]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.author")+": "+(t.user.username||"")))]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.content")+": "+t.content))])]),t._v(" "),"pay"===t.rewardOrPay?n("div",{staticClass:"amount"},[t._v("￥"+t._s(t.showAmount))]):t._e()]),t._v(" "),"reward"===t.rewardOrPay?n("div",{staticClass:"row"},[n("div",{staticClass:"head reward"},[t._v(t._s(t.$t("topic.reward")+t.$t("pay.sumOfMoney")))]),t._v(" "),n("div",{staticClass:"body reward"},[n("label",[n("span",[t._v("￥")]),t._v(" "),n("input",{attrs:{placeholder:t.$t("pay.inputRewardAmount"),maxlength:"7",type:"text"},domProps:{value:t.rewardAmount},on:{input:t.formatAmount}})]),t._v(" "),n("div",{staticClass:"default-amounts"},t._l(t.defaultAmounts,(function(e,o){return n("button",{key:o,class:{selected:e===t.rewardAmount},on:{click:function(n){t.rewardAmount=e}}},[t._v("￥"+t._s(e)+"\n          ")])})),0)])]):t._e(),t._v(" "),t.showAnonymous?n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.hideAvatar")))]),t._v(" "),n("div",{staticClass:"body hide-avatar",on:{click:function(e){t.hideAvatar=!t.hideAvatar}}},[t.hideAvatar?n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"checked"}}):n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"unchecked"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.hideMyAvatar")))])],1)]):t._e(),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"head"},[t._v(t._s(t.$t("pay.payType")))]),t._v(" "),t.showWechatPay?n("div",{staticClass:"body pay-way"},[n("div",{staticClass:"pay-card",class:{"pay-card":!0,selected:"wxPay"===t.payWay},on:{click:function(e){t.payWay="wxPay"}}},[n("div",{staticClass:"detail"},[n("div",{staticClass:"pay-title"},[n("svg-icon",{staticClass:"active-svg-wx",staticStyle:{fill:"#8590A6","font-size":"20px"},attrs:{type:"wechat"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPay")))]),t._v(" "),n("div",{staticClass:"pay-tip"},[n("div",[n("span",[t._v(t._s(t.$t("pay.wxPayTipUse")))]),t._v(" "),n("span",{staticClass:"active-tip",staticStyle:{"font-weight":"bold"}},[t._v(t._s(t.$t("pay.wxPayTipScan")))])]),t._v(" "),n("span",[t._v(t._s(t.$t("pay.wxPayTipPay")))])])],1),t._v(" "),n("div",{staticClass:"pay-amount"},[t._v("￥"+t._s(t.showAmount))])])])]):t._e(),t._v(" "),n("div",{staticClass:"body pay-way"},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"pay-card",class:{"pay-card":!0,selected:"walletPay"===t.payWay},on:{click:function(e){t.payWay="walletPay"}}},[n("div",{staticClass:"detail"},[n("div",{staticClass:"pay-title"},[n("svg-icon",{staticClass:"active-svg-wallet",staticStyle:{fill:"#8590a6","font-size":"20px"},attrs:{type:"wallet"}}),t._v(" "),n("span",[t._v(t._s(t.$t("pay.walletPay")))]),t._v(" "),n("div",{staticClass:"pay-tip"},[t.enoughBalance?n("div",[t.userWallet.canWalletPay?t._e():n("nuxt-link",{staticClass:"not-enough-balance",attrs:{to:"/my/wallet"}},[t._v(t._s(t.$t("pay.needToResetPassword")))]),t._v(" "),n("div",[t._v(t._s(t.$t("pay.walletBalance")))])],1):n("div",[t.userWallet.canWalletPay?n("span",{staticClass:"not-enough-balance"},[t._v(t._s(t.$t("pay.walletBalanceNo")))]):n("nuxt-link",{staticClass:"not-enough-balance",attrs:{to:"/my/wallet"}},[t._v(t._s(t.$t("pay.needToResetPassword")))])],1),t._v(" "),n("div",[n("span",[t._v("￥ "+t._s(t.userWallet.walletBalance))])])])],1),t._v(" "),n("div",{staticClass:"pay-amount"},[t._v("￥"+t._s(t.showAmount))])])])])])]),t._v(" "),n("div",{staticClass:"bottom"},[n("span",[t._v("￥ "+t._s(t.showAmount+t.$t("pay.rmb")+t.$t("pay.payTo")+"，"+(t.beAskedUser.username||t.user.username))+" "+t._s("wxPay"===t.payWay?t.$t("pay.ofAccount"):t.$t("pay.ofWalletAccount")))]),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"wxPay"===t.payWay,expression:"payWay === 'wxPay'"}],staticClass:"checkout-button",attrs:{type:"primary"},on:{click:function(e){t.$emit("paying",{payWay:t.payWay,hideAvatar:t.hideAvatar,rewardAmount:t.formatToFixed(t.rewardAmount)})}}},[t._v("\n      "+t._s(t.$t("pay.scanPay"))+"\n    ")]),t._v(" "),n("el-button",{directives:[{name:"show",rawName:"v-show",value:"walletPay"===t.payWay,expression:"payWay === 'walletPay'"}],staticClass:"checkout-button",staticStyle:{margin:"0"},attrs:{disabled:!t.enoughBalance||!t.userWallet.canWalletPay,type:"primary"},on:{click:function(e){t.$emit("paying",{payWay:t.payWay,hideAvatar:t.hideAvatar,rewardAmount:t.formatToFixed(t.rewardAmount)})}}},[t._v("\n      "+t._s(t.$t("pay.surePay"))+"\n    ")])],1)])}),[],!1,null,"50909a7a",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,MessageBox:n(531).default})},747:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(19),n(39),n(30),n(11),n(518)),c={name:"TopicAside",mixins:[n.n(r).a],props:{author:{type:Object,default:function(){}}},data:function(){return{threeEssenceThread:[],EssenceThread:[],followStatus:0,followLoading:!1,loading:!0,billboard:[{key:"threadCount",count:"",text:this.$t("home.thread")},{key:"questionCount",count:"",text:this.$t("profile.question")},{key:"likedCount",count:"",text:this.$t("topic.getLike")},{key:"followCount",count:"",text:this.$t("home.followed")},{key:"fansCount",count:"",text:this.$t("profile.followers")}]}},computed:{canOpera:function(){var t=this.$store.getters["session/get"]("userId");return!!(this.author.id&&this.author.id>0)&&(parseInt(t)>0&&t!==this.author.id.toString())}},watch:{author:{handler:function(t){0!==Object.keys(t).length&&(this.followStatus=t.follow,this.billboard.forEach((function(e){e.count=t[e.key]})))},deep:!0,immediate:!0}},mounted:function(){this.getEssenceThread()},methods:{getEssenceThread:function(){var t=this;return this.loading=!0,this.$store.dispatch("jv/get",["threads",{params:{"filter[isApproved]":1,"filter[isEssence]":"yes","filter[isDeleted]":"no"}}]).then((function(data){if(t.EssenceThread=Object(o.a)(data),0!==t.EssenceThread.length)for(var e=t.EssenceThread.length>3?3:t.EssenceThread.length;t.threeEssenceThread.length<e;){var n=t.getRandom(t.EssenceThread.length);t.threeEssenceThread.push(t.EssenceThread[n]),t.EssenceThread.splice(n,1)}}),(function(e){return t.handleError(e)})).finally((function(){t.loading=!1}))},getRandom:function(t){return Math.floor(Math.random()*t)},follow:function(){var t=this;if(!this.followLoading){this.followLoading=!0;var e={_jv:{type:"follow"},to_user_id:this.author.id.toString()};return this.$store.dispatch("jv/post",e).then((function(e){t.followLoading=!1,t.followStatus=0===e.is_mutual?1:2}),(function(e){return t.handleError(e)}))}},unFollow:function(){var t=this;this.followLoading||(this.followLoading=!0,this.$store.dispatch("jv/delete","follow/".concat(this.author.id,"/1")).then((function(){t.followLoading=!1,t.followStatus=0})))},goToPage:function(t){window.open("/thread/".concat(t._jv.id))}}},l=(n(700),n(13)),component=Object(l.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},[n("aside-header",{attrs:{author:t.author,billboard:t.billboard,"follow-status":t.followStatus,"follow-loading":t.followLoading,"can-opera":t.canOpera},on:{follow:t.follow,unFollow:t.unFollow}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.threeEssenceThread.length>0,expression:"threeEssenceThread.length > 0"},{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"recommend block"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("topic.recommend")))]),t._v(" "),t._l(t.threeEssenceThread,(function(e,o){return n("div",{key:o,staticClass:"container-post"},[e.title&&e.firstPost.summaryText?n("div",{staticClass:"content-html",on:{click:function(n){return t.goToPage(e)}}},[t._v(" "+t._s(e.title||e.firstPost.summaryText)+" ")]):n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(e.firstPost.summary))},on:{click:function(n){return t.goToPage(e)}}}),t._v(" "),n("span",{staticClass:"view-count"},[t._v(t._s(e.viewCount)+" "+t._s(t.$t("topic.readAlready")))])])}))],2),t._v(" "),n("advertising",{staticStyle:{"margin-top":"15px","margin-bottom":"3px"}}),t._v(" "),n("copyright")],1)}),[],!1,null,"d40523f6",null);e.default=component.exports;installComponents(component,{AsideHeader:n(750).default,Advertising:n(564).default,Copyright:n(565).default})},748:function(t,e,n){"use strict";n.r(e);n(251);var o={name:"CommentHeader",props:{commentCount:{type:Number,default:0},isPositiveSort:{type:Boolean,default:!1}}},r=(n(698),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-header"},[n("div",{staticClass:"count"},[t._v(t._s(t.commentCount+" "+t.$t("topic.item")+t.$t("topic.comment")))]),t._v(" "),n("div",{staticClass:"sort",on:{click:function(e){return t.$emit("changeSort",!t.isPositiveSort)}}},[n("svg-icon",{staticStyle:{"font-size":"14px"},attrs:{type:"sort"}}),t._v(" "),n("span",[t._v(t._s(t.isPositiveSort?t.$t("topic.switchToNegativeSort"):t.$t("topic.switchToPositiveSort")))])],1)])}),[],!1,null,"7d28ce9c",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},749:function(t,e,n){"use strict";n.r(e);var o={name:"PasswordInput",props:{error:{type:Boolean,default:!1}},data:function(){return{password:""}},watch:{error:function(t){t&&(this.password="")}},mounted:function(){document.addEventListener("keyup",this.onInput)},methods:{onInput:function(t){if(["0","1","2","3","4","5","6","7","8","9"].indexOf(t.key)>=0&&(this.password+=t.key,this.$emit("type")),6===this.password.length)return this.$emit("password",this.password);this.password.length>6&&(this.password=this.password.substring(0,6)),"Backspace"===t.key&&(this.password=this.password.substr(0,this.password.length-1))}}},r=(n(706),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"code"},t._l(6,(function(e,o){return n("span",{key:o,class:{"code-item":!0,filled:t.password[o],error:t.error}},[t._v(t._s(t.password[o]?"*":" "))])})),0)}),[],!1,null,"b0d1d7ca",null);e.default=component.exports},750:function(t,e,n){"use strict";n.r(e);n(26),n(251);var o=n(536),r=n.n(o),c=n(518),l={name:"AsideHeader",mixins:[n.n(c).a,r.a],props:{author:{type:Object,default:function(){}},billboard:{type:Array,default:function(){return[]}},followStatus:{type:Number,default:0},canOpera:{type:Boolean,default:!1},followLoading:{type:Boolean,default:!1}},data:function(){return{dialog:{id:"",name:""},chatting:!1}},watch:{author:{handler:function(){this.getAuthorInfo()}},deep:!0},mounted:function(){this.getAuthorInfo()},methods:{getAuthorInfo:function(){var t=this;if(this.author.id&&(!this.author.id||-1!==this.author.id))return this.$store.dispatch("jv/get",["users/".concat(this.author._jv.id),{params:{include:"groups,dialog"}}]).then((function(e){e.dialog&&(t.dialog.id=e.dialog._jv.id),t.dialog.name=t.author.username}),(function(e){return t.handleError(e)}))},openChatBox:function(){this.chatting=!0},toprofile:function(t){this.$router.push("/user/".concat(this.author._jv.id,"?current=").concat(t+1))}}},d=(n(701),n(13)),component=Object(d.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"author"},[n("div",{staticClass:"title"},[t._v(t._s(t.$t("topic.aboutAuthor")))]),t._v(" "),n("avatar-component",{staticClass:"author-info",attrs:{author:t.author}},[t._v("\n    "+t._s(t.$t("topic.activeAt"))+" "+t._s(t.timerDiff(t.author.updatedAt))+t._s(t.$t("topic.before"))+"\n  ")]),t._v(" "),n("div",{staticClass:"signature"},[t._v(t._s(t.author.signature))]),t._v(" "),n("div",{staticClass:"container-billBoard"},t._l(t.billboard,(function(e,o){return n("div",{key:o,staticClass:"billBoard-item",on:{click:function(e){return t.toprofile(o)}}},[n("div",{staticClass:"text"},[t._v(t._s(e.text))]),t._v(" "),n("div",{staticClass:"count"},[t._v(t._s(e.count))])])})),0),t._v(" "),t.canOpera?n("div",{staticClass:"buttons"},[n("el-button",{attrs:{type:"primary",loading:t.followLoading},on:{click:function(e){0===t.followStatus?t.$emit("follow"):t.$emit("unFollow")}}},[t._v("\n      "+t._s(0===t.followStatus?"+ "+t.$t("profile.following"):1===t.followStatus?t.$t("profile.followed"):t.$t("profile.mutualfollow"))+"\n    ")]),t._v(" "),n("el-button",{on:{click:t.openChatBox}},[t._v(t._s(t.$t("topic.sendMessage")))])],1):t._e(),t._v(" "),t.chatting?n("chat-box",{attrs:{dialog:t.dialog||{}},on:{close:function(e){t.chatting=!1}}}):t._e()],1)}),[],!1,null,"622ccbec",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(570).default,ChatBox:n(644).default})},751:function(t,e,n){"use strict";n.r(e);n(251);var o=n(33),r=n(518),c=n.n(r),l=n(532),d=["DOC","DOCX","PDF","PPT","TXT","XLS","XLSX"],h={name:"AttachmentList",mixins:[c.a],props:{file:{type:Object,default:function(){}},isPaid:{type:Boolean,default:!1},price:{type:[Number,String],default:0},isPaidAttachment:{type:Boolean,default:!1},attachmentPrice:{type:[Number,String],default:0}},data:function(){return{dialogVisible:!1,previewData:{},previewUrl:"",previewPage:1,previewTotal:1,loading:!1}},computed:{forums:function(){return this.$store.state.site.info.attributes||{}},unpaid:function(){return parseFloat(this.price)>0&&!this.isPaid||parseFloat(this.attachmentPrice)>0&&!this.isPaidAttachment},canReview:function(){return this.forums&&this.forums.qcloud&&this.forums.qcloud.qcloud_cos&&this.forums.qcloud.qcloud_cos_doc_preview&&this.isPreviewType(this.file.extension)&&(0===parseFloat(this.price)&&parseFloat(this.attachmentPrice)>0&&this.isPaidAttachment||parseFloat(this.price)>0&&this.isPaid)&&this.file.isRemote}},methods:{downloadAttachment:function(t){this.unpaid||window.open(t,"_self")},extensionValidate:function(t){return l.extensionList.indexOf(t.toUpperCase())>0?t.toUpperCase():"UNKNOWN"},isPreviewType:function(t){return-1!==d.indexOf(this.extensionValidate(t))},preview:function(t){this.previewUrl=t,this.getPreviewData()},getPreviewData:function(){var t=this;this.dialogVisible=!0,this.loading=!0,Object(o.a)({url:"".concat(this.previewUrl,"&page=").concat(this.previewPage),method:"get"}).then((function(e){t.loading=!1,200===e.status&&e.data&&e.data.data&&+e.data.data["X-Total-Page"]>0?(t.previewData=e.data.data,t.previewTotal=e.data.data["X-Total-Page"]):t.dialogVisible=!1}),(function(e){t.dialogVisible=!1,t.loading=!1,t.handleError(e)}))},prev:function(){this.previewPage-=1,this.getPreviewData()},next:function(){this.previewPage+=1,this.getPreviewData()}}},f=(n(697),n(13)),component=Object(f.a)(h,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"attachment-item",on:{click:function(e){return e.target!==e.currentTarget?null:t.downloadAttachment(t.file.url,t.file.fileName)}}},[n("div",{staticClass:"info"},[n("div",[n("svg-icon",{staticStyle:{"font-size":"18px","vertical-align":"middle"},attrs:{type:t.extensionValidate(t.file.extension)}}),t._v(" "),n("span",{staticClass:"file-name"},[t._v(t._s(t.file.fileName))])],1),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(parseInt((t.file.fileSize/1024).toString()).toLocaleString())+" KB")])]),t._v(" "),n("div",{staticClass:"action"},[t.unpaid?n("span",[t._v(t._s(t.$t("post.paidAfterDownload")))]):n("div",[t.canReview?n("span",{staticClass:"download",on:{click:function(e){return e.target!==e.currentTarget?null:t.preview(t.file.url)}}},[t._v(t._s(t.$t("post.preview")))]):t._e(),t._v(" "),n("span",{staticClass:"download",on:{click:function(e){return e.target!==e.currentTarget?null:t.downloadAttachment(t.file.url,t.file.fileName)}}},[t._v(t._s(t.$t("post.download")))])])]),t._v(" "),n("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.dialogVisible,"show-close":!1,top:"5vh",width:"800px","element-loading-background":"transparent"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("div",{staticClass:"dialog-cont"},[n("img",{staticClass:"img",attrs:{src:t.previewData.image,alt:""}})]),t._v(" "),n("div",{staticClass:"pagination",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{class:{hidden:1===t.previewPage},attrs:{type:"primary",size:"medium"},on:{click:t.prev}},[t._v(t._s(t.$t("post.prev")))]),t._v(" "),n("div",{staticClass:"pages"},[t._v(t._s(t.previewPage)+" / "+t._s(t.previewTotal))]),t._v(" "),n("el-button",{class:{hidden:parseInt(t.previewPage)>=parseInt(t.previewTotal)},attrs:{size:"medium",type:"primary"},on:{click:t.next}},[t._v(t._s(t.$t("post.next")))])],1)])],1)}),[],!1,null,"2b2f5713",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default})},764:function(t,e,n){"use strict";n.r(e);n(26),n(251);var o=n(518),r={name:"TopicReport",mixins:[n.n(o).a],props:{threadId:{type:String,default:""},type:{type:Number,default:0},commentId:{type:String,default:""}},data:function(){return{radio:"",inputInfo:"",otherReasonValue:"",currentReport:"",isOther:!1,reportData:[{value:"advertisingRubbish",name:"广告垃圾"},{value:"illegalContent",name:"违规内容"},{value:"maliciousIrrigation",name:"恶意灌水"},{value:"repeatPost",name:"重复发帖"},{value:"other",name:"其他"}]}},computed:{currentLoginId:function(){var t=this.$store.getters["session/get"]("userId");return parseInt(t,10)}},mounted:function(){this.otherReasonValue=""},methods:{select:function(t){this.currentReport=t,this.isOther="other"===this.currentReport},reportConfirmClick:function(t){var e=this;if(this.currentReport){var n="";if("other"===this.currentReport){if(!this.otherReasonValue)return void this.$message.error(this.$t("report.enterOtherReason"));n=this.otherReasonValue}else this.reportData.forEach((function(t){t.value===e.currentReport&&(n=t.name)}));var o={_jv:{type:"reports"},user_id:this.currentLoginId,thread_id:parseInt(this.threadId),type:t,reason:"".concat(n)};2===t&&(o.post_id=parseInt(this.commentId)),this.$store.dispatch("jv/post",o).then((function(t){t._jv&&(e.$emit("close"),e.$message.success(e.$t("report.reportSucceed")))}),(function(t){return e.handleError(t)}))}else this.$message.error(this.$t("report.pleaseClickReasons"))},reportCancelClick:function(){this.otherReasonValue="",this.currentReport="",this.$emit("close")}}},c=(n(876),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("message",{attrs:{title:t.$t("report.reportTitle")},on:{close:function(e){return t.$emit("close")}}},[n("div",{staticClass:"reportcontainer"},[n("div",{staticClass:"reportselect"},[n("el-radio-group",{on:{change:t.select},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[n("el-radio",{attrs:{label:"advertisingRubbish"}},[t._v(t._s(this.$t("report.advertisingRubbish")))]),t._v(" "),n("el-radio",{attrs:{label:"illegalContent"}},[t._v(t._s(this.$t("report.illegalContent")))]),t._v(" "),n("el-radio",{attrs:{label:"maliciousIrrigation"}},[t._v(t._s(this.$t("report.maliciousIrrigation")))]),t._v(" "),n("el-radio",{attrs:{label:"repeatPost"}},[t._v(t._s(this.$t("report.repeatPost")))]),t._v(" "),n("el-radio",{staticClass:"otherr",attrs:{label:"other"}},[t._v(t._s(this.$t("report.otherreason")))])],1)],1),t._v(" "),n("div",{staticClass:"other"},[t.isOther?n("el-input",{attrs:{type:"textarea",rows:5,disabled:!t.isOther,placeholder:t.$t("report.enterOtherReason")},model:{value:t.otherReasonValue,callback:function(e){t.otherReasonValue=e},expression:"otherReasonValue"}}):t._e()],1)]),t._v(" "),n("div",{staticClass:"confirmbtn"},[n("div",{staticClass:"allbtn"},[n("el-button",{staticClass:"comfirm",attrs:{type:"small"},on:{click:function(e){return t.reportConfirmClick(t.type)}}},[t._v(t._s(this.$t("report.confirm")))]),t._v(" "),n("el-button",{staticClass:"cancel",attrs:{type:"small"},on:{click:t.reportCancelClick}},[t._v(t._s(this.$t("report.cancel")))])],1)])])}),[],!1,null,"023858c4",null);e.default=component.exports;installComponents(component,{Message:n(571).default})},874:function(t,e,n){"use strict";var o=n(724);n.n(o).a},875:function(t,e,n){"use strict";var o=n(725);n.n(o).a},876:function(t,e,n){"use strict";var o=n(726);n.n(o).a},877:function(t,e,n){"use strict";var o=n(727);n.n(o).a},878:function(t,e,n){"use strict";var o=n(728);n.n(o).a},879:function(t,e,n){"use strict";var o=n(729);n.n(o).a},880:function(t,e,n){"use strict";var o=n(730);n.n(o).a},881:function(t,e,n){"use strict";var o=n(731);n.n(o).a},882:function(t,e,n){"use strict";var o=n(732);n.n(o).a},883:function(t,e,n){"use strict";var o=n(733);n.n(o).a},898:function(t,e,n){"use strict";n.r(e);var o=n(85),r=(n(11),n(634)),c=n.n(r),l=n(655),d=n.n(l),h=n(518),f=n.n(h),m=n(536),v=n.n(m),_=n(597),y=n.n(_),w="user,replyUser,images,thread,user.groups,thread.category,thread.firstPost,lastThreeComments,lastThreeComments.user,lastThreeComments.replyUser,deletedUser,lastDeletedLog,lastThreeComments.images",C={name:"Comment",mixins:[f.a,c.a,d.a,y.a,v.a],props:{threadId:{type:String,default:"0"}},data:function(){return{commentList:[],postCount:0,pageLimit:5,pageNumber:1,isPositiveSort:!0,onCommentPublish:!1,onEditCommentPublish:!1,comment:{text:"",imageList:[],attachedList:[]},editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},editCommentPost:{text:"",imageList:[],attachedList:[]},editComment:{},commentType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},commitLoading:!1,scrollLoading:!1,afterPushComment:!0}},created:function(){this.getComment("scroll")},methods:{getComment:function(t){var e=this;this.commitLoading||("commit"===t?this.commitLoading=!0:this.scrollLoading=!0,this.$store.dispatch("jv/get",["posts",{params:{"filter[thread]":this.threadId,"filter[isDeleted]":"no","filter[isComment]":"no","page[number]":this.pageNumber,"page[limit]":this.pageLimit,sort:this.isPositiveSort?"createdAt":"-createdAt",include:w}}]).then((function(data){var t;e.pageNumber+=1,(t=e.commentList).push.apply(t,Object(o.a)(data)),e.postCount=data.length>0?data[0].thread.postCount-1:0}),(function(t){return e.handleError(t)})).finally((function(){e.commitLoading=e.scrollLoading=!1})))},updateSingleComment:function(t){var e=this;if(!0!==this.commitLoading)return this.commitLoading=!0,this.$store.dispatch("jv/get",["posts/".concat(t),{params:{include:"user,likedUsers,commentPosts,commentPosts.user,commentPosts.user.groups,commentPosts.replyUser,commentPosts.replyUser.groups,commentPosts.mentionUsers,commentPosts.images,images,attachments"}}]).then((function(n){n.lastThreeComments=n.commentPosts.reverse().filter((function(t){return!t.isDeleted})).slice(0,3),e.$set(e.commentList,e.getCommentIndexFromId(t),n),e.commitLoading=!1}),(function(t){return e.handleError(t)})).finally((function(){e.commitLoading=!1}))},changeSort:function(t){this.scrollLoading=!0,this.pageNumber=1,this.commentList=[],this.isPositiveSort=t,this.getComment("commit")},onLike:function(t){var e=this,n=t.comment,o=t.index,r={_jv:{type:"posts",id:n._jv.id},isLiked:!n.isLiked,include:w};return this.$store.dispatch("jv/patch",r).then((function(data){e.$set(e.commentList,o,data)}),(function(t){return e.handleError(t)}))},deleteComment:function(t){var e=this,n={_jv:{type:"posts",id:t},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$store.dispatch("jv/patch",n).then((function(){e.postCount-=1,e.commentList.splice(e.getCommentIndexFromId(t),1),e.$message.success(e.$t("topic.deleteSuccess"))}),(function(t){return e.handleError(t)}))}),(function(){}))},deleteReply:function(t){var e=this,n=t.replyId,o=t.commentId,r={_jv:{type:"posts",id:n},isDeleted:!0};this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$store.dispatch("jv/patch",r).then((function(){e.updateSingleComment(o),e.$message.success(e.$t("topic.deleteSuccess"))}),(function(t){return e.handleError(t)}))}),(function(){}))},onEditComment:function(t){this.editComment=t,this.editCommentPost.text=t.content,this.$nextTick((function(){var textarea=document.querySelector(".edit-comment-editor #textarea");textarea.style.height=textarea.scrollHeight+"px"})),t.images.length>0&&(this.initThreadResource(this.editCommentPost.imageList,t.images),this.editResourceShow.showUploadImg=!0)},postEditCommentPublish:function(){var t=this;if(this.isLogin()&&!this.onEditCommentPublish){if(!this.editCommentPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.editCommentPost.text.length>this.commentType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onEditCommentPublish=!0;var e={_jv:{type:"posts",relationships:{}},content:this.editCommentPost.text};this.threadId&&(e._jv.id=this.threadId),e=this.publishPostResource(e,this.editCommentPost),this.deleteAttachmentsAfterEdit(this.editComment.images,this.editCommentPost.imageList),this.$store.dispatch("jv/patch",[e,{url:"/posts/".concat(this.editComment._jv.id)}]).then((function(e){t.updateSingleComment(t.editComment._jv.id),t.postLegalityCheck(e,t.$t("topic.commentPublishSuccess")),t.closeEditPop()}),(function(e){return t.handleError(e)})).finally((function(){t.onEditCommentPublish=!1}))}},closeEditPop:function(){this.editComment={},this.editCommentPost.text="",this.editCommentPost.imageList=[],this.editResourceShow.showUploadImg=!1},initThreadResource:function(t,e){e.forEach((function(e){var n={name:e.fileName,url:e.thumbUrl,id:e._jv.id,deleted:!1};t.push(n)}))},postCommentPublish:function(){var t=this;if(this.isLogin()&&!this.onCommentPublish){if(!this.comment.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.comment.text.length>this.commentType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onCommentPublish=!0;var e={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},content:this.comment.text};return this.publishPostResource(e,this.comment),this.$store.dispatch("jv/post",e).then((function(e){t.comment.text="",t.comment.imageList=[],t.afterPushComment=!1,t.$nextTick((function(){t.afterPushComment=!0})),t.postLegalityCheck(e,t.$t("topic.commentPublishSuccess")),t.isPositiveSort?t.commentList.length===t.postCount&&t.commentList.push(e):t.commentList.unshift(e),t.postCount+=1}),(function(e){return t.handleError(e)})).finally((function(){t.onCommentPublish=!1}))}},getCommentIndexFromId:function(t){var e=this.commentList.filter((function(e){return e._jv.id===t}))[0];return this.commentList.indexOf(e)}}},$=(n(881),n(882),n(13)),component=Object($.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.postCount>0?n("comment-header",{attrs:{"comment-count":t.postCount,"is-positive-sort":t.isPositiveSort},on:{changeSort:t.changeSort}}):n("div",{staticClass:"without-comment"},[t._v(t._s(t.$t("topic.noComment")))]),t._v(" "),t.afterPushComment?n("editor",{staticClass:"comment-editor",attrs:{"editor-style":"comment",selector:"comment-editor","type-information":t.commentType,post:t.comment,"on-publish":t.onCommentPublish},on:{"update:post":function(e){t.comment=e},publish:t.postCommentPublish}}):t._e(),t._v(" "),t.postCount>0?[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.commitLoading,expression:"commitLoading"}],staticStyle:{"min-height":"100px"}},[n("comment-list",{attrs:{"thread-id":t.threadId,"comment-list":t.commentList},on:{replyPublish:t.updateSingleComment,deleteComment:t.deleteComment,deleteReply:t.deleteReply,editComment:t.onEditComment,like:t.onLike}})],1),t._v(" "),n("list-load-more",{attrs:{loading:t.scrollLoading,length:t.commentList.length,"has-more":t.postCount>t.commentList.length,"page-num":t.pageNumber},on:{loadMore:function(e){return t.getComment("scroll")}}})]:t._e(),t._v(" "),n("el-dialog",{attrs:{title:t.$t("topic.editComment"),visible:Object.keys(t.editComment).length>0,width:"820px","destroy-on-close":""},on:{close:t.closeEditPop}},[n("avatar-component",{attrs:{author:t.editComment.user||{},size:50}},[t._v("\n      "+t._s(t.$t("topic.publishAt")+" "+t.timerDiff(t.editComment.updatedAt)+t.$t("topic.before"))+"..\n    ")]),t._v(" "),n("editor",{staticClass:"edit-comment-editor",staticStyle:{"margin-top":"20px"},attrs:{"editor-style":"comment",selector:"edit-comment-editor","edit-resource-show":t.editResourceShow,"on-publish":t.onEditCommentPublish,"type-information":t.commentType,post:t.editCommentPost,"is-edit":!0},on:{"update:post":function(e){t.editCommentPost=e},publish:t.postEditCommentPublish}})],1)],2)}),[],!1,null,"414cff72",null);e.default=component.exports;installComponents(component,{CommentHeader:n(748).default,Editor:n(585).default,CommentList:n(923).default,ListLoadMore:n(558).default,AvatarComponent:n(570).default})},899:function(t,e,n){"use strict";n.r(e);var o={name:"TopicActions",props:{actions:{type:Array,default:function(){return[]}},threadId:{type:String,default:""}},methods:{onClick:function(t){t.command&&this.$emit("clickAction",t)},copyLink:function(){var t=document.createElement("input");t.value=window.location.href,t.id="copyInput",document.body.appendChild(t),t.select(),document.execCommand("Copy"),this.$message.success("链接复制成功"),setTimeout((function(){t.remove()}),100)}}},r=(n(880),n(13)),component=Object(r.a)(o,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"actions"},[t._l(t.actions.slice(0,3),(function(e,o){return n("button",{key:o,class:{action:!0,disabled:!e.canOpera},attrs:{disabled:!e.canOpera},on:{click:function(n){return t.onClick(e)}}},[n("svg-icon",{staticClass:"action-icon",attrs:{type:e.icon}}),t._v(" "),n("span",{staticClass:"content"},[n("span",[t._v(t._s(e.text))]),t._v(" "),e.count?n("span",[t._v(" ("+t._s(e.count)+")")]):t._e()])],1)})),t._v(" "),n("div",{staticClass:"action"},[n("share-popover",{attrs:{"threads-id":t.threadId}},[n("div",{staticClass:"btn share"},[n("button",{class:{action:!0,disabled:!t.actions[3].canOpera},attrs:{slot:"reference",disabled:!t.actions[3].canOpera},slot:"reference"},[n("svg-icon",{staticClass:"action-icon",attrs:{type:t.actions[3].icon}}),t._v(" "),n("span",{staticClass:"content"},[n("span",[t._v(t._s(t.actions[3].text))]),t._v(" "),t.actions[3].count?n("span",[t._v(" ("+t._s(t.actions[3].count)+")")]):t._e()])],1)])])],1)],2)}),[],!1,null,"64a49188",null);e.default=component.exports;installComponents(component,{SvgIcon:n(67).default,SharePopover:n(563).default})},900:function(t,e,n){"use strict";n.r(e);n(251);var o=n(597),r={name:"TopicRewardList",mixins:[n.n(o).a],props:{author:{type:Object,default:function(){}},userLists:{type:Array,default:function(){return[]}},paidInformation:{type:Object,default:function(){}},threadType:{type:Number,default:0},canReward:{type:Boolean,default:!1},canPaid:{type:Boolean,default:!1}},data:function(){return{payButtonText:["",this.$t("topic.paymentViewRemainingContent"),this.$t("topic.paymentViewVideo"),this.$t("topic.paymentViewPicture"),this.$t("topic.paymentViewAudio")],command:[{value:24,title:"pay",buttonText:this.$t("topic.pay"),showButton:!1,icon:"pay"},{value:24,title:"reward",buttonText:this.$t("topic.reward"),showButton:!1,icon:"heart"},{value:24,title:"like"},{value:24,title:"pay",buttonText:this.$t("topic.pay"),showButton:!1,icon:"pay"}]}},watch:{paidInformation:{handler:function(t){this.command[0].showButton=parseFloat(t.price)>0&&!t.paid&&this.canPaid,this.command[3].showButton=parseFloat(t.attachmentPrice)>0&&!t.isPaidAttachment&&this.canPaid,this.command[1].showButton=0===parseFloat(t.price)&&0===parseFloat(t.attachmentPrice)&&this.canReward,this.command[3].buttonText=this.$t("topic.pay")+this.paidInformation.attachmentPrice+this.$t("topic.paymentViewAttachment")},deep:!0},threadType:function(t){this.command[0].buttonText=this.$t("topic.pay")+this.paidInformation.price+this.payButtonText[t]}},methods:{showMore:function(t,e){t.value<e?t.value+=24:t.value=24},onClick:function(t,e){if(this.isLogin()){var n=this.$store.state.user.info.id;return parseInt(n)===parseInt(this.author.id)?this.$message.error(this.$t("topic.iCantRewardMyself")):this.$emit("payOrReward",t[e].title)}}}},c=(n(879),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"global"},t._l(t.userLists,(function(e,o){return n("div",{key:o,staticClass:"group"},[e.length>0?n("div",{staticClass:"title"},[t._v("\n      "+t._s(e.length+t.$t("topic.personUnit")+t.$t("topic."+t.command[o].title))+"\n    ")]):t._e(),t._v(" "),e.length>0?n("div",{staticClass:"person-list"},[n("div",{staticClass:"first-show"},[t._l(e.slice(0,t.command[o].value),(function(t,e){return[n("Avatar",{key:e,staticClass:"container-avatar",attrs:{size:"30",round:"",user:t}})]}))],2)]):t._e(),t._v(" "),e.length>24?n("div",{class:{rotate:t.command[o].value>e.length},on:{click:function(n){return t.showMore(t.command[o],e.length)}}},[n("svg-icon",{staticStyle:{"font-size":"20px","margin-top":"10px",fill:"#8590A6"},attrs:{type:"drop-down"}})],1):t._e(),t._v(" "),t.command[o].showButton&&t.command[o].buttonText&&5!==t.threadType&&6!==t.threadType?n("button",{on:{click:function(e){return t.onClick(t.command,o)}}},[n("svg-icon",{staticStyle:{"font-size":"16px",fill:"white","margin-right":"10px"},attrs:{type:t.command[o].icon}}),t._v(" "),n("span",[t._v(t._s(t.command[o].buttonText))])],1):t._e()])})),0)}),[],!1,null,"348686fe",null);e.default=component.exports;installComponents(component,{Avatar:n(252).default,SvgIcon:n(67).default})},901:function(t,e,n){"use strict";n.r(e);n(11),n(251);var o=n(536),r=n.n(o),c=n(634),l=n.n(c),d=n(655),h=n.n(d),f=n(518),m=n.n(f),v=n(597),_=n.n(v),y={name:"QaActions",mixins:[r.a,l.a,h.a,m.a,_.a],props:{question:{type:Object,default:function(){}},questionUserId:{type:[String,Number],default:""},currentUserId:{type:[String,Number],default:""}},data:function(){return{answerType:{type:15,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},editResourceShow:{showUploadImg:!1,showUploadVideo:!1,showUploadAttached:!1},answer:{text:"",imageList:[],attachedList:[]},onAnswerPublish:!1,showAnswerEditor:!1}},computed:{isQuestionUser:function(){return parseInt(this.questionUserId)===parseInt(this.currentUserId)},isBeAskedUser:function(){return parseInt(this.question.be_user_id)===parseInt(this.currentUserId)},showAnswer:function(){return 0!==this.question.is_answer&&!(!this.isBeAskedUser&&!this.isQuestionUser&&"0"===this.question.onlookerState&&this.question.onlooker_price>0)},showAnswerButton:function(){return this.isBeAskedUser&&0===this.question.is_answer},showOnLookerButton:function(){return!this.isBeAskedUser&&!this.isQuestionUser&&this.question.onlooker_unit_price>0&&!this.question.onlookerState&&1===this.question.is_answer},forums:function(){return this.$store.state.site.info.attributes||{}},siteMasterScale:function(){return this.forums&&this.forums.set_site?this.forums.set_site.site_master_scale/10:""},siteUserScale:function(){return this.siteMasterScale?1-this.siteMasterScale:""}},methods:{closeEditor:function(){this.answer.text="",this.answer.imageList=[],this.showAnswerEditor=!1},answerPublish:function(){var t=this;if(this.isLogin()&&!this.onAnswerPublish){if(!this.answer.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.answer.text.length>this.answerType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onAnswerPublish=!0;var e=this.question._jv.id,n={_jv:{type:"answer",links:{self:"questions/".concat(e,"/answer")},relationships:{}},content:this.answer.text,type:5};return this.publishPostResource(n,this.answer),this.$store.dispatch("jv/post",[n,{url:"/questions/".concat(e,"/answer")}]).then((function(e){t.postLegalityCheck(e,t.$t("topic.answerPublishSuccess")),t.$emit("answerPublished"),t.closeEditor()}),(function(e){return t.handleError(e)})).finally((function(){t.onAnswerPublish=!1}))}}}},w=(n(877),n(878),n(13)),component=Object(w.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"qa"},[t.showAnswer?n("div",{staticClass:"block answer"},[n("div",{staticClass:"header"},[n("avatar-component",{attrs:{size:40,round:"",author:t.question.beUser||{}}},[t._v("\n        "+t._s(t.timerDiff(t.question.answered_at)+t.$t("topic.before"))+".. 回答\n      ")]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.question.onlooker_number,expression:"question.onlooker_number"}],staticClass:"counter"},[n("span",[t._v(t._s(t.question.onlooker_number+"人阅读"))]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.onlooker_number>0,expression:"question.onlooker_number > 0"}]},[t._v(", "+t._s(t.question.onlooker_number+"人已支付"))])])],1),t._v(" "),n("div",{staticClass:"answer-text content-html",domProps:{innerHTML:t._s(t.$xss(t.question.content_html))}}),t._v(" "),t.question.images&&t.question.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images"},t._l(t.question.images,(function(image,t){return n("el-image",{key:t,staticClass:"image",attrs:{"data-source":image.url,src:image.thumbUrl,alt:image.filename,fit:"cover"}},[n("div",{staticClass:"image-slot",attrs:{slot:"placeholder"},slot:"placeholder"},[n("i",{staticClass:"el-icon-loading"})])])})),1):t._e()]):t._e(),t._v(" "),t.showAnswerButton?n("div",{staticClass:"block"},[n("button",{on:{click:function(e){t.showAnswerEditor=!0}}},[n("svg-icon",{staticStyle:{"font-size":"15px"},attrs:{type:"question"}}),t._v(" "),n("span",[t._v(t._s(t.$t("topic.answerQuestion")))])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:parseFloat(t.question.price)>0,expression:"parseFloat(question.price) > 0"}],staticClass:"tip"},[n("span",[t._v(t._s(t.$t("topic.answerCanGet")))]),t._v(" "),n("span",{staticClass:"amount"},[t._v(" ￥"+t._s((parseFloat(t.question.price)*t.siteUserScale).toFixed(2))+" ")]),t._v(" "),n("span",[t._v(t._s(t.$t("topic.answerTip")))]),t._v(" "),n("span",{staticClass:"amount"},[t._v("￥ "+t._s((parseFloat(t.question.onlooker_unit_price)*t.siteUserScale/2).toFixed(2))+" ")]),t._v(" "),n("span",[t._v(t._s(t.$t("post.yuan")))])])]):t._e(),t._v(" "),t.showOnLookerButton?n("div",{staticClass:"block"},[n("button",{on:{click:function(e){return t.$emit("payForAnswer")}}},[n("svg-icon",{staticStyle:{"font-size":"15px"},attrs:{type:"yuan"}}),t._v(" "),n("span",[t._v(t._s(t.$t("topic.payAmountCanWatch",{amount:t.question.onlooker_unit_price})))])],1)]):t._e(),t._v(" "),n("el-dialog",{attrs:{title:t.$t("topic.answerQuestion"),visible:t.showAnswerEditor,"destroy-on-close":"",width:"820px"},on:{"update:visible":function(e){t.showAnswerEditor=e}}},[n("editor",{staticClass:"edit-answer-editor",attrs:{"editor-style":"comment",selector:"edit-answer-editor","edit-resource-show":t.editResourceShow,"on-publish":t.onAnswerPublish,"type-information":t.answerType,post:t.answer},on:{"update:post":function(e){t.answer=e},publish:t.answerPublish}})],1)],1)}),[],!1,null,"d6ba75ea",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(570).default,SvgIcon:n(67).default,Editor:n(585).default})},902:function(t,e,n){"use strict";n.r(e);var o=n(536),r={name:"TopicHeader",mixins:[n.n(o).a],props:{author:{type:Object,default:function(){}},thread:{type:Object,default:function(){}},managementList:{type:Array,default:function(){return[]}},beAskedUser:{type:Object,default:function(){}}},data:function(){return{isManagementDrop:!1,isReport:!1}},methods:{handleCommand:function(t){var e=t.command,n=t.item;return"toEdit"===e?this.$router.push("/thread/post?type=".concat(this.thread.type,"&operating=edit&threadId=").concat(this.thread._jv.id)):"isDeleted"===e?this.deleteConfirm(n):void this.$emit("managementSelected",n)},deleteConfirm:function(t){var e=this;this.$confirm(this.$t("topic.confirmDelete"),this.$t("discuzq.msgBox.title"),{confirmButtonText:this.$t("discuzq.msgBox.confirm"),cancelButtonText:this.$t("discuzq.msgBox.cancel"),type:"warning"}).then((function(){return e.$emit("managementSelected",t)}))},reportClick:function(){this.isReport=!0}}},c=(n(875),n(13)),component=Object(c.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"title"},[5!==t.thread.type?n("avatar-component",{attrs:{author:t.author}},[t._v("\n    "+t._s(t.$t("topic.publishAt"))+" "+t._s(t.timerDiff(t.thread.createdAt)+t.$t("topic.before"))+" ..\n    （"+t._s(t.$t("topic.editAt"))+" "+t._s(t.timerDiff(t.thread.firstPost?t.thread.firstPost.updatedAt:"")+t.$t("topic.before"))+"）\n  ")]):n("avatar-component",{attrs:{author:t.author}},[t._v("\n    "+t._s(t.timerDiff(t.thread.createdAt)+t.$t("topic.before")+"..."+t.$t("topic.to"))+"\n    "),n("nuxt-link",{staticClass:"be-ask-user",attrs:{to:"/user/"+t.beAskedUser._jv.id}},[t._v(t._s(" @"+t.beAskedUser.username))]),t._v("\n    "+t._s(" "+t.$t("topic.ask"))+"\n  ")],1),t._v(" "),n("div",{staticClass:"container-management"},[n("el-dropdown",{directives:[{name:"show",rawName:"v-show",value:t.managementList.length>0&&t.managementList.some((function(t){return t.canOpera})),expression:"managementList.length > 0 && managementList.some(item => item.canOpera)"}],staticClass:"dropdown",attrs:{placement:"bottom",trigger:"click"},on:{command:t.handleCommand,"visible-change":function(e){return t.isManagementDrop=e}}},[n("div",{class:{management:!0,"on-drop":t.isManagementDrop}},[n("svg-icon",{staticClass:"icon-setting",staticStyle:{"font-size":"16px"},attrs:{type:"setting"}}),t._v(" "),n("span",[t._v(" "+t._s(t.$t("topic.management"))+" ")])],1),t._v(" "),n("el-dropdown-menu",{staticStyle:{padding:"0 10px"},attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.managementList,(function(e,o){return n("el-dropdown-item",{key:o,staticStyle:{"border-bottom":"1px solid #EDEDED",width:"98px","text-align":"center"},attrs:{command:{command:e.command,item:e}}},[t._v("\n          "+t._s(e.text)+"\n        ")])})),1)],1),t._v(" "),n("div",{staticClass:"report",on:{click:t.reportClick}},[n("svg-icon",{staticClass:"icon-setting",staticStyle:{"font-size":"16px"},attrs:{type:"report"}}),t._v(" "),n("span",[t._v(t._s(t.$t("report.reportTitle")))])],1),t._v(" "),t.isReport?n("topic-report",{attrs:{"thread-id":t.thread._jv.id,type:1},on:{close:function(e){t.isReport=!1}}}):t._e(),t._v(" "),t.thread.isEssence?n("div",{staticClass:"essence"},[n("svg-icon",{staticStyle:{"font-size":"25px"},attrs:{type:"essence"}})],1):t._e()],1)],1)}),[],!1,null,"1e51a23a",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(570).default,SvgIcon:n(67).default,TopicReport:n(764).default})},923:function(t,e,n){"use strict";n.r(e);n(11);var o=n(518),r=n.n(o),c=n(597),l=n.n(c),d=n(634),h=n.n(d),f=n(655),m=n.n(f),v=n(536),_=n.n(v),y=n(534),w=n(627),C=n.n(w),$={name:"CommentList",mixins:[r.a,_.a,h.a,m.a,l.a],props:{commentList:{type:Array,default:function(){return[]}},threadId:{type:String,default:""}},data:function(){return{replyList:[],onReplyPublish:!1,showReplyEditorForIndex:-1,replyPost:{text:"",imageList:[],attachedList:[]},replyType:{type:10,textLimit:5e3,showPayment:!1,showTitle:!1,showImage:!0,showVideo:!1,showAttached:!1,showEmoji:!0,showTopic:!1,showCaller:!0,placeholder:"写下我的评论 ..."},showAllReply:!1,replyLoading:!1,isShield:!1,commentId:""}},watch:{commentList:{handler:function(t){this.showAllReply||(this.replyList=t.map((function(t){return t.lastThreeComments})))},deep:!0,immediate:!0}},methods:{formatDate:function(t){return C()(t).format("YYYY-MM-DD HH:mm")},formatSummary:function(t){var html;return html=t.content!==t.summaryText?t.summary+'<button class="showAllComment">'.concat(this.$t("topic.all"),"</button>"):t.contentHtml,y.a.parse(html)},showAll:function(t,e){t.target.matches(".showAllComment")&&this.$router.push("/thread/comment?threadId=".concat(this.threadId,"&commentId=").concat(e._jv.id))},replyPublish:function(t){var e=this;if(this.isLogin()){if(!this.replyPost.text)return this.$message.warning(this.$t("post.theContentCanNotBeBlank"));if(this.replyPost.text.length>this.replyType.textLimit)return this.$message.warning(this.$t("post.messageLengthCannotOver"));this.onReplyPublish=!0;var n={_jv:{type:"posts",relationships:{thread:{data:{type:"threads",id:this.threadId}}}},isComment:!0,replyId:t,content:this.replyPost.text};return this.publishPostResource(n,this.replyPost),this.$store.dispatch("jv/post",n).then((function(n){e.replyPost.text="",e.replyPost.imageList=[],e.showReplyEditorForIndex=-1,e.postLegalityCheck(n,e.$t("topic.replyPublishSuccess")),e.$emit("replyPublish",t)}),(function(t){return e.handleError(t)})).finally((function(){e.onReplyPublish=!1}))}},toShield:function(t){this.isShield=!0,this.commentId=t}}},x=(n(883),n(13)),component=Object(x.a)($,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._l(t.commentList,(function(e,o){return n("div",{key:o,staticClass:"comment"},[n("div",{staticClass:"title"},[n("avatar-component",{attrs:{author:e.user,size:45}},[t._v("\n        "+t._s(t.timerDiff(e.updatedAt)+t.$t("topic.before"))+"..\n      ")]),t._v(" "),n("div",{staticClass:"management"},[e.canEdit?n("div",{staticClass:"manage-button",on:{click:function(n){return t.$emit("editComment",e)}}},[t._v(t._s(t.$t("topic.edit")))]):t._e(),t._v(" "),e.canHide?n("div",{staticClass:"manage-button",on:{click:function(n){return t.$emit("deleteComment",e._jv.id)}}},[t._v(t._s(t.$t("topic.delete")))]):t._e(),t._v(" "),0===e.isApproved?n("div",{staticClass:"checking"},[t._v(t._s(t.$t("topic.inReview")))]):t._e()])],1),t._v(" "),n("div",{staticClass:"container-detail"},[n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(t.formatSummary(e)))},on:{click:function(n){return t.showAll(n,e)}}}),t._v(" "),e.images&&e.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images"},t._l(e.images,(function(image,t){return n("el-image",{key:t,staticStyle:{width:"100px",height:"100px","border-radius":"5px","margin-right":"10px"},attrs:{src:image.thumbUrl,alt:image.filename,"data-source":image.url,fit:"cover"}})})),1):t._e(),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===e.isApproved,expression:"comment.isApproved === 1"}],staticClass:"actions"},[n("div",{staticClass:"left"},[n("span",{directives:[{name:"show",rawName:"v-show",value:e.canLike,expression:"comment.canLike"}],on:{click:function(n){return t.$emit("like",{comment:e,index:o})}}},[n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:e.isLiked?"liked":"like"}}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.like"))+" "+t._s(e.likeCount>0?e.likeCount:""))])],1),t._v(" "),n("span",{on:{click:function(e){t.showReplyEditorForIndex=t.showReplyEditorForIndex===o?-1:o}}},[n("svg-icon",{staticStyle:{"font-size":"18px"},attrs:{type:"comment"}}),t._v(" "),n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.replyTa")))])],1),t._v(" "),n("span",[e.replyCount>0?n("span",{staticClass:"text"},[t._v(t._s(t.$t("topic.replyAlready")+" "+e.replyCount))]):t._e()])]),t._v(" "),n("div",{staticClass:"report",on:{click:function(n){return t.toShield(e._jv.id)}}},[t._v(t._s(t.$t("report.reportTitle")))])])]),t._v(" "),t.showReplyEditorForIndex===o?n("editor",{staticClass:"reply-editor",staticStyle:{"margin-top":"0","margin-bottom":"20px"},attrs:{"editor-style":"reply",selector:"reply-editor","type-information":t.replyType,post:t.replyPost,"on-publish":t.onReplyPublish},on:{"update:post":function(e){t.replyPost=e},publish:function(n){return t.replyPublish(e._jv.id)}}}):t._e(),t._v(" "),n("div",{staticClass:"reply-list",on:{click:function(n){return t.$router.push("/thread/comment?threadId="+t.threadId+"&commentId="+e._jv.id+"#reply")}}},[t._l(t.replyList[o],(function(o,r){return n("div",{key:r,staticClass:"reply"},[n("div",{staticClass:"title"},[n("Avatar",{attrs:{user:o.user||{},size:"30"}}),t._v(" "),n("div",{staticClass:"title-info"},[n("span",{staticClass:"author-name"},[t._v(t._s(o.user?o.user.username:""))]),t._v(" "),n("span",{staticClass:"text reply"},[t._v(t._s(t.$t("topic.reply")))]),t._v(" "),n("span",{staticClass:"text comment-author"},[t._v(t._s(e.user?e.user.username:"")+"   ")]),t._v(" "),n("span",{staticClass:"timer"},[t._v(t._s(t.formatDate(o.updatedAt)))]),t._v(" "),o.canHide?n("span",{staticClass:"delete-reply",on:{click:function(n){return n.stopPropagation(),t.$emit("deleteReply",{replyId:o._jv.id,commentId:e._jv.id})}}},[t._v(t._s(t.$t("topic.delete")))]):t._e()])],1),t._v(" "),n("div",{staticClass:"content-html",domProps:{innerHTML:t._s(t.$xss(o.summary))},on:{click:function(e){return t.showAll(e,r,t.replyList)}}}),t._v(" "),o.images&&o.images.length>0?n("div",{directives:[{name:"viewer",rawName:"v-viewer",value:{url:"data-source"},expression:"{url: 'data-source'}"}],staticClass:"images",on:{click:function(t){t.stopPropagation()}}},t._l(o.images,(function(image,t){return n("el-image",{key:t,staticStyle:{width:"100px",height:"100px","border-radius":"5px","margin-right":"10px","margin-bottom":"10px"},attrs:{src:image.thumbUrl,alt:image.filename,"data-source":image.url,fit:"cover"}})})),1):t._e(),t._v(" "),n("div",{staticClass:"line"})])})),t._v(" "),e.replyCount>3?n("div",[e.replyCount!==(t.replyList[o]||[]).length?n("div",{staticClass:"show-all-reply"},[t._v("\n          "+t._s(t.$t("topic.showOther"))+" "+t._s(e.replyCount-3)+" "+t._s(t.$t("topic.item")+t.$t("topic.reply"))+"\n        ")]):t._e()]):t._e()],2)],1)})),t._v(" "),t.isShield?n("topic-report",{attrs:{"thread-id":t.threadId,type:2,"comment-id":t.commentId},on:{close:function(e){t.isShield=!1}}}):t._e()],2)}),[],!1,null,"372a3b20",null);e.default=component.exports;installComponents(component,{AvatarComponent:n(570).default,SvgIcon:n(67).default,Editor:n(585).default,Avatar:n(252).default,TopicReport:n(764).default})},936:function(t,e,n){"use strict";n.r(e);n(60),n(29);var o=n(9),r=(n(26),n(51),n(19),n(11),n(39),n(32),n(7)),c=n(518),l=n.n(c),d=n(597),h=n.n(d),f=n(702),m=n.n(f),v=n(173);function _(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function y(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var w="posts.replyUser,threadAudio,user.groups,user,user.groups.permissionWithoutCategories,posts,posts.user,posts.likedUsers,posts.images,firstPost,firstPost.likedUsers,firstPost.images,firstPost.attachments,rewardedUsers,category,threadVideo,paidUsers,question,question.beUser,question.images,onlookers",C={name:"Topic",layout:"custom_layout",mixins:[l.a,h.a,m.a],asyncData:function(t){return Object(r.a)(regeneratorRuntime.mark((function e(){var n,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.params,o=t.store,v.a.isSpider){e.next=3;break}return e.abrupt("return",{});case 3:return e.prev=3,e.next=6,o.dispatch("jv/get",["threads/".concat(n.id),{params:{include:w}}]);case 6:return r=e.sent,e.abrupt("return",{thread:r,article:r.firstPost,postId:r.firstPost._jv.id});case 10:return e.prev=10,e.t0=e.catch(3),e.abrupt("return",{articleLoading:!0});case 13:case"end":return e.stop()}}),e,null,[[3,10]])})))()},data:function(){return{thread:{},article:{},question:{},postId:0,actions:[{text:this.$t("topic.read"),count:0,command:"",canOpera:!1,icon:"book"},{text:this.$t("topic.getLike"),count:0,command:"isLiked",canOpera:!1,isStatus:!1,icon:"like"},{text:this.$t("topic.collection"),command:"isFavorite",canOpera:!1,isStatus:!1,icon:"favor"},{text:this.$t("topic.share"),command:"showLink",canOpera:!0,icon:"link"}],paidInformation:{price:"0",paid:!1,paidUsers:[],paidCount:0,isPaidAttachment:!1,attachmentPrice:"0"},payment:{wechat_qrcode:"",rewardAmount:""},location:{location:"",latitude:"",longitude:""},managementList:[{name:"canEdit",command:"toEdit",isStatus:!1,canOpera:!1,text:this.$t("topic.edit"),type:"0"},{name:"canEssence",command:"isEssence",isStatus:!1,canOpera:!1,text:this.$t("topic.essence"),type:"1"},{name:"canSticky",command:"isSticky",isStatus:!1,canOpera:!1,text:this.$t("topic.sticky"),type:"2"},{name:"canHide",command:"isDeleted",isStatus:!1,canOpera:!1,text:this.$t("topic.delete"),type:"3"}],showCheckoutCounter:!1,showPasswordInput:!1,showWxPay:!1,defaultLoading:!1,articleLoading:!1,passwordError:!1,passwordErrorTip:"",findPassword:!1}},computed:{threadId:function(){return this.$route.params.id},currentUser:function(){return this.$store.state.user.info.attributes||{}},forums:function(){return this.$store.state.site.info.attributes||{}},rewardOrPay:function(){var t=parseFloat(this.paidInformation.price),e=parseFloat(this.paidInformation.attachmentPrice),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t>0||e>0||n>0?"pay":"reward"},payOrRewardAmount:function(){var t=parseFloat(this.paidInformation.price||"0"),e=parseFloat(this.paidInformation.attachmentPrice||"0"),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t||e||n||this.payment.rewardAmount},payOrderType:function(){var t=parseFloat(this.paidInformation.price||"0"),e=parseFloat(this.paidInformation.attachmentPrice||"0"),n=Object.keys(this.question).length>0?parseFloat(this.question.onlooker_unit_price):0;return t>0?3:e>0?7:n>0?6:2}},mounted:function(){0===Object.keys(this.thread).length?this.getThread():this.initData()},methods:{getThread:function(){var t=this;return this.$store.dispatch("jv/get",["threads/".concat(this.threadId),{params:{include:w}}]).then((function(data){if(data.isDeleted)return t.$router.replace("/error");t.articleLoading=!1,t.thread=data,t.article=data.firstPost,t.postId=t.article._jv.id,t.initData()}),(function(e){return t.handleError(e,"thread")}))},initData:function(){this.initManagementList(this.thread),this.initPaidInformation(this.thread),this.initActions(this.thread,this.article),this.initLocation(this.thread),this.initQuestion(this.thread),this.filterImages()},filterImages:function(){var t=this;this.article.contentAttachIds&&this.article.contentAttachIds.length>0&&this.article.images&&this.article.images.length>0&&(this.article.images=this.article.images.filter((function(image){return t.article.contentAttachIds.indexOf(image._jv.id)<0})))},initQuestion:function(data){data.question&&(this.question=data.question,this.question.onlookerState=data.onlookerState)},initLocation:function(data){for(var t in this.location)this.location[t]=data[t]},initPaidInformation:function(data){for(var t in this.paidInformation)this.paidInformation[t]=data[t]},initManagementList:function(data){var t=this;this.managementList.forEach((function(e){e.canOpera=data[e.name],"canEssence"===e.name?(e.isStatus=data.isEssence,e.text=e.isStatus?t.$t("topic.cancelEssence"):t.$t("topic.essence")):"canSticky"===e.name&&(e.isStatus=data.isSticky,e.text=e.isStatus?t.$t("topic.cancelSticky"):t.$t("topic.sticky"))})),(4===this.thread.type||5===this.thread.type)&&this.managementList.filter((function(t){return"canEdit"===t.name})).length>0&&(this.managementList.filter((function(t){return"canEdit"===t.name}))[0].canOpera=!1),this.thread.isEssence=data.isEssence,this.managementList=this.managementList.filter((function(t){return t.canOpera}))},initActions:function(data,t){var e=y({},this.actions[0]),n=y({},this.actions[2]),o=y({},this.actions[1]);data&&(e.count=data.viewCount,n.isStatus=data.isFavorite,n.text=n.isStatus?this.$t("topic.collectionAlready"):this.$t("topic.collection"),n.icon=n.isStatus?"favored":"favor",n.canOpera=data.canFavorite),t&&(o.count=t.likeCount,o.isStatus=t.isLiked,o.canOpera=t.canLike,o.text=o.isStatus?this.$t("topic.liked"):this.$t("topic.getLike"),o.icon=o.isStatus?"liked":"like"),this.$set(this.actions,0,e),this.$set(this.actions,1,o),this.$set(this.actions,2,n)},paying:function(t){var e=this,n=t.payWay,o=t.hideAvatar,r=t.rewardAmount;if("reward"===this.rewardOrPay&&(!r||0===parseFloat(r)))return this.$message.error(this.$t("pay.AmountCannotBeLessThan0"));if(this.payment.rewardAmount=r,this.showCheckoutCounter=!1,"walletPay"===n)this.showPasswordInput=!0,this.createOrder(o,this.payOrRewardAmount,this.payOrderType,20).finally((function(){e.defaultLoading=!1}));else if("wxPay"===n){if(!this.forums.paycenter.wxpay_close)return this.$message.warning(this.$t("pay.wxPayClose"));this.createOrder(o,this.payOrRewardAmount,this.payOrderType,10).then((function(){e.payOrder().then((function(t){e.payment.wechat_qrcode=t,e.wxPayActive().then((function(){e.getThread()}),(function(){}))}),(function(){}))})).finally((function(){e.defaultLoading=!1}))}},onPasswordInputCompleted:function(t){var e=this;this.payOrder(t).then((function(){e.getThread()}),(function(){}))},postCommand:function(t){var e=this;if(!this.defaultLoading&&this.isLogin()){this.defaultLoading=!0;var n="isLiked"===t.command?{_jv:{type:"posts",id:this.postId}}:{_jv:{type:"threads",id:this.threadId}};return n[t.command]=!t.isStatus,this.$store.dispatch("jv/patch",n).then((function(data){return data.firstPost&&e.initManagementList(data),data.firstPost&&e.initActions(data),"isSticky"===t.command?t.isStatus?e.$message.success(e.$t("topic.stickySuccess")):e.$message.success(e.$t("topic.cancelStickySuccess")):"isLiked"===t.command?e.setLikeUser(!t.isStatus,data):"isDeleted"===t.command?e.afterDeleted():void 0}),(function(t){return e.handleError(t)})).finally((function(){e.defaultLoading=!1}))}},setLikeUser:function(t,data){var e=this;this.initActions(null,data),t?this.article.likedUsers.unshift(this.currentUser):this.article.likedUsers.forEach((function(t,n,o){t.id===e.currentUser.id&&o.splice(n,1)}))},afterDeleted:function(){var t=this;this.$message({typeInformation:"success",message:this.$t("topic.deleteSuccessAndJumpToBack")}),setTimeout((function(){t.$router.push("/")}),1e3)}},head:function(){return{title:(this.thread&&this.thread.title||this.thread&&this.thread.firstPost&&this.thread.firstPost.summaryText.slice(0,15)||"主题详情页")+(this.forums&&this.forums.set_site&&this.forums.set_site.site_name?" - "+this.forums.set_site.site_name:"‎"),meta:[{hid:"keywords",name:"keywords",content:this.thread.category&&this.thread.category.name||""},{hid:"description",name:"description",content:this.thread.firstPost&&this.thread.firstPost.summaryText.slice(0,80)||""},{name:"og:video",content:this.thread.threadVideo&&this.thread.threadVideo.media_url||""}]}}},$=(n(874),n(13)),component=Object($.a)(C,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.defaultLoading,expression:"defaultLoading",modifiers:{fullscreen:!0}}],staticClass:"page-post",attrs:{"element-loading-background":"rgba(0, 0, 0, 0)"}},[n("main",{directives:[{name:"loading",rawName:"v-loading",value:t.articleLoading,expression:"articleLoading"}]},[n("div",{staticClass:"container-post"},[0===t.thread.isApproved?n("div",{staticClass:"checking"},[t._v("\n        "+t._s(t.thread.threadVideo&&0===t.thread.threadVideo.status?t.$t("topic.VideoTranscoding"):t.$t("topic.examineTip"))+"\n      ")]):t._e(),t._v(" "),n("topic-header",{attrs:{author:t.thread.user||{},thread:t.thread,"management-list":t.managementList,"be-asked-user":t.question&&t.question.beUser?t.question.beUser:{}},on:{managementSelected:t.postCommand}}),t._v(" "),n("topic-content",{attrs:{article:t.article,title:t.thread.title||"",video:t.thread.threadVideo||{},audio:t.thread.threadAudio||{},"paid-information":t.paidInformation,"thread-type":t.thread.type||0,category:t.thread.category||{},location:t.location},on:{payForThread:function(e){t.showCheckoutCounter=!0}}}),t._v(" "),5===t.thread.type?n("qa-actions",{attrs:{question:t.question||{},"current-user-id":t.currentUser&&t.currentUser.id?t.currentUser.id:"","question-user-id":t.thread.user&&t.thread.user.id?t.thread.user.id:""},on:{answerPublished:function(e){return t.getThread()},payForAnswer:function(e){t.showCheckoutCounter=!0}}}):t._e(),t._v(" "),n("topic-reward-list",{attrs:{author:t.thread.user||{},"paid-information":t.paidInformation,"can-paid":t.forums&&t.forums.paycenter&&t.forums.paycenter.wxpay_close,"can-reward":t.forums&&t.forums.paycenter&&t.forums.paycenter.wxpay_close&&t.thread.canBeReward,"thread-type":t.thread.type||0,"user-lists":[t.thread.paidUsers||[],t.thread.rewardedUsers||[],t.article.likedUsers||[],[]]},on:{payOrReward:function(e){t.showCheckoutCounter=!0}}}),t._v(" "),n("topic-actions",{attrs:{"thread-id":t.threadId,actions:t.actions||[]},on:{clickAction:t.postCommand}}),t._v(" "),t.showCheckoutCounter?n("topic-checkout-counter",{attrs:{"thread-type":t.thread.type||0,user:t.thread.user||{},amount:t.payOrRewardAmount,content:t.article.summaryText||"","reward-or-pay":t.rewardOrPay,"be-asked-user":t.question.beUser||{},"ask-or-watch-answer":"watchAnswer"},on:{close:function(e){t.showCheckoutCounter=!1},paying:t.paying}}):t._e(),t._v(" "),t.showPasswordInput?n("topic-password",{attrs:{price:t.payOrRewardAmount,"password-error":t.passwordError,"password-error-tip":t.passwordErrorTip},on:{"update:passwordError":function(e){t.passwordError=e},"update:password-error":function(e){t.passwordError=e},close:function(e){t.showPasswordInput=t.passwordError=!1},password:t.onPasswordInputCompleted,findPassword:t.onFindPassword}}):t._e(),t._v(" "),t.showWxPay?n("topic-wx-pay",{attrs:{"qr-code":t.payment.wechat_qrcode},on:{close:function(e){t.showWxPay=!1}}}):t._e(),t._v(" "),t.findPassword&&t.currentUser.originalMobile?n("find-paypwd",{attrs:{mobile:t.currentUser.mobile,phonenum:t.currentUser.originalMobile},on:{close:function(e){t.findPassword=!1}}}):t._e(),t._v(" "),t.findPassword&&!t.currentUser.originalMobile?n("without-phone",{on:{close:function(e){t.findPassword=!1}}}):t._e(),t._v(" "),n("comment",{attrs:{"thread-id":t.threadId}})],1)]),t._v(" "),n("topic-aside",{attrs:{author:t.thread.user||{}}})],1)}),[],!1,null,"9562ef2c",null);e.default=component.exports;installComponents(component,{TopicHeader:n(902).default,TopicContent:n(743).default,QaActions:n(901).default,TopicRewardList:n(900).default,TopicActions:n(899).default,TopicCheckoutCounter:n(746).default,TopicPassword:n(745).default,TopicWxPay:n(658).default,FindPaypwd:n(656).default,WithoutPhone:n(657).default,Comment:n(898).default,TopicAside:n(747).default})}}]);