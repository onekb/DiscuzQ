_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[54],{"/Ugf":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("rB9j"),n("UxlC");function i(e){return e.replace(/(<\/?.+?\/?>)|\n/g,"")}},"5MUC":function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n("QWBl"),n("T63A"),n("tkto"),n("FZtP");var i=n("J4zp"),a=n.n(i),r={101:"IMAGE",102:"VOICE",103:"VIDEO",104:"GOODS",105:"QA",106:"RED_PACKET",107:"REWARD",108:"VOTE",109:"VOTE_THREAD",110:"FILE",111:"QA_IMAGE"};function s(e){var t={};return e&&Object.keys(e)&&Object.entries(e).forEach((function(e){var n=a()(e,2)[1];if(n){var i=n.tomId,s=n.body;t[r[i]]=s}})),t}},"7mQc":function(e,t,n){"use strict";n("ma9I"),n("2B1R"),n("sMBO");var i,a=n("nKUr"),r=n("lwsE"),s=n.n(r),o=n("W8MJ"),c=n.n(o),l=n("7W2i"),u=n.n(l),d=n("a1gu"),p=n.n(d),h=n("Nsbk"),v=n.n(h),m=n("q1tI"),f=n.n(m),j=n("YuPt"),b=n("Bvw4"),k=n("MCNy"),x=n.n(k),O=n("+B3f"),y=n("+Lwc"),C=n("kMSe"),g=n("Q6w4"),w=n("5WlO"),D=n("TSYQ"),N=n.n(D),R=n("RGe9"),I=n("TibX"),P=n("vPOe"),S=n("HLiX");function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p()(this,n)}}var T,E=Object(C.d)(i=function(e){u()(n,e);var t=L(n);function n(){var e;s()(this,n);for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).transformer=function(t){var n,i,r,s,o,c=e.props.threadId===(null===(n=e.props)||void 0===n||null===(i=n.data)||void 0===i?void 0:i.commentUserId),l=!(null===(r=e.props)||void 0===r||null===(s=r.data)||void 0===s||null===(o=s.commentUser)||void 0===o||!o.avatar),u=e.props.data.commentUserId?Object(a.jsxs)("div",{className:"".concat(O.a.commentUser," ").concat(l?"":O.a.positionTop),children:[Object(a.jsx)("div",{className:O.a.replyedAvatar,onClick:function(){e.avatarClick(3)},children:Object(a.jsx)(b.a,{className:O.a.avatar,image:(e.props.data.commentUser.nickname||e.props.data.commentUser.userName)&&e.props.data.commentUser.avatar,name:e.props.data.commentUser.nickname||e.props.data.replyUser.userName||"\u5f02",circle:!0,size:"small"})}),Object(a.jsx)("span",{className:O.a.replyedUserName,onClick:function(){e.avatarClick(3)},children:e.props.data.commentUser.nickname||e.props.data.commentUser.userName||"\u7528\u6237\u5f02\u5e38"}),c&&!e.props.isAnonymous&&Object(a.jsx)("div",{className:O.a.masterBox,children:Object(a.jsx)("span",{className:O.a.masterText,children:"\u697c\u4e3b"})})]}):"";return t.unshift(u),t},e.toCommentDetail=function(){"function"===typeof e.props.toCommentDetail&&e.props.toCommentDetail()},e}return c()(n,[{key:"likeClick",value:function(){"function"===typeof this.props.likeClick&&this.props.likeClick()}},{key:"replyClick",value:function(){"function"===typeof this.props.replyClick&&this.props.replyClick()}},{key:"deleteClick",value:function(){"function"===typeof this.props.deleteClick&&this.props.deleteClick()}},{key:"avatarClick",value:function(e){"function"===typeof this.props.avatarClick&&this.props.avatarClick(e)}},{key:"generatePermissions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{canApprove:e.canApprove||!1,canDelete:e.canDelete||!1,canEdit:e.canEdit||!1,canHide:e.canHide||!1,canLike:e.canLike||!1}}},{key:"filterContent",value:function(){var e,t,n=(null===(e=this.props)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.content)||"";return n=g.a.parse(n),n=Object(w.a)(n),n=Object(P.a)(n)}},{key:"render",value:function(){var e,t,n,i,r,s,o,c,l,u,d,p,h,v,m,f,j,k,x,C,g,w,D,P,L,T,E,A,M,B,F,z,V=this,U=this.generatePermissions(this.props.data),W=U.canLike,q=(U.canDelete,U.canHide),H=((null===(e=this.props.data)||void 0===e?void 0:e.user)||{}).groups,_=this.props.threadId===(null===(t=this.props)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.userId),G=1===(null===(i=this.props)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.isApproved);return Object(a.jsxs)("div",{className:O.a.replyList,children:[Object(a.jsx)("div",{className:O.a.replyListAvatar,onClick:function(){V.avatarClick(2)},children:Object(a.jsx)(b.a,{image:((null===(s=this.props.data)||void 0===s||null===(o=s.user)||void 0===o?void 0:o.nickname)||(null===(c=this.props.data)||void 0===c||null===(l=c.user)||void 0===l?void 0:l.userName))&&(null===(u=this.props.data)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.avatar),name:(null===(p=this.props.data)||void 0===p||null===(h=p.user)||void 0===h?void 0:h.nickname)||(null===(v=this.props.data)||void 0===v||null===(m=v.user)||void 0===m?void 0:m.userName)||"\u5f02",circle:!0,size:"small"})}),Object(a.jsxs)("div",{className:O.a.replyListContent,children:[Object(a.jsxs)("div",{className:"".concat(O.a.replyListContentText," ").concat(this.props.active&&O.a.active),children:[Object(a.jsxs)("div",{className:O.a.replyListName,children:[Object(a.jsxs)("div",{className:O.a.userInfo,children:[Object(a.jsx)("div",{className:O.a.replyListName,onClick:function(){V.avatarClick(2)},children:Object(a.jsx)("span",{className:O.a.replyListNameText,children:(null===(f=this.props.data)||void 0===f||null===(j=f.user)||void 0===j?void 0:j.nickname)||(null===(k=this.props.data)||void 0===k||null===(x=k.user)||void 0===x?void 0:x.userName)||"\u7528\u6237\u5f02\u5e38"})}),_&&!this.props.isAnonymous&&Object(a.jsx)("div",{className:O.a.masterBox,children:Object(a.jsx)("span",{className:O.a.masterText,children:"\u697c\u4e3b"})}),!(null===H||void 0===H||!H.isDisplay)&&Object(a.jsx)("div",{className:O.a.groups,children:(null===H||void 0===H?void 0:H.name)||(null===H||void 0===H?void 0:H.groupName)})]}),G?Object(a.jsx)("div",{}):Object(a.jsx)("div",{className:O.a.isApproved,children:"\u5ba1\u6838\u4e2d"})]}),Object(a.jsxs)("div",{className:O.a.replyListText,children:[Object(a.jsx)("div",{className:N()(O.a.content),children:Object(a.jsx)(S.a,{onRedirectToDetail:function(){return V.toCommentDetail()},transformer:this.transformer,useShowMore:!!this.props.isShowOne,content:null===(C=this.props)||void 0===C||null===(g=C.data)||void 0===g?void 0:g.content,customHoverBg:!0})}),((null===(w=this.props.data)||void 0===w||null===(D=w.images)||void 0===D?void 0:D.length)||(null===(P=this.props.data)||void 0===P||null===(L=P.attachments)||void 0===L?void 0:L.length))&&Object(a.jsx)("div",{className:O.a.imageDisplay,children:Object(a.jsx)(R.a,{platform:"h5",imgData:(null===(T=this.props.data)||void 0===T?void 0:T.images)||(null===(E=this.props.data)||void 0===E?void 0:E.attachments)})})]})]}),Object(a.jsxs)("div",{className:O.a.replyListFooter,children:[Object(a.jsx)("div",{className:O.a.replyTime,children:Object(y.a)(this.props.data.createdAt)}),(null===(A=this.props.data)||void 0===A?void 0:A.user)&&Object(a.jsxs)("div",{className:O.a.extraBottom,children:[Object(a.jsx)("div",{className:null!==(M=this.props)&&void 0!==M&&null!==(B=M.data)&&void 0!==B&&B.isLiked?O.a.replyLike:O.a.replyLiked,children:Object(a.jsxs)("span",{onClick:Object(I.a)((function(){return V.likeClick(W)}),500),children:["\u8d5e\xa0",0===(null===(F=this.props)||void 0===F||null===(z=F.data)||void 0===z?void 0:z.likeCount)?"":this.props.data.likeCount]})}),Object(a.jsx)("div",{className:O.a.replyReply,children:Object(a.jsx)("span",{onClick:function(){return V.replyClick()},children:"\u56de\u590d"})}),q&&Object(a.jsx)("div",{className:O.a.replyDelete,children:Object(a.jsx)("span",{onClick:function(){return V.deleteClick()},children:"\u5220\u9664"})})]})]})]})]})}}]),n}(f.a.Component))||i;function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p()(this,n)}}var M=Object(C.d)(T=function(e){u()(n,e);var t=A(n);function n(e){var i;return s()(this,n),(i=t.call(this,e)).toCommentDetail=function(){i.state.isShowOne&&"function"===typeof i.props.onCommentClick&&i.props.onCommentClick()},i.state={isShowOne:i.props.isShowOne||!1},i.needReply=i.props.data.lastThreeComments,i}return c()(n,[{key:"filterContent",value:function(){var e,t,n=(null===(e=this.props)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.content)||"";return n=g.a.parse(n),n=Object(w.a)(n)}},{key:"avatarClick",value:function(){var e;"function"===typeof(null===(e=this.props)||void 0===e?void 0:e.avatarClick)&&this.props.avatarClick()}},{key:"likeClick",value:function(){"function"===typeof this.props.likeClick&&this.props.likeClick()}},{key:"replyClick",value:function(){"function"===typeof this.props.replyClick&&this.props.replyClick()}},{key:"deleteClick",value:function(){"function"===typeof this.props.deleteClick&&this.props.deleteClick()}},{key:"editClick",value:function(){"function"===typeof this.props.editClick&&this.props.editClick()}},{key:"replyLikeClick",value:function(e){"function"===typeof this.props.replyLikeClick&&this.props.replyLikeClick(e)}},{key:"replyReplyClick",value:function(e){"function"===typeof this.props.replyReplyClick&&this.props.replyReplyClick(e)}},{key:"replyDeleteClick",value:function(e){"function"===typeof this.props.replyDeleteClick&&this.props.replyDeleteClick(e)}},{key:"replyAvatarClick",value:function(e,t){"function"===typeof this.props.replyAvatarClick&&this.props.replyAvatarClick(e,t)}},{key:"generatePermissions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{canApprove:e.canApprove||!1,canDelete:e.canDelete||!1,canEdit:e.canEdit||!1,canHide:e.canHide||!1,canLike:e.canLike||!1}}},{key:"render",value:function(){var e,t,n,i,r,s,o,c,l,u,d,p,h,v,m,f,k,O,C,g,w,D,P,L,T,A,M,B,F,z,V,U,W,q=this,H=this.generatePermissions(this.props.data),_=(H.canDelete,H.canEdit,H.canLike),G=H.canHide,K=((null===(e=this.props.data)||void 0===e?void 0:e.user)||{}).groups,X=this.props.threadId===(null===(t=this.props)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.userId),J=1===(null===(i=this.props)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.isApproved);return Object(a.jsxs)("div",{className:"".concat(j.a.commentList," dzq-comment"),children:[Object(a.jsx)("div",{className:j.a.header,children:Object(a.jsxs)("div",{className:j.a.showGet,children:[Object(a.jsx)("div",{}),Object(a.jsxs)("div",{className:j.a.headerRigth,children:[null!==(s=this.props.data)&&void 0!==s&&s.rewards?Object(a.jsxs)("div",{className:j.a.imageNumber,children:[Object(a.jsx)("img",{className:j.a.rewardImage,src:"/dzq-img/coin.png",alt:"\u60ac\u8d4f\u56fe\u6807"}),Object(a.jsxs)("div",{className:j.a.showMoneyNum,children:["\u83b7\u5f97",Object(a.jsx)("span",{className:j.a.moneyNumber,children:this.props.data.rewards}),"\u5143\u60ac\u8d4f\u91d1"]})]}):"",null!==(o=this.props.data)&&void 0!==o&&o.redPacketAmount?Object(a.jsxs)("div",{className:"".concat(j.a.redpacket," ").concat(j.a.imageNumber),children:[Object(a.jsx)("img",{className:j.a.image,src:"/dzq-img/redpacket-mini.png",alt:"\u7ea2\u5305\u56fe\u6807"}),Object(a.jsxs)("div",{className:j.a.showMoneyNum,children:["\u83b7\u5f97",Object(a.jsx)("span",{className:j.a.moneyNumber,children:this.props.data.redPacketAmount}),"\u5143\u7ea2\u5305"]})]}):"",this.state.isShowOne?"":Object(a.jsx)("div",{className:j.a.more,onClick:this.props.onMoreClick,children:Object(a.jsx)(x.a,{size:20,color:"#8590A6",name:"MoreVOutlined",className:j.a.moreIcon})})]})]})}),Object(a.jsxs)("div",{className:j.a.content,children:[Object(a.jsx)("div",{className:j.a.commentListAvatar,onClick:function(){return q.avatarClick()},children:Object(a.jsx)(b.a,{image:((null===(c=this.props.data)||void 0===c||null===(l=c.user)||void 0===l?void 0:l.nickname)||(null===(u=this.props.data)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.userName))&&(null===(p=this.props.data)||void 0===p||null===(h=p.user)||void 0===h?void 0:h.avatar),name:(null===(v=this.props.data)||void 0===v||null===(m=v.user)||void 0===m?void 0:m.nickname)||(null===(f=this.props.data)||void 0===f||null===(k=f.user)||void 0===k?void 0:k.userName)||"\u5f02",circle:!0})}),Object(a.jsxs)("div",{className:j.a.commentListContent,children:[Object(a.jsxs)("div",{className:"".concat(j.a.commentListContentText," ").concat(this.props.active&&j.a.active),children:[Object(a.jsxs)("div",{className:j.a.commentHeader,children:[Object(a.jsxs)("div",{className:j.a.userInfo,children:[Object(a.jsx)("div",{className:j.a.commentListName,children:(null===(O=this.props.data)||void 0===O||null===(C=O.user)||void 0===C?void 0:C.nickname)||(null===(g=this.props.data)||void 0===g||null===(w=g.user)||void 0===w?void 0:w.userName)||"\u7528\u6237\u5f02\u5e38"}),X&&!this.props.isAnonymous&&Object(a.jsx)("div",{className:j.a.masterBox,children:Object(a.jsx)("span",{className:j.a.masterText,children:"\u697c\u4e3b"})}),!(null===K||void 0===K||!K.isDisplay)&&Object(a.jsx)("div",{className:j.a.groups,children:(null===K||void 0===K?void 0:K.name)||(null===K||void 0===K?void 0:K.groupName)})]}),J?Object(a.jsx)("div",{}):Object(a.jsx)("div",{className:j.a.isApproved,children:"\u5ba1\u6838\u4e2d"})]}),Object(a.jsx)("div",{className:N()(j.a.commentListText),children:Object(a.jsx)(S.a,{onRedirectToDetail:function(){return q.toCommentDetail()},useShowMore:!!this.state.isShowOne,content:null===(D=this.props)||void 0===D||null===(P=D.data)||void 0===P?void 0:P.content,customHoverBg:!0})}),(null===(L=this.props.data)||void 0===L?void 0:L.images.length)>0&&Object(a.jsx)("div",{className:j.a.imageDisplay,children:Object(a.jsx)(R.a,{platform:"h5",imgData:null===(T=this.props.data)||void 0===T?void 0:T.images})})]}),(null===(A=this.props.data)||void 0===A?void 0:A.user)&&Object(a.jsxs)("div",{className:j.a.commentListFooter,children:[Object(a.jsxs)("div",{className:j.a.commentBtn,children:[Object(a.jsx)("div",{className:j.a.commentTime,children:Object(y.a)(this.props.data.createdAt)}),Object(a.jsxs)("div",{className:j.a.extraBottom,children:[Object(a.jsx)("div",{className:null!==(M=this.props)&&void 0!==M&&null!==(B=M.data)&&void 0!==B&&B.isLiked?j.a.commentLike:j.a.commentLiked,children:Object(a.jsxs)("span",{onClick:Object(I.a)((function(){return q.likeClick(_)}),500),children:["\u8d5e\xa0",(null===(F=this.props)||void 0===F||null===(z=F.data)||void 0===z?void 0:z.likeCount)>0?this.props.data.likeCount:""]})}),Object(a.jsx)("div",{className:j.a.commentReply,children:Object(a.jsx)("span",{onClick:function(){return q.replyClick()},children:"\u56de\u590d"})}),this.props.isShowAdopt&&Object(a.jsx)("div",{className:j.a.commentAdopt,children:Object(a.jsx)("span",{onClick:function(){return q.props.onAboptClick()},children:"\u91c7\u7eb3"})}),G&&Object(a.jsx)("div",{className:j.a.extra,children:G&&Object(a.jsx)("div",{className:j.a.revise,onClick:function(){return q.deleteClick()},children:"\u5220\u9664"})})]})]}),(null===(V=this.props.data)||void 0===V?void 0:V.replyCount)-1>0&&this.state.isShowOne?Object(a.jsxs)("div",{className:j.a.moreReply,onClick:function(){return q.toCommentDetail()},children:["\u67e5\u770b\u4e4b\u524d",(null===(U=this.props.data)||void 0===U?void 0:U.replyCount)-1,"\u6761\u56de\u590d..."]}):"",(null===(W=this.needReply)||void 0===W?void 0:W.length)>0&&Object(a.jsx)("div",{className:j.a.replyList,children:this.state.isShowOne?Object(a.jsx)(E,{isAnonymous:this.props.isAnonymous,data:this.needReply[0],isShowOne:!0,avatarClick:function(e){return q.replyAvatarClick(q.needReply[0],e)},likeClick:function(){return q.replyLikeClick(q.needReply[0])},replyClick:function(){return q.replyReplyClick(q.needReply[0])},deleteClick:function(){return q.replyDeleteClick(q.needReply[0])},toCommentDetail:function(){return q.toCommentDetail()},threadId:this.props.threadId},this.needReply[0].id):(this.needReply||[]).map((function(e,t){return Object(a.jsx)("div",{ref:e.id===q.props.postId?q.props.positionRef:null,children:Object(a.jsx)(E,{isAnonymous:q.props.isAnonymous,data:e,avatarClick:function(t){return q.replyAvatarClick(e,t)},likeClick:function(){return q.replyLikeClick(e)},replyClick:function(){return q.replyReplyClick(e)},deleteClick:function(){return q.replyDeleteClick(e)},toCommentDetail:function(){return q.toCommentDetail()},active:q.props.postId===e.id,threadId:q.props.threadId},e.id||t)},e.id||t)}))})]})]})]})]})}}]),n}(f.a.Component))||T;t.a=M},JMpY:function(e,t,n){"use strict";n("sMBO");var i,a=n("nKUr"),r=n("lwsE"),s=n.n(r),o=n("W8MJ"),c=n.n(o),l=n("7W2i"),u=n.n(l),d=n("a1gu"),p=n.n(d),h=n("Nsbk"),v=n.n(h),m=n("q1tI"),f=n.n(m),j=n("MCNy"),b=n.n(j),k=n("5f2u"),x=n.n(k),O=n("Bvw4"),y=n("l/UT"),C=n("+Lwc"),g=n("kMSe"),w=n("TSYQ"),D=n.n(w);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=v()(e);if(t){var a=v()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return p()(this,n)}}var R=Object(g.c)("thread")(i=Object(g.d)(i=function(e){u()(n,e);var t=N(n);function n(e){var i;return s()(this,n),(i=t.call(this,e)).user=i.props.user||{},i}return c()(n,[{key:"onFollowClick",value:function(){"function"===typeof this.props.onFollowClick&&this.props.onFollowClick()}},{key:"onPrivateLetter",value:function(){"function"===typeof this.props.onPrivateLetter&&this.props.onPrivateLetter()}},{key:"onPersonalPage",value:function(){"function"===typeof this.props.onPersonalPage&&this.props.onPersonalPage()}},{key:"render",value:function(){var e=this;return Object(a.jsxs)("div",{className:y.a.container,children:[Object(a.jsx)("div",{className:y.a.header,children:Object(a.jsx)("span",{children:"\u697c\u4e3b"})}),Object(a.jsxs)("div",{className:y.a.info,children:[Object(a.jsxs)("div",{className:y.a.AuthorInfo,children:[Object(a.jsx)("div",{className:y.a.avatar,children:Object(a.jsx)(O.a,{image:this.user.avatarUrl,name:this.user.nickname,circle:!0,userId:this.user.id,platform:"pc",onClick:function(){return e.onPersonalPage()}})}),Object(a.jsxs)("div",{className:y.a.information,children:[Object(a.jsx)("div",{className:y.a.name,onClick:function(){return e.onPersonalPage()},children:this.user.nickname||""}),Object(a.jsxs)("div",{className:y.a.dynamic,children:["\u6d3b\u8dc3\u5728 ",Object(C.a)(this.user.updatedAt)]})]})]}),Object(a.jsxs)("div",{className:y.a.theme,children:[Object(a.jsxs)("div",{className:y.a.themeInfo,children:[Object(a.jsx)("div",{className:y.a.title,children:"\u4e3b\u9898"}),Object(a.jsx)("div",{className:y.a.number,children:this.user.threadCount})]}),Object(a.jsxs)("div",{className:y.a.themeInfo,children:[Object(a.jsx)("div",{className:y.a.title,children:"\u70b9\u8d5e"}),Object(a.jsx)("div",{className:y.a.number,children:this.user.likedCount})]}),Object(a.jsxs)("div",{className:y.a.themeInfo,children:[Object(a.jsx)("div",{className:y.a.title,children:"\u5df2\u5173\u6ce8"}),Object(a.jsx)("div",{className:y.a.number,children:this.user.followCount})]}),Object(a.jsxs)("div",{className:y.a.themeInfo,children:[Object(a.jsx)("div",{className:y.a.title,children:"\u7c89\u4e1d"}),Object(a.jsx)("div",{className:y.a.number,children:this.user.fansCount})]})]})]}),this.props.isShowBtn?Object(a.jsxs)("div",{className:y.a.btn,children:[!this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:y.a.follow,onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:y.a.btnItem,children:[Object(a.jsx)(b.a,{name:"PlusOutlined",size:"14",className:y.a.btnIcon}),Object(a.jsx)("span",{children:"\u5173\u6ce8"})]})}),1===this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:D()(y.a.follow,y.a["is-followed"]),onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:y.a.btnItem,children:[Object(a.jsx)(b.a,{name:"CheckOutlined",size:"14",className:y.a.btnIcon}),Object(a.jsx)("span",{children:"\u5df2\u5173\u6ce8"})]})}),2===this.user.follow&&Object(a.jsx)(x.a,{type:"primary",className:D()(y.a.follow,y.a["with-followed"]),onClick:function(){return e.onFollowClick()},children:Object(a.jsxs)("div",{className:y.a.btnItem,children:[Object(a.jsx)(b.a,{name:"WithdrawOutlined",size:"14",className:y.a.btnIcon}),Object(a.jsx)("span",{children:"\u4e92\u5173"})]})}),Object(a.jsx)(x.a,{className:y.a.privateLetter,onClick:function(){return e.onPrivateLetter()},children:Object(a.jsxs)("div",{className:y.a.btnItem,children:[Object(a.jsx)(b.a,{name:"CommentOutlined",size:"14",className:y.a.btnIcon}),Object(a.jsx)("span",{children:"\u53d1\u79c1\u4fe1"})]})})]}):""]})}}]),n}(f.a.Component))||i)||i;t.a=R},L0er:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("nKUr"),a=n("q1tI"),r=n("no3E"),s=n("5f2u"),o=n.n(s),c=n("z8Av");function l(e){var t=Object(a.useState)(e.text||"\u670d\u52a1\u5668\u9519\u8bef SERVER ERROR")[0];return Object(i.jsxs)("div",{className:r.a.page,children:[Object(i.jsx)(c.a,{}),Object(i.jsxs)("div",{className:r.a.body,children:[Object(i.jsx)("img",{className:r.a.icon,src:"/dzq-img/error.png"}),Object(i.jsx)("span",{className:r.a.text,children:t})]}),Object(i.jsx)("div",{className:r.a.footer,children:Object(i.jsx)(o.a,{onClick:function(){window.location.reload()},className:r.a.button,type:"primary",children:"\u70b9\u6211\u5237\u65b0"})})]})}},"TP+V":function(e,t,n){"use strict";n.r(t);n("ma9I"),n("yXV3"),n("oVuX"),n("qePV"),n("rB9j"),n("Rm1S"),n("UxlC"),n("hByQ");var i=n("nKUr"),a=n("o0o1"),r=n.n(a),s=(n("ls82"),n("yXPU")),o=n.n(s),c=n("lwsE"),l=n.n(c),u=n("W8MJ"),d=n.n(u),p=n("7W2i"),h=n.n(p),v=n("a1gu"),m=n.n(v),f=n("Nsbk"),j=n.n(f),b=n("q1tI"),k=n.n(b),x=n("20a2"),O=n("kMSe"),y=n("sho3"),C=(n("TeQF"),n("2B1R"),n("R5XZ"),n("B5JU")),g=n.n(C),w=n("B5zU"),D=n("HgT0"),N=(n("ACYA"),n("TSYQ")),R=n.n(N);var I,P=n("wrmh"),S=n("n/mO"),L=n("MCNy"),T=n.n(L),E=n("DetZ"),A=n.n(E),M=n("wdT/"),B=n.n(M),F=n("z8Av"),z=n("IvHc"),V=n("woGs"),U=n("33mu"),W=function(e){var t=e.showContent,n=e.setTop;return Object(i.jsxs)("div",{className:"".concat(U.a.setTop," ").concat(n?U.a.inTop:U.a.outTop),children:[Object(i.jsx)("span",{className:U.a.setTopIcon,children:Object(i.jsx)(T.a,{className:U.a.icon,name:"CheckOutlined"})}),t?"\u7f6e\u9876\u6210\u529f":"\u5df2\u53d6\u6d88\u7f6e\u9876"]})},q=n("aIz1"),H=n("c7hV"),_=n("iVyX"),G=n("dQ0f"),K=n("TibX"),X=n("z6Ap"),J=n("rOX+"),Q=n.n(J),Z=n("fkjL"),Y=n("k8W2"),$=n.n(Y),ee=n("5f2u"),te=n.n(ee),ne=n("x2xJ"),ie=n.n(ne),ae=n("/G68"),re=n("lY1M"),se=function(e){var t=e.visible,n=e.onOkClick,a=Object(b.useState)(""),s=a[0],c=a[1];Object(b.useEffect)((function(){c("")}),[t]);var l=function(){"function"===typeof(null===e||void 0===e?void 0:e.onCancel)&&e.onCancel()},u=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""===s||Number(s)<=0||Number(s)>1e6)){e.next=4;break}return(""===s||Number(s)<=0)&&B.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u4e3a0"}),Number(s)>1e6&&B.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc7100\u4e07"}),e.abrupt("return");case 4:if("function"!==typeof n){e.next=16;break}return e.prev=6,e.next=9,n(s);case 9:e.sent&&c(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}(),d=function(){re.b.env("ios")&&setTimeout((function(){return function(){var e=document.body.scrollHeight;window.scrollTo(0,e)}()}),100)};return Object(i.jsx)($.a,{position:"bottom",visible:t,onClose:l,children:Object(i.jsxs)("div",{className:ae.a.container,children:[Object(i.jsx)("div",{className:ae.a.header,children:"\u652f\u4ed8\u4f5c\u8005\u7ee7\u7eed\u521b\u4f5c"}),Object(i.jsxs)("div",{className:ae.a.rewardInput,children:[Object(i.jsx)("span",{className:ae.a.prepend,children:"\u652f\u4ed8\u91d1\u989d"}),Object(i.jsx)(A.a,{mode:"number",placeholder:"\u91d1\u989d",className:ae.a.input,value:s,onChange:function(e){return function(e){var t=e.match(/([1-9]\d{0,6}|0)(\.\d{0,2})?/);c(t?t[0]:"")}(e.target.value)},onFocus:function(){return d()}}),Object(i.jsx)("span",{className:ae.a.append,children:"\u5143"})]}),Object(i.jsx)("div",{className:ae.a.rewardList,children:[1,2,5,10,20,50,88,128].map((function(e){return Object(i.jsxs)("div",{onClick:function(){return function(e){c(e)}(e)},className:R()(ae.a.reward,Number(s)===e&&ae.a.actived),children:["\uffe5",e]},e)}))}),Object(i.jsx)(ie.a,{className:ae.a.divider}),Object(i.jsxs)("div",{className:ae.a.button,children:[Object(i.jsx)(te.a,{onClick:l,className:ae.a.cancel,type:"default",children:"\u53d6\u6d88"}),Object(i.jsx)(te.a,{onClick:u,className:ae.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})},oe=n("kjBj"),ce=n("RiVy"),le=n("5MUC"),ue=n("RGe9"),de=n("NOng"),pe=n("HLiX"),he=n("Hg/G"),ve=n("JMBi"),me=n("f5Uc"),fe=(n("pNMO"),n("4Brf"),n("07d7"),n("9p2j"),n("zzKd"),Symbol("\u7ea2\u5305"),Symbol("\u8d4f\u91d1"),n("fEx9")),je=n("W7Eq"),be=(n("lW1z"),n("JuNc")),ke=n("zBpv"),xe=n("bJLh"),Oe=n("lSNA"),ye=n.n(Oe),Ce=n("Jd9u"),ge=function(e){var t=e.onClose,n=void 0===t?function(){}:t,a=e.money,r=void 0===a?"0.00":a,s=Object(b.useState)(!1),o=s[0],c=s[1],l=function(){document.querySelector("#button").style="transform: rotateY(360deg); visibility: hidden",document.querySelector("#open").style.visibility="hidden",document.querySelector("#moneyText").style="opacity: 1",c(!0)};return Object(i.jsxs)("div",{className:Ce.a.masking,onClick:function(e){"function"===typeof n&&o&&n()},children:[Object(i.jsxs)("div",{className:Ce.a.container,children:[Object(i.jsxs)("div",{className:Ce.a.moneyText,id:"moneyText",children:[Object(i.jsx)("div",{className:Ce.a.text,children:"\u606d\u559c\u60a8\uff0c\u9886\u5230\u4e86"}),Object(i.jsxs)("div",{className:Ce.a.money,children:[r,"\u5143"]})]}),Object(i.jsx)("div",{className:Ce.a.button,id:"button",onClick:l,children:Object(i.jsx)("div",{className:Ce.a.open,id:"open",children:"\u5f00"})}),Object(i.jsx)("img",{src:"https://imgcache.qq.com/operation/dianshi/other/up.01d1a47e41389411f01d143867134d93e0678512.png",id:"up",className:R()(Ce.a.up,ye()({},Ce.a.animationUp,o))}),Object(i.jsx)("img",{src:"https://imgcache.qq.com/operation/dianshi/other/bottom.5e276e5e63dc355cea9ad803dbc2bc6169acc0ed.gif",id:"bottom",className:R()(Ce.a.bottom,ye()({},Ce.a.animationBottom,o))})]}),Object(i.jsx)("div",{className:Ce.a.button,id:"button",onClick:l,children:Object(i.jsx)("div",{className:Ce.a.open,id:"open",children:"\u5f00"})})]})},we=Object(O.c)("user")(Object(O.d)((function(e){var t,n,a,s,c,l,u,d,p,h,v,m,f,j,k,x,O,y,C,g,w,D,N,I,P,S,L,E,A,M,B,F,z,V,U,W,q,H,_,G,X,J,Q,Z,Y,$,ee,ne,ie,ae,re,se,oe,ce,Oe,ye,Ce,we=e.store,De=(null===we||void 0===we||null===(t=we.threadData)||void 0===t?void 0:t.content)||{},Ne=De.text,Re=De.indexes,Ie=null===we||void 0===we?void 0:we.threadData,Pe=Ie.parentCategoryName,Se=Ie.categoryName,Le=we.hasRedPacket,Te={postId:null===we||void 0===we||null===(n=we.threadData)||void 0===n?void 0:n.postId,threadId:null===we||void 0===we||null===(a=we.threadData)||void 0===a?void 0:a.threadId,platform:"h5",payType:null===we||void 0===we||null===(s=we.threadData)||void 0===s?void 0:s.payType},Ee=1===((null===we||void 0===we||null===(c=we.threadData)||void 0===c?void 0:c.isApproved)||0),Ae=(null===we||void 0===we||null===(l=we.threadData)||void 0===l||null===(u=l.displayTag)||void 0===u?void 0:u.isEssence)||!1,Me=0===(null===we||void 0===we||null===(d=we.threadData)||void 0===d?void 0:d.payType),Be=2===(null===we||void 0===we||null===(p=we.threadData)||void 0===p?void 0:p.payType)&&!1===(null===we||void 0===we||null===(h=we.threadData)||void 0===h?void 0:h.paid),Fe=(null===we||void 0===we||null===(v=we.threadData)||void 0===v?void 0:v.attachmentPrice)||0,ze=!Je&&Be&&!qe&&!We,Ve=1===(null===we||void 0===we||null===(m=we.threadData)||void 0===m?void 0:m.payType),Ue=(null===we||void 0===we||null===(f=we.threadData)||void 0===f?void 0:f.price)||0,We=!0===(null===we||void 0===we||null===(j=we.threadData)||void 0===j?void 0:j.paid),qe=(1===(null===we||void 0===we||null===(k=we.threadData)||void 0===k?void 0:k.payType)&&(null===we||void 0===we||null===(x=we.threadData)||void 0===x||x.paid),(null===(O=e.user)||void 0===O||null===(y=O.userInfo)||void 0===y?void 0:y.id)&&(null===(C=e.user)||void 0===C||null===(g=C.userInfo)||void 0===g?void 0:g.id)===(null===we||void 0===we||null===(w=we.threadData)||void 0===w?void 0:w.userId)),He=null===we||void 0===we||null===(D=we.threadData)||void 0===D||null===(N=D.displayTag)||void 0===N?void 0:N.isRedPack,_e=null===we||void 0===we||null===(I=we.threadData)||void 0===I||null===(P=I.displayTag)||void 0===P?void 0:P.isReward,Ge=Me&&(null===we||void 0===we||null===(S=we.threadData)||void 0===S?void 0:S.ability.canBeReward)&&!He&&!_e,Ke=Me&&(null===we||void 0===we||null===(L=we.threadData)||void 0===L?void 0:L.ability.canBeReward)&&!He&&!_e,Xe=null===we||void 0===we||null===(E=we.threadData)||void 0===E?void 0:E.isReward,Je=null===we||void 0===we||null===(A=we.threadData)||void 0===A?void 0:A.ability.canFreeViewPost,Qe=Object(le.a)(Re);1===(null===(M=Qe.RED_PACKET)||void 0===M?void 0:M.condition)&&we.getRedPacketInfo(Qe.RED_PACKET.threadId);var Ze=function(){var t=o()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"function"===typeof e.onPayClick&&e.onPayClick();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ye=function(){"function"===typeof e.onRewardClick&&e.onRewardClick()};return Object(b.useEffect)((function(){var t;(null===(t=Qe.IMAGE)||void 0===t?void 0:t.length)!==we.contentImgLength&&Qe.IMAGE||e.setContentImgReady()}),[we.contentImgLength]),Object(i.jsxs)("div",{className:"".concat(ke.a.container),children:[Object(i.jsxs)("div",{className:ke.a.header,children:[Object(i.jsx)("div",{className:ke.a.userInfo,children:Object(i.jsx)(be.a,{name:(null===we||void 0===we||null===(B=we.threadData)||void 0===B||null===(F=B.user)||void 0===F?void 0:F.nickname)||"",avatar:(null===we||void 0===we||null===(z=we.threadData)||void 0===z||null===(V=z.user)||void 0===V?void 0:V.avatar)||"",location:(null===we||void 0===we||null===(U=we.threadData)||void 0===U?void 0:U.position.location)||"",groupName:(null===we||void 0===we||null===(W=we.threadData)||void 0===W||null===(q=W.group)||void 0===q?void 0:q.groupName)||"",view:"".concat(null===we||void 0===we||null===(H=we.threadData)||void 0===H?void 0:H.viewCount)||"",time:"".concat(null===we||void 0===we||null===(_=we.threadData)||void 0===_?void 0:_.diffTime)||"",isEssence:Ae,isPay:!Me,isReward:_e,isRed:He,userId:null===we||void 0===we||null===(G=we.threadData)||void 0===G||null===(X=G.user)||void 0===X?void 0:X.userId,onClick:function(t){"function"===typeof e.onUserClick&&e.onUserClick(t)}})}),(null===e||void 0===e||null===(J=e.user)||void 0===J?void 0:J.isLogin())&&Ee&&Object(i.jsx)("div",{className:ke.a.more,onClick:function(){e.fun.moreClick()},children:Object(i.jsx)(T.a,{size:20,color:"#8590A6",name:"MoreVOutlined"})})]}),Object(i.jsxs)("div",{className:ke.a.body,children:[(null===we||void 0===we||null===(Q=we.threadData)||void 0===Q?void 0:Q.title)&&Object(i.jsx)("div",{className:ke.a.title,children:null===we||void 0===we||null===(Z=we.threadData)||void 0===Z?void 0:Z.title}),Ne&&Object(i.jsx)(pe.a,{useShowMore:!1,content:Ne||""}),Qe.VIDEO&&Object(i.jsx)(ve.a,{url:Qe.VIDEO.mediaUrl,coverUrl:Qe.VIDEO.coverUrl,v_height:Qe.VIDEO.height||null,v_width:Qe.VIDEO.width||null,status:Qe.VIDEO.status}),Qe.IMAGE&&Object(i.jsx)(ue.a,{postLoad:function(){we.setContentImgLength()},flat:!0,platform:"h5",imgData:Qe.IMAGE,isPay:ze,onPay:Ze}),Qe.REWARD&&Object(i.jsx)("div",{className:ke.a.rewardText,children:Qe.REWARD&&Object(i.jsxs)("div",{children:[Object(i.jsxs)("div",{className:ke.a.rewardMoney,children:["\u672c\u5e16\u5411\u6240\u6709\u4eba\u60ac\u8d4f",Object(i.jsx)("span",{className:ke.a.rewardNumber,children:Qe.REWARD.money||0}),"\u5143"]}),Object(i.jsxs)("div",{className:ke.a.rewardTime,children:[Qe.REWARD.expiredAt,"\u622a\u6b62\u60ac\u8d4f"]})]})}),(Qe.RED_PACKET||Qe.REWARD)&&Object(i.jsxs)("div",{className:ke.a.reward,children:[Qe.REWARD&&Object(i.jsx)("div",{className:ke.a.rewardBody,style:{width:"100%"},children:Object(i.jsx)(xe.a,{type:1,money:Qe.REWARD.money,remainMoney:Qe.REWARD.remainMoney})}),Qe.RED_PACKET&&Object(i.jsxs)("div",{style:{width:"100%"},children:[Object(i.jsx)(xe.a,{number:Qe.RED_PACKET.number,remainNumber:Qe.RED_PACKET.remainNumber,condition:Qe.RED_PACKET.condition}),!!Qe.RED_PACKET.condition&&Object(i.jsxs)("div",{className:ke.a.redPacketLikeNum,children:["\u8bc4\u8bba\u96c6",Qe.RED_PACKET.likenum,"\u8d5e\u9886\u7ea2\u5305"]})]})]}),Qe.GOODS&&Object(i.jsxs)("div",{children:[Object(i.jsx)(he.a,{image:Qe.GOODS.imagePath,amount:Qe.GOODS.price,title:Qe.GOODS.title,className:ke.a.product}),Object(i.jsxs)(te.a,{className:ke.a.buyBtn,type:"danger",onClick:function(){var e;(e=Qe.GOODS.detailContent)&&window.open(e)},children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"ShoppingCartOutlined",size:20}),Object(i.jsx)("span",{className:ke.a.buyText,children:"\u8d2d\u4e70\u5546\u54c1"})]})]}),Qe.VOICE&&Object(i.jsx)(de.a,{url:Qe.VOICE.mediaUrl}),Qe.VOTE&&Object(i.jsx)(je.a,{attachments:Qe.VOTE,threadId:null===we||void 0===we||null===(Y=we.threadData)||void 0===Y?void 0:Y.threadId}),Qe.VOTE_THREAD&&Object(i.jsx)(me.a,{voteData:Qe.VOTE_THREAD,threadId:null===we||void 0===we||null===($=we.threadData)||void 0===$?void 0:$.threadId,page:"detail"}),ze&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:Ze,children:Object(i.jsxs)(te.a,{className:ke.a.payButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"GoldCoinOutlined",size:16}),Object(i.jsxs)("p",{children:["\u652f\u4ed8",Fe,"\u5143\u67e5\u770b\u9644\u4ef6\u5185\u5bb9"]})]})}),(Pe||Se)&&Object(i.jsx)("div",{className:ke.a.tag,onClick:function(){"function"===typeof e.onTagClick&&e.onTagClick()},children:Pe?"".concat(Pe,"/").concat(Se):Se}),!Je&&Ve&&!qe&&!We&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:Ze,children:Object(i.jsxs)(te.a,{className:ke.a.payButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"GoldCoinOutlined",size:16}),"\u652f\u4ed8",Ue,"\u5143\u67e5\u770b\u5269\u4f59\u5185\u5bb9"]})}),Ke&&Ee&&!qe&&Object(i.jsx)("div",{className:ke.a.rewardContianer,children:Object(i.jsxs)(te.a,{onClick:Ye,className:ke.a.rewardButton,type:"primary",children:[Object(i.jsx)(T.a,{className:ke.a.payIcon,name:"HeartOutlined",size:20}),Object(i.jsx)("span",{className:ke.a.rewardext,children:"\u6253\u8d4f"})]})})]}),Ee&&Object(i.jsxs)("div",{className:ke.a.footer,children:[Object(i.jsxs)("div",{className:ke.a.thumbs,children:[Ve&&Object(i.jsx)(T.a,{className:R()(ke.a.payIcon,We&&ke.a.actived),name:"GoldCoinOutlined",size:20}),Ge&&Object(i.jsx)(T.a,{onClick:function(){return!qe&&Ye()},className:R()(ke.a.payIcon,Xe&&ke.a.actived),name:"HeartOutlined",size:20}),Object(i.jsxs)("div",{className:R()(ke.a.liked,(null===we||void 0===we||null===(ee=we.threadData)||void 0===ee?void 0:ee.isLike)&&ke.a.actived),onClick:Object(K.a)((function(){"function"===typeof e.onLikeClick&&e.onLikeClick()}),500),children:[Object(i.jsx)(T.a,{name:"LikeOutlined",size:20}),(null===we||void 0===we||null===(ne=we.threadData)||void 0===ne||null===(ie=ne.likeReward)||void 0===ie?void 0:ie.likePayCount)>0&&Object(i.jsx)("span",{className:ke.a.likedNumber,children:(null===we||void 0===we||null===(ae=we.threadData)||void 0===ae||null===(re=ae.likeReward)||void 0===re?void 0:re.likePayCount)||""})]}),Object(i.jsx)("div",{className:ke.a.likeReward,children:Object(i.jsx)(fe.a,{tipData:Te,imgs:(null===we||void 0===we||null===(se=we.threadData)||void 0===se||null===(oe=se.likeReward)||void 0===oe?void 0:oe.users)||[],showMore:!0,showCount:5,platform:"h5"})})]}),(null===we||void 0===we||null===(ce=we.threadData)||void 0===ce||null===(Oe=ce.likeReward)||void 0===Oe?void 0:Oe.shareCount)>0&&Object(i.jsxs)("div",{className:ke.a.shareCount,children:[null===we||void 0===we||null===(ye=we.threadData)||void 0===ye||null===(Ce=ye.likeReward)||void 0===Ce?void 0:Ce.shareCount,"\u6b21\u5206\u4eab"]})]}),Le>0&&Object(i.jsx)(ge,{onClose:function(){return we.setRedPacket(0)},money:Le})]})}))),De=(n("ToJy"),n("7mQc")),Ne=(n("toAj"),n("4l63"),n("40Bt")),Re=n.n(Ne),Ie=n("gOng"),Pe=function(e){var t=e.visible,n=e.onOkClick,a=e.onCancel,s=e.remainMoney,c=e.money,l=parseInt(s/c*100),u=Object(b.useState)(0),d=u[0],p=u[1],h=Object(b.useState)(0),v=h[0],m=h[1],f=Object(b.useState)(!1),j=f[0],k=f[1];Object(b.useEffect)((function(){k(v>=s)}),[v]);var x=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof n){e.next=11;break}return e.prev=1,e.next=4,n(v);case 4:e.sent&&(p(0),m(0)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)($.a,{position:"bottom",visible:t,onClose:a,children:Object(i.jsxs)("div",{className:Ie.a.container,children:[Object(i.jsxs)("div",{className:Ie.a.main,children:[Object(i.jsx)("div",{className:Ie.a.header,children:"\u91c7\u7eb3\u56de\u590d\u60ac\u8d4f"}),Object(i.jsxs)("div",{className:Ie.a.body,children:[Object(i.jsxs)("div",{className:Ie.a.percentage,children:[Object(i.jsx)("div",{className:Ie.a.text,children:"\u60ac\u8d4f\u767e\u5206\u6bd4"}),Object(i.jsxs)("div",{className:Ie.a.slider,children:[Object(i.jsx)(Re.a,{value:d,defaultValue:d,max:l,min:0,step:5,onChange:Object(K.b)((function(e){return function(e){p(Number(e)),m((.01*Number(e)*c).toFixed(2))}(e)}),100),formatter:function(e){return"".concat(e)}}),Object(i.jsx)("div",{className:Ie.a.perCent,children:"%"}),j&&Object(i.jsx)("div",{className:Ie.a.maxMoney,children:"*\u5df2\u8fbe\u5230\u6700\u5927\u53ef\u7528\u91d1\u989d"})]})]}),Object(i.jsxs)("div",{className:Ie.a.rewardMoney,children:[Object(i.jsx)("div",{className:Ie.a.text,children:"\u60ac\u8d4f\u91d1\u989d"}),Object(i.jsxs)("div",{className:Ie.a.moneyNum,children:[v,"\u5143"]})]})]})]}),Object(i.jsxs)("div",{className:Ie.a.button,children:[Object(i.jsx)(te.a,{full:!0,onClick:a,className:Ie.a.cancel,type:"text",size:"medium",children:"\u53d6\u6d88"}),Object(i.jsx)(te.a,{full:!0,onClick:x,className:Ie.a.ok,type:"primary",size:"medium",children:"\u786e\u5b9a"})]})]})})},Se=n("iJKD");function Le(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Te=Object(O.c)("thread")(I=Object(O.c)("comment")(I=Object(O.c)("commentPosition")(I=Object(O.c)("user")(I=Object(O.c)("site")(I=Object(O.d)(I=function(e){h()(n,e);var t=Le(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).onSortClick=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof i.props.sort){e.next=11;break}return e.prev=1,e.next=4,i.props.sort(!i.state.commentSort);case 4:e.sent&&i.setState({commentSort:!i.state.commentSort}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),i.state={showAboptPopup:!1,showCommentInput:!1,commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,inputText:"\u8bf7\u8f93\u5165\u5185\u5bb9"},i.commentData=null,i.replyData=null,i.recordCommentLike={id:null,status:null},i.recordReplyLike={id:null,status:null},i}return d()(n,[{key:"likeClick",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:if(this.recordCommentLike.id!==t.id&&(this.recordCommentLike.status=null),this.recordCommentLike.status===t.isLiked){e.next=12;break}this.recordCommentLike.status=t.isLiked,this.recordCommentLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return n={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(n,this.props.thread);case 16:i=e.sent,a=i.success,s=i.msg,a&&(this.props.isPositionComment?(this.props.commentPosition.setCommentListDetailField(t.id,"isLiked",n.isLiked),o=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setCommentListDetailField(t.id,"likeCount",o)):(this.props.thread.setCommentListDetailField(t.id,"isLiked",n.isLiked),c=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setCommentListDetailField(t.id,"likeCount",c))),a||B.a.error({content:s});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replyLikeClick",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.id){e.next=2;break}return e.abrupt("return");case 2:if(this.props.user.isLogin()){e.next=6;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 6:if(this.recordReplyLike.id!==t.id&&(this.recordReplyLike.status=null),this.recordReplyLike.status===t.isLiked){e.next=12;break}this.recordReplyLike.status=t.isLiked,this.recordReplyLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return i={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(i);case 16:a=e.sent,s=a.success,o=a.msg,this.props.isPositionComment?(this.props.commentPosition.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),c=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setReplyListDetailField(n.id,t.id,"likeCount",c)):(this.props.thread.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),l=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setReplyListDetailField(n.id,t.id,"likeCount",l)),s||B.a.error({content:o});case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=o()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=t,this.setState({showDeletePopup:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.commentData.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.comment.delete(this.commentData.id,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 4:if(t=e.sent,n=t.success,i=t.msg,this.setState({showDeletePopup:!1}),!n){e.next=11;break}return B.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 11:B.a.error({content:i});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=o()(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=n,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 6:if(n=e.sent,i=n.success,a=n.msg,this.setState({showReplyDeletePopup:!1}),!i){e.next=13;break}return B.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:B.a.error({content:a});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){var t,n;if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});if(this.props.canPublish()){this.commentData=e,this.replyData=null;var i=(null===e||void 0===e||null===(t=e.user)||void 0===t?void 0:t.nickname)||(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.userName);this.setState({showCommentInput:!0,inputText:i?"\u56de\u590d".concat(i):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}}},{key:"replyReplyClick",value:function(e,t){var n,i;if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});if(this.props.canPublish()){this.commentData=null,this.replyData=e,this.replyData.commentId=t.id;var a=(null===e||void 0===e||null===(n=e.user)||void 0===n?void 0:n.nickname)||(null===e||void 0===e||null===(i=e.user)||void 0===i?void 0:i.userName);this.setState({showCommentInput:!0,inputText:a?"\u56de\u590d".concat(a):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}}},{key:"createReply",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>0&&void 0!==p[0]?p[0]:"",a=p.length>1&&void 0!==p[1]?p[1]:[],i.replace(/\s/g,"")||0!==a.length){e.next=6;break}return B.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id){e.next=9;break}return e.abrupt("return");case 9:return o={id:s,content:i},this.replyData&&(o.replyId=this.replyData.id,o.isComment=!0,o.commentId=this.replyData.commentId,o.commentPostId=this.replyData.id),this.commentData&&(o.replyId=this.commentData.id,o.isComment=!0,o.commentId=this.commentData.id),null!==a&&void 0!==a&&a.length&&(o.attachments=a.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=15,this.props.comment.createReply(o,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 15:if(c=e.sent,l=c.success,u=c.msg,d=c.isApproved,!l){e.next=23;break}return this.setState({showCommentInput:!1,inputValue:""}),d?B.a.success({content:u}):B.a.warning({content:u}),e.abrupt("return",!0);case 23:B.a.error({content:u});case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editClick",value:function(e){"function"===typeof this.props.onEditClick&&this.props.onEditClick(e)}},{key:"onCommentClick",value:function(e){var t,n,i,a;e.id&&null!==(t=this.props.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.id&&this.props.router.push("/thread/comment/".concat(e.id,"?threadId=").concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}},{key:"onAboptClick",value:function(e){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.commentData=e,this.setState({showAboptPopup:!0})}},{key:"onAboptOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=15;break}return s={postId:null===(n=this.commentData)||void 0===n?void 0:n.id,rewards:t,threadId:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.threadId},e.next=4,this.props.thread.reward(s);case 4:if(o=e.sent,c=o.success,l=o.msg,!c){e.next=12;break}return this.setState({showAboptPopup:!1}),this.props.thread.fetchThreadDetail(s.threadId),B.a.success({content:"\u60ac\u8d4f".concat(t,"\u5143")}),e.abrupt("return",!0);case 12:B.a.error({content:l}),e.next=16;break;case 15:B.a.info({content:"\u60ac\u8d4f\u91d1\u989d\u4e0d\u80fd\u4e3a0"});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAboptCancel",value:function(){this.commentData=null,this.setState({showAboptPopup:!1})}},{key:"avatarClick",value:function(e){var t=e.userId;t&&this.props.router.push("/user/".concat(t))}},{key:"replyAvatarClick",value:function(e,t,n){"function"===typeof this.props.replyAvatarClick&&this.props.replyAvatarClick(e,t,n)}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m=this,f=this.props.thread,j=f.totalCount,k=f.commentList,x=this.props.commentPosition,O=x.commentList,y=x.postId;this.props.isPositionComment&&(k=O||[]);var C=(null===(e=this.props.user)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.id)&&(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)===(null===(r=this.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId),g=null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c||null===(l=c.displayTag)||void 0===l?void 0:l.isReward,w=((null===(u=this.props.thread)||void 0===u||null===(d=u.threadData)||void 0===d?void 0:d.content)||{}).indexes,D=((null===(p=this.props.thread)||void 0===p?void 0:p.threadData)||"").isAnonymous,N=Object(le.a)(w);return Object(i.jsxs)(b.Fragment,{children:[this.props.showHeader&&Object(i.jsxs)("div",{className:Se.a.header,children:[Object(i.jsxs)("div",{className:Se.a.number,children:["\u5171",j,"\u6761\u8bc4\u8bba"]}),Object(i.jsxs)("div",{className:Se.a.sort,onClick:function(){return m.onSortClick()},children:[Object(i.jsx)(T.a,{className:Se.a.sortIcon,name:"SortOutlined"}),Object(i.jsx)("span",{className:Se.a.sortText,children:this.state.commentSort?"\u8bc4\u8bba\u4ece\u65b0\u5230\u65e7":"\u8bc4\u8bba\u4ece\u65e7\u5230\u65b0"})]})]}),Object(i.jsx)("div",{className:Se.a.body,children:k.map((function(e,t){var n,a,r,s;return Object(i.jsx)("div",{className:"".concat(Se.a.commentItems," ").concat(t===k.length-1&&Se.a.isLastOne),ref:e.id===y?m.props.positionRef:null,children:Object(i.jsx)(De.a,{data:e,likeClick:Object(K.a)((function(){return m.likeClick(e)}),500),avatarClick:function(){return m.avatarClick(e)},replyClick:function(){return m.replyClick(e)},deleteClick:function(){return m.deleteClick(e)},editClick:function(){return m.editClick(e)},replyAvatarClick:function(t,n){return m.replyAvatarClick(t,e,n)},replyLikeClick:Object(K.a)((function(t){return m.replyLikeClick(t,e)}),500),replyReplyClick:function(t){return m.replyReplyClick(t,e)},replyDeleteClick:function(t){return m.replyDeleteClick(t,e)},onCommentClick:function(){return m.onCommentClick(e)},onAboptClick:function(){return m.onAboptClick(e)},isShowOne:!0,isShowAdopt:C&&g&&(null===(n=m.props.thread)||void 0===n||null===(a=n.threadData)||void 0===a?void 0:a.userId)!==e.userId,threadId:null===(r=m.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId,active:e.id===y,isAnonymous:D},e.id)},e.id||t)}))}),Object(i.jsx)(_.a,{visible:this.state.showCommentInput,inputText:this.state.inputText,onClose:function(){return m.setState({showCommentInput:!1})},onSubmit:function(e,t){return m.createReply(e,t)},site:this.props.site}),Object(i.jsx)(q.a,{visible:this.state.showDeletePopup,onClose:function(){return m.setState({showDeletePopup:!1})},onBtnClick:function(){return m.deleteComment()}}),Object(i.jsx)(q.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return m.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return m.replyDeleteComment()}}),(null===N||void 0===N||null===(h=N.REWARD)||void 0===h?void 0:h.money)&&(null===N||void 0===N||null===(v=N.REWARD)||void 0===v?void 0:v.remainMoney)&&Object(i.jsx)(Pe,{money:Number(N.REWARD.money),remainMoney:Number(N.REWARD.remainMoney),visible:this.state.showAboptPopup,onCancel:function(){return m.onAboptCancel()},onOkClick:function(e){return m.onAboptOk(e)}})]})}}]),n}(k.a.Component))||I)||I)||I)||I)||I)||I;Te.defaultProps={showHeader:!0};var Ee,Ae=Te,Me=n("QcND"),Be=n("ni5c"),Fe=n("wXCO"),ze=n("FeKq");function Ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Ue,We=Object(O.c)("site")(Ee=Object(O.c)("user")(Ee=Object(O.c)("thread")(Ee=Object(O.c)("commentPosition")(Ee=Object(O.c)("comment")(Ee=Object(O.c)("index")(Ee=Object(O.c)("topic")(Ee=Object(O.c)("search")(Ee=Object(O.c)("card")(Ee=Object(O.c)("vlist")(Ee=Object(O.d)(Ee=function(e){h()(n,e);var t=Ve(n);function n(e){var i,a,s;return l()(this,n),(s=t.call(this,e)).setContentImgReady=function(){s.setState({contentImgIsReady:!0})},s.onMoreClick=function(){s.setState({showMorePopup:!0})},s.onOperClick=function(e){if(!s.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});if(s.setState({showMorePopup:!1}),"stick"===e&&s.updateStick(),"essence"===e&&s.updateEssence(),"delete"===e&&s.setState({showDeletePopup:!0}),"edit"===e){var t,n,i,a;if(null===(t=s.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n||!n.id)return;s.props.router.push("/thread/post?id=".concat(null===(i=s.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}"report"===e&&s.setState({showReportPopup:!0}),"collect"===e&&s.onCollectionClick(),"wxshare"===e&&s.onShareClick(),"copylink"===e&&s.handleH5Share(),"post"===e&&s.createCard()},s.handleClick=function(){s.props.user.isLogin()?s.setState({show:!0}):Object(z.a)({url:"/user/login"})},s.onShareClose=function(){s.setState({show:!1})},s.handleH5Share=o()(r.a.mark((function e(){var t,n,i,a,o,c,l,u,d,p,h,v;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.a.info({content:"\u590d\u5236\u94fe\u63a5\u6210\u529f"}),s.onShareClose(),c=(null===(t=s.props.thread)||void 0===t?void 0:t.threadData)||{},l=c.title,u=void 0===l?"":l,Q()({title:u,path:"thread/".concat(null===(n=s.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId)}),d=null===(a=s.props.thread)||void 0===a||null===(o=a.threadData)||void 0===o?void 0:o.id,e.next=7,s.props.thread.shareThread(d);case 7:p=e.sent,h=p.success,v=p.msg,h||B.a.error({content:v});case 11:case"end":return e.stop()}}),e)}))),s.handleWxShare=function(){s.setState({isShowWeiXinShare:!0}),s.onShareClose()},s.createCard=function(){var e=s.props.thread.threadData,t=e.id;s.props.card.setThreadData(e),g.a.push({url:"/card?threadId=".concat(t)})},s.state={loadWeiXin:!1,isShowWeiXinShare:!1,showReportPopup:!1,showDeletePopup:!1,showCommentInput:!1,showMorePopup:!1,showRewardPopup:!1,isCommentLoading:!1,setTop:!1,showContent:"",show:!1,stateFlag:!(null!==(i=s.props.thread)&&void 0!==i&&i.isPositionToComment),contentImgIsReady:!1},s.perPage=20,s.commentDataSort=!0,s.threadBodyRef=k.a.createRef(),s.commentDataRef=k.a.createRef(),s.position=0,s.nextPosition=0,s.flag=!(null!==(a=s.props.thread)&&void 0!==a&&a.isPositionToComment),s.isFirst=!0,s.comment=null,s.reportContent=["\u5e7f\u544a\u5783\u573e","\u8fdd\u89c4\u5185\u5bb9","\u6076\u610f\u704c\u6c34","\u91cd\u590d\u53d1\u5e16"],s.inputText="\u5176\u4ed6\u7406\u7531...",s.positionRef=k.a.createRef(),s.isPositioned=!1,s}return d()(n,[{key:"handleOnScroll",value:function(){var e,t,n,i,a,r,s,o,c=null===(e=this.threadBodyRef)||void 0===e||null===(t=e.current)||void 0===t?void 0:t.scrollTop,l=null===(n=this.threadBodyRef)||void 0===n||null===(i=n.current)||void 0===i?void 0:i.offsetHeight,u=null===(a=this.threadBodyRef)||void 0===a||null===(r=a.current)||void 0===r?void 0:r.scrollHeight,d=this.props.thread,p=d.isCommentReady,h=d.isNoMore;(this.props.thread.setScrollDistance(c),c+l>=u&&!this.state.isCommentLoading&&p&&!h&&(this.props.thread.setCommentListPage(this.props.thread.page+1),this.loadCommentList()),this.flag)&&(this.nextPosition=(null===(s=this.threadBodyRef)||void 0===s||null===(o=s.current)||void 0===o?void 0:o.scrollTop)||0)}},{key:"componentDidMount",value:function(){this.setState({loadWeiXin:Object(ce.a)()})}},{key:"componentDidUpdate",value:function(){var e,t,n=this;if(this.isFirst){var i=this.props.thread;if(this.state.contentImgIsReady){var a,r,s,o;if(this.isFirst=!1,this.position=(null===(a=this.commentDataRef)||void 0===a||null===(r=a.current)||void 0===r?void 0:r.offsetTop)-50,i.clearContentImgState(),null!==(s=this.props)&&void 0!==s&&null!==(o=s.thread)&&void 0!==o&&o.isPositionToComment)return void setTimeout((function(){n.threadBodyRef.current.scrollTo(0,n.position)}),1e3);this.threadBodyRef.current.scrollTo(0,this.props.thread.scrollDistance)}null!==(e=this.props.commentPosition)&&void 0!==e&&e.postId&&!this.isPositioned&&null!==(t=this.positionRef)&&void 0!==t&&t.current&&(this.isPositioned=!0,setTimeout((function(){n.positionRef.current.scrollIntoView()}),1e3))}}},{key:"componentWillUnmount",value:function(){}},{key:"onMessageClick",value:function(){var e=this.flag?this.position:0;this.flag=!this.flag,this.setState({stateFlag:this.flag}),this.threadBodyRef.current.scrollTo(0,e)}},{key:"onCollectionClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,isFavorite:!(null!==(i=this.props.thread)&&void 0!==i&&i.isFavorite)},e.next=8,this.props.thread.updateFavorite(s);case 8:if(o=e.sent,c=o.success,l=o.msg,!c){e.next=14;break}return B.a.success({content:s.isFavorite?"\u6536\u85cf\u6210\u529f":"\u53d6\u6d88\u6536\u85cf"}),e.abrupt("return");case 14:B.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadCommentList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props.thread.isCommentReady,!this.state.isCommentLoading&&i){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,page:this.props.thread.page,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.thread.loadCommentList(s);case 8:if(o=e.sent,c=o.success,l=o.msg,this.setState({isCommentLoading:!1}),!c){e.next=14;break}return e.abrupt("return",!0);case 14:B.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSortChange",value:function(e){return this.commentDataSort=e,this.props.thread.setCommentListPage(1),this.props.commentPosition.reset(),this.loadCommentList()}},{key:"onInputClick",value:function(){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.props.canPublish()&&this.setState({showCommentInput:!0})}},{key:"onReportOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return n={threadId:this.props.thread.threadData.threadId,type:1,reason:t,userId:this.props.user.userInfo.id},e.next=5,this.props.thread.createReports(n);case 5:if(i=e.sent,a=i.success,s=i.msg,!a){e.next=12;break}return B.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),this.setState({showReportPopup:!1}),e.abrupt("return",!0);case 12:B.a.error({content:s});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setTopState",value:function(e){var t=this;this.setState({showContent:e,setTop:!this.state.setTop}),setTimeout((function(){t.setState({setTop:!t.state.setTop})}),2e3)}},{key:"updateStick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,o={id:s,isStick:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&a.isStick)},e.next=4,this.props.thread.updateStick(o);case 4:if(c=e.sent,l=c.success,u=c.msg,!l){e.next=11;break}return this.setTopState(o.isStick),(null===(d=this.props)||void 0===d||null===(p=d.index)||void 0===p?void 0:p.refreshHomeData)&&this.props.index.refreshHomeData(),e.abrupt("return");case 11:B.a.error({content:u});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateEssence",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,isEssence:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&null!==(s=a.displayTag)&&void 0!==s&&s.isEssence)},e.next=4,this.props.thread.updateEssence(c);case 4:if(l=e.sent,u=l.success,d=l.msg,this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic),!u){e.next=11;break}return B.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),e.abrupt("return");case 11:B.a.error({content:d});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showDeletePopup:!1}),i=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,e.next=4,this.props.thread.delete(i,this.props.index,this.props.search,this.props.topic,this.props.site,this.props.user);case 4:if(a=e.sent,s=a.success,o=a.msg,!s){e.next=11;break}return B.a.success({content:"\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u9996\u9875"}),setTimeout((function(){c.props.router.push("/")}),1e3),e.abrupt("return");case 11:B.a.error({content:o});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onBtnClick",value:function(){this.delete(),this.setState({showDeletePopup:!1})}},{key:"onPublishClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:"",n=i.length>1&&void 0!==i[1]?i[1]:[],t.replace(/\s/g,"")||0!==n.length){e.next=6;break}return B.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(!this.comment){e.next=12;break}return e.next=9,this.updateComment(t,n);case 9:e.t0=e.sent,e.next=15;break;case 12:return e.next=14,this.createComment(t,n);case 14:e.t0=e.sent;case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createComment",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d,p,h,v,m,f,j;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id,l={id:c,content:t,sort:this.commentDataSort,isNoMore:null===(s=this.props)||void 0===s||null===(o=s.thread)||void 0===o?void 0:o.isNoMore,attachments:[]},null!==n&&void 0!==n&&n.length&&(l.attachments=n.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=5,this.props.comment.createComment(l,this.props.thread);case 5:if(u=e.sent,d=u.success,p=u.msg,h=u.isApproved,v=u.redPacketAmount,!d){e.next=19;break}return this.props.thread.updatePostCount(this.props.thread.totalCount),this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic),(null===(m=this.props.thread)||void 0===m||null===(f=m.threadData)||void 0===f||null===(j=f.displayTag)||void 0===j?void 0:j.isRedPack)&&this.props.thread.fetchThreadDetail(c),v&&v>0&&this.props.thread.setRedPacket(v),h?B.a.success({content:p}):B.a.warning({content:p}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 19:B.a.error({content:p});case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateComment",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.comment){e.next=2;break}return e.abrupt("return");case 2:return a=null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.id,s={id:a,pid:this.comment.id,content:t,attachments:[]},e.next=6,this.props.comment.updateComment(s,this.props.thread);case 6:if(o=e.sent,c=o.success,l=o.msg,u=o.isApproved,!c){e.next=14;break}return u?B.a.success({content:l}):B.a.warning({content:l}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 14:B.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onEditClick",value:function(e){this.comment=e,this.setState({inputValue:e.content,showCommentInput:!0})}},{key:"onClose",value:function(){this.setState({showCommentInput:!1}),this.comment=null}},{key:"onLikeClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:return c=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,l={id:c,pid:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.postId,isLiked:!(null!==(s=this.props.thread)&&void 0!==s&&null!==(o=s.threadData)&&void 0!==o&&o.isLike)},e.next=8,this.props.thread.updateLiked(l,this.props.index,this.props.user,this.props.search,this.props.topic);case 8:u=e.sent,d=u.success,p=u.msg,d||B.a.error({content:p});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onShareClick",value:function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Object(ce.a)()&&this.setState({isShowWeiXinShare:!0});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onPayClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=this.props.thread.threadData,e.next=7,Object(Z.a)(a,null===(t=this.props.user)||void 0===t?void 0:t.userInfo);case 7:if(s=e.sent,!s.success||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId){e.next=13;break}return e.next=12,this.props.thread.fetchThreadDetail(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.threadId);case 12:this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRewardClick",value:function(){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.setState({showRewardPopup:!0})}},{key:"onRewardSubmit",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isNaN(Number(t))||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId||null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s||!s.userId){e.next=9;break}return this.setState({showRewardPopup:!1}),l={amount:Number(t),threadId:this.props.thread.threadData.threadId,payeeId:this.props.thread.threadData.userId,title:(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.title)||"\u4e3b\u9898\u6253\u8d4f"},e.next=5,this.props.thread.rewardPay(l,this.props.user,this.props.index,this.props.search,this.props.topic);case 5:u=e.sent,d=u.success,p=u.msg,d||B.a.error({content:p});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTagClick",value:function(){var e,t,n=null===(e=this.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t?void 0:t.categoryId;(n||"number"===typeof n)&&this.props.index.refreshHomeData({categoryIds:[n]}),this.props.vlist.resetPosition(),this.props.router.push("/")}},{key:"replyAvatarClick",value:function(e,t,n){if(2===n){var i=e.userId;if(!i)return;this.props.router.push("/user/".concat(i))}if(3===n){var a=e.commentUserId;if(!a)return;this.props.router.push("/user/".concat(a))}}},{key:"onUserClick",value:function(e){var t,n,i=(this.props.thread||{}).threadData;(null===i||void 0===i||null===(t=i.user)||void 0===t?void 0:t.userId)&&this.props.router.push("/user/".concat(null===i||void 0===i||null===(n=i.user)||void 0===n?void 0:n.userId))}},{key:"onLoadMoreClick",value:function(){this.props.commentPosition.page=this.props.commentPosition.page+1,this.loadCommentPositionList()}},{key:"loadCommentPositionList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.commentPosition.isCommentReady,!this.state.isCommentLoading&&s){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,page:(null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a?void 0:a.page)||1,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.commentPosition.loadCommentList(c);case 8:if(l=e.sent,u=l.success,d=l.msg,this.setState({isCommentLoading:!1}),!u){e.next=14;break}return e.abrupt("return",!0);case 14:B.a.error({content:d});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m,f,j,k=this,x=this.props.thread,O=x.isReady,y=x.isCommentReady,C=x.isNoMore,g=x.totalCount,N=x.isCommentListError,I={moreClick:this.onMoreClick},L={canEdit:null===x||void 0===x||null===(e=x.threadData)||void 0===e||null===(t=e.ability)||void 0===t?void 0:t.canEdit,canDelete:null===x||void 0===x||null===(n=x.threadData)||void 0===n||null===(a=n.ability)||void 0===a?void 0:a.canDelete,canEssence:null===x||void 0===x||null===(r=x.threadData)||void 0===r||null===(s=r.ability)||void 0===s?void 0:s.canEssence,canStick:null===x||void 0===x||null===(o=x.threadData)||void 0===o||null===(c=o.ability)||void 0===c?void 0:c.canStick,canShare:this.props.user.isLogin(),canWxShare:this.props.user.isLogin()&&Object(ce.a)(),canCollect:this.props.user.isLogin(),isAdmini:null===(l=this.props)||void 0===l||null===(u=l.user)||void 0===u?void 0:u.isAdmini},E={isEssence:null===x||void 0===x||null===(d=x.threadData)||void 0===d||null===(p=d.displayTag)||void 0===p?void 0:p.isEssence,isStick:null===x||void 0===x||null===(h=x.threadData)||void 0===h?void 0:h.isStick,isCollect:null===x||void 0===x?void 0:x.isFavorite},M=1===((null===x||void 0===x||null===(v=x.threadData)||void 0===v?void 0:v.isApproved)||0),B=this.props.commentPosition,z=B.isShowCommentList,U=B.isNoMore;return Object(i.jsxs)("div",{className:w.a.container,children:[Object(i.jsxs)("div",{className:w.a.header,children:[Object(i.jsx)(F.a,{}),O&&!M&&Object(i.jsxs)("div",{className:w.a.examine,children:[Object(i.jsx)(T.a,{className:w.a.tipsIcon,name:"TipsOutlined"}),Object(i.jsx)("span",{className:w.a.tipsText,children:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a\uff01"})]})]}),Object(i.jsxs)("div",{className:w.a.body,ref:this.threadBodyRef,onScrollCapture:Object(G.a)((function(){return k.handleOnScroll()}),1e3),children:[Object(i.jsx)(W,{showContent:this.state.showContent,setTop:this.state.setTop}),O?Object(i.jsx)(we,{store:x,setContentImgReady:this.setContentImgReady,fun:I,onLikeClick:function(){return k.onLikeClick()},onOperClick:function(e){return k.onOperClick(e)},onCollectionClick:function(){return k.onCollectionClick()},onReportClick:function(){return k.onReportClick()},onRewardClick:function(){return k.onRewardClick()},onTagClick:function(){return k.onTagClick()},onPayClick:function(){return k.onPayClick()},onUserClick:function(e){return k.onUserClick(e)}}):Object(i.jsx)(P.a,{type:"init"}),O&&M&&Object(i.jsx)("div",{className:"".concat(w.a.bottom),ref:this.commentDataRef,children:y?Object(i.jsxs)(b.Fragment,{children:[y&&z&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(Ae,{isPositionComment:!0,router:this.props.router,sort:function(e){return k.onSortChange(e)},replyAvatarClick:function(e,t,n){return k.replyAvatarClick(e,t,n)}}),!U&&Object(i.jsxs)("div",{className:w.a.showMore,onClick:function(){return k.onLoadMoreClick()},children:[Object(i.jsx)("div",{className:w.a.hidePercent,children:"\u5c55\u5f00\u66f4\u591a\u8bc4\u8bba"}),Object(i.jsx)(T.a,{className:w.a.icon,name:"RightOutlined",size:12})]})]}),Object(i.jsx)(Ae,{canPublish:this.props.canPublish,positionRef:this.positionRef,showHeader:!z,router:this.props.router,sort:function(e){return k.onSortChange(e)},onEditClick:function(e){return k.onEditClick(e)},replyAvatarClick:function(e,t,n){return k.replyAvatarClick(e,t,n)}}),Object(i.jsx)(Be.a,{noMoreType:"line",isError:N,noMore:C})]}):Object(i.jsx)(P.a,{isError:N,type:"init"})}),Object(i.jsx)(Fe.a,{marginTop:0})]}),O&&M&&Object(i.jsx)("div",{className:w.a.footerContainer,children:Object(i.jsxs)("div",{className:w.a.footer,children:[Object(i.jsx)("div",{className:D.a.inputClick,onClick:function(){return k.onInputClick()},children:Object(i.jsx)(A.a,{className:D.a.input,placeholder:"\u5199\u8bc4\u8bba",disabled:!0,prefixIcon:"EditOutlined"})}),Object(i.jsxs)("div",{className:D.a.operate,children:[Object(i.jsxs)("div",{className:D.a.icon,onClick:function(){return k.onMessageClick()},children:[this.state.stateFlag?g>0?Object(i.jsx)("div",{className:R()(D.a.badge,g<10&&D.a.isCricle),children:g>99?"99+":"".concat(g||"0")}):"":Object(i.jsx)("div",{className:D.a.content,children:"\u6b63\u6587"}),Object(i.jsx)(T.a,{size:"20",name:"MessageOutlined"})]}),Object(i.jsx)(T.a,{color:null!==(m=this.props.thread)&&void 0!==m&&null!==(f=m.threadData)&&void 0!==f&&f.isLike?S["--color-primary"]:"",className:D.a.icon,onClick:Object(K.a)((function(){return k.onLikeClick()}),500),size:"20",name:"LikeOutlined"}),Object(i.jsx)(T.a,{color:null!==(j=this.props.thread)&&void 0!==j&&j.isFavorite?S["--color-primary"]:"",className:D.a.icon,onClick:Object(K.a)((function(){return k.onCollectionClick()}),500),size:"20",name:"CollectOutlinedBig"}),Object(i.jsx)(T.a,{onClick:Object(X.a)((function(){return k.handleClick()}),1e3),className:D.a.icon,size:"20",name:"ShareAltOutlined"})]})]})}),Object(i.jsx)(ze.a,{show:this.state.show,onClose:this.onShareClose,handleH5Share:this.handleH5Share,handleWxShare:this.handleWxShare,createCard:this.createCard}),O&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(_.a,{visible:this.state.showCommentInput,onClose:function(){return k.onClose()},initValue:this.state.inputValue,onSubmit:function(e,t){return k.onPublishClick(e,t)},site:this.props.site}),Object(i.jsx)(H.a,{permissions:L,statuses:E,visible:this.state.showMorePopup,onClose:function(){return k.setState({showMorePopup:!1})},onSubmit:function(){return k.setState({showMorePopup:!1})},onOperClick:function(e){return k.onOperClick(e)}}),Object(i.jsx)(q.a,{visible:this.state.showDeletePopup,onClose:function(){return k.setState({showDeletePopup:!1})},onBtnClick:function(e){return k.onBtnClick(e)},type:"thread"}),Object(i.jsx)(V.a,{reportContent:this.reportContent,inputText:this.inputText,visible:this.state.showReportPopup,onCancel:function(){return k.setState({showReportPopup:!1})},onOkClick:function(e){return k.onReportOk(e)}}),Object(i.jsx)(se,{visible:this.state.showRewardPopup,onCancel:function(){return k.setState({showRewardPopup:!1})},onOkClick:function(e){return k.onRewardSubmit(e)}}),this.state.loadWeiXin&&Object(i.jsx)(oe.a,{visible:this.state.isShowWeiXinShare,onClose:function(){return k.setState({isShowWeiXinShare:!1})},type:"thread"})]})]})}}]),n}(k.a.Component))||Ee)||Ee)||Ee)||Ee)||Ee)||Ee)||Ee)||Ee)||Ee)||Ee)||Ee,qe=Object(Me.a)(Object(x.withRouter)(We)),He=n("JMpY"),_e=n("iUiS"),Ge=n("E2V6"),Ke=function(e){var t=e.visible,n=e.onOkClick,a=Object(b.useState)(""),s=a[0],c=a[1];Object(b.useEffect)((function(){c("")}),[t]);var l=function(){"function"===typeof(null===e||void 0===e?void 0:e.onCancel)&&e.onCancel()},u=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(""===s||Number(s)<=0||Number(s)>1e6)){e.next=4;break}return(""===s||Number(s)<=0)&&B.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u4e3a0"}),Number(s)>1e6&&B.a.error({content:"\u91d1\u989d\u4e0d\u80fd\u8d85\u8fc7100\u4e07"}),e.abrupt("return");case 4:if("function"!==typeof n){e.next=16;break}return e.prev=6,e.next=9,n(s);case 9:e.sent&&c(""),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)($.a,{position:"center",visible:t,onClose:l,children:Object(i.jsxs)("div",{className:Ge.a.container,children:[Object(i.jsxs)("div",{className:Ge.a.header,children:[Object(i.jsx)("div",{className:Ge.a.headerLeft,children:"\u652f\u4ed8\u4f5c\u8005\u7ee7\u7eed\u521b\u4f5c"}),Object(i.jsx)(T.a,{className:Ge.a.headerIcon,size:14,name:"CloseOutlined",onClick:l})]}),Object(i.jsxs)("div",{className:Ge.a.rewardInput,children:[Object(i.jsx)("span",{className:Ge.a.prepend,children:"\u652f\u4ed8\u91d1\u989d"}),Object(i.jsx)(A.a,{mode:"number",placeholder:"\u91d1\u989d",className:Ge.a.input,value:s,onChange:function(e){return function(e){var t=e.match(/([1-9]\d{0,6}|0)(\.\d{0,2})?/);c(t?t[0]:"")}(e.target.value)}}),Object(i.jsx)("span",{className:Ge.a.append,children:"\u5143"})]}),Object(i.jsx)("div",{className:Ge.a.rewardList,children:[1,2,5,10,20,50,88,128].map((function(e){return Object(i.jsxs)("div",{onClick:function(){return function(e){c(e)}(e)},className:R()(Ge.a.reward,Number(s)===e&&Ge.a.actived),children:["\uffe5",e]},e)}))}),Object(i.jsxs)("div",{className:Ge.a.button,children:[Object(i.jsx)(te.a,{onClick:l,className:Ge.a.cancel,type:"default",children:"\u53d6\u6d88"}),Object(i.jsx)(te.a,{onClick:u,className:Ge.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})},Xe=n("INMq"),Je=n("KimE"),Qe=n("2w7u"),Ze=n("cjmN"),Ye=function(e){var t=e.showContent,n=e.setTop;return Object(i.jsxs)("div",{className:"".concat(Ze.a.setTop," ").concat(n?Ze.a.inTop:Ze.a.outTop),children:[Object(i.jsx)("span",{className:Ze.a.setTopIcon,children:Object(i.jsx)(T.a,{className:Ze.a.icon,name:"CheckOutlined"})}),t?"\u7f6e\u9876\u6210\u529f":"\u5df2\u53d6\u6d88\u7f6e\u9876"]})},$e=n("DT/J"),et=function(e){var t=e.isShow;return Object(i.jsx)("div",{className:"".concat($e.a.examine," ").concat($e.a.setTop," ").concat(t?$e.a.inTop:$e.a.outTop),children:Object(i.jsxs)("div",{className:$e.a.innerTip,children:[Object(i.jsx)(T.a,{className:$e.a.tipsIcon,name:"TipsOutlined"}),Object(i.jsx)("span",{className:$e.a.tipsText,children:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a\uff01"})]})})},tt=n("Wpw2"),nt=n("7BN5"),it=n("nfQ1"),at=n.n(it),rt=n("wdPI"),st=Object(O.c)("user")(Object(O.d)((function(e){var t,n,a,s,c,l,u,d,p,h,v,m,f,j,b,k,x,O,y,C,g,w,D,N,I,P,S,L,E,A,M,B,F,z,V,U,W,q,H,_,G,X,J,Q,Z,Y,$,ee,ne,ae,re,se,oe,ce,ke,Oe,ye,Ce,we,De,Ne,Re,Ie,Pe,Se,Le,Te,Ee,Ae=e.store,Me=(null===Ae||void 0===Ae||null===(t=Ae.threadData)||void 0===t?void 0:t.content)||{},Be=Me.text,Fe=Me.indexes,ze=null===Ae||void 0===Ae?void 0:Ae.threadData,Ve=ze.parentCategoryName,Ue=ze.categoryName,We=Ae.hasRedPacket,qe={postId:null===Ae||void 0===Ae||null===(n=Ae.threadData)||void 0===n?void 0:n.postId,threadId:null===Ae||void 0===Ae||null===(a=Ae.threadData)||void 0===a?void 0:a.threadId,platform:"pc",payType:null===Ae||void 0===Ae||null===(s=Ae.threadData)||void 0===s?void 0:s.payType},He=1===((null===Ae||void 0===Ae||null===(c=Ae.threadData)||void 0===c?void 0:c.isApproved)||0),_e=0===(null===Ae||void 0===Ae||null===(l=Ae.threadData)||void 0===l?void 0:l.payType),Ge=(null===Ae||void 0===Ae||null===(u=Ae.threadData)||void 0===u||null===(d=u.displayTag)||void 0===d?void 0:d.isEssence)||!1,Ke=null===Ae||void 0===Ae||null===(p=Ae.threadData)||void 0===p?void 0:p.isStick,Xe=null===Ae||void 0===Ae||null===(h=Ae.threadData)||void 0===h||null===(v=h.ability)||void 0===v?void 0:v.canEdit,Je=null===Ae||void 0===Ae||null===(m=Ae.threadData)||void 0===m||null===(f=m.ability)||void 0===f?void 0:f.canDelete,Qe=null===Ae||void 0===Ae||null===(j=Ae.threadData)||void 0===j||null===(b=j.ability)||void 0===b?void 0:b.canEssence,Ze=null===Ae||void 0===Ae||null===(k=Ae.threadData)||void 0===k||null===(x=k.ability)||void 0===x?void 0:x.canStick,Ye=2===(null===Ae||void 0===Ae||null===(O=Ae.threadData)||void 0===O?void 0:O.payType)&&!1===(null===Ae||void 0===Ae||null===(y=Ae.threadData)||void 0===y?void 0:y.paid),$e=(null===Ae||void 0===Ae||null===(C=Ae.threadData)||void 0===C?void 0:C.attachmentPrice)||0,et=!ut&&Ye&&!st&&!it,tt=1===(null===Ae||void 0===Ae||null===(g=Ae.threadData)||void 0===g?void 0:g.payType),nt=(null===Ae||void 0===Ae||null===(w=Ae.threadData)||void 0===w?void 0:w.price)||0,it=!0===(null===Ae||void 0===Ae||null===(D=Ae.threadData)||void 0===D?void 0:D.paid),st=(null===(N=e.user)||void 0===N||null===(I=N.userInfo)||void 0===I?void 0:I.id)&&(null===(P=e.user)||void 0===P||null===(S=P.userInfo)||void 0===S?void 0:S.id)===(null===Ae||void 0===Ae||null===(L=Ae.threadData)||void 0===L?void 0:L.userId),ot=null===Ae||void 0===Ae||null===(E=Ae.threadData)||void 0===E||null===(A=E.displayTag)||void 0===A?void 0:A.isRedPack,ct=null===Ae||void 0===Ae||null===(M=Ae.threadData)||void 0===M||null===(B=M.displayTag)||void 0===B?void 0:B.isReward,lt=(_e&&(null===Ae||void 0===Ae||null===(F=Ae.threadData)||void 0===F||F.ability.canBeReward),_e&&(null===Ae||void 0===Ae||null===(z=Ae.threadData)||void 0===z?void 0:z.ability.canBeReward)&&!ot&&!ct),ut=(null===Ae||void 0===Ae||null===(V=Ae.threadData)||void 0===V||V.isReward,null===Ae||void 0===Ae||null===(U=Ae.threadData)||void 0===U?void 0:U.ability.canFreeViewPost),dt=Object(le.a)(Fe);1===(null===(W=dt.RED_PACKET)||void 0===W?void 0:W.condition)&&Ae.getRedPacketInfo(dt.RED_PACKET.threadId);var pt=function(){var t=o()(r.a.mark((function t(){return r.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"function"===typeof e.onPayClick&&e.onPayClick();case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ht=function(e){e&&window.open(e)},vt=function(t){"function"===typeof e.onOperClick&&e.onOperClick(t)};return Object(i.jsxs)("div",{className:"".concat(rt.a.container),children:[Object(i.jsxs)("div",{className:rt.a.header,children:[Object(i.jsx)("div",{className:rt.a.userInfo,children:Object(i.jsx)(be.a,{name:(null===Ae||void 0===Ae||null===(q=Ae.threadData)||void 0===q||null===(H=q.user)||void 0===H?void 0:H.nickname)||"",avatar:(null===Ae||void 0===Ae||null===(_=Ae.threadData)||void 0===_||null===(G=_.user)||void 0===G?void 0:G.avatar)||"",groupName:(null===Ae||void 0===Ae||null===(X=Ae.threadData)||void 0===X||null===(J=X.group)||void 0===J?void 0:J.groupName)||"",location:(null===Ae||void 0===Ae||null===(Q=Ae.threadData)||void 0===Q?void 0:Q.position.location)||"",view:"".concat(null===Ae||void 0===Ae||null===(Z=Ae.threadData)||void 0===Z?void 0:Z.viewCount)||"",time:"".concat(null===Ae||void 0===Ae||null===(Y=Ae.threadData)||void 0===Y?void 0:Y.diffTime)||"",userId:null===Ae||void 0===Ae||null===($=Ae.threadData)||void 0===$||null===(ee=$.user)||void 0===ee?void 0:ee.userId,isEssence:Ge,isPay:!_e,isReward:ct,isRed:ot,hideInfoPopip:!0,platform:"pc",onClick:function(t){t&&t.stopPropagation(),"function"===typeof e.onUserClick&&e.onUserClick()}})}),(null===e||void 0===e||null===(ne=e.user)||void 0===ne?void 0:ne.isLogin())&&Object(i.jsxs)("div",{className:rt.a.more,children:[(Ge||!_e||ct||ot)&&Object(i.jsx)(ie.a,{mode:"vertical",className:rt.a.moreDivider}),He&&(Xe||Ze||Qe||Je)&&Object(i.jsx)("div",{className:rt.a.iconText,children:Object(i.jsxs)(at.a,{menu:Object(i.jsxs)(at.a.Menu,{children:[Xe&&Object(i.jsx)(at.a.Item,{id:"edit",children:"\u7f16\u8f91"}),Ze&&Object(i.jsx)(at.a.Item,{id:"stick",children:Ke?"\u53d6\u6d88\u7f6e\u9876":"\u7f6e\u9876"}),Qe&&Object(i.jsxs)(at.a.Item,{id:"essence",children:[" ",Ge?"\u53d6\u6d88\u7cbe\u534e":"\u7cbe\u534e"]}),Je&&Object(i.jsx)(at.a.Item,{id:"delete",children:"\u5220\u9664"})]}),placement:"center",hideOnClick:!0,arrow:!1,trigger:"hover",onChange:function(e){return vt(e)},children:[Object(i.jsx)(T.a,{className:rt.a.icon,name:"SettingOutlined"}),Object(i.jsx)("span",{className:rt.a.text,children:"\u7ba1\u7406"})]})}),!(null!==e&&void 0!==e&&null!==(ae=e.user)&&void 0!==ae&&ae.isAdmini)&&Object(i.jsxs)("div",{className:R()(rt.a.iconText,(null===e||void 0===e||null===(re=e.user)||void 0===re?void 0:re.isAdmini)&&rt.a.disabled),onClick:function(){return vt("report")},children:[Object(i.jsx)(T.a,{className:rt.a.icon,name:"WarnOutlinedThick"}),Object(i.jsx)("span",{className:rt.a.text,children:"\u4e3e\u62a5"})]})]})]}),Object(i.jsx)(ie.a,{className:rt.a.divider}),Object(i.jsxs)("div",{className:rt.a.body,children:[(null===Ae||void 0===Ae||null===(se=Ae.threadData)||void 0===se?void 0:se.title)&&Object(i.jsx)("div",{className:rt.a.title,children:null===Ae||void 0===Ae||null===(oe=Ae.threadData)||void 0===oe?void 0:oe.title}),Be&&Object(i.jsx)(pe.a,{useShowMore:!1,content:Be||"",usePointer:!1}),dt.VIDEO&&Object(i.jsx)(ve.a,{url:dt.VIDEO.mediaUrl,coverUrl:dt.VIDEO.coverUrl,v_width:dt.VIDEO.width||null,v_height:dt.VIDEO.height||null,status:dt.VIDEO.status}),dt.IMAGE&&Object(i.jsx)(ue.a,{flat:!0,platform:"pc",isPay:et,onPay:pt,imgData:dt.IMAGE}),(dt.RED_PACKET||dt.REWARD)&&Object(i.jsxs)("div",{className:rt.a.reward,style:{width:"100%"},children:[dt.REWARD&&Object(i.jsxs)("div",{className:rt.a.rewardBody,style:{width:"100%"},children:[Object(i.jsx)(xe.a,{type:1,money:dt.REWARD.money,remainMoney:dt.REWARD.remainMoney}),Object(i.jsxs)("div",{className:rt.a.rewardMoney,children:["\u672c\u5e16\u5411\u6240\u6709\u4eba\u60ac\u8d4f",Object(i.jsx)("span",{className:rt.a.rewardNumber,children:dt.REWARD.money||0}),"\u5143"]}),Object(i.jsxs)("div",{className:rt.a.rewardTime,children:[dt.REWARD.expiredAt,"\u622a\u6b62\u60ac\u8d4f"]})]}),dt.RED_PACKET&&Object(i.jsxs)("div",{style:{width:"100%"},children:[Object(i.jsx)(xe.a,{number:dt.RED_PACKET.number,remainNumber:dt.RED_PACKET.remainNumber,condition:dt.RED_PACKET.condition}),!!dt.RED_PACKET.condition&&Object(i.jsxs)("div",{className:rt.a.redPacketLikeNum,children:["\u8bc4\u8bba\u96c6",dt.RED_PACKET.likenum,"\u8d5e\u9886\u7ea2\u5305"]})]})]}),dt.GOODS&&Object(i.jsxs)("div",{className:rt.a.goods,children:[Object(i.jsx)(he.a,{image:null===dt||void 0===dt||null===(ce=dt.GOODS)||void 0===ce?void 0:ce.imagePath,amount:null===dt||void 0===dt||null===(ke=dt.GOODS)||void 0===ke?void 0:ke.price,title:null===dt||void 0===dt||null===(Oe=dt.GOODS)||void 0===Oe?void 0:Oe.title,onClick:function(){return ht(dt.GOODS.detailContent)}}),Object(i.jsx)(te.a,{className:rt.a.buyBtn,type:"danger",onClick:function(){return ht(dt.GOODS.detailContent)},children:Object(i.jsxs)("div",{className:rt.a.buyContent,children:[Object(i.jsx)(T.a,{className:rt.a.buyIcon,name:"ShoppingCartOutlined",size:20}),Object(i.jsx)("span",{className:rt.a.buyText,children:"\u8d2d\u4e70\u5546\u54c1"})]})})]}),dt.VOICE&&Object(i.jsx)(de.a,{url:dt.VOICE.mediaUrl}),dt.VOTE&&Object(i.jsx)(je.a,{attachments:dt.VOTE,threadId:null===Ae||void 0===Ae||null===(ye=Ae.threadData)||void 0===ye?void 0:ye.threadId}),dt.VOTE_THREAD&&Object(i.jsx)(me.a,{voteData:dt.VOTE_THREAD,threadId:null===Ae||void 0===Ae||null===(Ce=Ae.threadData)||void 0===Ce?void 0:Ce.threadId,page:"detail"}),et&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:pt,children:Object(i.jsx)(te.a,{className:rt.a.payButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:rt.a.pay,children:[Object(i.jsx)(T.a,{className:rt.a.payIcon,name:"GoldCoinOutlined",size:18}),"\u652f\u4ed8",$e,"\u5143\u67e5\u770b\u9644\u4ef6"]})})}),(Ve||Ue)&&Object(i.jsx)("div",{className:rt.a.tag,onClick:function(){"function"===typeof e.onTagClick&&e.onTagClick()},children:Ve?"".concat(Ve,"/").concat(Ue):Ue}),!ut&&tt&&!st&&!it&&Object(i.jsx)("div",{style:{textAlign:"center"},onClick:pt,children:Object(i.jsx)(te.a,{className:rt.a.payButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:rt.a.pay,children:[Object(i.jsx)(T.a,{className:rt.a.payIcon,name:"GoldCoinOutlined",size:18}),"\u652f\u4ed8",nt,"\u5143\u67e5\u770b\u5269\u4f59\u5185\u5bb9"]})})}),lt&&He&&!st&&Object(i.jsx)(te.a,{onClick:function(){"function"===typeof e.onRewardClick&&e.onRewardClick()},className:rt.a.rewardButton,type:"primary",size:"large",children:Object(i.jsxs)("div",{className:rt.a.buttonIconText,children:[Object(i.jsx)(T.a,{className:rt.a.buttonIcon,name:"HeartOutlined",size:19}),Object(i.jsx)("span",{className:rt.a.buttonText,children:"\u6253\u8d4f"})]})})]}),Object(i.jsxs)("div",{className:rt.a.footer,children:[Object(i.jsxs)("div",{className:rt.a.thumbs,children:[Object(i.jsx)("div",{className:rt.a.likeReward,children:Object(i.jsx)(fe.a,{tipData:qe,imgs:(null===Ae||void 0===Ae||null===(we=Ae.threadData)||void 0===we||null===(De=we.likeReward)||void 0===De?void 0:De.users)||[],showCount:10,platform:"pc"})}),Object(i.jsx)("span",{children:(null===Ae||void 0===Ae||null===(Ne=Ae.threadData)||void 0===Ne||null===(Re=Ne.likeReward)||void 0===Re?void 0:Re.likePayCount)||""})]}),(null===Ae||void 0===Ae||null===(Ie=Ae.threadData)||void 0===Ie||null===(Pe=Ie.likeReward)||void 0===Pe?void 0:Pe.shareCount)>0&&Object(i.jsxs)("span",{className:rt.a.share,children:[null===Ae||void 0===Ae||null===(Se=Ae.threadData)||void 0===Se||null===(Le=Se.likeReward)||void 0===Le?void 0:Le.shareCount,"\u6b21\u5206\u4eab"]})]}),Object(i.jsx)(ie.a,{className:rt.a.divider}),He&&Object(i.jsxs)("div",{className:rt.a.bottomOperate,children:[Object(i.jsxs)("div",{className:R()(rt.a.item,(null===Ae||void 0===Ae||null===(Te=Ae.threadData)||void 0===Te?void 0:Te.isLike)&&rt.a.active),onClick:Object(K.a)((function(){"function"===typeof e.onLikeClick&&e.onLikeClick()}),500),children:[Object(i.jsx)(T.a,{name:"LikeOutlined"}),Object(i.jsx)("span",{children:"\u8d5e"})]}),Object(i.jsxs)("div",{className:R()(rt.a.item,(null===Ae||void 0===Ae||null===(Ee=Ae.threadData)||void 0===Ee?void 0:Ee.isFavorite)&&rt.a.active),onClick:Object(K.a)((function(){"function"===typeof e.onCollectionClick&&e.onCollectionClick()}),500),children:[Object(i.jsx)(T.a,{name:"CollectOutlined"}),Object(i.jsx)("span",{children:"\u6536\u85cf"})]}),Object(i.jsxs)("div",{className:R()(rt.a.item),onClick:Object(K.a)((function(){"function"===typeof e.onShareClick&&e.onShareClick()}),500),children:[Object(i.jsx)(T.a,{name:"ShareAltOutlined"}),Object(i.jsx)("span",{children:"\u5206\u4eab"})]})]}),We>0&&Object(i.jsx)(ge,{onClose:function(){return Ae.setRedPacket(0)},money:We})]})}))),ot=(n("QWBl"),n("T63A"),n("tkto"),n("FZtP"),n("J4zp")),ct=n.n(ot),lt=n("TciF"),ut=n("/c/8"),dt=n("PuBq");function pt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var ht={101:"IMAGE",102:"VOICE",103:"VIDEO",104:"GOODS",105:"QA",106:"RED_PACKET",107:"REWARD",108:"VOTE",109:"QUEUE",110:"FILE",111:"QA_IMAGE"},vt=Object(O.c)("thread")(Ue=Object(O.c)("comment")(Ue=Object(O.c)("commentPosition")(Ue=Object(O.c)("user")(Ue=Object(O.d)(Ue=function(e){h()(n,e);var t=pt(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).onSortClick=function(){i.setState({commentSort:!i.state.commentSort}),"function"===typeof i.props.sort&&i.props.sort(!i.state.commentSort)},i.state={showAboptPopup:!1,showCommentInput:!1,commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,placeholder:"\u5199\u4e0b\u6211\u7684\u8bc4\u8bba...",commentId:null},i.commentData=null,i.replyData=null,i}return d()(n,[{key:"likeClick",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return n={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(n,this.props.thread);case 9:i=e.sent,a=i.success,s=i.msg,a&&(this.props.isPositionComment?(this.props.commentPosition.setCommentListDetailField(t.id,"isLiked",n.isLiked),o=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setCommentListDetailField(t.id,"likeCount",o)):(this.props.thread.setCommentListDetailField(t.id,"isLiked",n.isLiked),c=n.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setCommentListDetailField(t.id,"likeCount",c))),a||B.a.error({content:s});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replyLikeClick",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return i={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(i);case 9:a=e.sent,s=a.success,o=a.msg,s&&(this.props.isPositionComment?(this.props.commentPosition.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),c=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.commentPosition.setReplyListDetailField(n.id,t.id,"likeCount",c)):(this.props.thread.setReplyListDetailField(n.id,t.id,"isLiked",i.isLiked),l=i.isLiked?t.likeCount+1:t.likeCount-1,this.props.thread.setReplyListDetailField(n.id,t.id,"likeCount",l))),s||B.a.error({content:o});case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=o()(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:this.commentData=t,this.setState({showDeletePopup:!0});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(this.commentData.id){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.props.comment.delete(this.commentData.id,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 8:if(t=e.sent,n=t.success,i=t.msg,this.setState({showDeletePopup:!1}),!n){e.next=15;break}return B.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 15:B.a.error({content:i});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=o()(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=n,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 6:if(n=e.sent,i=n.success,a=n.msg,this.setState({showReplyDeletePopup:!1}),!i){e.next=13;break}return B.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:B.a.error({content:a});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.props.canPublish()&&(this.commentData=e,this.replyData=null,this.setState({showCommentInput:!0,commentId:e.id}))}},{key:"replyReplyClick",value:function(e,t){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.props.canPublish()&&(this.commentData=null,this.replyData=e,this.replyData.commentId=t.id,this.setState({showCommentInput:!0,commentId:null}))}},{key:"createReply",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=p.length>0&&void 0!==p[0]?p[0]:"",a=p.length>1&&void 0!==p[1]?p[1]:[],i.replace(/\s/g,"")||0!==a.length){e.next=6;break}return B.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 6:if(s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id){e.next=9;break}return e.abrupt("return");case 9:return o={id:s,content:i},this.replyData&&(o.replyId=this.replyData.id,o.isComment=!0,o.commentId=this.replyData.commentId,o.commentPostId=this.replyData.id),this.commentData&&(o.replyId=this.commentData.id,o.isComment=!0,o.commentId=this.commentData.id),null!==a&&void 0!==a&&a.length&&(o.attachments=a.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=15,this.props.comment.createReply(o,this.props.isPositionComment?this.props.commentPosition:this.props.thread);case 15:if(c=e.sent,l=c.success,u=c.msg,d=c.isApproved,!l){e.next=23;break}return this.setState({showCommentInput:!1,inputValue:"",commentId:null}),d?B.a.success({content:u}):B.a.warning({content:u}),e.abrupt("return",!0);case 23:B.a.error({content:u});case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"editClick",value:function(e){"function"===typeof this.props.onEditClick&&this.props.onEditClick(e)}},{key:"onCommentClick",value:function(e){var t,n,i,a;e.id&&null!==(t=this.props.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.id&&this.props.router.push("/thread/comment/".concat(e.id,"?threadId=").concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}},{key:"onAboptClick",value:function(e){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.commentData=e,this.setState({showAboptPopup:!0})}},{key:"onAboptOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=15;break}return a={postId:this.commentData.id,rewards:t,threadId:null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId},e.next=4,this.props.thread.reward(a);case 4:if(s=e.sent,o=s.success,c=s.msg,!o){e.next=12;break}return this.setState({showAboptPopup:!1}),this.props.thread.fetchThreadDetail(a.threadId),B.a.success({content:"\u60ac\u8d4f".concat(t,"\u5143")}),e.abrupt("return",!0);case 12:B.a.error({content:c}),e.next=16;break;case 15:B.a.info({content:"\u60ac\u8d4f\u91d1\u989d\u4e0d\u80fd\u4e3a0"});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAboptCancel",value:function(){this.commentData=null,this.setState({showAboptPopup:!1})}},{key:"onUserClick",value:function(e){e&&g.a.push({url:"/user/".concat(e)})}},{key:"reportClick",value:function(e){"function"===typeof this.props.onReportClick&&this.props.onReportClick(e)}},{key:"replyAvatarClick",value:function(e,t,n){if(2===n){var i=e.userId;if(!i)return;this.props.router.push("/user/".concat(i))}if(3===n){var a=e.commentUserId;if(!a)return;this.props.router.push("/user/".concat(a))}}},{key:"onFocus",value:function(e){return this.props.user.isLogin()?!!this.props.canPublish()||void 0:(e&&e.stopPropagation(),B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"}))}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m=this,f=this.props.thread,j=f.totalCount,b=f.commentList,k=this.props.commentPosition,x=k.commentList,O=k.postId;this.props.isPositionComment&&(b=x||[]);var y=(null===(e=this.props.user)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.id)&&(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)===(null===(r=this.props.thread)||void 0===r||null===(s=r.threadData)||void 0===s?void 0:s.userId),C=null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c||null===(l=c.displayTag)||void 0===l?void 0:l.isReward,g=((null===(u=this.props.thread)||void 0===u?void 0:u.threadData)||"").isAnonymous,w=((null===(d=this.props.thread)||void 0===d||null===(p=d.threadData)||void 0===p?void 0:p.content)||{}).indexes,D={};return w&&Object.keys(w)&&Object.entries(w).forEach((function(e){var t=ct()(e,2)[1];if(t){var n=t.tomId,i=t.body;D[ht[n]]=i}})),Object(i.jsxs)("div",{className:R()(lt.a.container,!j&&lt.a.isEmpty),children:[this.props.showHeader&&Object(i.jsxs)("div",{className:lt.a.header,children:[j?Object(i.jsxs)("div",{className:lt.a.number,children:[j,"\u6761\u8bc4\u8bba"]}):Object(i.jsx)("div",{className:lt.a.number,children:"\u6682\u65e0\u8bc4\u8bba"}),Object(i.jsxs)("div",{className:lt.a.sort,onClick:function(){return m.onSortClick()},children:[Object(i.jsx)(T.a,{className:lt.a.sortIcon,name:"SortOutlined",size:14}),Object(i.jsx)("span",{className:lt.a.sortText,children:this.state.commentSort?"\u8bc4\u8bba\u4ece\u65b0\u5230\u65e7":"\u8bc4\u8bba\u4ece\u65e7\u5230\u65b0"})]})]}),this.props.showHeader&&Object(i.jsx)("div",{className:lt.a.input,children:Object(i.jsx)(_e.a,{height:"middle",onSubmit:function(e,t){return m.props.onPublishClick(e,t)},initValue:this.state.inputValue,placeholder:this.state.placeholder,onFocus:function(e){return m.onFocus(e)},onEmojiIconClick:function(){return m.onFocus()},onAtIconClick:function(){return m.onFocus()},onPcitureIconClick:function(){return m.onFocus()}})}),Object(i.jsx)("div",{className:lt.a.body,children:b.map((function(e,t){var n,a;return Object(i.jsx)("div",{className:"".concat(lt.a.commentItems," ").concat(t===b.length-1&&lt.a.isLastOne),ref:e.id===O?m.props.positionRef:null,children:Object(i.jsx)(dt.a,{data:e,avatarClick:function(e){return m.onUserClick(e)},replyAvatarClick:function(t,n){return m.replyAvatarClick(t,e,n)},likeClick:function(){return m.likeClick(e)},replyClick:function(){return m.replyClick(e)},deleteClick:function(){return m.deleteClick(e)},editClick:function(){return m.editClick(e)},replyLikeClick:function(t){return m.replyLikeClick(t,e)},replyReplyClick:function(t){return m.replyReplyClick(t,e)},replyDeleteClick:function(t){return m.replyDeleteClick(t,e)},reportClick:function(){return m.reportClick(e)},onCommentClick:function(){return m.onCommentClick(e)},onSubmit:function(e,t){return m.createReply(e,t)},isShowOne:!0,isShowInput:m.state.commentId===e.id,onAboptClick:function(){return m.onAboptClick(e)},isShowAdopt:y&&C&&(null===(n=m.props.thread)||void 0===n||null===(a=n.threadData)||void 0===a?void 0:a.userId)!==e.userId,threadId:m.props.thread.threadData.userId,active:e.id===O,isAnonymous:g},e.id)},e.id||t)}))}),Object(i.jsx)(q.a,{visible:this.state.showDeletePopup,onClose:function(){return m.setState({showDeletePopup:!1})},onBtnClick:function(){return m.deleteComment()}}),Object(i.jsx)(q.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return m.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return m.replyDeleteComment()}}),(null===D||void 0===D||null===(h=D.REWARD)||void 0===h?void 0:h.money)&&(null===D||void 0===D||null===(v=D.REWARD)||void 0===v?void 0:v.remainMoney)&&Object(i.jsx)(ut.a,{money:Number(D.REWARD.money),remainMoney:Number(D.REWARD.remainMoney),visible:this.state.showAboptPopup,onCancel:function(){return m.onAboptCancel()},onOkClick:function(e){return m.onAboptOk(e)}})]})}}]),n}(k.a.Component))||Ue)||Ue)||Ue)||Ue)||Ue;vt.defaultProps={showHeader:!0};var mt,ft=vt;function jt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var bt,kt=Object(O.c)("site")(mt=Object(O.c)("user")(mt=Object(O.c)("thread")(mt=Object(O.c)("commentPosition")(mt=Object(O.c)("comment")(mt=Object(O.c)("index")(mt=Object(O.c)("topic")(mt=Object(O.c)("search")(mt=Object(O.d)(mt=function(e){h()(n,e);var t=jt(n);function n(e){var i;return l()(this,n),(i=t.call(this,e)).state={showReportPopup:!1,showDeletePopup:!1,showCommentInput:!1,showMorePopup:!1,showRewardPopup:!1,isCommentLoading:!1,setTop:!1,inputValue:"",isBaseLayoutReady:!1},i.likedLoading=!1,i.collectLoading=!1,i.perPage=20,i.page=1,i.commentDataSort=!0,i.threadBodyRef=k.a.createRef(),i.commentDataRef=k.a.createRef(),i.position=0,i.comment=null,i.reportContent=["\u5e7f\u544a\u5783\u573e","\u8fdd\u89c4\u5185\u5bb9","\u6076\u610f\u704c\u6c34","\u91cd\u590d\u53d1\u5e16"],i.inputText="\u8bf7\u8f93\u5165\u5176\u4ed6\u7406\u7531",i.positionRef=k.a.createRef(),i.isPositioned=!1,i}return d()(n,[{key:"handleOnRefresh",value:function(){return this.props.thread.setCommentListPage(this.props.thread.page+1),this.loadCommentList()}},{key:"handleOnScroll",value:function(){var e,t,n,i,a=null===(e=this.threadBodyRef)||void 0===e||null===(t=e.current)||void 0===t||null===(n=t.listRef)||void 0===n||null===(i=n.current)||void 0===i?void 0:i.listWrapper;if(a&&a.current){var r,s=null===a||void 0===a||null===(r=a.current)||void 0===r?void 0:r.scrollTop;this.props.thread.setScrollDistance(s)}}},{key:"onBaseLayoutReady",value:function(){this.setState({isBaseLayoutReady:!0})}},{key:"componentDidUpdate",value:function(){var e,t,n=this;if(this.state.isBaseLayoutReady){var i,a,r,s,o=null===(i=this.threadBodyRef)||void 0===i||null===(a=i.current)||void 0===a||null===(r=a.listRef)||void 0===r||null===(s=r.current)||void 0===s?void 0:s.listWrapper;o&&this.scrollToPostion(o),this.setState({isBaseLayoutReady:!1})}null!==(e=this.props.commentPosition)&&void 0!==e&&e.postId&&!this.isPositioned&&null!==(t=this.positionRef)&&void 0!==t&&t.current&&(this.isPositioned=!0,setTimeout((function(){n.positionRef.current.scrollIntoView()}),1e3))}},{key:"componentWillUnmount",value:function(){}},{key:"scrollToPostion",value:function(e){var t,n,i,a,r,s=this;if(null!==(t=this.props)&&void 0!==t&&null!==(n=t.thread)&&void 0!==n&&n.isPositionToComment)return this.position=(null===(a=this.commentDataRef)||void 0===a||null===(r=a.current)||void 0===r?void 0:r.offsetTop)-50,void setTimeout((function(){var t;null===e||void 0===e||null===(t=e.current)||void 0===t||t.scrollTo(0,s.position)}),1e3);null===e||void 0===e||null===(i=e.current)||void 0===i||i.scrollTo(0,this.props.thread.scrollDistance)}},{key:"loadCommentList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.props.thread.isCommentReady,!this.state.isCommentLoading&&i){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,page:this.props.thread.page,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.thread.loadCommentList(s);case 8:if(o=e.sent,c=o.success,l=o.msg,this.setState({isCommentLoading:!1}),!c){e.next=14;break}return e.abrupt("return");case 14:B.a.error({content:l});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onSortChange",value:function(e){this.commentDataSort=e,this.props.thread.setCommentListPage(1),this.props.commentPosition.reset(),this.loadCommentList()}},{key:"onInputClick",value:function(){this.setState({showCommentInput:!0})}},{key:"onOperClick",value:function(e){if("stick"===e&&this.updateStick(),"essence"===e&&this.updateEssence(),"delete"===e&&this.setState({showDeletePopup:!0}),"edit"===e){var t,n,i,a;if(null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n||!n.id)return;this.props.router.push("/thread/post?id=".concat(null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id))}"report"===e&&this.setState({showReportPopup:!0})}},{key:"onReportClick",value:function(e){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.comment=e,this.setState({showReportPopup:!0})}},{key:"onReportOk",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=3;break}return B.a.info({content:"\u8bf7\u9009\u62e9\u6216\u8f93\u5165\u4e3e\u62a5\u7406\u7531"}),e.abrupt("return");case 3:return n={threadId:this.props.thread.threadData.threadId,reason:t,userId:this.props.user.userInfo.id},this.comment?(n.type=2,n.postId=this.comment.id):n.type=1,e.next=7,this.props.thread.createReports(n);case 7:if(i=e.sent,a=i.success,s=i.msg,!a){e.next=14;break}return B.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),this.setState({showReportPopup:!1}),e.abrupt("return",!0);case 14:B.a.error({content:s});case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onReportCancel",value:function(){this.comment=null,this.setState({showReportPopup:!1})}},{key:"setTopState",value:function(e){var t=this;this.setState({showContent:e,setTop:!this.state.setTop}),setTimeout((function(){t.setState({setTop:!t.state.setTop})}),2e3)}},{key:"updateStick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,o={id:s,isStick:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&a.isStick)},e.next=4,this.props.thread.updateStick(o);case 4:if(c=e.sent,l=c.success,u=c.msg,!l){e.next=11;break}return this.setTopState(o.isStick),(null===(d=this.props)||void 0===d||null===(p=d.index)||void 0===p?void 0:p.refreshHomeData)&&this.props.index.refreshHomeData(),e.abrupt("return");case 11:B.a.error({content:u});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateEssence",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,isEssence:!(null!==(i=this.props.thread)&&void 0!==i&&null!==(a=i.threadData)&&void 0!==a&&null!==(s=a.displayTag)&&void 0!==s&&s.isEssence)},e.next=4,this.props.thread.updateEssence(c);case 4:if(l=e.sent,u=l.success,d=l.msg,this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic),!u){e.next=11;break}return B.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),e.abrupt("return");case 11:B.a.error({content:d});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({showDeletePopup:!1}),i=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,e.next=4,this.props.thread.delete(i,this.props.index,this.props.search,this.props.topic,this.props.site,this.props.user);case 4:if(a=e.sent,s=a.success,o=a.msg,!s){e.next=11;break}return B.a.success({content:"\u5220\u9664\u6210\u529f\uff0c\u5373\u5c06\u8df3\u8f6c\u81f3\u9996\u9875"}),setTimeout((function(){c.props.router.push("/")}),1e3),e.abrupt("return");case 11:B.a.error({content:o});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onBtnClick",value:function(){this.delete(),this.setState({showDeletePopup:!1})}},{key:"onPublishClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:"",n=i.length>1&&void 0!==i[1]?i[1]:[],this.props.user.isLogin()){e.next=6;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 6:if(t.replace(/\s/g,"")||0!==n.length){e.next=10;break}return B.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 10:if(!this.comment){e.next=16;break}return e.next=13,this.updateComment(t,n);case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,this.createComment(t,n);case 18:e.t0=e.sent;case 19:return e.abrupt("return",e.t0);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createComment",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d,p,h,v,m,f,j;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id,l={id:c,content:t,sort:this.commentDataSort,isNoMore:null===(s=this.props)||void 0===s||null===(o=s.thread)||void 0===o?void 0:o.isNoMore,attachments:[]},null!==n&&void 0!==n&&n.length&&(l.attachments=n.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=5,this.props.comment.createComment(l,this.props.thread);case 5:if(u=e.sent,d=u.success,p=u.msg,h=u.isApproved,v=u.redPacketAmount,!d){e.next=19;break}return h?B.a.success({content:p}):B.a.warning({content:p}),v&&v>0&&this.props.thread.setRedPacket(v),this.props.thread.updatePostCount(this.props.thread.totalCount),this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic),(null===(m=this.props.thread)||void 0===m||null===(f=m.threadData)||void 0===f||null===(j=f.displayTag)||void 0===j?void 0:j.isRedPack)&&this.props.thread.fetchThreadDetail(c),this.setState({showCommentInput:!1,inputValue:""}),e.abrupt("return",!0);case 19:B.a.error({content:p});case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateComment",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.comment){e.next=2;break}return e.abrupt("return");case 2:return s=null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.id,o={id:s,pid:this.comment.id,content:t,attachments:[]},null!==n&&void 0!==n&&n.length&&(o.attachments=n.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=7,this.props.comment.updateComment(o,this.props.thread);case 7:if(c=e.sent,l=c.success,u=c.msg,d=c.isApproved,!l){e.next=15;break}return d?B.a.success({content:u}):B.a.warning({content:u}),this.setState({showCommentInput:!1}),e.abrupt("return",!0);case 15:B.a.error({content:u});case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onEditClick",value:function(e){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.comment=e,this.setState({inputValue:e.content,showCommentInput:!0})}},{key:"onClose",value:function(){this.setState({showCommentInput:!1}),this.comment=null}},{key:"onLikeClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(!this.likedLoading){e.next=6;break}return e.abrupt("return");case 6:return this.likedLoading=!0,c=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,l={id:c,pid:null===(i=this.props.thread)||void 0===i||null===(a=i.threadData)||void 0===a?void 0:a.postId,isLiked:!(null!==(s=this.props.thread)&&void 0!==s&&null!==(o=s.threadData)&&void 0!==o&&o.isLike)},e.next=11,this.props.thread.updateLiked(l,this.props.index,this.props.user,this.props.search,this.props.topic);case 11:u=e.sent,d=u.success,p=u.msg,this.likedLoading=!1,d||B.a.error({content:p});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onShareClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d,p,h;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B.a.info({content:"\u590d\u5236\u94fe\u63a5\u6210\u529f"}),o=(null===(t=this.props.thread)||void 0===t?void 0:t.threadData)||{},c=o.title,l=void 0===c?"":c,Q()({title:l,path:"thread/".concat(null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i?void 0:i.threadId)}),u=null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s?void 0:s.id,e.next=6,this.props.thread.shareThread(u);case 6:d=e.sent,p=d.success,h=d.msg,p||B.a.error({content:h});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onCollectionClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:if(!this.collectLoading){e.next=6;break}return e.abrupt("return");case 6:return this.collectLoading=!0,a=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,s={id:a,isFavorite:!(null!==(i=this.props.thread)&&void 0!==i&&i.isFavorite)},e.next=11,this.props.thread.updateFavorite(s);case 11:o=e.sent,c=o.success,l=o.msg,this.collectLoading=!1,c||B.a.error({content:l});case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onFollowClick",value:function(){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});var e,t,n,i;this.props.thread.threadData.userId&&(2===(null===(e=this.props.thread)||void 0===e||null===(t=e.authorInfo)||void 0===t?void 0:t.follow)||1===(null===(n=this.props.thread)||void 0===n||null===(i=n.authorInfo)||void 0===i?void 0:i.follow)?this.props.thread.cancelFollow({id:this.props.thread.threadData.userId,type:1},this.props.user):this.props.thread.postFollow(this.props.thread.threadData.userId,this.props.user))}},{key:"onPayClick",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(z.a)({url:"/user/login"}),e.abrupt("return");case 4:return a=this.props.thread.threadData,e.next=7,Object(Z.a)(a,null===(t=this.props.user)||void 0===t?void 0:t.userInfo);case 7:if(s=e.sent,!s.success||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId){e.next=13;break}return e.next=12,this.props.thread.fetchThreadDetail(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.threadId);case 12:this.props.thread.updateListStore(this.props.index,this.props.search,this.props.topic);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onRewardClick",value:function(){if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});this.setState({showRewardPopup:!0})}},{key:"onRewardSubmit",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l,u,d,p;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(isNaN(Number(t))||null===(n=this.props.thread)||void 0===n||null===(i=n.threadData)||void 0===i||!i.threadId||null===(a=this.props.thread)||void 0===a||null===(s=a.threadData)||void 0===s||!s.userId){e.next=9;break}return this.setState({showRewardPopup:!1}),l={amount:Number(t),threadId:this.props.thread.threadData.threadId,payeeId:this.props.thread.threadData.userId,title:(null===(o=this.props.thread)||void 0===o||null===(c=o.threadData)||void 0===c?void 0:c.title)||"\u4e3b\u9898\u6253\u8d4f"},e.next=5,this.props.thread.rewardPay(l,this.props.user,this.props.index,this.props.search,this.props.topic);case 5:u=e.sent,d=u.success,p=u.msg,d||B.a.error({content:p});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTagClick",value:function(){var e,t,n=null===(e=this.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t?void 0:t.categoryId;(n||"number"===typeof n)&&this.props.index.refreshHomeData({categoryIds:[n]}),this.props.router.push("/")}},{key:"onPrivateLetter",value:function(){var e;if(!this.props.user.isLogin())return B.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(z.a)({url:"/user/login"});var t=null===(e=this.props.thread)||void 0===e?void 0:e.authorInfo,n=t.username,i=t.nickname;n&&g.a.push({url:"/message?page=chat&username=".concat(n,"&nickname=").concat(i)})}},{key:"onUserClick",value:function(e){e&&g.a.push({url:"/user/".concat(e)})}},{key:"onLoadMoreClick",value:function(){this.props.commentPosition.page=this.props.commentPosition.page+1,this.loadCommentPositionList()}},{key:"loadCommentPositionList",value:function(){var e=o()(r.a.mark((function e(){var t,n,i,a,s,o,c,l,u,d;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.commentPosition.isCommentReady,!this.state.isCommentLoading&&s){e.next=3;break}return e.abrupt("return");case 3:return this.setState({isCommentLoading:!0}),o=null===(t=this.props.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.id,c={id:o,page:(null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a?void 0:a.page)||1,perPage:this.perPage,sort:this.commentDataSort?"createdAt":"-createdAt"},e.next=8,this.props.commentPosition.loadCommentList(c);case 8:if(l=e.sent,u=l.success,d=l.msg,this.setState({isCommentLoading:!1}),!u){e.next=14;break}return e.abrupt("return",!0);case 14:B.a.error({content:d});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"renderContent",value:function(){var e,t=this,n=this.props,a=n.thread,r=n.canPublish,s=a.isReady,o=a.isCommentReady,c=(a.isNoMore,a.totalCount,a.isCommentListError),l=1===((null===a||void 0===a||null===(e=a.threadData)||void 0===e?void 0:e.isApproved)||0),u=this.props.commentPosition,d=u.isShowCommentList,p=u.isNoMore;return Object(i.jsxs)("div",{className:Je.a.bodyLeft,children:[s&&!l&&Object(i.jsx)("div",{className:Je.a.examinePosition}),s?Object(i.jsx)(st,{store:a,onOperClick:function(e){return t.onOperClick(e)},onLikeClick:function(){return t.onLikeClick()},onCollectionClick:function(){return t.onCollectionClick()},onShareClick:function(){return t.onShareClick()},onRewardClick:function(){return t.onRewardClick()},onTagClick:function(){return t.onTagClick()},onPayClick:function(){return t.onPayClick()},onUserClick:function(){var e,n,i;return t.onUserClick(null===(e=t.props.thread)||void 0===e||null===(n=e.threadData)||void 0===n||null===(i=n.user)||void 0===i?void 0:i.userId)}}):Object(i.jsx)(P.a,{type:"init"}),Object(i.jsx)("div",{className:"".concat(Je.a.bottom),ref:this.commentDataRef,children:o&&l?Object(i.jsxs)(b.Fragment,{children:[o&&d&&Object(i.jsxs)(b.Fragment,{children:[Object(i.jsx)(ft,{isPositionComment:!0,router:this.props.router,sort:function(e){return t.onSortChange(e)},replyAvatarClick:function(e,n,i){return t.replyAvatarClick(e,n,i)}}),!p&&Object(i.jsxs)("div",{className:Je.a.showMore,onClick:function(){return t.onLoadMoreClick()},children:[Object(i.jsx)("div",{className:Je.a.hidePercent,children:"\u5c55\u5f00\u66f4\u591a\u8bc4\u8bba"}),Object(i.jsx)(T.a,{className:Je.a.icon,name:"RightOutlined",size:12})]})]}),Object(i.jsx)(ft,{canPublish:r,positionRef:this.positionRef,showHeader:!d,router:this.props.router,sort:function(e){return t.onSortChange(e)},onEditClick:function(e){return t.onEditClick(e)},onPublishClick:function(e,n){return t.onPublishClick(e,n)},onReportClick:function(e){return t.onReportClick(e)}})]}):l&&Object(i.jsx)(P.a,{isError:c,type:"init"})})]})}},{key:"renderRight",value:function(){var e,t,n,a,r,s,o,c=this,l=this.props.thread,u=l.isAuthorInfoError,d=l.isReady,p=1===((null===l||void 0===l||null===(e=l.threadData)||void 0===e?void 0:e.isApproved)||0),h=(null===(t=this.props.user)||void 0===t||null===(n=t.userInfo)||void 0===n?void 0:n.id)&&(null===(a=this.props.user)||void 0===a||null===(r=a.userInfo)||void 0===r?void 0:r.id)===(null===l||void 0===l||null===(s=l.threadData)||void 0===s?void 0:s.userId),v=null===l||void 0===l||null===(o=l.threadData)||void 0===o?void 0:o.isAnonymous;return Object(i.jsxs)("div",{className:"".concat(Je.a.bodyRigth),children:[d&&!p&&Object(i.jsx)("div",{className:Je.a.examinePosition}),!v&&Object(i.jsx)("div",{className:"".concat(Je.a.authorInfo," detail-authorinfo"),children:null!==l&&void 0!==l&&l.authorInfo?Object(i.jsx)(He.a,{user:l.authorInfo,onFollowClick:function(){return c.onFollowClick()},onPrivateLetter:function(){return c.onPrivateLetter()},onPersonalPage:function(){var e,t,n;return c.onUserClick(null===(e=c.props.thread)||void 0===e||null===(t=e.threadData)||void 0===t||null===(n=t.user)||void 0===n?void 0:n.userId)},isShowBtn:!h}):Object(i.jsx)(P.a,{type:"init",isError:u})}),Object(i.jsx)("div",{className:Je.a.recommend,children:Object(i.jsx)(tt.a,{})}),Object(i.jsx)("div",{className:Je.a.qrcode,children:Object(i.jsx)(nt.a,{})}),Object(i.jsx)(Fe.a,{className:Je.a.copyright})]})}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u,d,p,h,v,m,f,j,b,k=this,x=this.props.thread,O=x.isCommentReady,y=x.isNoMore,C=this.props.thread,g=C.isReady,w=1===((null===C||void 0===C||null===(e=C.threadData)||void 0===e?void 0:e.isApproved)||0),D=null===C||void 0===C||null===(t=C.threadData)||void 0===t?void 0:t.isAnonymous,N=(null===(n=this.props.user)||void 0===n||null===(a=n.userInfo)||void 0===a?void 0:a.id)&&(null===(r=this.props.user)||void 0===r||null===(s=r.userInfo)||void 0===s?void 0:s.id)===(null===C||void 0===C||null===(o=C.threadData)||void 0===o?void 0:o.userId);return Object(i.jsxs)("div",{children:[Object(i.jsx)(Ye,{showContent:null===(c=this.props.thread)||void 0===c||null===(l=c.threadData)||void 0===l?void 0:l.isStick,setTop:this.state.setTop}),Object(i.jsx)(et,{isShow:g&&!w}),Object(i.jsx)(Xe.a,{onRefresh:function(){return k.handleOnRefresh()},onScroll:function(){return k.handleOnScroll()},noMore:y,ref:this.threadBodyRef,showRefresh:!1,right:this.renderRight(),isShowLayoutRefresh:O,ready:function(){return k.onBaseLayoutReady()},rightClassName:R()(Je.a.positionSticky,{"is-userinfo-show":!D,"is-operate-show":!N}),className:"detail",children:this.renderContent()}),Object(i.jsx)($.a,{position:"center",visible:this.state.showCommentInput,onClose:function(){return k.onClose()},children:Object(i.jsxs)("div",{className:Je.a.editCmment,children:[Object(i.jsx)("div",{className:Je.a.close,onClick:function(){return k.onClose()},children:Object(i.jsx)(T.a,{size:18,name:"WrongOutlined"})}),Object(i.jsx)("div",{className:Je.a.title,children:"\u7f16\u8f91\u8bc4\u8bba"}),Object(i.jsx)("div",{className:Je.a.user,children:Object(i.jsx)(be.a,{name:(null===this||void 0===this||null===(u=this.comment)||void 0===u||null===(d=u.user)||void 0===d?void 0:d.nickname)||"",avatar:(null===this||void 0===this||null===(p=this.comment)||void 0===p||null===(h=p.user)||void 0===h?void 0:h.avatar)||"",time:"".concat(null===this||void 0===this||null===(v=this.comment)||void 0===v?void 0:v.updatedAt)||"",userId:null===this||void 0===this||null===(m=this.comment)||void 0===m||null===(f=m.user)||void 0===f?void 0:f.userId,platform:"pc"})}),Object(i.jsx)(_e.a,{height:"middle",onSubmit:function(e){return k.onPublishClick(e)},initValue:this.state.inputValue,threadId:null===(j=this.props.thread)||void 0===j||null===(b=j.threadData)||void 0===b?void 0:b.userId,isAnonymous:D})]})}),Object(i.jsx)(q.a,{visible:this.state.showDeletePopup,onClose:function(){return k.setState({showDeletePopup:!1})},onBtnClick:function(){return k.delete()},type:"thread"}),Object(i.jsx)(Qe.a,{reportContent:this.reportContent,inputText:this.inputText,visible:this.state.showReportPopup,onCancel:function(){return k.onReportCancel()},onOkClick:function(e){return k.onReportOk(e)}}),Object(i.jsx)(Ke,{visible:this.state.showRewardPopup,onCancel:function(){return k.setState({showRewardPopup:!1})},onOkClick:function(e){return k.onRewardSubmit(e)}})]})}}]),n}(k.a.Component))||mt)||mt)||mt)||mt)||mt)||mt)||mt)||mt)||mt,xt=Object(x.withRouter)(kt),Ot=n("ZCww"),yt=n("L0er"),Ct=n("J0pL"),gt=n("Tk/S"),wt=n("/Ugf"),Dt=n("lF3x");function Nt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=j()(e);if(t){var a=j()(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return m()(this,n)}}var Rt=Object(O.c)("site")(bt=Object(O.c)("thread")(bt=Object(O.c)("commentPosition")(bt=Object(O.c)("user")(bt=Object(O.c)("index")(bt=Object(O.c)("topic")(bt=Object(O.c)("search")(bt=Object(O.d)(bt=function(e){h()(n,e);var t=Nt(n);function n(e){var i;l()(this,n),(i=t.call(this,e)).updateViewCount=function(){var e=o()(r.a.mark((function e(t){var n,a,s,o,c,l,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i.props.site,s=(null===a||void 0===a||null===(n=a.webConfig)||void 0===n?void 0:n.setSite)||{},o=s.openViewCount,c=Number(o),l=Number(t),e.next=6,Object(Dt.c)(l,0===c);case 6:(u=e.sent)&&(i.props.thread.updateViewCount(u),i.props.index.updateAssignThreadInfo(l,{updateType:"viewCount",updatedInfo:{viewCount:u}}),i.props.search.updateAssignThreadInfo(l,{updateType:"viewCount",updatedInfo:{viewCount:u}}),i.props.topic.updateAssignThreadInfo(l,{updateType:"viewCount",updatedInfo:{viewCount:u}}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.handleWeiXinShare=o()(r.a.mark((function e(){var t,n,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,O,y;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var i=Object(wt.a)(e);if(i)return i.length>28?"".concat(i.substr(0,28),"..."):i}var a=[];n[101]&&a.push("\u56fe\u7247"),n[103]&&a.push("\u89c6\u9891"),n[102]&&a.push("\u8bed\u97f3"),n[108]&&a.push("\u9644\u4ef6");var r=a.length>0?"".concat(a.join("/")):"\u5185\u5bb9",s=t&&t.nickname?"".concat(t.nickname):"\u533f\u540d\u7528\u6237";return"".concat(s,"\u53d1\u5e03\u7684").concat(r)},n=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3?arguments[3]:void 0,a=null;if(1!==f){for(var r=t.match(/<img[\s]+[^<>]*>|<img[\s]+[^<>]*/g)||[],s=0;s<r.length;s++)if(-1===r[s].indexOf("qq-emotion")&&(a=r[s].match(/(http|https):\/\/.*?(webp|png|jpg|jpeg)/gi))){a=a?a[0]:null;break}if(2!==f&&!a&&n[101])for(var o=n[101].body||[],c=0;c<o.length;c++)if("gif"!==o[c].extension){a=o[c].thumbUrl;break}}return!j&&!a&&e&&e.avatar&&(a=e.avatar),!a&&i&&""!==i&&(a=i),a},a=i.props,s=a.site,o=a.thread,c=s.webConfig,l=c.setSite,u=l.siteHeaderLogo,d=l.siteIntroduction,p=o.threadData,h=p.content,v=p.title,m=p.user,f=p.payType,j=p.isAnonymous,b=h.text,k=h.indexes,x=d&&""!==d?d:"\u5728\u8fd9\u91cc\uff0c\u53d1\u73b0\u66f4\u591a\u7cbe\u5f69\u5185\u5bb9",O=v&&""!==v?v:t(b,m,k),y=n(m,b,k,u),Object(gt.a)(O,x,window.location.href,y)}catch(r){console.error("\u8bbe\u7f6e\u5206\u4eab\u9519\u8bef",r)}case 1:case"end":return e.stop()}}),e)}))),i.state={isServerError:!1,serverErrorMsg:""};var a=i.props,s=a.thread,c=a.serverThread;return(null===c||void 0===c?void 0:c.commentList)&&s.setCommentList(c.commentList),(null===c||void 0===c?void 0:c.totalCount)&&s.setTotalCount(c.totalCount),i}return d()(n,null,[{key:"getInitialProps",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null===t||void 0===t||null===(n=t.query)||void 0===n?void 0:n.id,a={threadData:null,commentList:null,totalCount:0,authorInfo:null},!i){e.next=11;break}return e.next=5,Object(y.readThreadDetail)({params:{threadId:Number(i)}});case 5:return 0===(s=e.sent).code&&(a.threadData=s.data),e.next=9,Object(y.readCommentList)({params:{filter:{thread:Number(i)},sort:"createdAt",page:1,perPage:20}});case 9:0===(o=e.sent).code&&(a.commentList=(null===(c=o.data)||void 0===c?void 0:c.pageData)||[],a.totalCount=(null===(l=o.data)||void 0===l?void 0:l.totalCount)||0);case 11:return e.abrupt("return",{serverThread:a});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),d()(n,[{key:"componentDidUpdate",value:function(e){var t,n,i,a,r,s;(null!==(t=this.props.router)&&void 0!==t&&null!==(n=t.query)&&void 0!==n&&n.id&&this.props.router.query.id!==e.router.query.id&&(this.props.thread.reset(),this.getPageDate(this.props.router.query.id)),null!==(i=this.props.router)&&void 0!==i&&null!==(a=i.query)&&void 0!==a&&a.postId&&this.props.router.query.postId!==e.router.query.postId)&&this.getPositionComment(null===(r=this.props.router)||void 0===r||null===(s=r.query)||void 0===s?void 0:s.id,this.props.router.query.postId)}},{key:"componentDidMount",value:function(){var e=o()(r.a.mark((function e(){var t,n,i;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.router.query,n=t.id,i=t.postId,!n){e.next=5;break}return e.next=4,this.getPageDate(n,i);case 4:this.updateViewCount(n);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPageDate",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o,c,l,u,d,p,h,v,m,f,j,b,k,x,O,y,C,w,D,N,R,I,P,S,L;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(i=this.props)&&void 0!==i&&null!==(a=i.thread)&&void 0!==a&&a.threadData&&this.hasMaybeCache()){e.next=21;break}return h=(null===(u=this.props.thread)||void 0===u?void 0:u.isPositionToComment)||!1,this.props.thread.reset({isPositionToComment:h}),e.next=5,this.props.thread.fetchThreadDetail(t);case 5:if(0===(v=e.sent).code){e.next=13;break}if(-4004!==v.code){e.next=10;break}return g.a.replace({url:"/404"}),e.abrupt("return");case 10:return v.code>-5e3&&v.code<-4e3&&this.setState({serverErrorMsg:v.msg}),this.setState({isServerError:!0}),e.abrupt("return");case 13:if(1===((null===(d=this.props.thread)||void 0===d||null===(p=d.threadData)||void 0===p?void 0:p.isApproved)||0)){e.next=21;break}if(x=null===(m=this.props.user)||void 0===m||null===(f=m.userInfo)||void 0===f?void 0:f.id,O=null===(j=this.props.thread)||void 0===j||null===(b=j.threadData)||void 0===b||null===(k=b.user)||void 0===k?void 0:k.userId,x&&O&&x===O){e.next=21;break}return B.a.info({content:"\u5185\u5bb9\u6b63\u5728\u5ba1\u6838\u4e2d\uff0c\u5ba1\u6838\u901a\u8fc7\u540e\u624d\u80fd\u6b63\u5e38\u663e\u793a!"}),g.a.redirect({url:"/"}),e.abrupt("return");case 21:return this.hasMaybeCache()&&(1===((null===(y=this.props.thread)||void 0===y||null===(C=y.threadData)||void 0===C?void 0:C.isApproved)||0)||this.getThreadDataFromList(t)),Object(ce.a)()&&this.handleWeiXinShare(),e.next=25,this.getPositionComment(t,n);case 25:null!==(s=this.props)&&void 0!==s&&null!==(o=s.thread)&&void 0!==o&&o.commentList&&this.hasMaybeCache()&&!n||(this.props.thread.setCommentListPage((null===(w=this.props.commentPosition)||void 0===w?void 0:w.postsPositionPage)||1),D={id:t,page:this.props.thread.page},this.props.thread.loadCommentList(D)),null!==(c=this.props)&&void 0!==c&&null!==(l=c.thread)&&void 0!==l&&l.authorInfo&&this.hasMaybeCache()||(P=this.props.site,S=P.platform,L=null===(N=this.props.thread)||void 0===N||null===(R=N.threadData)||void 0===R||null===(I=R.user)||void 0===I?void 0:I.userId,"pc"===S&&L&&this.props.thread.fetchAuthorInfo(L));case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getThreadDataFromList",value:function(){var e=o()(r.a.mark((function e(t){var n,i,a,s,o,c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&(a=this.props.index.findAssignThread(Number(t)),(i=null===a||void 0===a?void 0:a.data)||(o=this.props.search.findAssignThread(Number(t)),i=null===(s=o[0])||void 0===s?void 0:s.data),i||(c=this.props.topic.findAssignThread(Number(t)),i=null===c||void 0===c?void 0:c.data),null!==(n=i)&&void 0!==n&&n.threadId&&this.props.thread.setThreadData(i));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPositionComment",value:function(){var e=o()(r.a.mark((function e(t,n){var i,a,s,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n||null===(i=this.props)||void 0===i||null===(a=i.commentPosition)||void 0===a||a.reset(),!t||!n){e.next=7;break}return this.props.commentPosition.setPostId(Number(n)),s={threadId:t,postId:n,pageSize:20},e.next=6,this.props.commentPosition.fetchPositionPosts(s);case 6:this.props.commentPosition.isShowCommentList&&(o={id:t},this.props.commentPosition.loadCommentList(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hasMaybeCache",value:function(){var e,t,n,i=this.props.router.query.id,a=null===(e=this.props)||void 0===e||null===(t=e.thread)||void 0===t||null===(n=t.threadData)||void 0===n?void 0:n.threadId;return i&&a&&Number(i)===a}},{key:"render",value:function(){var e,t,n,a,r,s,o,c,l,u=this.props,d=u.site,p=u.canPublish,h=d.platform,v=!0;return(null!==(e=this.props)&&void 0!==e&&null!==(t=e.thread)&&void 0!==t&&null!==(n=t.threadData)&&void 0!==n&&n.title||null!==(a=this.props)&&void 0!==a&&null!==(r=a.thread)&&void 0!==r&&null!==(s=r.threadData)&&void 0!==s&&null!==(o=s.content)&&void 0!==o&&o.text)&&(v=!1),this.state.isServerError?"h5"===h?Object(i.jsx)(yt.a,{text:this.state.serverErrorMsg}):Object(i.jsx)(Ot.a,{text:this.state.serverErrorMsg}):Object(i.jsx)(Ct.a,{h5:Object(i.jsx)(qe,{}),pc:Object(i.jsx)(xt,{canPublish:p}),title:(null===(c=this.props)||void 0===c||null===(l=c.thread)||void 0===l?void 0:l.title)||"",showSiteName:v})}}]),n}(k.a.Component))||bt)||bt)||bt)||bt)||bt)||bt)||bt)||bt;t.default=Object(x.withRouter)(Object(Me.a)(Rt))},ZCww:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("nKUr"),a=n("q1tI"),r=n("6csX"),s=n("5f2u"),o=n.n(s),c=n("z8Av"),l=n("wXCO");function u(e){var t=Object(a.useState)(e.text||"\u670d\u52a1\u5668\u9519\u8bef SERVER ERROR")[0];return Object(i.jsxs)("div",{className:r.a.page,children:[Object(i.jsx)(c.a,{}),Object(i.jsxs)("div",{className:r.a.body,children:[Object(i.jsx)("img",{className:r.a.icon,src:"/dzq-img/error.png"}),Object(i.jsx)("span",{className:r.a.text,children:t}),Object(i.jsx)(o.a,{onClick:function(){window.location.reload()},className:r.a.button,type:"primary",children:"\u70b9\u6211\u5237\u65b0"})]}),Object(i.jsx)("div",{className:r.a.footer,children:Object(i.jsx)(l.a,{})})]})}},c7hV:function(e,t,n){"use strict";var i=n("nKUr"),a=n("q1tI"),r=n("MCNy"),s=n.n(r),o=n("k8W2"),c=n.n(o),l=n("5f2u"),u=n.n(l),d=n("ZS9c"),p=n("TSYQ"),h=n.n(p);t.a=function(e){var t=e.visible,n=e.onSubmit,r=e.onClose,o=e.onOperClick,l=e.permissions,p=void 0===l?{}:l,v=e.statuses,m=void 0===v?{}:v,f=p.canEdit,j=p.canDelete,b=p.canEssence,k=p.canStick,x=p.canShare,O=p.canWxShare,y=p.canCollect,C=p.isAdmini,g=m.isEssence,w=m.isStick,D=m.isCollect,N=Object(a.useState)(g),R=N[0],I=N[1],P=Object(a.useState)(w),S=P[0],L=P[1],T=Object(a.useState)(D),E=T[0],A=T[1],M=Object(a.useMemo)((function(){return 1+f+j+b+k+x+y}),[f,j,b,k,x,y]);return Object(a.useEffect)((function(){I(g)}),[g]),Object(a.useEffect)((function(){L(w)}),[w]),Object(a.useEffect)((function(){A(D)}),[D]),Object(i.jsx)(c.a,{position:"bottom",visible:t,onClose:r,children:Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:d.a.container,children:Object(i.jsxs)("div",{className:h()(d.a.more,M<5&&d.a.flex),children:[f&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("edit")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"RedactOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7f16\u8f91"})]}),j&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("delete")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"DeleteOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u5220\u9664"})]}),b&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,R&&d.a.actived),onClick:function(){return o("essence")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"HotBigOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7cbe\u534e"})]}),k&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,S&&d.a.actived),onClick:function(){return o("stick")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"TopOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u7f6e\u9876"})]}),y&&Object(i.jsxs)("div",{className:h()(d.a.moreItem,E&&d.a.actived),onClick:function(){return o("collect")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"CollectFunOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u6536\u85cf"})]}),x&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("post")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"PictureOutlinedBig",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u751f\u6210\u6d77\u62a5"})]}),x&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("copylink")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"PaperClipOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u590d\u5236\u94fe\u63a5"})]}),O&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("wxshare")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"WeChatOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u5fae\u4fe1\u5206\u4eab"})]}),!C&&Object(i.jsxs)("div",{className:d.a.moreItem,onClick:function(){return o("report")},children:[Object(i.jsx)("div",{className:d.a.icon,children:Object(i.jsx)(s.a,{name:"WarnOutlined",size:20})}),Object(i.jsx)("div",{className:d.a.text,children:"\u4e3e\u62a5"})]})]})}),Object(i.jsx)("div",{className:d.a.button,children:Object(i.jsx)(u.a,{full:!0,onClick:n,className:d.a.cancel,type:"default",children:"\u53d6\u6d88"})})]})})}},iVyX:function(e,t,n){"use strict";n("QWBl"),n("yq1k"),n("oVuX"),n("2B1R"),n("Rfxz"),n("pDQq"),n("sMBO"),n("rB9j"),n("JTJg"),n("EnZy"),n("FZtP");var i=n("nKUr"),a=n("RIqP"),r=n.n(a),s=n("o0o1"),o=n.n(s),c=(n("ls82"),n("yXPU")),l=n.n(c),u=n("q1tI"),d=n("MCNy"),p=n.n(d),h=n("k8W2"),v=n.n(h),m=n("7O/2"),f=n.n(m),j=n("x2xJ"),b=n.n(j),k=n("wdT/"),x=n.n(k),O=n("6OTW"),y=n("TSYQ"),C=n.n(y),g=n("emxO"),w=n("sho3"),D=n("/1yQ"),N=n("FhbE"),R=n("uPFr");t.a=function(e){var t=e.visible,n=e.onSubmit,a=e.initValue,s=e.onClose,c=e.inputText,d=void 0===c?"\u5199\u8bc4\u8bba...":c,h=e.site,m=Object(u.createRef)(),j=Object(u.useState)(""),k=j[0],y=j[1],I=Object(u.useState)(!1),P=I[0],S=I[1],L=Object(u.useState)([]),T=L[0],E=L[1],A=Object(u.useState)(!1),M=A[0],B=A[1],F=Object(u.useState)(!1),z=F[0],V=F[1],U=Object(u.useState)(!1),W=U[0],q=U[1],H=Object(u.useState)([]),_=H[0],G=H[1],K=Object(u.useState)(!0),X=K[0],J=K[1],Q=Object(u.useState)(!1),Z=Q[0],Y=Q[1];Object(u.useEffect)((function(){y(a||"")}),[a]),Object(u.useEffect)(l()(o.a.mark((function t(){var n,i,a,r;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(B(e.showEmojis),null!==T&&void 0!==T&&T.length){t.next=7;break}return t.next=4,Object(w.readEmoji)();case 4:n=t.sent,i=n.code,a=n.data,r=void 0===a?[]:a,0===i&&E(r.map((function(e){return{code:e.code,url:e.url}})));case 7:case"end":return t.stop()}}),t)}))),[e.showEmojis]),Object(u.useEffect)((function(){q(e.showPicture)}),[e.showPicture]);var $=function(){var e=l()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!P&&!Z){e.next=2;break}return e.abrupt("return");case 2:if("function"!==typeof n){e.next=17;break}return e.prev=3,S(!0),e.next=7,n(k,_);case 7:e.sent&&(y(""),q(!1),G([]),B(!1),J(!0)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log(e.t0);case 14:return e.prev=14,S(!1),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=l()(o.a.mark((function e(){var t,n,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B(!M),V(!1),q(!1),null!==T&&void 0!==T&&T.length){e.next=9;break}return e.next=6,Object(w.readEmoji)();case 6:t=e.sent,n=t.code,i=t.data,a=void 0===i?[]:i,0===n&&E(a.map((function(e){return{code:e.code,url:e.url}})));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),te=function(){V(!z),B(!1),q(!1)},ne=function(){var e=l()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(r()(t)),t.length>0&&X&&J(!1),0!==t.length||X||0!==k.length||J(!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(i.jsxs)("div",{children:[Object(i.jsxs)(v.a,{position:"bottom",visible:t,onClose:function(){V(!1),B(!1),q(!1),"function"===typeof e.cancleEmojie&&e.cancleEmojie(),"function"===typeof e.canclePicture&&e.canclePicture(),s()},children:[Object(i.jsxs)("div",{className:O.a.container,children:[Object(i.jsx)("div",{className:O.a.main,children:Object(i.jsx)(f.a,{className:O.a.input,maxLength:5e3,rows:4,showLimit:!1,value:k,onChange:function(e){return function(e){y(e.target.value),e.target.value.length>0&&X&&J(!1),0!==e.target.value.length||X||0!==_.length||J(!0)}(e)},placeholder:d,disabled:P,forwardedRef:m,autoFocus:!0,onFocus:function(){return B(!1)}})}),W&&Object(i.jsxs)(u.Fragment,{children:[Object(i.jsx)("div",{className:O.a.imageUpload,children:Object(i.jsx)(g.a,{fileList:_,onChange:ne,onComplete:function(e,t,n){0===e.code&&(t.response=e.data),Y((null===n||void 0===n?void 0:n.length)&&n.some((function(e){return"uploading"===e.status})))},beforeUpload:function(e,t){return function(e,t,n){var i=h.webConfig;if(!i)return!1;var a=i.setAttach,r=a.supportFileExt,s=a.supportImgExt,o=a.supportMaxSize;if(n===R.j.file){var c=e[0].name.split(".").pop().toLocaleLowerCase(),l=e[0].size,u=l>0&&l<1024*o*1024;if(!r.toLocaleLowerCase().includes(c))return x.a.info({content:"\u5f53\u524d\u6587\u4ef6\u7c7b\u578b\u6682\u4e0d\u652f\u6301"}),!1;if(!u)return x.a.info({content:"\u4e0a\u4f20\u9644\u4ef6\u5927\u5c0f\u8303\u56f40 ~ ".concat(o,"MB")}),!1}else if(n===R.j.image){var d=9-t.length;e.splice(d,e.length-d);var p=!0;return e.forEach((function(t,n){var i="";i=t.imageType?t.imageType:t.name.split(".").pop().toLocaleLowerCase(),s.toLocaleLowerCase().includes(i)||(e.splice(n,1),p=!1)})),!p&&x.a.info({content:"\u4ec5\u652f\u6301".concat(s,"\u7c7b\u578b\u7684\u56fe\u7247")}),(null===e||void 0===e?void 0:e.length)&&Y(!0),!0}return!0}(e,t,R.j.image)},onFail:function(e){var t=null===e||void 0===e?void 0:e.msg,n=-7075===(null===e||void 0===e?void 0:e.code);x.a.error({content:n?t:"\u56fe\u7247\u4e0a\u4f20\u5931\u8d25"})}})}),Object(i.jsx)(b.a,{className:O.a.divider})]}),Object(i.jsxs)("div",{className:O.a.button,children:[Object(i.jsxs)("div",{className:O.a.operates,children:[Object(i.jsx)(p.a,{className:C()(O.a.operate,M&&O.a.actived),name:"SmilingFaceOutlined",size:20,onClick:ee}),Object(i.jsx)(p.a,{className:C()(O.a.operate,z&&O.a.actived),name:"AtOutlined",size:20,onClick:te}),Object(i.jsx)(p.a,{className:C()(O.a.operate,W&&O.a.actived),name:"PictureOutlinedBig",size:20,onClick:function(){q(!W),B(!1),V(!1)}})]}),Object(i.jsx)("div",{onClick:$,className:C()(O.a.ok,(P||Z||X)&&O.a.disabled),children:"\u53d1\u5e03"})]})]}),M&&Object(i.jsx)("div",{className:O.a.emojis,children:Object(i.jsx)(D.a,{show:M,emojis:T,onClick:function(e){var t,n=(null===m||void 0===m||null===(t=m.current)||void 0===t?void 0:t.selectionStart)||0,i=k.substr(0,n)+(e.code||"")+k.substr(n);y(i),i.length>0&&X&&J(!1),0!==i.length||X||J(!0)}})}),Object(i.jsx)("div",{className:O.a.safeArea})]}),z&&Object(i.jsx)(N.a,{visible:z,getAtList:function(e){var t,n=e.map((function(e){return" @".concat(e," ")})).join(""),i=(null===m||void 0===m||null===(t=m.current)||void 0===t?void 0:t.selectionStart)||0,a=k.substr(0,i)+(n||"")+k.substr(i);y(a),B(!1),e.length>0&&X&&J(!1),0!==e.length||X||J(!0)},onCancel:te})]})}},"n/mO":function(e){e.exports=JSON.parse('{"--color-primary":"#2469f6","--color-primary2":"#3978f7","--color-primary3":"#5087f8","--color-primary4":"#6596f9","--color-primary5":"#7ca5fa","--color-primary6":"#91b4fa","--color-primary7":"#a7c3fb","--color-primary8":"#bdd2fc","--color-primary9":"#d3e1fd","--color-primary10":"#e9f0fe","--color-success":"#57bd6a","--color-success2":"#79ca88","--color-success3":"#abdeb4","--color-success4":"#ccebd2","--color-success5":"#eef8f0","--color-info":"#5087f8","--color-info2":"#739ff9","--color-info3":"#a7c3fb","--color-info4":"#cadbfd","--color-info5":"#edf3fe","--color-error":"#e02433","--color-error2":"#e6505c","--color-error3":"#ef9199","--color-error4":"#f6bdc1","--color-error5":"#fce9ea","--color-warn":"#f6C443","--color-warn2":"#f8d069","--color-warn3":"#fae1a1","--color-warn4":"#fcedc6","--color-warn5":"#fef9ec","--color-disabled":"#c5c6cb","--color-disabled2":"#d0d1d5","--color-disabled3":"#dcdde0","--color-disabled4":"#e8e8ea","--color-disabled5":"#f4f4f5","--color-white":"#ffffff","--color-black":"#000000","--border-line-color":"#eeeeee","--color-text-primary":"#0b0b37","--color-text-regular":"#4f5a70","--color-text-secondary":"#8590a6","--color-text-placeholder":"#dcdde0","--background-color":"#f5f7f8","--background-color-text":"#f9fafb","--background-color-text2":"#eff1f3","--commont-box-bg-color":"#f5f7f8","--comment-content-bg-color":"#f4f6f7","--mask-background-color":"rgba(51, 51, 51, 0.3)","--border-border":"1px solid #eeeeee","--border-color-dotted-border":"1px dashed #eeeeee","--font-size-label":"12px","--font-size-primary":"14px","--font-size-middle":"16px","--font-size-large":"20px","--font-line-height-small":"22px","--font-line-height-primary":"24px","--font-line-height-middle":"26px","--font-line-height-large":"30px","--font-weight-light":"400","--font-weight-regular":"600","--font-weight-bold":"800","--box-shadow":"0px 0px 8px 0px #f1f3f4","--border-radius-small":"5px","--border-radius-circle":"50%","--border-radius-zero":"0px","--zindex-normal":"0","--zindex-backtotop":"1000","--zindex-too0p":"1200","--zindex-popup":"1400","--zindex-dialog":"1600","--zindex-toast":"1800","--padding-1n":"4px","--padding-2n":"8px","--padding-3n":"12px","--padding-4n":"16px","--padding-5n":"20px","--padding-6n":"24px","--padding-5":"5px","--padding-10":"10px","--margin-1n":"4px","--margin-2n":"8px","--margin-3n":"12px","--margin-4n":"16px","--margin-5n":"20px","--margin-6n":"24px","--margin-5":"5px","--margin-10":"10px"}')},tuZy:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/thread/[id]",function(){return n("TP+V")}])},woGs:function(e,t,n){"use strict";n("2B1R"),n("qePV");var i=n("nKUr"),a=n("o0o1"),r=n.n(a),s=(n("ls82"),n("yXPU")),o=n.n(s),c=n("q1tI"),l=n("wdT/"),u=n.n(l),d=n("k8W2"),p=n.n(d),h=n("5f2u"),v=n.n(h),m=n("7O/2"),f=n.n(m),j=n("BGqZ"),b=n.n(j),k=n("qtPy");t.a=function(e){var t=e.visible,n=e.onOkClick,a=e.onCancel,s=e.inputText,l=e.reportContent,d=void 0===l?[]:l,h=Object(c.useState)(""),m=h[0],j=h[1],x=Object(c.useState)(!1),O=x[0],y=x[1],C=function(){var e=o()(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(m.length>450)){e.next=3;break}return u.a.error({content:"\u4e3e\u62a5\u5185\u5bb9\u4e0d\u80fd\u5927\u4e8e450\u4e2a\u5b57\u7b26"}),e.abrupt("return");case 3:if("function"!==typeof n){e.next=14;break}return e.prev=4,e.next=7,n(m);case 7:e.sent&&j(""),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(){return e.apply(this,arguments)}}();return Object(i.jsx)(p.a,{position:"bottom",visible:t,onClose:a,children:Object(i.jsxs)("div",{className:k.a.container,children:[Object(i.jsxs)("div",{className:k.a.header,children:[Object(i.jsx)("div",{className:k.a.title,children:"\u4e3e\u62a5"}),Object(i.jsx)("div",{className:k.a.reason,children:"\u8bf7\u9009\u62e9\u4e3e\u62a5\u7406\u7531"})]}),Object(i.jsxs)("div",{className:k.a.body,children:[Object(i.jsxs)(b.a.Group,{defaultValue:"5",onChange:function(e){return function(e){"other"===e?(y(!0),j("")):(y(!1),j(d[Number(e)]))}(e)},children:[d.map((function(e,t){return Object(i.jsxs)("div",{className:k.a.reportTitle,children:[Object(i.jsx)("div",{className:k.a.content,children:e}),Object(i.jsx)(b.a,{name:"".concat(t)})]},t)})),Object(i.jsxs)("div",{className:k.a.reportTitle,children:[Object(i.jsx)("div",{className:k.a.content,children:"\u5176\u4ed6"}),Object(i.jsx)(b.a,{name:"other"})]})]}),O?Object(i.jsx)("div",{className:k.a.textarea,children:Object(i.jsx)(f.a,{className:k.a.input,rows:5,showLimit:!0,value:m,onChange:function(e){return j(e.target.value)},placeholder:s})}):""]}),Object(i.jsxs)("div",{className:k.a.button,children:[Object(i.jsx)(v.a,{onClick:a,className:k.a.cancel,children:"\u53d6\u6d88"}),Object(i.jsx)(v.a,{onClick:C,className:k.a.ok,type:"primary",children:"\u786e\u5b9a"})]})]})})}}},[["tuZy",1,0,3,5,4,6,8,2]]]);