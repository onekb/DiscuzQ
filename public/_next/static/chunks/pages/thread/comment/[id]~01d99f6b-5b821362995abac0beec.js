_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[49],{Rs2Y:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/thread/comment/[id]",function(){return r("wc3I")}])},wc3I:function(e,t,r){"use strict";r.r(t);r("qePV"),r("rB9j"),r("UxlC");var n,s=r("nKUr"),i=r("o0o1"),o=r.n(i),a=(r("ls82"),r("yXPU")),c=r.n(a),u=r("lwsE"),l=r.n(u),p=r("W8MJ"),m=r.n(p),h=r("7W2i"),d=r.n(h),f=r("a1gu"),v=r.n(f),k=r("Nsbk"),y=r.n(k),b=r("q1tI"),j=r.n(b),x=r("20a2"),C=r("kMSe"),D=r("sho3"),w=(r("TeQF"),r("2B1R"),r("B5JU")),O=r.n(w),g=r("5gkB"),L=r("7mQc"),I=r("c7hV"),R=r("aIz1"),P=r("z8Av"),S=r("wdT/"),N=r.n(S),E=r("iVyX"),M=r("woGs"),F=r("IvHc");function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var s=y()(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return v()(this,r)}}var T,B=Object(C.c)("site")(n=Object(C.c)("user")(n=Object(C.c)("comment")(n=Object(C.c)("thread")(n=Object(C.d)(n=function(e){d()(r,e);var t=A(r);function r(e){var n;return l()(this,r),(n=t.call(this,e)).onOperClick=function(e){if(!n.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});n.setState({showMorePopup:!1}),"delete"===e&&n.setState({showDeletePopup:!0}),"report"===e&&n.setState({showReportPopup:!0})},n.state={showReportPopup:!1,showMorePopup:!1,showCommentInput:!1,commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,inputText:"\u8bf7\u8f93\u5165\u5185\u5bb9"},n.commentData=null,n.replyData=null,n.recordCommentLike={id:null,status:null},n.recordReplyLike={id:null,status:null},n.reportContent=["\u5e7f\u544a\u5783\u573e","\u8fdd\u89c4\u5185\u5bb9","\u6076\u610f\u704c\u6c34","\u91cd\u590d\u53d1\u5e16"],n.inputText="\u5176\u4ed6\u7406\u7531...",n}return m()(r,[{key:"onMoreClick",value:function(){this.setState({showMorePopup:!0})}},{key:"likeClick",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:if(this.recordCommentLike.id!==t.id&&(this.recordCommentLike.status=null),this.recordCommentLike.status===t.isLiked){e.next=12;break}this.recordCommentLike.status=t.isLiked,this.recordCommentLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return r={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(r,this.props.thread);case 16:n=e.sent,s=n.success,i=n.msg,s&&(this.props.comment.setCommentDetailField("isLiked",r.isLiked),a=r.isLiked?t.likeCount+1:t.likeCount-1,this.props.comment.setCommentDetailField("likeCount",a)),s||N.a.error({content:i});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replyLikeClick",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:if(this.recordCommentLike.id!==t.id&&(this.recordCommentLike.status=null),this.recordCommentLike.status===t.isLiked){e.next=12;break}this.recordCommentLike.status=t.isLiked,this.recordCommentLike.id=t.id,e.next=13;break;case 12:return e.abrupt("return");case 13:return r={id:t.id,isLiked:!t.isLiked},e.next=16,this.props.comment.updateLiked(r,this.props.comment);case 16:n=e.sent,s=n.success,i=n.msg,s&&(this.props.comment.setReplyListDetailField(t.id,"isLiked",r.isLiked),a=r.isLiked?t.likeCount+1:t.likeCount-1,this.props.comment.setReplyListDetailField(t.id,"likeCount",a)),s||N.a.error({content:i});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=c()(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=t,this.setState({showDeletePopup:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onBtnClick",value:function(){this.deleteComment(),this.setState({showDeletePopup:!1})}},{key:"deleteComment",value:function(){var e=c()(o.a.mark((function e(){var t,r,n,s,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=this.props)&&void 0!==t&&null!==(r=t.comment)&&void 0!==r&&null!==(n=r.commentDetail)&&void 0!==n&&n.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.comment.delete(this.props.comment.commentDetail.id,this.props.thread);case 4:if(s=e.sent,i=s.success,a=s.msg,this.setState({showDeletePopup:!1}),!i){e.next=12;break}return N.a.success({content:"\u5220\u9664\u6210\u529f"}),O.a.back(),e.abrupt("return");case 12:N.a.error({content:a});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=c()(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=r,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=c()(o.a.mark((function e(){var t,r,n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.thread);case 6:if(r=e.sent,n=r.success,s=r.msg,this.setState({showReplyDeletePopup:!1}),!n){e.next=13;break}return N.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:N.a.error({content:s});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){var t;if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});this.commentData=e,this.replyData=null,this.setState({showCommentInput:!0,inputText:null!==e&&void 0!==e&&null!==(t=e.user)&&void 0!==t&&t.nickname?"\u56de\u590d".concat(e.user.nickname):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}},{key:"replyReplyClick",value:function(e,t){var r;if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});this.commentData=null,this.replyData=e,this.replyData.commentId=t.id,this.setState({showCommentInput:!0,inputText:null!==e&&void 0!==e&&null!==(r=e.user)&&void 0!==r&&r.nickname?"\u56de\u590d".concat(e.user.nickname):"\u8bf7\u8f93\u5165\u5185\u5bb9"})}},{key:"createReply",value:function(){var e=c()(o.a.mark((function e(t,r){var n,s,i,a,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.replace(/\s/g,"")){e.next=4;break}return N.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 4:if(n=this.props.comment.threadId){e.next=7;break}return e.abrupt("return");case 7:return s={id:n,content:t},this.replyData&&(s.replyId=this.replyData.id,s.isComment=!0,s.commentId=this.replyData.commentId,s.commentPostId=this.replyData.id),this.commentData&&(s.replyId=this.commentData.id,s.isComment=!0,s.commentId=this.commentData.id),null!==r&&void 0!==r&&r.length&&(s.attachments=r.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=13,this.props.comment.createReply(s,this.props.thread);case 13:if(i=e.sent,a=i.success,c=i.msg,u=i.isApproved,!a){e.next=21;break}return this.setState({showCommentInput:!1,inputText:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),u?N.a.success({content:c}):N.a.warning({content:c}),e.abrupt("return",!0);case 21:N.a.error({content:c});case 22:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onReportOk",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s,i,a,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return i={threadId:this.props.comment.threadId,type:2,reason:t,userId:this.props.user.userInfo.id,postId:null===(r=this.props)||void 0===r||null===(n=r.comment)||void 0===n||null===(s=n.commentDetail)||void 0===s?void 0:s.id},e.next=5,this.props.thread.createReports(i);case 5:if(a=e.sent,c=a.success,u=a.msg,!c){e.next=12;break}return N.a.success({content:"\u64cd\u4f5c\u6210\u529f"}),this.setState({showReportPopup:!1}),e.abrupt("return",!0);case 12:N.a.error({content:u});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"avatarClick",value:function(e){var t=e.userId;t&&this.props.router.push("/user/".concat(t))}},{key:"replyAvatarClick",value:function(e,t,r){if(2===r){var n=e.userId;if(!n)return;this.props.router.push("/user/".concat(n))}if(3===r){var s=e.commentUserId;if(!s)return;this.props.router.push("/user/".concat(s))}}},{key:"render",value:function(){var e,t,r=this,n=this.props.comment,i=n.commentDetail,o=n.isReady,a={canEdit:!1,canDelete:null===i||void 0===i?void 0:i.canDelete,canEssence:!1,canStick:!1,isAdmini:null===(e=this.props)||void 0===e||null===(t=e.user)||void 0===t?void 0:t.isAdmini};return Object(s.jsxs)("div",{className:g.a.index,children:[Object(s.jsx)(P.a,{}),Object(s.jsx)("div",{className:g.a.content,children:o&&Object(s.jsx)(L.a,{data:i,likeClick:function(){return r.likeClick(i)},replyClick:function(){return r.replyClick(i)},avatarClick:function(){return r.avatarClick(i)},deleteClick:function(){return r.deleteClick(i)},replyLikeClick:function(e){return r.replyLikeClick(e,i)},replyReplyClick:function(e){return r.replyReplyClick(e,i)},replyAvatarClick:function(e,t){return r.replyAvatarClick(e,i,t)},replyDeleteClick:function(e){return r.replyDeleteClick(e,i)},onMoreClick:function(){return r.onMoreClick()},isHideEdit:!0})}),Object(s.jsxs)("div",{className:g.a.footer,children:[Object(s.jsx)(E.a,{visible:this.state.showCommentInput,inputText:this.state.inputText,onClose:function(){return r.setState({showCommentInput:!1})},onSubmit:function(e,t){return r.createReply(e,t)},site:this.props.site}),Object(s.jsx)(I.a,{permissions:a,statuses:{isEssence:!1,isStick:!1},visible:this.state.showMorePopup,onClose:function(){return r.setState({showMorePopup:!1})},onSubmit:function(){return r.setState({showMorePopup:!1})},onOperClick:function(e){return r.onOperClick(e)}}),Object(s.jsx)(R.a,{visible:this.state.showDeletePopup,onClose:function(){return r.setState({showDeletePopup:!1})},onBtnClick:function(){return r.deleteComment()}}),Object(s.jsx)(R.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return r.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return r.replyDeleteComment()}}),Object(s.jsx)(M.a,{reportContent:this.reportContent,inputText:this.inputText,visible:this.state.showReportPopup,onCancel:function(){return r.setState({showReportPopup:!1})},onOkClick:function(e){return r.onReportOk(e)}})]})]})}}]),r}(j.a.Component))||n)||n)||n)||n)||n,_=Object(x.withRouter)(B),U=(r("ma9I"),r("9cud")),J=r("JMpY"),W=r("PuBq"),q=r("Wpw2"),H=r("MCNy"),X=r.n(H),z=r("wrmh"),Q=r("jpI4"),Y=r("myta"),V=r("gdiw"),Z=r("TSYQ"),K=r.n(Z);function G(e){var t=e.empty;return t?Object(s.jsx)("div",{className:K()(V.a.container,t&&V.a.empty)}):Object(s.jsx)("div",{className:V.a.container,children:"\u6ca1\u6709\u66f4\u591a\u6570\u636e\u4e86"})}function $(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var s=y()(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return v()(this,r)}}var ee,te=Object(C.c)("site")(T=Object(C.c)("user")(T=Object(C.c)("comment")(T=Object(C.c)("thread")(T=Object(C.d)(T=function(e){d()(r,e);var t=$(r);function r(e){var n;return l()(this,r),(n=t.call(this,e)).state={commentSort:!0,showDeletePopup:!1,showReplyDeletePopup:!1,commentId:null},n.commentData=null,n.replyData=null,n}return m()(r,[{key:"onBackClick",value:function(){this.props.router.back()}},{key:"likeClick",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return r={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(r,this.props.thread);case 9:n=e.sent,s=n.success,i=n.msg,s&&(this.props.comment.setCommentDetailField("isLiked",r.isLiked),a=r.isLiked?t.likeCount+1:t.likeCount-1,this.props.comment.setCommentDetailField("likeCount",a)),s||N.a.error({content:i});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onFollowClick",value:function(){var e,t,r,n,s,i;if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});null!==(e=this.props.comment)&&void 0!==e&&null!==(t=e.commentDetail)&&void 0!==t&&t.userId&&(2===(null===(r=this.props.comment)||void 0===r||null===(n=r.authorInfo)||void 0===n?void 0:n.follow)||1===(null===(s=this.props.comment)||void 0===s||null===(i=s.authorInfo)||void 0===i?void 0:i.follow)?this.props.comment.cancelFollow({id:this.props.comment.commentDetail.userId,type:1},this.props.user):this.props.comment.postFollow(this.props.comment.commentDetail.userId,this.props.user))}},{key:"replyLikeClick",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s,i,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.id){e.next=6;break}return e.abrupt("return");case 6:return r={id:t.id,isLiked:!t.isLiked},e.next=9,this.props.comment.updateLiked(r,this.props.thread);case 9:n=e.sent,s=n.success,i=n.msg,s&&(this.props.comment.setReplyListDetailField(t.id,"isLiked",r.isLiked),a=r.isLiked?t.likeCount+1:t.likeCount-1,this.props.comment.setReplyListDetailField(t.id,"likeCount",a)),s||N.a.error({content:i});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteClick",value:function(){var e=c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:this.commentData=this.props.comment.commentDetail,this.setState({showDeletePopup:!0});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteComment",value:function(){var e=c()(o.a.mark((function e(){var t,r,n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.commentData.id){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.props.comment.delete(this.commentData.id,this.props.thread);case 4:if(t=e.sent,r=t.success,n=t.msg,this.setState({showDeletePopup:!1}),!r){e.next=13;break}return N.a.success({content:"\u5220\u9664\u6210\u529f"}),(s=this.props.comment.threadId)&&this.props.router.push("/thread/".concat(s)),e.abrupt("return");case 13:N.a.error({content:n});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyDeleteClick",value:function(){var e=c()(o.a.mark((function e(t,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.commentData=r,this.replyData=t,this.setState({showReplyDeletePopup:!0});case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"replyDeleteComment",value:function(){var e=c()(o.a.mark((function e(){var t,r,n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.replyData.id){e.next=2;break}return e.abrupt("return");case 2:return t={},this.replyData&&this.commentData&&(t.replyData=this.replyData,t.commentData=this.commentData),e.next=6,this.props.comment.deleteReplyComment(t,this.props.thread);case 6:if(r=e.sent,n=r.success,s=r.msg,this.setState({showReplyDeletePopup:!1}),!n){e.next=13;break}return N.a.success({content:"\u5220\u9664\u6210\u529f"}),e.abrupt("return");case 13:N.a.error({content:s});case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"replyClick",value:function(e){if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});this.commentData=e,this.replyData=null,this.setState({commentId:e.id})}},{key:"replyReplyClick",value:function(e,t){if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});this.commentData=null,this.replyData=e,this.replyData.commentId=t.id,this.setState({commentId:null})}},{key:"createReply",value:function(){var e=c()(o.a.mark((function e(t,r){var n,s,i,a,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.user.isLogin()){e.next=4;break}return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),Object(F.a)({url:"/user/login"}),e.abrupt("return");case 4:if(t.replace(/\s/g,"")){e.next=8;break}return N.a.info({content:"\u8bf7\u8f93\u5165\u5185\u5bb9"}),e.abrupt("return");case 8:if(n=this.props.comment.threadId){e.next=11;break}return e.abrupt("return");case 11:return s={id:n,content:t},this.replyData&&(s.replyId=this.replyData.id,s.isComment=!0,s.commentId=this.replyData.commentId,s.commentPostId=this.replyData.id),this.commentData&&(s.replyId=this.commentData.id,s.isComment=!0,s.commentId=this.commentData.id),null!==r&&void 0!==r&&r.length&&(s.attachments=r.filter((function(e){return"success"===e.status&&e.response})).map((function(e){return{id:e.response.id,type:"attachments"}}))),e.next=17,this.props.comment.createReply(s,this.props.thread);case 17:if(i=e.sent,a=i.success,c=i.msg,u=i.isApproved,!a){e.next=25;break}return this.setState({commentId:null}),u?N.a.success({content:c}):N.a.warning({content:c}),e.abrupt("return",!0);case 25:N.a.error({content:c});case 26:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"onPrivateLetter",value:function(){var e;if(!this.props.user.isLogin())return N.a.info({content:"\u8bf7\u5148\u767b\u5f55!"}),void Object(F.a)({url:"/user/login"});var t=null===(e=this.props.comment)||void 0===e?void 0:e.authorInfo,r=t.username,n=t.nickname;r&&O.a.push({url:"/message?page=chat&username=".concat(r,"&nickname=").concat(n)})}},{key:"onUserClick",value:function(e){e&&O.a.push({url:"/user/".concat(e)})}},{key:"render",value:function(){var e,t,r,n,i,o,a,c,u,l,p=this,m=this.props.comment,h=m.commentDetail,d=m.isReady,f=m.isAuthorInfoError,v=(null===(e=this.props.user)||void 0===e||null===(t=e.userInfo)||void 0===t?void 0:t.id)&&(null===(r=this.props.user)||void 0===r||null===(n=r.userInfo)||void 0===n?void 0:n.id)===(null===h||void 0===h?void 0:h.userId);return Object(s.jsxs)("div",{className:U.a.container,children:[Object(s.jsx)("div",{className:U.a.header,children:Object(s.jsx)(P.a,{})}),Object(s.jsxs)("div",{className:U.a.body,children:[Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:U.a.bodyLeft,children:[Object(s.jsxs)("div",{className:U.a.bodyLeftHeader,children:[Object(s.jsxs)("div",{className:U.a.back,onClick:function(){return p.onBackClick()},children:[Object(s.jsx)(X.a,{name:"ReturnOutlined"}),Object(s.jsx)("span",{className:U.a.text,children:"\u8fd4\u56de"})]}),Object(s.jsxs)("div",{className:U.a.bodyHeaderOperate,children:[null!==(i=this.props.comment)&&void 0!==i&&i.rewards?Object(s.jsx)("div",{className:U.a.reward,children:Object(s.jsx)(Q.a,{number:this.props.comment.rewards})}):"",null!==(o=this.props.comment)&&void 0!==o&&o.redPacketAmount?Object(s.jsx)("div",{className:U.a.redpacket,children:Object(s.jsx)(Y.a,{number:this.props.comment.redPacketAmount})}):"",(null===(a=this.props.comment)||void 0===a||null===(c=a.commentDetail)||void 0===c?void 0:c.canDelete)&&Object(s.jsxs)("div",{className:U.a.delete,onClick:function(){return p.deleteClick()},children:[Object(s.jsx)(X.a,{name:"DeleteOutlined"}),Object(s.jsx)("span",{className:U.a.text,children:"\u5220\u9664"})]})]})]}),d?Object(s.jsx)(W.a,{data:h,likeClick:function(){return p.likeClick(h)},replyClick:function(){return p.replyClick(h)},replyLikeClick:function(e){return p.replyLikeClick(e,h)},replyReplyClick:function(e){return p.replyReplyClick(e,h)},replyDeleteClick:function(e){return p.replyDeleteClick(e,h)},avatarClick:function(e){return p.onUserClick(e)},isHideEdit:!0,isFirstDivider:!0,isShowInput:this.state.commentId===h.id,onSubmit:function(e,t){return p.createReply(e,t)}}):Object(s.jsx)(z.a,{type:"init"})]}),Object(s.jsx)(G,{empty:!1})]}),Object(s.jsxs)("div",{className:U.a.bodyRigth,children:[Object(s.jsx)("div",{className:U.a.authorInfo,children:null!==(u=this.props.comment)&&void 0!==u&&u.authorInfo?Object(s.jsx)(J.a,{user:null===(l=this.props.comment)||void 0===l?void 0:l.authorInfo,onFollowClick:function(){return p.onFollowClick()},isShowBtn:!v,onPrivateLetter:function(){return p.onPrivateLetter()},onPersonalPage:function(){var e,t;return p.onUserClick(null===(e=p.props.comment)||void 0===e||null===(t=e.authorInfo)||void 0===t?void 0:t.id)}}):Object(s.jsx)(z.a,{isError:f,type:"init"})}),Object(s.jsx)("div",{className:U.a.recommend,children:Object(s.jsx)(q.a,{})})]})]}),Object(s.jsx)(R.a,{visible:this.state.showDeletePopup,onClose:function(){return p.setState({showDeletePopup:!1})},onBtnClick:function(){return p.deleteComment()}}),Object(s.jsx)(R.a,{visible:this.state.showReplyDeletePopup,onClose:function(){return p.setState({showReplyDeletePopup:!1})},onBtnClick:function(){return p.replyDeleteComment()}})]})}}]),r}(j.a.Component))||T)||T)||T)||T)||T,re=Object(x.withRouter)(te),ne=r("ZCww"),se=r("L0er"),ie=r("QcND"),oe=r("zZWi"),ae=r("J0pL");function ce(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=y()(e);if(t){var s=y()(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return v()(this,r)}}var ue=Object(C.c)("site")(ee=Object(C.c)("comment")(ee=Object(C.d)(ee=function(e){d()(r,e);var t=ce(r);function r(e){var n;l()(this,r);var s=(n=t.call(this,e)).props,i=s.serverData,o=s.comment;return i&&o.setCommentDetail(i),n.state={isServerError:!1,serverErrorMsg:""},n}return m()(r,null,[{key:"getInitialProps",value:function(){var e=c()(o.a.mark((function e(t){var r,n,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===t||void 0===t||null===(r=t.query)||void 0===r?void 0:r.id){e.next=3;break}return e.abrupt("return",{props:{serverData:null}});case 3:return e.next=5,Object(D.readCommentDetail)({params:{pid:n}});case 5:return s=e.sent,e.abrupt("return",{props:{serverData:s.data}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),m()(r,[{key:"componentDidMount",value:function(){var e=c()(o.a.mark((function e(){var t,r,n,s,i,a,c,u,l,p,m,h,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=this.props.router.query,i=s.id,a=s.threadId,c=null===(t=this.props)||void 0===t||null===(r=t.comment)||void 0===r||null===(n=r.commentDetail)||void 0===n?void 0:n.id,Number(i)!==c||!i||!c){e.next=4;break}return e.abrupt("return");case 4:if(this.props.comment.reset(),a&&this.props.comment.setThreadId(a),this.props.serverData||!i){e.next=21;break}return e.next=9,this.props.comment.fetchCommentDetail(i);case 9:if(0===(p=e.sent).code){e.next=17;break}if(-4004!==p.code){e.next=14;break}return O.a.replace({url:"/404"}),e.abrupt("return");case 14:return p.code>-5e3&&p.code<-4e3&&this.setState({serverErrorMsg:p.msg}),this.setState({isServerError:!0}),e.abrupt("return");case 17:m=this.props.site,h=m.platform,d=null===(u=this.props.comment)||void 0===u||null===(l=u.commentDetail)||void 0===l?void 0:l.userId,"pc"===h&&d&&this.props.comment.fetchAuthorInfo(d);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.site.platform;return this.state.isServerError?"h5"===e?Object(s.jsx)(se.a,{text:this.state.serverErrorMsg}):Object(s.jsx)(ne.a,{text:this.state.serverErrorMsg}):Object(s.jsx)(ae.a,{h5:Object(s.jsx)(_,{}),pc:Object(s.jsx)(re,{})})}}]),r}(j.a.Component))||ee)||ee)||ee;t.default=Object(ie.a)(Object(oe.a)(Object(x.withRouter)(ue)))},zZWi:function(e,t,r){"use strict";r.d(t,"a",(function(){return I}));var n=r("nKUr"),s=r("o0o1"),i=r.n(s),o=r("lSNA"),a=r.n(o),c=(r("ls82"),r("yXPU")),u=r.n(c),l=r("lwsE"),p=r.n(l),m=r("W8MJ"),h=r.n(m),d=r("7W2i"),f=r.n(d),v=r("a1gu"),k=r.n(v),y=r("Nsbk"),b=r.n(y),j=r("q1tI"),x=r.n(j),C=r("kMSe"),D=r("n4oF"),w=r("lN2P");function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b()(e);if(t){var s=b()(this).constructor;r=Reflect.construct(n,arguments,s)}else r=n.apply(this,arguments);return k()(this,r)}}function I(e){var t;return Object(C.c)("user")(t=Object(C.d)(t=function(t){f()(s,t);var r=L(s);function s(e){return p()(this,s),r.call(this,e)}return h()(s,null,[{key:"getInitialProps",value:function(){var t=u()(i.a.mark((function t(r,n){var s;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n){t.next=2;break}throw Error("CheckLoginStatus\u5fc5\u987b\u524d\u7f6e\u4f7f\u7528HOCFetchSiteData");case 2:if(t.prev=2,s={},!Object(D.a)()){t.next=9;break}if(!e.getInitialProps){t.next=9;break}return t.next=8,e.getInitialProps(r);case 8:s=t.sent;case 9:return t.abrupt("return",g({},s));case 12:return t.prev=12,t.t0=t.catch(2),console.log("err",t.t0),t.abrupt("return",{});case 16:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(e,r){return t.apply(this,arguments)}}()}]),h()(s,[{key:"componentDidMount",value:function(){this.props.user.loginStatus||w.a.saveAndLogin()}},{key:"componentDidUpdate",value:function(){this.props.user.loginStatus||w.a.saveAndLogin()}},{key:"render",value:function(){var t=this.props.user.loginStatus;return"padding"!==t&&t?Object(n.jsx)(e,g({},this.props)):null}}]),s}(x.a.Component))||t)||t}}},[["Rs2Y",1,0,3,4,7,2]]]);